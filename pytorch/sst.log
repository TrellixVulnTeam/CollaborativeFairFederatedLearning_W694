Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'save_gpu': True, 'dataset': 'sst', 'sample_size_cap': 5000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 64, 'train_val_split_ratio': 0.9, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNN_Text'>, 'embed_num': 20000, 'embed_dim': 300, 'class_num': 5, 'kernel_num': 128, 'kernel_sizes': [3, 4, 5], 'optimizer_fn': <class 'torch.optim.adam.Adam'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 1e-05, 'dssgd_lr': 0.0001, 'lr': 0.0001, 'grad_clip': 1, 'gamma': 1, 'pretrain_epochs': 1, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_ids': [0]} 

Model embedding arguments: Namespace(class_num=5, embed_dim=128, embed_num=19538, kernel_num=128, kernel_sizes=[3, 4, 5], label_field=<torchtext.data.field.LabelField object at 0x7fa3da3cf4d0>, static=False, text_field=<torchtext.data.field.Field object at 0x7fa3da3cfb90>)

Experiment : No.1/5
CFFL server model validation accuracy : 16.8937%
CFFL server model test accuracy : 16.2896%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1988, 0.2129, 0.1897, 0.2007, 0.1979])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.2222)
tensor([0.0000, 0.2443, 0.2544, 0.2583, 0.2430])
Reputable parties pretrain:  [1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['21.267%', '26.606%', '25.611%', '24.389%', '27.195%']
Workers DSSGD     accuracies:  ['25.520%', '28.688%', '28.643%', '28.733%', '28.733%']

Workers before    accuracies:  ['16.290%', '16.290%', '16.290%', '16.290%', '16.290%']
Workers CFFL      accuracies:  ['28.733%', '28.733%', '28.733%', '28.733%', '28.733%']

Workers before pr accuracies:  ['17.014%', '17.647%', '19.593%', '21.493%', '17.964%']
Workers CFFL pret accuracies:  ['19.683%', '28.597%', '28.597%', '28.643%', '28.552%']

Epoch 21:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.2222)
tensor([0.0000, 0.2370, 0.2508, 0.2752, 0.2371])
Reputable parties pretrain:  [1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.109%', '30.995%', '28.552%', '31.222%', '30.271%']
Workers DSSGD     accuracies:  ['30.407%', '31.222%', '30.136%', '27.964%', '26.154%']

Workers before    accuracies:  ['16.290%', '16.290%', '16.290%', '16.290%', '16.290%']
Workers CFFL      accuracies:  ['30.271%', '32.489%', '29.548%', '31.041%', '28.869%']

Workers before pr accuracies:  ['17.014%', '17.647%', '19.593%', '21.493%', '17.964%']
Workers CFFL pret accuracies:  ['25.249%', '29.095%', '28.959%', '29.050%', '29.005%']

Epoch 41:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.2222)
tensor([0.0000, 0.2287, 0.2538, 0.2835, 0.2339])
Reputable parties pretrain:  [1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.063%', '30.543%', '29.910%', '30.317%', '30.995%']
Workers DSSGD     accuracies:  ['33.167%', '31.900%', '31.765%', '30.543%', '29.457%']

Workers before    accuracies:  ['16.290%', '16.290%', '16.290%', '16.290%', '16.290%']
Workers CFFL      accuracies:  ['30.000%', '32.308%', '29.276%', '31.991%', '29.321%']

Workers before pr accuracies:  ['17.014%', '17.647%', '19.593%', '21.493%', '17.964%']
Workers CFFL pret accuracies:  ['25.475%', '29.683%', '29.683%', '29.683%', '29.729%']

Epoch 61:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.2222)
tensor([0.0000, 0.2319, 0.2526, 0.2798, 0.2357])
Reputable parties pretrain:  [1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.923%', '30.995%', '30.090%', '32.127%', '30.633%']
Workers DSSGD     accuracies:  ['33.620%', '33.575%', '33.167%', '33.394%', '32.624%']

Workers before    accuracies:  ['16.290%', '16.290%', '16.290%', '16.290%', '16.290%']
Workers CFFL      accuracies:  ['29.864%', '32.262%', '28.914%', '32.353%', '29.774%']

Workers before pr accuracies:  ['17.014%', '17.647%', '19.593%', '21.493%', '17.964%']
Workers CFFL pret accuracies:  ['26.154%', '30.633%', '30.724%', '30.633%', '30.543%']

Epoch 81:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.2222)
tensor([0.0000, 0.2367, 0.2519, 0.2726, 0.2388])
Reputable parties pretrain:  [1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.923%', '31.222%', '29.231%', '31.719%', '31.041%']
Workers DSSGD     accuracies:  ['34.706%', '34.796%', '35.339%', '35.249%', '33.801%']

Workers before    accuracies:  ['16.290%', '16.290%', '16.290%', '16.290%', '16.290%']
Workers CFFL      accuracies:  ['29.548%', '31.765%', '28.778%', '31.810%', '30.136%']

Workers before pr accuracies:  ['17.014%', '17.647%', '19.593%', '21.493%', '17.964%']
Workers CFFL pret accuracies:  ['26.109%', '33.122%', '33.484%', '33.484%', '33.032%']
pretraining 2.758277654647827
evaluation after pretraining 0.7728376388549805
workers local training 2029.6525604724884
server aggregation 68.4427421092987
server aggregation with pretraining 70.30955982208252
server aggregation dssgd 40.76788520812988
fed model eval on valid loader 5.755651235580444
credit updates 0.8052036762237549
assign updates 12.019679546356201
performance update 110.68512296676636
total seconds 2341.969520330429
Time_dict-----
{"pretraining": 2.758277654647827, "evaluation after pretraining": 0.7728376388549805, "workers local training": 2029.6525604724884, "server aggregation": 68.4427421092987, "server aggregation with pretraining": 70.30955982208252, "server aggregation dssgd": 40.76788520812988, "fed model eval on valid loader": 5.755651235580444, "credit updates": 0.8052036762237549, "assign updates": 12.019679546356201, "performance update": 110.68512296676636}
-----
Performance and Fairness analysis: 
Worker credits : [0.0, 0.0, 0.0, 1.0, 0.0]
Number of reputable parties:  1
Worker credits pretrain: [0.0, 0.23934213817119598, 0.2639327645301819, 0.2590527832508087, 0.23767231404781342]
Number of reputable parties with pretrain:  4
----Results without pretrain
standalone_best_worker  -  0.32081449031829834
CFFL_best_worker  -  0.3199095129966736
rr_dssgd_best  -  0.3321267068386078
standlone_vs_rrdssgd  -  [0.8527742008225088]
standalone_vs_final  -  [0.91397816369073]
----
----Results with pretrain
standalone_best_worker  -  0.32081449031829834
CFFL_best_worker  -  0.2760181128978729
rr_dssgd_best  -  0.3321267068386078
standlone_vs_rrdssgd  -  [0.8527742008225088]
standalone_vs_final  -  [0.8435368538456692]
----

Experiment : No.2/5
CFFL server model validation accuracy : 26.7030%
CFFL server model test accuracy : 26.4706%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1823, 0.2073, 0.1974, 0.2056, 0.2073])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1979, 0.1979, 0.1996, 0.2058, 0.1988])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['25.701%', '26.878%', '25.882%', '24.706%', '27.511%']
Workers DSSGD     accuracies:  ['25.068%', '26.652%', '27.104%', '26.154%', '26.109%']

Workers before    accuracies:  ['26.425%', '26.425%', '26.425%', '26.425%', '26.471%']
Workers CFFL      accuracies:  ['28.462%', '28.416%', '28.462%', '28.507%', '28.416%']

Workers before pr accuracies:  ['26.516%', '26.425%', '26.335%', '25.249%', '26.516%']
Workers CFFL pret accuracies:  ['26.335%', '26.516%', '25.566%', '24.932%', '26.335%']

Epoch 21:
credits, credit threshold: tensor(0.1667)
tensor([0.1950, 0.2001, 0.2035, 0.1995, 0.2020])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2015, 0.2024, 0.1987, 0.1994, 0.1979])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['25.973%', '30.633%', '29.095%', '30.498%', '29.864%']
Workers DSSGD     accuracies:  ['23.122%', '23.122%', '23.258%', '25.475%', '32.805%']

Workers before    accuracies:  ['26.425%', '26.425%', '26.425%', '26.425%', '26.471%']
Workers CFFL      accuracies:  ['34.570%', '34.977%', '34.751%', '34.887%', '34.796%']

Workers before pr accuracies:  ['26.516%', '26.425%', '26.335%', '25.249%', '26.516%']
Workers CFFL pret accuracies:  ['18.688%', '31.674%', '30.814%', '30.769%', '31.041%']

Epoch 41:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2464, 0.2477, 0.2576, 0.2483])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties pretrain:  [3]
Below are testset accuracies: ---
Workers standalone accuracies:  ['25.973%', '30.995%', '30.633%', '31.765%', '31.403%']
Workers DSSGD     accuracies:  ['26.878%', '25.611%', '25.837%', '29.005%', '31.629%']

Workers before    accuracies:  ['26.425%', '26.425%', '26.425%', '26.425%', '26.471%']
Workers CFFL      accuracies:  ['31.584%', '32.172%', '31.855%', '31.946%', '32.081%']

Workers before pr accuracies:  ['26.516%', '26.425%', '26.335%', '25.249%', '26.516%']
Workers CFFL pret accuracies:  ['23.891%', '33.394%', '32.172%', '30.543%', '29.955%']

Epoch 61:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2393, 0.2567, 0.2631, 0.2409])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties pretrain:  [3]
Below are testset accuracies: ---
Workers standalone accuracies:  ['25.837%', '30.950%', '30.995%', '32.353%', '31.222%']
Workers DSSGD     accuracies:  ['32.624%', '32.896%', '33.756%', '34.072%', '32.805%']

Workers before    accuracies:  ['26.425%', '26.425%', '26.425%', '26.425%', '26.471%']
Workers CFFL      accuracies:  ['33.077%', '28.145%', '27.692%', '27.783%', '27.919%']

Workers before pr accuracies:  ['26.516%', '26.425%', '26.335%', '25.249%', '26.516%']
Workers CFFL pret accuracies:  ['29.593%', '33.348%', '32.262%', '31.855%', '32.308%']

Epoch 81:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2516, 0.2480, 0.2498, 0.2507])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties pretrain:  [3]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.425%', '31.086%', '31.448%', '31.855%', '32.081%']
Workers DSSGD     accuracies:  ['34.299%', '34.661%', '35.611%', '35.837%', '35.747%']

Workers before    accuracies:  ['26.425%', '26.425%', '26.425%', '26.425%', '26.471%']
Workers CFFL      accuracies:  ['33.122%', '33.710%', '33.756%', '33.710%', '33.620%']

Workers before pr accuracies:  ['26.516%', '26.425%', '26.335%', '25.249%', '26.516%']
Workers CFFL pret accuracies:  ['29.729%', '33.575%', '31.810%', '32.127%', '32.398%']
pretraining 1.1870687007904053
evaluation after pretraining 0.6692578792572021
workers local training 1960.190604686737
server aggregation 65.93613600730896
server aggregation with pretraining 67.07433271408081
server aggregation dssgd 39.92892098426819
fed model eval on valid loader 5.54547381401062
credit updates 0.7909541130065918
assign updates 11.915788650512695
performance update 106.93181037902832
total seconds 2260.170347929001
Time_dict-----
{"pretraining": 1.1870687007904053, "evaluation after pretraining": 0.6692578792572021, "workers local training": 1960.190604686737, "server aggregation": 65.93613600730896, "server aggregation with pretraining": 67.07433271408081, "server aggregation dssgd": 39.92892098426819, "fed model eval on valid loader": 5.54547381401062, "credit updates": 0.7909541130065918, "assign updates": 11.915788650512695, "performance update": 106.93181037902832}
-----
Performance and Fairness analysis: 
Worker credits : [0.0, 0.2515195310115814, 0.2480674684047699, 0.25158628821372986, 0.24882671236991882]
Number of reputable parties:  4
Worker credits pretrain: [0.0, 0.0, 0.0, 1.0, 0.0]
Number of reputable parties with pretrain:  1
----Results without pretrain
standalone_best_worker  -  0.32307693362236023
CFFL_best_worker  -  0.35113123059272766
rr_dssgd_best  -  0.3416289687156677
standlone_vs_rrdssgd  -  [0.8563365104894315]
standalone_vs_final  -  [0.8138299304072376]
----
----Results with pretrain
standalone_best_worker  -  0.30814480781555176
CFFL_best_worker  -  0.3334841728210449
rr_dssgd_best  -  0.3153846263885498
standlone_vs_rrdssgd  -  [0.8563365104894315]
standalone_vs_final  -  [0.7993648800393373]
----

Experiment : No.3/5
CFFL server model validation accuracy : 25.7039%
CFFL server model test accuracy : 27.6471%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1877, 0.2049, 0.2031, 0.2059, 0.1985])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1969, 0.2024, 0.2005, 0.2005, 0.1996])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['27.873%', '28.054%', '24.570%', '25.475%', '27.149%']
Workers DSSGD     accuracies:  ['27.149%', '23.439%', '23.348%', '23.303%', '23.213%']

Workers before    accuracies:  ['27.647%', '27.647%', '27.647%', '27.647%', '27.647%']
Workers CFFL      accuracies:  ['23.348%', '23.303%', '23.303%', '23.303%', '23.303%']

Workers before pr accuracies:  ['27.647%', '27.738%', '27.828%', '27.964%', '27.647%']
Workers CFFL pret accuracies:  ['23.167%', '23.167%', '23.122%', '23.122%', '23.122%']

Epoch 21:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1944, 0.1986, 0.1980, 0.2118, 0.1972])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['28.552%', '29.412%', '29.683%', '31.131%', '30.814%']
Workers DSSGD     accuracies:  ['28.733%', '28.688%', '28.733%', '30.136%', '26.606%']

Workers before    accuracies:  ['27.647%', '27.647%', '27.647%', '27.647%', '27.647%']
Workers CFFL      accuracies:  ['30.452%', '27.059%', '28.145%', '29.367%', '26.697%']

Workers before pr accuracies:  ['27.647%', '27.738%', '27.828%', '27.964%', '27.647%']
Workers CFFL pret accuracies:  ['23.982%', '23.982%', '23.756%', '23.801%', '23.756%']

Epoch 41:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1914, 0.1985, 0.2010, 0.2128, 0.1963])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['28.326%', '30.226%', '30.814%', '32.534%', '31.131%']
Workers DSSGD     accuracies:  ['32.036%', '31.991%', '29.729%', '27.421%', '26.335%']

Workers before    accuracies:  ['27.647%', '27.647%', '27.647%', '27.647%', '27.647%']
Workers CFFL      accuracies:  ['30.045%', '29.140%', '29.638%', '30.498%', '28.733%']

Workers before pr accuracies:  ['27.647%', '27.738%', '27.828%', '27.964%', '27.647%']
Workers CFFL pret accuracies:  ['25.294%', '25.204%', '25.068%', '24.887%', '25.113%']

Epoch 61:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1879, 0.1960, 0.2014, 0.2167, 0.1981])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['28.281%', '29.729%', '30.136%', '32.534%', '31.448%']
Workers DSSGD     accuracies:  ['34.887%', '34.751%', '33.891%', '31.629%', '30.498%']

Workers before    accuracies:  ['27.647%', '27.647%', '27.647%', '27.647%', '27.647%']
Workers CFFL      accuracies:  ['29.910%', '29.729%', '29.638%', '30.498%', '29.683%']

Workers before pr accuracies:  ['27.647%', '27.738%', '27.828%', '27.964%', '27.647%']
Workers CFFL pret accuracies:  ['26.833%', '26.697%', '26.290%', '26.063%', '26.652%']

Epoch 81:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1926, 0.1971, 0.2054, 0.2121, 0.1928])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['28.009%', '29.502%', '30.181%', '32.579%', '31.538%']
Workers DSSGD     accuracies:  ['33.439%', '33.394%', '33.575%', '33.801%', '33.122%']

Workers before    accuracies:  ['27.647%', '27.647%', '27.647%', '27.647%', '27.647%']
Workers CFFL      accuracies:  ['29.774%', '29.638%', '29.638%', '30.633%', '29.276%']

Workers before pr accuracies:  ['27.647%', '27.738%', '27.828%', '27.964%', '27.647%']
Workers CFFL pret accuracies:  ['28.145%', '28.009%', '27.783%', '27.511%', '28.009%']
pretraining 1.2014515399932861
evaluation after pretraining 0.6898758411407471
workers local training 1960.8722586631775
server aggregation 65.58760857582092
server aggregation with pretraining 66.93779683113098
server aggregation dssgd 39.84126567840576
fed model eval on valid loader 5.856163024902344
credit updates 0.7460732460021973
assign updates 12.187413692474365
performance update 106.63497519493103
total seconds 2260.554882287979
Time_dict-----
{"pretraining": 1.2014515399932861, "evaluation after pretraining": 0.6898758411407471, "workers local training": 1960.8722586631775, "server aggregation": 65.58760857582092, "server aggregation with pretraining": 66.93779683113098, "server aggregation dssgd": 39.84126567840576, "fed model eval on valid loader": 5.856163024902344, "credit updates": 0.7460732460021973, "assign updates": 12.187413692474365, "performance update": 106.63497519493103}
-----
Performance and Fairness analysis: 
Worker credits : [0.0, 0.0, 0.0, 1.0, 0.0]
Number of reputable parties:  1
Worker credits pretrain: [0.18638361990451813, 0.20220282673835754, 0.199728325009346, 0.21299798786640167, 0.19868719577789307]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.3176470696926117
CFFL_best_worker  -  0.31402716040611267
rr_dssgd_best  -  0.3416289687156677
standlone_vs_rrdssgd  -  [-0.748396669355003]
standalone_vs_final  -  [0.5994777929192194]
----
----Results with pretrain
standalone_best_worker  -  0.3176470696926117
CFFL_best_worker  -  0.34298643469810486
rr_dssgd_best  -  0.3416289687156677
standlone_vs_rrdssgd  -  [-0.748396669355003]
standalone_vs_final  -  [0.5230973705604869]
----

Experiment : No.4/5
CFFL server model validation accuracy : 25.3406%
CFFL server model test accuracy : 22.8507%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.2010, 0.2081, 0.1881, 0.2045, 0.1984])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1928, 0.2072, 0.2027, 0.1937, 0.2036])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['23.937%', '27.511%', '25.566%', '25.566%', '26.968%']
Workers DSSGD     accuracies:  ['26.290%', '29.276%', '29.548%', '28.824%', '28.235%']

Workers before    accuracies:  ['22.851%', '22.851%', '22.851%', '22.851%', '22.851%']
Workers CFFL      accuracies:  ['28.281%', '28.235%', '28.552%', '28.190%', '28.326%']

Workers before pr accuracies:  ['22.896%', '23.258%', '23.529%', '24.072%', '23.167%']
Workers CFFL pret accuracies:  ['28.235%', '28.190%', '28.009%', '28.100%', '28.145%']

Epoch 21:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2505, 0.2535, 0.2513, 0.2448])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1922, 0.1907, 0.2003, 0.2262, 0.1906])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.109%', '29.683%', '28.009%', '31.222%', '29.729%']
Workers DSSGD     accuracies:  ['29.005%', '29.367%', '23.167%', '22.760%', '22.805%']

Workers before    accuracies:  ['22.851%', '22.851%', '22.851%', '22.851%', '22.851%']
Workers CFFL      accuracies:  ['29.231%', '28.959%', '30.498%', '30.543%', '28.552%']

Workers before pr accuracies:  ['22.896%', '23.258%', '23.529%', '24.072%', '23.167%']
Workers CFFL pret accuracies:  ['29.095%', '29.367%', '29.140%', '29.095%', '29.186%']

Epoch 41:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2494, 0.2510, 0.2566, 0.2430])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1836, 0.1886, 0.2093, 0.2322, 0.1863])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.833%', '29.955%', '30.136%', '31.403%', '30.362%']
Workers DSSGD     accuracies:  ['28.733%', '28.100%', '25.566%', '26.833%', '29.321%']

Workers before    accuracies:  ['22.851%', '22.851%', '22.851%', '22.851%', '22.851%']
Workers CFFL      accuracies:  ['29.095%', '28.100%', '26.923%', '26.742%', '28.009%']

Workers before pr accuracies:  ['22.896%', '23.258%', '23.529%', '24.072%', '23.167%']
Workers CFFL pret accuracies:  ['29.367%', '29.502%', '29.412%', '29.729%', '29.321%']

Epoch 61:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2486, 0.2492, 0.2491, 0.2532])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1728, 0.1940, 0.2113, 0.2251, 0.1969])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['27.330%', '30.362%', '30.362%', '32.217%', '31.448%']
Workers DSSGD     accuracies:  ['28.100%', '28.190%', '28.326%', '29.140%', '29.412%']

Workers before    accuracies:  ['22.851%', '22.851%', '22.851%', '22.851%', '22.851%']
Workers CFFL      accuracies:  ['29.231%', '23.620%', '26.063%', '26.335%', '23.620%']

Workers before pr accuracies:  ['22.896%', '23.258%', '23.529%', '24.072%', '23.167%']
Workers CFFL pret accuracies:  ['31.991%', '32.081%', '31.674%', '31.900%', '32.036%']

Epoch 81:
credits, credit threshold: tensor(0.1667)
tensor([0.2056, 0.1973, 0.1916, 0.1982, 0.2073])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1761, 0.1949, 0.2154, 0.2182, 0.1954])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['27.647%', '30.724%', '29.548%', '31.493%', '30.679%']
Workers DSSGD     accuracies:  ['32.534%', '32.443%', '29.593%', '28.643%', '28.416%']

Workers before    accuracies:  ['22.851%', '22.851%', '22.851%', '22.851%', '22.851%']
Workers CFFL      accuracies:  ['19.638%', '23.077%', '22.579%', '22.534%', '24.525%']

Workers before pr accuracies:  ['22.896%', '23.258%', '23.529%', '24.072%', '23.167%']
Workers CFFL pret accuracies:  ['33.032%', '33.077%', '32.805%', '32.805%', '33.077%']
pretraining 1.188816785812378
evaluation after pretraining 0.6664688587188721
workers local training 1959.556619644165
server aggregation 65.96041512489319
server aggregation with pretraining 66.91287541389465
server aggregation dssgd 39.999722719192505
fed model eval on valid loader 5.767096042633057
credit updates 0.772132158279419
assign updates 12.482100486755371
performance update 106.38045382499695
total seconds 2259.6867010593414
Time_dict-----
{"pretraining": 1.188816785812378, "evaluation after pretraining": 0.6664688587188721, "workers local training": 1959.556619644165, "server aggregation": 65.96041512489319, "server aggregation with pretraining": 66.91287541389465, "server aggregation dssgd": 39.999722719192505, "fed model eval on valid loader": 5.767096042633057, "credit updates": 0.772132158279419, "assign updates": 12.482100486755371, "performance update": 106.38045382499695}
-----
Performance and Fairness analysis: 
Worker credits : [0.20258554816246033, 0.1960209161043167, 0.19237661361694336, 0.2008538395166397, 0.2081630825996399]
Number of reputable parties:  5
Worker credits pretrain: [0.18778051435947418, 0.19455768167972565, 0.20214881002902985, 0.2189549207687378, 0.19655804336071014]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.30995476245880127
CFFL_best_worker  -  0.33122172951698303
rr_dssgd_best  -  0.33122172951698303
standlone_vs_rrdssgd  -  [-0.33789415396495504]
standalone_vs_final  -  [0.47855378124903813]
----
----Results with pretrain
standalone_best_worker  -  0.31628960371017456
CFFL_best_worker  -  0.26515838503837585
rr_dssgd_best  -  0.32669684290885925
standlone_vs_rrdssgd  -  [-0.33789415396495504]
standalone_vs_final  -  [-0.00721017826531728]
----

Experiment : No.5/5
CFFL server model validation accuracy : 25.8856%
CFFL server model test accuracy : 27.5566%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1902, 0.1945, 0.1953, 0.2220, 0.1979])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1970, 0.2017, 0.1979, 0.1998, 0.2036])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.109%', '26.697%', '26.199%', '26.471%', '25.611%']
Workers DSSGD     accuracies:  ['25.837%', '26.063%', '25.656%', '25.068%', '18.190%']

Workers before    accuracies:  ['27.557%', '27.557%', '27.557%', '27.557%', '27.557%']
Workers CFFL      accuracies:  ['19.050%', '18.824%', '18.824%', '18.643%', '18.824%']

Workers before pr accuracies:  ['27.557%', '27.330%', '27.149%', '26.742%', '27.240%']
Workers CFFL pret accuracies:  ['21.855%', '20.000%', '19.050%', '18.733%', '19.638%']

Epoch 21:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2452, 0.2374, 0.2733, 0.2441])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1922, 0.1934, 0.1967, 0.2220, 0.1958])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['27.602%', '30.679%', '28.733%', '32.670%', '30.407%']
Workers DSSGD     accuracies:  ['23.710%', '23.348%', '23.439%', '26.516%', '22.760%']

Workers before    accuracies:  ['27.557%', '27.557%', '27.557%', '27.557%', '27.557%']
Workers CFFL      accuracies:  ['29.231%', '28.643%', '28.643%', '28.145%', '28.733%']

Workers before pr accuracies:  ['27.557%', '27.330%', '27.149%', '26.742%', '27.240%']
Workers CFFL pret accuracies:  ['23.620%', '23.665%', '23.756%', '23.529%', '23.575%']

Epoch 41:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2507, 0.2464, 0.2502, 0.2527])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1810, 0.1877, 0.2114, 0.2323, 0.1876])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['27.511%', '30.452%', '30.181%', '31.719%', '30.769%']
Workers DSSGD     accuracies:  ['27.240%', '26.290%', '26.516%', '25.566%', '25.339%']

Workers before    accuracies:  ['27.557%', '27.557%', '27.557%', '27.557%', '27.557%']
Workers CFFL      accuracies:  ['29.412%', '25.294%', '29.548%', '30.271%', '24.977%']

Workers before pr accuracies:  ['27.557%', '27.330%', '27.149%', '26.742%', '27.240%']
Workers CFFL pret accuracies:  ['24.434%', '24.389%', '24.570%', '24.615%', '24.434%']

Epoch 61:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2478, 0.2517, 0.2507, 0.2499])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1798, 0.1888, 0.2138, 0.2257, 0.1918])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['27.783%', '30.679%', '30.045%', '31.810%', '30.543%']
Workers DSSGD     accuracies:  ['29.593%', '32.715%', '35.339%', '33.620%', '33.348%']

Workers before    accuracies:  ['27.557%', '27.557%', '27.557%', '27.557%', '27.557%']
Workers CFFL      accuracies:  ['28.914%', '32.896%', '32.534%', '33.213%', '32.670%']

Workers before pr accuracies:  ['27.557%', '27.330%', '27.149%', '26.742%', '27.240%']
Workers CFFL pret accuracies:  ['25.520%', '25.747%', '26.154%', '26.833%', '25.611%']

Epoch 81:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2528, 0.2468, 0.2497, 0.2507])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1888, 0.1906, 0.2018, 0.2262, 0.1926])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['26.742%', '31.674%', '30.136%', '32.670%', '30.362%']
Workers DSSGD     accuracies:  ['33.077%', '32.715%', '33.077%', '33.982%', '34.525%']

Workers before    accuracies:  ['27.557%', '27.557%', '27.557%', '27.557%', '27.557%']
Workers CFFL      accuracies:  ['28.643%', '32.262%', '33.258%', '33.439%', '32.036%']

Workers before pr accuracies:  ['27.557%', '27.330%', '27.149%', '26.742%', '27.240%']
Workers CFFL pret accuracies:  ['27.285%', '27.285%', '27.195%', '27.149%', '27.376%']
pretraining 1.186502456665039
evaluation after pretraining 0.6739082336425781
workers local training 1960.4191329479218
server aggregation 65.58685231208801
server aggregation with pretraining 67.82849860191345
server aggregation dssgd 39.631266355514526
fed model eval on valid loader 5.72761344909668
credit updates 0.7622296810150146
assign updates 12.451613187789917
performance update 106.69815158843994
total seconds 2260.965768814087
Time_dict-----
{"pretraining": 1.186502456665039, "evaluation after pretraining": 0.6739082336425781, "workers local training": 1960.4191329479218, "server aggregation": 65.58685231208801, "server aggregation with pretraining": 67.82849860191345, "server aggregation dssgd": 39.631266355514526, "fed model eval on valid loader": 5.72761344909668, "credit updates": 0.7622296810150146, "assign updates": 12.451613187789917, "performance update": 106.69815158843994}
-----
Performance and Fairness analysis: 
Worker credits : [0.0, 0.25237828493118286, 0.25077691674232483, 0.24909541010856628, 0.24774940311908722]
Number of reputable parties:  4
Worker credits pretrain: [0.18173593282699585, 0.1878572255373001, 0.21045412123203278, 0.22595399618148804, 0.19399872422218323]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.26742082834243774
CFFL_best_worker  -  0.28823530673980713
rr_dssgd_best  -  0.3570135831832886
standlone_vs_rrdssgd  -  [-0.5748492536192367]
standalone_vs_final  -  [-0.5301431987071356]
----
----Results with pretrain
standalone_best_worker  -  0.3217194676399231
CFFL_best_worker  -  0.3583710491657257
rr_dssgd_best  -  0.3013574779033661
standlone_vs_rrdssgd  -  [-0.5748492536192367]
standalone_vs_final  -  [0.8092368716350342]
----


|        |   Distriubted |     CFFL |   CFFL pretrain |
|:-------|--------------:|---------:|----------------:|
| P5_0.1 |    0.00959413 | 0.455139 |        0.593605 |
|               |   P5_0.1 |
|:--------------|---------:|
| Distributed   | 0.33638  |
| Standalone    | 0.320724 |
| CFFL          | 0.334932 |
| CFFL pretrain | 0.311946 |