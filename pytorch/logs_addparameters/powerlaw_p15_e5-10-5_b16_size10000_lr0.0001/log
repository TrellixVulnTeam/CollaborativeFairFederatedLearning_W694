Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 15, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.674358. Accuracy: 60.4492%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.9000%
Leave-one-out validation accuracies :  ['71.8000%', '71.8000%', '72.1000%', '72.0000%', '72.4000%', '73.2000%', '74.3000%', '75.0000%', '75.0000%', '75.5000%', '75.5000%', '75.8000%', '76.5000%', '76.5000%', '76.3000%']
Computed and normalized credits:  tensor([0.0705, 0.0705, 0.0700, 0.0702, 0.0696, 0.0683, 0.0665, 0.0655, 0.0655,
        0.0647, 0.0647, 0.0642, 0.0632, 0.0632, 0.0635])
Federated model performance: Loss: 0.570569. Accuracy: 71.4652%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['59.123%', '59.422%', '60.064%', '60.428%', '60.877%', '61.455%', '61.433%', '62.524%', '62.225%', '62.930%', '63.144%', '63.914%', '63.765%', '64.107%', '64.342%']
Workers federated accuracies:  ['59.123%', '59.422%', '60.064%', '60.428%', '60.877%', '61.455%', '61.433%', '62.524%', '62.225%', '62.930%', '63.144%', '63.914%', '63.765%', '64.107%', '64.342%']
Workers improved  accuracies:  ['0.385%', '0.449%', '0.727%', '0.920%', '1.112%', '1.390%', '1.390%', '1.797%', '1.519%', '2.032%', '2.118%', '2.524%', '2.374%', '2.524%', '2.481%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 2:
Federated model validation accuracy : 75.1000%
Leave-one-out validation accuracies :  ['75.1000%', '75.2000%', '75.5000%', '75.7000%', '75.8000%', '75.8000%', '76.1000%', '76.6000%', '76.5000%', '76.4000%', '76.5000%', '76.6000%', '76.6000%', '76.5000%', '76.3000%']
Computed and normalized credits:  tensor([0.0686, 0.0684, 0.0679, 0.0677, 0.0674, 0.0673, 0.0666, 0.0658, 0.0659,
        0.0660, 0.0658, 0.0656, 0.0655, 0.0656, 0.0660])
Federated model performance: Loss: 0.519328. Accuracy: 73.5615%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['59.422%', '59.765%', '60.513%', '61.219%', '61.861%', '62.674%', '62.866%', '64.021%', '63.765%', '64.278%', '64.663%', '65.775%', '65.775%', '66.353%', '66.610%']
Workers federated accuracies:  ['59.422%', '59.765%', '60.513%', '61.219%', '61.861%', '62.674%', '62.866%', '64.021%', '63.765%', '64.278%', '64.663%', '65.775%', '65.775%', '66.353%', '66.610%']
Workers improved  accuracies:  ['0.684%', '0.791%', '1.176%', '1.711%', '2.096%', '2.610%', '2.824%', '3.294%', '3.059%', '3.380%', '3.636%', '4.385%', '4.385%', '4.770%', '4.749%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 3:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.4000%', '76.4000%', '76.6000%', '76.5000%', '76.6000%', '76.5000%', '76.5000%', '76.6000%', '76.5000%', '76.5000%', '76.5000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%']
Computed and normalized credits:  tensor([0.0671, 0.0671, 0.0667, 0.0668, 0.0667, 0.0668, 0.0667, 0.0665, 0.0666,
        0.0666, 0.0666, 0.0664, 0.0664, 0.0664, 0.0665])
Federated model performance: Loss: 0.502437. Accuracy: 74.3102%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['59.615%', '60.150%', '60.984%', '61.818%', '62.973%', '64.086%', '63.872%', '65.455%', '65.155%', '66.011%', '66.439%', '67.743%', '67.401%', '67.936%', '68.171%']
Workers federated accuracies:  ['59.615%', '60.150%', '60.984%', '61.818%', '62.973%', '64.086%', '63.872%', '65.455%', '65.155%', '66.011%', '66.439%', '67.743%', '67.401%', '67.936%', '68.171%']
Workers improved  accuracies:  ['0.877%', '1.176%', '1.647%', '2.310%', '3.209%', '4.021%', '3.829%', '4.727%', '4.449%', '5.112%', '5.412%', '6.353%', '6.011%', '6.353%', '6.310%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 4:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.4000%', '76.4000%', '76.4000%', '76.6000%', '76.6000%', '76.7000%', '76.7000%', '76.7000%', '76.8000%', '76.8000%', '76.6000%', '76.6000%', '76.4000%', '76.6000%', '76.5000%']
Computed and normalized credits:  tensor([0.0670, 0.0670, 0.0669, 0.0667, 0.0666, 0.0665, 0.0665, 0.0665, 0.0664,
        0.0664, 0.0666, 0.0666, 0.0669, 0.0666, 0.0668])
Federated model performance: Loss: 0.506977. Accuracy: 74.2888%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['59.786%', '60.620%', '61.561%', '62.588%', '63.872%', '65.027%', '64.877%', '66.310%', '66.417%', '67.230%', '67.743%', '69.112%', '68.791%', '69.476%', '69.947%']
Workers federated accuracies:  ['59.786%', '60.620%', '61.561%', '62.588%', '63.872%', '65.027%', '64.877%', '66.310%', '66.417%', '67.230%', '67.743%', '69.112%', '68.791%', '69.476%', '69.947%']
Workers improved  accuracies:  ['1.048%', '1.647%', '2.225%', '3.080%', '4.107%', '4.963%', '4.834%', '5.583%', '5.711%', '6.332%', '6.717%', '7.722%', '7.401%', '7.893%', '8.086%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 5:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.7000%', '76.6000%', '76.6000%', '76.7000%', '76.6000%', '76.6000%', '76.4000%', '76.4000%', '76.5000%', '76.6000%', '76.8000%', '76.6000%', '76.6000%']
Computed and normalized credits:  tensor([0.0664, 0.0664, 0.0666, 0.0667, 0.0667, 0.0665, 0.0667, 0.0667, 0.0669,
        0.0669, 0.0668, 0.0667, 0.0664, 0.0667, 0.0667])
Federated model performance: Loss: 0.523812. Accuracy: 74.3957%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['60.021%', '60.856%', '61.968%', '63.294%', '64.535%', '65.519%', '65.711%', '67.636%', '67.337%', '68.471%', '68.920%', '70.545%', '69.861%', '70.781%', '71.016%']
Workers federated accuracies:  ['60.021%', '60.856%', '61.968%', '63.294%', '64.535%', '65.519%', '65.711%', '67.636%', '67.337%', '68.471%', '68.920%', '70.545%', '69.861%', '70.781%', '71.016%']
Workers improved  accuracies:  ['1.283%', '1.882%', '2.631%', '3.786%', '4.770%', '5.455%', '5.668%', '6.909%', '6.631%', '7.572%', '7.893%', '9.155%', '8.471%', '9.198%', '9.155%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 6:
Federated model validation accuracy : 76.5000%
Leave-one-out validation accuracies :  ['76.4000%', '76.4000%', '76.6000%', '76.6000%', '76.6000%', '76.8000%', '76.6000%', '76.6000%', '76.5000%', '76.7000%', '76.8000%', '76.8000%', '76.8000%', '77.1000%', '77.2000%']
Computed and normalized credits:  tensor([0.0671, 0.0671, 0.0668, 0.0668, 0.0668, 0.0665, 0.0668, 0.0668, 0.0670,
        0.0667, 0.0665, 0.0665, 0.0665, 0.0661, 0.0660])
Federated model performance: Loss: 0.546852. Accuracy: 74.4599%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['60.128%', '61.348%', '62.738%', '63.850%', '65.519%', '66.246%', '66.545%', '68.556%', '68.342%', '69.754%', '70.246%', '71.251%', '71.037%', '71.444%', '71.722%']
Workers federated accuracies:  ['60.128%', '61.348%', '62.738%', '63.850%', '65.519%', '66.246%', '66.545%', '68.556%', '68.342%', '69.754%', '70.246%', '71.251%', '71.037%', '71.444%', '71.722%']
Workers improved  accuracies:  ['1.390%', '2.374%', '3.401%', '4.342%', '5.754%', '6.182%', '6.503%', '7.829%', '7.636%', '8.856%', '9.219%', '9.861%', '9.647%', '9.861%', '9.861%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 7:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '77.0000%', '76.9000%', '77.0000%', '77.1000%', '77.0000%', '77.0000%', '77.0000%', '77.0000%', '77.0000%', '77.2000%', '77.2000%', '77.3000%', '77.2000%', '77.5000%']
Computed and normalized credits:  tensor([0.0671, 0.0668, 0.0669, 0.0668, 0.0667, 0.0668, 0.0668, 0.0668, 0.0668,
        0.0668, 0.0665, 0.0665, 0.0663, 0.0664, 0.0660])
Federated model performance: Loss: 0.573894. Accuracy: 74.6738%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['60.471%', '61.711%', '63.037%', '64.406%', '66.332%', '67.273%', '67.316%', '69.690%', '69.112%', '70.824%', '70.845%', '71.658%', '72.021%', '72.171%', '72.578%']
Workers federated accuracies:  ['60.471%', '61.711%', '63.037%', '64.406%', '66.332%', '67.273%', '67.316%', '69.690%', '69.112%', '70.824%', '70.845%', '71.658%', '72.021%', '72.171%', '72.578%']
Workers improved  accuracies:  ['1.733%', '2.738%', '3.701%', '4.898%', '6.567%', '7.209%', '7.273%', '8.963%', '8.406%', '9.925%', '9.818%', '10.267%', '10.631%', '10.588%', '10.717%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 8:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.3000%', '77.2000%', '77.2000%', '77.3000%', '77.3000%', '77.3000%', '77.3000%', '77.4000%', '77.2000%', '77.4000%', '77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.5000%']
Computed and normalized credits:  tensor([0.0668, 0.0669, 0.0669, 0.0668, 0.0668, 0.0668, 0.0668, 0.0666, 0.0669,
        0.0666, 0.0666, 0.0666, 0.0663, 0.0663, 0.0664])
Federated model performance: Loss: 0.603130. Accuracy: 74.9733%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['60.599%', '61.989%', '63.572%', '65.155%', '66.930%', '67.979%', '68.086%', '70.417%', '70.225%', '71.337%', '71.444%', '71.957%', '72.578%', '72.599%', '72.963%']
Workers federated accuracies:  ['60.599%', '61.989%', '63.572%', '65.155%', '66.930%', '67.979%', '68.086%', '70.417%', '70.225%', '71.337%', '71.444%', '71.957%', '72.578%', '72.599%', '72.963%']
Workers improved  accuracies:  ['1.861%', '3.016%', '4.235%', '5.647%', '7.166%', '7.914%', '8.043%', '9.690%', '9.519%', '10.439%', '10.417%', '10.567%', '11.187%', '11.016%', '11.102%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 9:
Federated model validation accuracy : 77.5000%
Leave-one-out validation accuracies :  ['77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.6000%', '77.6000%', '77.6000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.4000%', '77.4000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0667, 0.0665, 0.0665, 0.0665, 0.0667, 0.0667,
        0.0667, 0.0667, 0.0667, 0.0666, 0.0668, 0.0668])
Federated model performance: Loss: 0.632243. Accuracy: 75.1016%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['60.684%', '62.203%', '64.000%', '65.711%', '67.380%', '68.770%', '69.219%', '71.123%', '70.695%', '71.722%', '71.850%', '72.364%', '72.984%', '73.134%', '73.326%']
Workers federated accuracies:  ['60.684%', '62.203%', '64.000%', '65.711%', '67.380%', '68.770%', '69.219%', '71.123%', '70.695%', '71.722%', '71.850%', '72.364%', '72.984%', '73.134%', '73.326%']
Workers improved  accuracies:  ['1.947%', '3.230%', '4.663%', '6.203%', '7.615%', '8.706%', '9.176%', '10.396%', '9.989%', '10.824%', '10.824%', '10.973%', '11.594%', '11.551%', '11.465%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 10:
Federated model validation accuracy : 77.5000%
Leave-one-out validation accuracies :  ['77.5000%', '77.5000%', '77.5000%', '77.4000%', '77.4000%', '77.4000%', '77.3000%', '77.3000%', '77.4000%', '77.3000%', '77.3000%', '77.5000%', '77.4000%', '77.5000%', '77.5000%']
Computed and normalized credits:  tensor([0.0665, 0.0665, 0.0665, 0.0667, 0.0667, 0.0667, 0.0668, 0.0668, 0.0667,
        0.0668, 0.0668, 0.0665, 0.0667, 0.0666, 0.0666])
Federated model performance: Loss: 0.661170. Accuracy: 75.1872%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['60.706%', '62.503%', '64.321%', '66.246%', '68.128%', '69.455%', '69.647%', '71.658%', '70.909%', '71.957%', '72.385%', '72.749%', '73.305%', '73.519%', '73.754%']
Workers federated accuracies:  ['60.706%', '62.503%', '64.321%', '66.246%', '68.128%', '69.455%', '69.647%', '71.658%', '70.909%', '71.957%', '72.385%', '72.749%', '73.305%', '73.519%', '73.754%']
Workers improved  accuracies:  ['1.968%', '3.529%', '4.984%', '6.738%', '8.364%', '9.390%', '9.604%', '10.930%', '10.203%', '11.059%', '11.358%', '11.358%', '11.914%', '11.936%', '11.893%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.661170. Accuracy: 75.1872%.
Workers before    accuracies:  ['58.738%', '58.973%', '59.337%', '59.508%', '59.765%', '60.064%', '60.043%', '60.727%', '60.706%', '60.898%', '61.027%', '61.390%', '61.390%', '61.583%', '61.861%']
Workers standlone accuracies:  ['60.706%', '62.503%', '64.321%', '66.246%', '68.128%', '69.455%', '69.647%', '71.658%', '70.909%', '71.957%', '72.385%', '72.749%', '73.305%', '73.519%', '73.754%']
Workers federated accuracies:  ['60.706%', '62.503%', '64.321%', '66.246%', '68.128%', '69.455%', '69.647%', '71.658%', '70.909%', '71.957%', '72.385%', '72.749%', '73.305%', '73.519%', '73.754%']
Workers improved  accuracies:  ['1.968%', '3.529%', '4.984%', '6.738%', '8.364%', '9.390%', '9.604%', '10.930%', '10.203%', '11.059%', '11.358%', '11.358%', '11.914%', '11.936%', '11.893%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]
Workers sharing_contributions :  tensor([ 5.3333, 10.6667, 14.9333, 20.2667, 25.6000, 30.9333, 35.2000, 40.5333,
        45.8667, 50.1333, 55.4667, 60.8000, 66.1333, 70.4000, 75.7333])
Correlation between stand alone test acc & perturbed federated test acc:  (0.5803124030807378, 0.023328841192478165)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999998, 3.5089823585550356e-101)
Correlation between test_acc & sharing contributions:  (0.9432270628932461, 1.367105339531708e-07)
Correlation between test_acc improvements & sharing_contributions:  (0.915083166792003, 1.7473091626438551e-06)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.712497. Accuracy: 60.6417%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 69.7000%
Leave-one-out validation accuracies :  ['69.8000%', '69.9000%', '70.2000%', '70.7000%', '71.1000%', '71.7000%', '71.9000%', '72.4000%', '72.1000%', '73.3000%', '73.3000%', '73.5000%', '73.5000%', '73.4000%', '73.6000%']
Computed and normalized credits:  tensor([0.0703, 0.0701, 0.0696, 0.0688, 0.0681, 0.0672, 0.0668, 0.0660, 0.0665,
        0.0646, 0.0646, 0.0643, 0.0643, 0.0645, 0.0641])
Federated model performance: Loss: 0.624007. Accuracy: 71.4866%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['59.102%', '59.529%', '60.128%', '60.813%', '61.219%', '61.733%', '62.139%', '62.481%', '63.102%', '63.273%', '63.358%', '63.914%', '64.128%', '64.770%', '64.150%']
Workers federated accuracies:  ['59.102%', '59.529%', '60.128%', '60.813%', '61.219%', '61.733%', '62.139%', '62.481%', '63.102%', '63.273%', '63.358%', '63.914%', '64.128%', '64.770%', '64.150%']
Workers improved  accuracies:  ['0.278%', '0.406%', '0.834%', '1.305%', '1.455%', '1.476%', '1.733%', '1.733%', '2.075%', '2.032%', '1.947%', '2.203%', '2.246%', '2.503%', '2.267%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 2:
Federated model validation accuracy : 73.2000%
Leave-one-out validation accuracies :  ['73.2000%', '73.2000%', '73.3000%', '73.2000%', '73.4000%', '73.5000%', '73.5000%', '73.5000%', '73.5000%', '73.6000%', '73.8000%', '74.0000%', '73.9000%', '73.9000%', '74.3000%']
Computed and normalized credits:  tensor([0.0677, 0.0677, 0.0675, 0.0675, 0.0671, 0.0669, 0.0668, 0.0667, 0.0668,
        0.0664, 0.0661, 0.0658, 0.0659, 0.0659, 0.0653])
Federated model performance: Loss: 0.576940. Accuracy: 74.3102%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['59.444%', '60.150%', '60.898%', '61.711%', '62.225%', '62.888%', '63.358%', '63.979%', '64.471%', '64.791%', '65.091%', '65.390%', '65.775%', '66.781%', '65.754%']
Workers federated accuracies:  ['59.444%', '60.150%', '60.898%', '61.711%', '62.225%', '62.888%', '63.358%', '63.979%', '64.471%', '64.791%', '65.091%', '65.390%', '65.775%', '66.781%', '65.754%']
Workers improved  accuracies:  ['0.620%', '1.027%', '1.604%', '2.203%', '2.460%', '2.631%', '2.952%', '3.230%', '3.444%', '3.551%', '3.679%', '3.679%', '3.893%', '4.513%', '3.872%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 3:
Federated model validation accuracy : 73.7000%
Leave-one-out validation accuracies :  ['73.7000%', '73.8000%', '73.8000%', '73.9000%', '73.9000%', '74.0000%', '73.8000%', '74.1000%', '74.2000%', '74.4000%', '74.4000%', '74.6000%', '74.7000%', '74.8000%', '74.9000%']
Computed and normalized credits:  tensor([0.0675, 0.0674, 0.0674, 0.0672, 0.0672, 0.0670, 0.0673, 0.0668, 0.0667,
        0.0663, 0.0663, 0.0660, 0.0658, 0.0657, 0.0655])
Federated model performance: Loss: 0.558830. Accuracy: 75.3583%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['59.786%', '60.620%', '61.647%', '62.545%', '62.909%', '64.299%', '64.364%', '64.984%', '65.433%', '66.203%', '66.332%', '67.209%', '67.294%', '68.299%', '67.701%']
Workers federated accuracies:  ['59.786%', '60.620%', '61.647%', '62.545%', '62.909%', '64.299%', '64.364%', '64.984%', '65.433%', '66.203%', '66.332%', '67.209%', '67.294%', '68.299%', '67.701%']
Workers improved  accuracies:  ['0.963%', '1.497%', '2.353%', '3.037%', '3.144%', '4.043%', '3.957%', '4.235%', '4.406%', '4.963%', '4.920%', '5.497%', '5.412%', '6.032%', '5.818%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 4:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.4000%', '74.4000%', '74.4000%', '74.5000%', '74.7000%', '74.7000%', '74.7000%', '74.7000%', '74.7000%', '74.9000%', '74.8000%', '74.9000%', '74.9000%', '75.1000%', '75.1000%']
Computed and normalized credits:  tensor([0.0673, 0.0672, 0.0672, 0.0671, 0.0668, 0.0667, 0.0668, 0.0667, 0.0667,
        0.0664, 0.0665, 0.0663, 0.0663, 0.0660, 0.0660])
Federated model performance: Loss: 0.560401. Accuracy: 75.7861%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['60.107%', '61.048%', '62.246%', '63.230%', '63.679%', '65.112%', '65.134%', '66.203%', '66.610%', '67.465%', '67.679%', '68.599%', '68.770%', '70.011%', '69.433%']
Workers federated accuracies:  ['60.107%', '61.048%', '62.246%', '63.230%', '63.679%', '65.112%', '65.134%', '66.203%', '66.610%', '67.465%', '67.679%', '68.599%', '68.770%', '70.011%', '69.433%']
Workers improved  accuracies:  ['1.283%', '1.925%', '2.952%', '3.722%', '3.914%', '4.856%', '4.727%', '5.455%', '5.583%', '6.225%', '6.267%', '6.888%', '6.888%', '7.743%', '7.551%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 5:
Federated model validation accuracy : 74.9000%
Leave-one-out validation accuracies :  ['74.9000%', '74.9000%', '74.8000%', '74.8000%', '74.8000%', '74.9000%', '75.0000%', '75.0000%', '75.2000%', '75.2000%', '75.2000%', '75.1000%', '75.0000%', '74.8000%', '74.9000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0670, 0.0670, 0.0669, 0.0668, 0.0666, 0.0666, 0.0663,
        0.0663, 0.0663, 0.0664, 0.0666, 0.0668, 0.0667])
Federated model performance: Loss: 0.573795. Accuracy: 76.2139%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['60.342%', '61.540%', '62.824%', '63.765%', '64.449%', '65.925%', '65.947%', '67.294%', '67.850%', '68.856%', '68.941%', '69.861%', '69.968%', '71.166%', '70.717%']
Workers federated accuracies:  ['60.342%', '61.540%', '62.824%', '63.765%', '64.449%', '65.925%', '65.947%', '67.294%', '67.850%', '68.856%', '68.941%', '69.861%', '69.968%', '71.166%', '70.717%']
Workers improved  accuracies:  ['1.519%', '2.417%', '3.529%', '4.257%', '4.684%', '5.668%', '5.540%', '6.545%', '6.824%', '7.615%', '7.529%', '8.150%', '8.086%', '8.898%', '8.834%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 6:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.1000%', '75.2000%', '75.3000%', '75.0000%', '74.9000%', '75.0000%', '75.1000%', '74.9000%', '74.9000%', '74.8000%', '74.9000%', '75.2000%', '75.3000%', '75.3000%', '75.2000%']
Computed and normalized credits:  tensor([0.0666, 0.0665, 0.0664, 0.0668, 0.0670, 0.0668, 0.0666, 0.0669, 0.0669,
        0.0670, 0.0669, 0.0665, 0.0663, 0.0664, 0.0665])
Federated model performance: Loss: 0.593918. Accuracy: 76.4064%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['60.642%', '61.925%', '63.273%', '64.342%', '64.920%', '66.738%', '66.888%', '68.128%', '69.112%', '69.754%', '70.032%', '71.102%', '71.166%', '72.064%', '71.422%']
Workers federated accuracies:  ['60.642%', '61.925%', '63.273%', '64.342%', '64.920%', '66.738%', '66.888%', '68.128%', '69.112%', '69.754%', '70.032%', '71.102%', '71.166%', '72.064%', '71.422%']
Workers improved  accuracies:  ['1.818%', '2.802%', '3.979%', '4.834%', '5.155%', '6.481%', '6.481%', '7.380%', '8.086%', '8.513%', '8.620%', '9.390%', '9.283%', '9.797%', '9.540%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 7:
Federated model validation accuracy : 74.8000%
Leave-one-out validation accuracies :  ['74.8000%', '74.9000%', '74.9000%', '74.9000%', '75.1000%', '75.1000%', '75.1000%', '75.3000%', '75.3000%', '75.2000%', '75.2000%', '75.4000%', '75.5000%', '75.5000%', '75.5000%']
Computed and normalized credits:  tensor([0.0672, 0.0671, 0.0670, 0.0671, 0.0668, 0.0668, 0.0668, 0.0665, 0.0665,
        0.0667, 0.0667, 0.0663, 0.0662, 0.0662, 0.0662])
Federated model performance: Loss: 0.618581. Accuracy: 76.4920%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['61.005%', '62.310%', '63.551%', '64.684%', '65.519%', '67.636%', '67.914%', '69.005%', '69.882%', '70.695%', '70.909%', '71.829%', '71.893%', '72.599%', '72.342%']
Workers federated accuracies:  ['61.005%', '62.310%', '63.551%', '64.684%', '65.519%', '67.636%', '67.914%', '69.005%', '69.882%', '70.695%', '70.909%', '71.829%', '71.893%', '72.599%', '72.342%']
Workers improved  accuracies:  ['2.182%', '3.187%', '4.257%', '5.176%', '5.754%', '7.380%', '7.508%', '8.257%', '8.856%', '9.455%', '9.497%', '10.118%', '10.011%', '10.332%', '10.460%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 8:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.3000%', '75.3000%', '75.3000%', '75.4000%', '75.5000%', '75.5000%', '75.4000%', '75.5000%', '75.6000%', '75.5000%', '75.6000%', '75.6000%', '75.7000%', '75.8000%', '75.9000%']
Computed and normalized credits:  tensor([0.0671, 0.0670, 0.0670, 0.0669, 0.0667, 0.0667, 0.0669, 0.0667, 0.0665,
        0.0667, 0.0666, 0.0665, 0.0664, 0.0662, 0.0661])
Federated model performance: Loss: 0.646266. Accuracy: 76.4920%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['61.369%', '62.588%', '64.043%', '65.390%', '66.139%', '68.428%', '68.684%', '69.861%', '70.674%', '71.508%', '71.636%', '72.428%', '72.834%', '73.176%', '73.070%']
Workers federated accuracies:  ['61.369%', '62.588%', '64.043%', '65.390%', '66.139%', '68.428%', '68.684%', '69.861%', '70.674%', '71.508%', '71.636%', '72.428%', '72.834%', '73.176%', '73.070%']
Workers improved  accuracies:  ['2.545%', '3.465%', '4.749%', '5.882%', '6.374%', '8.171%', '8.278%', '9.112%', '9.647%', '10.267%', '10.225%', '10.717%', '10.952%', '10.909%', '11.187%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 9:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.7000%', '75.6000%', '75.7000%', '75.7000%', '75.7000%', '75.8000%', '76.0000%', '75.9000%', '75.9000%', '76.0000%', '76.0000%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0669, 0.0669, 0.0668, 0.0669, 0.0668, 0.0668, 0.0667,
        0.0666, 0.0663, 0.0664, 0.0664, 0.0663, 0.0662])
Federated model performance: Loss: 0.673710. Accuracy: 76.6203%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['61.476%', '62.738%', '64.171%', '65.797%', '66.759%', '69.070%', '69.390%', '70.631%', '71.380%', '72.193%', '72.299%', '72.770%', '73.112%', '73.476%', '73.647%']
Workers federated accuracies:  ['61.476%', '62.738%', '64.171%', '65.797%', '66.759%', '69.070%', '69.390%', '70.631%', '71.380%', '72.193%', '72.299%', '72.770%', '73.112%', '73.476%', '73.647%']
Workers improved  accuracies:  ['2.652%', '3.615%', '4.877%', '6.289%', '6.995%', '8.813%', '8.984%', '9.882%', '10.353%', '10.952%', '10.888%', '11.059%', '11.230%', '11.209%', '11.765%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 10:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.9000%', '75.9000%', '75.9000%', '75.9000%', '75.9000%', '75.9000%', '75.9000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0667, 0.0668, 0.0667, 0.0667, 0.0666,
        0.0666, 0.0665, 0.0666, 0.0666, 0.0665, 0.0665])
Federated model performance: Loss: 0.702059. Accuracy: 76.5562%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['61.668%', '63.166%', '64.770%', '66.374%', '67.358%', '69.775%', '70.032%', '71.380%', '71.914%', '72.578%', '72.642%', '73.219%', '73.390%', '73.882%', '74.139%']
Workers federated accuracies:  ['61.668%', '63.166%', '64.770%', '66.374%', '67.358%', '69.775%', '70.032%', '71.380%', '71.914%', '72.578%', '72.642%', '73.219%', '73.390%', '73.882%', '74.139%']
Workers improved  accuracies:  ['2.845%', '4.043%', '5.476%', '6.866%', '7.594%', '9.519%', '9.626%', '10.631%', '10.888%', '11.337%', '11.230%', '11.508%', '11.508%', '11.615%', '12.257%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.702059. Accuracy: 76.5562%.
Workers before    accuracies:  ['58.824%', '59.123%', '59.294%', '59.508%', '59.765%', '60.257%', '60.406%', '60.749%', '61.027%', '61.241%', '61.412%', '61.711%', '61.882%', '62.267%', '61.882%']
Workers standlone accuracies:  ['61.668%', '63.166%', '64.770%', '66.374%', '67.358%', '69.775%', '70.032%', '71.380%', '71.914%', '72.578%', '72.642%', '73.219%', '73.390%', '73.882%', '74.139%']
Workers federated accuracies:  ['61.668%', '63.166%', '64.770%', '66.374%', '67.358%', '69.775%', '70.032%', '71.380%', '71.914%', '72.578%', '72.642%', '73.219%', '73.390%', '73.882%', '74.139%']
Workers improved  accuracies:  ['2.845%', '4.043%', '5.476%', '6.866%', '7.594%', '9.519%', '9.626%', '10.631%', '10.888%', '11.337%', '11.230%', '11.508%', '11.508%', '11.615%', '12.257%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]
Workers sharing_contributions :  tensor([ 5.3333, 10.6667, 14.9333, 20.2667, 25.6000, 30.9333, 35.2000, 40.5333,
        45.8667, 50.1333, 55.4667, 60.8000, 66.1333, 70.4000, 75.7333])
Correlation between stand alone test acc & perturbed federated test acc:  (0.019115368251505768, 0.9460911728868372)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9547880450832053, 3.200686296117921e-08)
Correlation between test_acc improvements & sharing_contributions:  (0.9271492698650161, 6.646956031709868e-07)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.722510. Accuracy: 53.7326%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 66.4000%
Leave-one-out validation accuracies :  ['66.5000%', '66.5000%', '66.7000%', '67.1000%', '67.6000%', '69.1000%', '70.2000%', '70.2000%', '70.7000%', '71.6000%', '72.1000%', '72.6000%', '72.9000%', '72.9000%', '73.0000%']
Computed and normalized credits:  tensor([0.0727, 0.0727, 0.0723, 0.0716, 0.0707, 0.0681, 0.0662, 0.0662, 0.0653,
        0.0638, 0.0630, 0.0622, 0.0617, 0.0617, 0.0616])
Federated model performance: Loss: 0.631960. Accuracy: 67.4866%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['51.572%', '52.321%', '53.176%', '53.947%', '54.503%', '55.080%', '55.572%', '56.449%', '56.599%', '56.920%', '57.155%', '57.797%', '58.011%', '59.016%', '58.310%']
Workers federated accuracies:  ['51.572%', '52.321%', '53.176%', '53.947%', '54.503%', '55.080%', '55.572%', '56.449%', '56.599%', '56.920%', '57.155%', '57.797%', '58.011%', '59.016%', '58.310%']
Workers improved  accuracies:  ['0.342%', '0.663%', '1.155%', '1.412%', '1.775%', '2.032%', '2.160%', '2.631%', '2.503%', '2.631%', '2.545%', '2.738%', '2.973%', '3.401%', '2.802%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 2:
Federated model validation accuracy : 72.3000%
Leave-one-out validation accuracies :  ['72.4000%', '72.4000%', '72.5000%', '72.3000%', '72.2000%', '72.6000%', '73.0000%', '73.1000%', '73.1000%', '73.1000%', '73.0000%', '73.2000%', '73.4000%', '73.7000%', '73.7000%']
Computed and normalized credits:  tensor([0.0682, 0.0682, 0.0680, 0.0682, 0.0682, 0.0673, 0.0665, 0.0663, 0.0662,
        0.0660, 0.0661, 0.0657, 0.0653, 0.0649, 0.0649])
Federated model performance: Loss: 0.582734. Accuracy: 72.2139%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['51.829%', '52.898%', '54.096%', '55.316%', '55.936%', '56.877%', '57.134%', '58.332%', '58.781%', '59.658%', '59.679%', '60.898%', '61.005%', '62.267%', '61.390%']
Workers federated accuracies:  ['51.829%', '52.898%', '54.096%', '55.316%', '55.936%', '56.877%', '57.134%', '58.332%', '58.781%', '59.658%', '59.679%', '60.898%', '61.005%', '62.267%', '61.390%']
Workers improved  accuracies:  ['0.599%', '1.241%', '2.075%', '2.781%', '3.209%', '3.829%', '3.722%', '4.513%', '4.684%', '5.369%', '5.070%', '5.840%', '5.968%', '6.652%', '5.882%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 3:
Federated model validation accuracy : 73.0000%
Leave-one-out validation accuracies :  ['73.0000%', '72.9000%', '73.1000%', '73.1000%', '73.1000%', '73.4000%', '73.8000%', '73.8000%', '73.8000%', '73.6000%', '73.7000%', '73.9000%', '73.9000%', '74.3000%', '74.7000%']
Computed and normalized credits:  tensor([0.0678, 0.0679, 0.0676, 0.0676, 0.0676, 0.0671, 0.0663, 0.0663, 0.0663,
        0.0666, 0.0665, 0.0661, 0.0661, 0.0654, 0.0648])
Federated model performance: Loss: 0.563458. Accuracy: 73.9679%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['52.193%', '53.647%', '55.316%', '56.342%', '56.963%', '58.310%', '58.439%', '60.214%', '60.642%', '61.925%', '62.053%', '63.059%', '63.230%', '64.299%', '63.594%']
Workers federated accuracies:  ['52.193%', '53.647%', '55.316%', '56.342%', '56.963%', '58.310%', '58.439%', '60.214%', '60.642%', '61.925%', '62.053%', '63.059%', '63.230%', '64.299%', '63.594%']
Workers improved  accuracies:  ['0.963%', '1.989%', '3.294%', '3.807%', '4.235%', '5.262%', '5.027%', '6.396%', '6.545%', '7.636%', '7.444%', '8.000%', '8.193%', '8.684%', '8.086%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 4:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.8000%', '73.8000%', '73.7000%', '73.8000%', '74.0000%', '74.0000%', '74.0000%', '74.2000%', '74.4000%', '74.6000%', '74.7000%', '74.5000%', '74.5000%', '74.5000%']
Computed and normalized credits:  tensor([0.0676, 0.0673, 0.0673, 0.0674, 0.0673, 0.0669, 0.0668, 0.0668, 0.0665,
        0.0663, 0.0659, 0.0658, 0.0661, 0.0660, 0.0659])
Federated model performance: Loss: 0.562877. Accuracy: 74.6952%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['52.471%', '54.160%', '55.893%', '57.262%', '58.481%', '59.829%', '60.086%', '61.904%', '62.139%', '63.594%', '63.679%', '64.898%', '64.963%', '66.053%', '65.348%']
Workers federated accuracies:  ['52.471%', '54.160%', '55.893%', '57.262%', '58.481%', '59.829%', '60.086%', '61.904%', '62.139%', '63.594%', '63.679%', '64.898%', '64.963%', '66.053%', '65.348%']
Workers improved  accuracies:  ['1.241%', '2.503%', '3.872%', '4.727%', '5.754%', '6.781%', '6.674%', '8.086%', '8.043%', '9.305%', '9.070%', '9.840%', '9.925%', '10.439%', '9.840%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 5:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.5000%', '74.7000%', '74.7000%', '74.6000%', '74.7000%', '74.8000%', '74.6000%', '74.7000%', '74.6000%', '74.6000%', '74.8000%', '74.7000%', '74.8000%', '74.7000%', '74.8000%']
Computed and normalized credits:  tensor([0.0671, 0.0667, 0.0667, 0.0669, 0.0667, 0.0665, 0.0668, 0.0667, 0.0668,
        0.0667, 0.0664, 0.0665, 0.0664, 0.0666, 0.0664])
Federated model performance: Loss: 0.574498. Accuracy: 75.2086%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['52.770%', '54.845%', '56.599%', '58.139%', '59.508%', '61.348%', '61.176%', '63.209%', '63.636%', '64.727%', '64.834%', '66.075%', '66.503%', '67.465%', '66.888%']
Workers federated accuracies:  ['52.770%', '54.845%', '56.599%', '58.139%', '59.508%', '61.348%', '61.176%', '63.209%', '63.636%', '64.727%', '64.834%', '66.075%', '66.503%', '67.465%', '66.888%']
Workers improved  accuracies:  ['1.540%', '3.187%', '4.578%', '5.604%', '6.781%', '8.299%', '7.765%', '9.390%', '9.540%', '10.439%', '10.225%', '11.016%', '11.465%', '11.850%', '11.380%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 6:
Federated model validation accuracy : 74.7000%
Leave-one-out validation accuracies :  ['74.7000%', '74.7000%', '74.7000%', '74.7000%', '74.5000%', '74.8000%', '74.7000%', '74.7000%', '74.8000%', '74.7000%', '74.8000%', '74.8000%', '74.9000%', '75.0000%', '75.0000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0671, 0.0666, 0.0668, 0.0668, 0.0666,
        0.0668, 0.0666, 0.0666, 0.0664, 0.0663, 0.0663])
Federated model performance: Loss: 0.593617. Accuracy: 75.6364%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['53.005%', '55.572%', '57.241%', '59.102%', '60.642%', '62.267%', '62.246%', '64.492%', '64.813%', '65.690%', '65.947%', '67.230%', '67.572%', '68.856%', '68.278%']
Workers federated accuracies:  ['53.005%', '55.572%', '57.241%', '59.102%', '60.642%', '62.267%', '62.246%', '64.492%', '64.813%', '65.690%', '65.947%', '67.230%', '67.572%', '68.856%', '68.278%']
Workers improved  accuracies:  ['1.775%', '3.914%', '5.219%', '6.567%', '7.914%', '9.219%', '8.834%', '10.674%', '10.717%', '11.401%', '11.337%', '12.171%', '12.535%', '13.241%', '12.770%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 7:
Federated model validation accuracy : 74.8000%
Leave-one-out validation accuracies :  ['74.8000%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '75.0000%', '75.0000%', '74.9000%', '74.9000%', '75.0000%', '75.1000%', '75.1000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0669, 0.0668, 0.0668, 0.0668, 0.0665,
        0.0665, 0.0666, 0.0666, 0.0665, 0.0663, 0.0663])
Federated model performance: Loss: 0.617780. Accuracy: 75.8075%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['53.476%', '56.107%', '58.096%', '60.364%', '61.668%', '63.551%', '63.401%', '65.326%', '65.989%', '66.909%', '67.166%', '68.321%', '68.663%', '69.968%', '69.390%']
Workers federated accuracies:  ['53.476%', '56.107%', '58.096%', '60.364%', '61.668%', '63.551%', '63.401%', '65.326%', '65.989%', '66.909%', '67.166%', '68.321%', '68.663%', '69.968%', '69.390%']
Workers improved  accuracies:  ['2.246%', '4.449%', '6.075%', '7.829%', '8.941%', '10.503%', '9.989%', '11.508%', '11.893%', '12.620%', '12.556%', '13.262%', '13.626%', '14.353%', '13.882%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 8:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.0000%', '74.9000%', '74.9000%', '74.9000%', '74.8000%', '74.8000%', '75.0000%', '75.1000%', '75.1000%', '75.1000%', '75.3000%', '75.4000%', '75.3000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0669, 0.0669, 0.0669, 0.0670, 0.0670, 0.0667,
        0.0666, 0.0666, 0.0666, 0.0663, 0.0661, 0.0662])
Federated model performance: Loss: 0.644551. Accuracy: 75.9572%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['53.733%', '56.578%', '58.695%', '61.134%', '62.481%', '64.278%', '64.492%', '66.118%', '67.059%', '68.021%', '67.872%', '69.262%', '69.797%', '70.652%', '70.246%']
Workers federated accuracies:  ['53.733%', '56.578%', '58.695%', '61.134%', '62.481%', '64.278%', '64.492%', '66.118%', '67.059%', '68.021%', '67.872%', '69.262%', '69.797%', '70.652%', '70.246%']
Workers improved  accuracies:  ['2.503%', '4.920%', '6.674%', '8.599%', '9.754%', '11.230%', '11.080%', '12.299%', '12.963%', '13.733%', '13.262%', '14.203%', '14.759%', '15.037%', '14.738%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 9:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.4000%', '75.4000%', '75.4000%', '75.1000%', '75.2000%', '75.1000%', '75.1000%', '75.1000%', '75.2000%', '75.2000%', '75.3000%', '75.3000%', '75.5000%', '75.5000%', '75.5000%']
Computed and normalized credits:  tensor([0.0665, 0.0665, 0.0665, 0.0670, 0.0668, 0.0670, 0.0670, 0.0670, 0.0668,
        0.0668, 0.0666, 0.0666, 0.0663, 0.0663, 0.0663])
Federated model performance: Loss: 0.673221. Accuracy: 76.1497%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['53.925%', '56.963%', '59.572%', '61.925%', '63.187%', '65.134%', '65.241%', '66.866%', '67.679%', '68.791%', '68.920%', '70.032%', '70.781%', '71.508%', '71.251%']
Workers federated accuracies:  ['53.925%', '56.963%', '59.572%', '61.925%', '63.187%', '65.134%', '65.241%', '66.866%', '67.679%', '68.791%', '68.920%', '70.032%', '70.781%', '71.508%', '71.251%']
Workers improved  accuracies:  ['2.695%', '5.305%', '7.551%', '9.390%', '10.460%', '12.086%', '11.829%', '13.048%', '13.583%', '14.503%', '14.310%', '14.973%', '15.743%', '15.893%', '15.743%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 10:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.6000%', '75.6000%', '75.5000%', '75.5000%', '75.5000%', '75.5000%', '75.5000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0669, 0.0668, 0.0669, 0.0669, 0.0669, 0.0664,
        0.0664, 0.0665, 0.0665, 0.0665, 0.0665, 0.0665])
Federated model performance: Loss: 0.701870. Accuracy: 76.2353%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['54.160%', '57.455%', '60.193%', '62.310%', '64.107%', '65.904%', '65.882%', '67.487%', '68.428%', '69.668%', '69.690%', '70.888%', '71.294%', '72.064%', '71.701%']
Workers federated accuracies:  ['54.160%', '57.455%', '60.193%', '62.310%', '64.107%', '65.904%', '65.882%', '67.487%', '68.428%', '69.668%', '69.690%', '70.888%', '71.294%', '72.064%', '71.701%']
Workers improved  accuracies:  ['2.930%', '5.797%', '8.171%', '9.775%', '11.380%', '12.856%', '12.471%', '13.668%', '14.332%', '15.380%', '15.080%', '15.829%', '16.257%', '16.449%', '16.193%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.701870. Accuracy: 76.2353%.
Workers before    accuracies:  ['51.230%', '51.658%', '52.021%', '52.535%', '52.727%', '53.048%', '53.412%', '53.818%', '54.096%', '54.289%', '54.610%', '55.059%', '55.037%', '55.615%', '55.508%']
Workers standlone accuracies:  ['54.160%', '57.455%', '60.193%', '62.310%', '64.107%', '65.904%', '65.882%', '67.487%', '68.428%', '69.668%', '69.690%', '70.888%', '71.294%', '72.064%', '71.701%']
Workers federated accuracies:  ['54.160%', '57.455%', '60.193%', '62.310%', '64.107%', '65.904%', '65.882%', '67.487%', '68.428%', '69.668%', '69.690%', '70.888%', '71.294%', '72.064%', '71.701%']
Workers improved  accuracies:  ['2.930%', '5.797%', '8.171%', '9.775%', '11.380%', '12.856%', '12.471%', '13.668%', '14.332%', '15.380%', '15.080%', '15.829%', '16.257%', '16.449%', '16.193%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]
Workers sharing_contributions :  tensor([ 5.3333, 10.6667, 14.9333, 20.2667, 25.6000, 30.9333, 35.2000, 40.5333,
        45.8667, 50.1333, 55.4667, 60.8000, 66.1333, 70.4000, 75.7333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.09468755227651371, 0.7371243982088418)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9533074406088271, 3.932291135706703e-08)
Correlation between test_acc improvements & sharing_contributions:  (0.927291098931207, 6.565576073073973e-07)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.741060. Accuracy: 55.4011%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 70.7000%
Leave-one-out validation accuracies :  ['70.6000%', '70.6000%', '71.0000%', '71.2000%', '71.2000%', '71.6000%', '72.0000%', '72.0000%', '71.9000%', '72.5000%', '73.1000%', '72.8000%', '73.1000%', '73.5000%', '73.5000%']
Computed and normalized credits:  tensor([0.0690, 0.0690, 0.0683, 0.0680, 0.0680, 0.0674, 0.0667, 0.0667, 0.0669,
        0.0659, 0.0650, 0.0655, 0.0650, 0.0644, 0.0644])
Federated model performance: Loss: 0.629015. Accuracy: 71.2941%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['53.369%', '53.775%', '54.824%', '55.615%', '56.086%', '56.578%', '57.027%', '58.182%', '58.888%', '58.909%', '59.615%', '60.428%', '60.578%', '61.241%', '61.070%']
Workers federated accuracies:  ['53.369%', '53.775%', '54.824%', '55.615%', '56.086%', '56.578%', '57.027%', '58.182%', '58.888%', '58.909%', '59.615%', '60.428%', '60.578%', '61.241%', '61.070%']
Workers improved  accuracies:  ['0.449%', '0.449%', '1.198%', '1.668%', '1.626%', '1.861%', '1.968%', '2.631%', '3.123%', '3.080%', '3.358%', '3.529%', '3.594%', '3.893%', '3.914%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 2:
Federated model validation accuracy : 72.9000%
Leave-one-out validation accuracies :  ['72.9000%', '73.1000%', '73.4000%', '73.2000%', '73.1000%', '73.0000%', '72.8000%', '73.1000%', '73.4000%', '72.9000%', '72.7000%', '72.7000%', '72.7000%', '73.0000%', '73.1000%']
Computed and normalized credits:  tensor([0.0671, 0.0668, 0.0663, 0.0665, 0.0667, 0.0668, 0.0670, 0.0665, 0.0661,
        0.0667, 0.0669, 0.0670, 0.0669, 0.0664, 0.0663])
Federated model performance: Loss: 0.580731. Accuracy: 73.9251%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['53.647%', '54.503%', '55.701%', '57.112%', '57.861%', '58.524%', '59.316%', '60.513%', '61.540%', '61.283%', '62.353%', '63.144%', '63.487%', '64.578%', '63.914%']
Workers federated accuracies:  ['53.647%', '54.503%', '55.701%', '57.112%', '57.861%', '58.524%', '59.316%', '60.513%', '61.540%', '61.283%', '62.353%', '63.144%', '63.487%', '64.578%', '63.914%']
Workers improved  accuracies:  ['0.727%', '1.176%', '2.075%', '3.166%', '3.401%', '3.807%', '4.257%', '4.963%', '5.775%', '5.455%', '6.096%', '6.246%', '6.503%', '7.230%', '6.759%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 3:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.4000%', '73.5000%', '73.4000%', '73.0000%', '72.8000%', '72.7000%', '72.5000%', '72.8000%', '72.9000%', '73.2000%', '73.5000%', '73.5000%', '73.7000%', '73.7000%', '73.8000%']
Computed and normalized credits:  tensor([0.0665, 0.0663, 0.0664, 0.0670, 0.0673, 0.0675, 0.0678, 0.0673, 0.0671,
        0.0667, 0.0663, 0.0663, 0.0660, 0.0659, 0.0658])
Federated model performance: Loss: 0.576161. Accuracy: 74.3529%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['53.882%', '54.995%', '56.856%', '58.289%', '59.166%', '60.471%', '61.219%', '62.567%', '63.337%', '63.187%', '64.578%', '65.455%', '65.840%', '67.016%', '66.460%']
Workers federated accuracies:  ['53.882%', '54.995%', '56.856%', '58.289%', '59.166%', '60.471%', '61.219%', '62.567%', '63.337%', '63.187%', '64.578%', '65.455%', '65.840%', '67.016%', '66.460%']
Workers improved  accuracies:  ['0.963%', '1.668%', '3.230%', '4.342%', '4.706%', '5.754%', '6.160%', '7.016%', '7.572%', '7.358%', '8.321%', '8.556%', '8.856%', '9.668%', '9.305%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 4:
Federated model validation accuracy : 73.1000%
Leave-one-out validation accuracies :  ['73.1000%', '73.1000%', '73.3000%', '73.6000%', '73.5000%', '73.7000%', '73.8000%', '73.7000%', '73.7000%', '73.6000%', '73.6000%', '73.7000%', '73.7000%', '73.8000%', '73.6000%']
Computed and normalized credits:  tensor([0.0674, 0.0673, 0.0670, 0.0667, 0.0668, 0.0666, 0.0664, 0.0665, 0.0665,
        0.0666, 0.0666, 0.0664, 0.0664, 0.0662, 0.0665])
Federated model performance: Loss: 0.598216. Accuracy: 74.9519%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['54.267%', '55.636%', '57.647%', '59.615%', '60.535%', '61.904%', '62.781%', '64.321%', '65.091%', '65.155%', '66.481%', '67.358%', '67.722%', '69.155%', '68.599%']
Workers federated accuracies:  ['54.267%', '55.636%', '57.647%', '59.615%', '60.535%', '61.904%', '62.781%', '64.321%', '65.091%', '65.155%', '66.481%', '67.358%', '67.722%', '69.155%', '68.599%']
Workers improved  accuracies:  ['1.348%', '2.310%', '4.021%', '5.668%', '6.075%', '7.187%', '7.722%', '8.770%', '9.326%', '9.326%', '10.225%', '10.460%', '10.738%', '11.807%', '11.444%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 5:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.8000%', '73.8000%', '73.8000%', '73.7000%', '73.7000%', '73.6000%', '73.7000%', '73.7000%', '73.8000%', '73.8000%', '73.9000%', '74.0000%', '74.1000%', '74.2000%', '74.1000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0669, 0.0669, 0.0670, 0.0669, 0.0669, 0.0667,
        0.0667, 0.0666, 0.0664, 0.0663, 0.0661, 0.0663])
Federated model performance: Loss: 0.634640. Accuracy: 75.1230%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['54.460%', '56.321%', '58.717%', '60.791%', '61.925%', '63.273%', '64.193%', '65.797%', '66.545%', '66.610%', '68.171%', '69.305%', '69.519%', '70.717%', '70.032%']
Workers federated accuracies:  ['54.460%', '56.321%', '58.717%', '60.791%', '61.925%', '63.273%', '64.193%', '65.797%', '66.545%', '66.610%', '68.171%', '69.305%', '69.519%', '70.717%', '70.032%']
Workers improved  accuracies:  ['1.540%', '2.995%', '5.091%', '6.845%', '7.465%', '8.556%', '9.134%', '10.246%', '10.781%', '10.781%', '11.914%', '12.406%', '12.535%', '13.369%', '12.877%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 6:
Federated model validation accuracy : 73.7000%
Leave-one-out validation accuracies :  ['73.7000%', '73.7000%', '73.8000%', '73.9000%', '73.9000%', '73.9000%', '73.9000%', '74.1000%', '74.2000%', '74.2000%', '74.2000%', '74.1000%', '74.0000%', '74.3000%', '74.1000%']
Computed and normalized credits:  tensor([0.0671, 0.0671, 0.0670, 0.0668, 0.0668, 0.0669, 0.0668, 0.0665, 0.0664,
        0.0664, 0.0664, 0.0665, 0.0666, 0.0661, 0.0665])
Federated model performance: Loss: 0.678402. Accuracy: 75.3369%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['54.717%', '56.984%', '59.401%', '61.904%', '62.995%', '64.535%', '65.134%', '67.059%', '68.021%', '68.086%', '69.497%', '70.246%', '70.717%', '72.000%', '71.209%']
Workers federated accuracies:  ['54.717%', '56.984%', '59.401%', '61.904%', '62.995%', '64.535%', '65.134%', '67.059%', '68.021%', '68.086%', '69.497%', '70.246%', '70.717%', '72.000%', '71.209%']
Workers improved  accuracies:  ['1.797%', '3.658%', '5.775%', '7.957%', '8.535%', '9.818%', '10.075%', '11.508%', '12.257%', '12.257%', '13.241%', '13.348%', '13.733%', '14.652%', '14.053%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 7:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.1000%', '74.2000%', '74.2000%', '74.2000%', '74.1000%', '74.1000%', '74.2000%', '74.2000%', '74.2000%', '74.1000%', '74.1000%', '74.2000%', '74.2000%', '74.1000%', '74.1000%']
Computed and normalized credits:  tensor([0.0668, 0.0667, 0.0666, 0.0666, 0.0668, 0.0668, 0.0666, 0.0666, 0.0666,
        0.0667, 0.0667, 0.0666, 0.0666, 0.0667, 0.0667])
Federated model performance: Loss: 0.727328. Accuracy: 75.3155%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['55.123%', '57.626%', '60.278%', '62.695%', '63.957%', '65.583%', '66.160%', '68.000%', '69.134%', '69.390%', '70.460%', '71.251%', '71.551%', '72.684%', '71.936%']
Workers federated accuracies:  ['55.123%', '57.626%', '60.278%', '62.695%', '63.957%', '65.583%', '66.160%', '68.000%', '69.134%', '69.390%', '70.460%', '71.251%', '71.551%', '72.684%', '71.936%']
Workers improved  accuracies:  ['2.203%', '4.299%', '6.652%', '8.749%', '9.497%', '10.866%', '11.102%', '12.449%', '13.369%', '13.561%', '14.203%', '14.353%', '14.567%', '15.337%', '14.781%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 8:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.1000%', '74.1000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.0000%', '74.1000%', '74.1000%', '74.1000%', '74.2000%', '74.1000%', '74.2000%', '74.3000%']
Computed and normalized credits:  tensor([0.0668, 0.0667, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0669, 0.0667,
        0.0668, 0.0668, 0.0666, 0.0667, 0.0666, 0.0665])
Federated model performance: Loss: 0.778119. Accuracy: 75.3583%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['55.422%', '58.225%', '60.963%', '63.743%', '64.877%', '66.717%', '67.422%', '69.198%', '69.947%', '70.160%', '71.658%', '71.979%', '72.278%', '73.305%', '72.620%']
Workers federated accuracies:  ['55.422%', '58.225%', '60.963%', '63.743%', '64.877%', '66.717%', '67.422%', '69.198%', '69.947%', '70.160%', '71.658%', '71.979%', '72.278%', '73.305%', '72.620%']
Workers improved  accuracies:  ['2.503%', '4.898%', '7.337%', '9.797%', '10.417%', '12.000%', '12.364%', '13.647%', '14.182%', '14.332%', '15.401%', '15.080%', '15.294%', '15.957%', '15.465%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 9:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2000%', '74.2000%', '74.1000%', '74.1000%', '74.2000%', '74.3000%', '74.3000%', '74.2000%', '74.2000%', '74.3000%', '74.4000%', '74.4000%', '74.6000%', '74.6000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0669, 0.0669, 0.0668, 0.0666, 0.0667, 0.0668,
        0.0668, 0.0667, 0.0665, 0.0665, 0.0662, 0.0662])
Federated model performance: Loss: 0.828079. Accuracy: 75.4439%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['55.594%', '58.674%', '61.754%', '64.642%', '65.733%', '67.807%', '68.150%', '69.968%', '70.695%', '71.230%', '72.214%', '72.706%', '72.791%', '73.861%', '73.134%']
Workers federated accuracies:  ['55.594%', '58.674%', '61.754%', '64.642%', '65.733%', '67.807%', '68.150%', '69.968%', '70.695%', '71.230%', '72.214%', '72.706%', '72.791%', '73.861%', '73.134%']
Workers improved  accuracies:  ['2.674%', '5.348%', '8.128%', '10.695%', '11.273%', '13.091%', '13.091%', '14.417%', '14.930%', '15.401%', '15.957%', '15.807%', '15.807%', '16.513%', '15.979%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 10:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.4000%', '74.5000%', '74.5000%', '74.5000%', '74.4000%', '74.5000%', '74.5000%', '74.4000%', '74.5000%', '74.5000%', '74.6000%', '74.6000%', '74.6000%', '74.7000%', '74.7000%']
Computed and normalized credits:  tensor([0.0669, 0.0667, 0.0667, 0.0667, 0.0669, 0.0667, 0.0667, 0.0669, 0.0667,
        0.0667, 0.0666, 0.0665, 0.0665, 0.0664, 0.0664])
Federated model performance: Loss: 0.877134. Accuracy: 75.5508%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['56.000%', '59.123%', '62.417%', '65.540%', '66.717%', '68.770%', '69.219%', '70.973%', '71.337%', '71.872%', '72.898%', '73.134%', '73.390%', '74.332%', '73.775%']
Workers federated accuracies:  ['56.000%', '59.123%', '62.417%', '65.540%', '66.717%', '68.770%', '69.219%', '70.973%', '71.337%', '71.872%', '72.898%', '73.134%', '73.390%', '74.332%', '73.775%']
Workers improved  accuracies:  ['3.080%', '5.797%', '8.791%', '11.594%', '12.257%', '14.053%', '14.160%', '15.422%', '15.572%', '16.043%', '16.642%', '16.235%', '16.406%', '16.984%', '16.620%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.877134. Accuracy: 75.5508%.
Workers before    accuracies:  ['52.920%', '53.326%', '53.626%', '53.947%', '54.460%', '54.717%', '55.059%', '55.551%', '55.765%', '55.829%', '56.257%', '56.898%', '56.984%', '57.348%', '57.155%']
Workers standlone accuracies:  ['56.000%', '59.123%', '62.417%', '65.540%', '66.717%', '68.770%', '69.219%', '70.973%', '71.337%', '71.872%', '72.898%', '73.134%', '73.390%', '74.332%', '73.775%']
Workers federated accuracies:  ['56.000%', '59.123%', '62.417%', '65.540%', '66.717%', '68.770%', '69.219%', '70.973%', '71.337%', '71.872%', '72.898%', '73.134%', '73.390%', '74.332%', '73.775%']
Workers improved  accuracies:  ['3.080%', '5.797%', '8.791%', '11.594%', '12.257%', '14.053%', '14.160%', '15.422%', '15.572%', '16.043%', '16.642%', '16.235%', '16.406%', '16.984%', '16.620%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]
Workers sharing_contributions :  tensor([ 5.3333, 10.6667, 14.9333, 20.2667, 25.6000, 30.9333, 35.2000, 40.5333,
        45.8667, 50.1333, 55.4667, 60.8000, 66.1333, 70.4000, 75.7333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.3847626348783563, 0.15674078089427246)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999998, 3.5089823585550356e-101)
Correlation between test_acc & sharing contributions:  (0.9278502747140907, 6.252805076013275e-07)
Correlation between test_acc improvements & sharing_contributions:  (0.8824553794899193, 1.333663202366754e-05)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.701778. Accuracy: 61.3904%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.3000%
Leave-one-out validation accuracies :  ['71.3000%', '71.2000%', '71.2000%', '71.5000%', '71.6000%', '71.5000%', '72.1000%', '72.0000%', '72.4000%', '72.4000%', '72.6000%', '72.4000%', '72.7000%', '72.5000%', '72.1000%']
Computed and normalized credits:  tensor([0.0677, 0.0679, 0.0679, 0.0674, 0.0672, 0.0674, 0.0665, 0.0666, 0.0660,
        0.0660, 0.0657, 0.0660, 0.0655, 0.0658, 0.0665])
Federated model performance: Loss: 0.624142. Accuracy: 72.2781%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['60.064%', '60.513%', '60.963%', '61.604%', '61.968%', '62.481%', '62.802%', '63.551%', '63.529%', '64.428%', '64.428%', '64.941%', '65.433%', '65.604%', '65.561%']
Workers federated accuracies:  ['60.064%', '60.513%', '60.963%', '61.604%', '61.968%', '62.481%', '62.802%', '63.551%', '63.529%', '64.428%', '64.428%', '64.941%', '65.433%', '65.604%', '65.561%']
Workers improved  accuracies:  ['0.086%', '0.321%', '0.727%', '1.112%', '1.070%', '1.412%', '1.626%', '1.947%', '1.647%', '2.438%', '2.225%', '2.610%', '2.973%', '2.973%', '2.973%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 2:
Federated model validation accuracy : 72.5000%
Leave-one-out validation accuracies :  ['72.5000%', '72.4000%', '72.4000%', '72.4000%', '72.3000%', '72.5000%', '72.7000%', '72.6000%', '72.5000%', '72.3000%', '72.3000%', '72.5000%', '72.4000%', '72.4000%', '72.5000%']
Computed and normalized credits:  tensor([0.0667, 0.0669, 0.0669, 0.0668, 0.0670, 0.0667, 0.0663, 0.0664, 0.0665,
        0.0668, 0.0668, 0.0665, 0.0666, 0.0666, 0.0666])
Federated model performance: Loss: 0.588618. Accuracy: 73.9465%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['60.364%', '61.005%', '61.797%', '62.652%', '63.123%', '63.615%', '64.406%', '65.690%', '65.925%', '66.610%', '66.717%', '67.209%', '68.150%', '68.428%', '68.043%']
Workers federated accuracies:  ['60.364%', '61.005%', '61.797%', '62.652%', '63.123%', '63.615%', '64.406%', '65.690%', '65.925%', '66.610%', '66.717%', '67.209%', '68.150%', '68.428%', '68.043%']
Workers improved  accuracies:  ['0.385%', '0.813%', '1.561%', '2.160%', '2.225%', '2.545%', '3.230%', '4.086%', '4.043%', '4.620%', '4.513%', '4.877%', '5.690%', '5.797%', '5.455%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 3:
Federated model validation accuracy : 72.2000%
Leave-one-out validation accuracies :  ['72.2000%', '72.0000%', '72.0000%', '72.3000%', '72.5000%', '72.5000%', '72.4000%', '72.4000%', '72.4000%', '72.5000%', '72.5000%', '72.4000%', '72.3000%', '72.6000%', '72.6000%']
Computed and normalized credits:  tensor([0.0669, 0.0673, 0.0673, 0.0668, 0.0665, 0.0665, 0.0666, 0.0666, 0.0666,
        0.0665, 0.0665, 0.0666, 0.0668, 0.0663, 0.0663])
Federated model performance: Loss: 0.584140. Accuracy: 74.0749%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['60.513%', '61.390%', '62.353%', '63.829%', '64.299%', '65.176%', '65.840%', '67.594%', '67.722%', '68.620%', '68.578%', '69.433%', '70.225%', '70.610%', '69.989%']
Workers federated accuracies:  ['60.513%', '61.390%', '62.353%', '63.829%', '64.299%', '65.176%', '65.840%', '67.594%', '67.722%', '68.620%', '68.578%', '69.433%', '70.225%', '70.610%', '69.989%']
Workers improved  accuracies:  ['0.535%', '1.198%', '2.118%', '3.337%', '3.401%', '4.107%', '4.663%', '5.989%', '5.840%', '6.631%', '6.374%', '7.102%', '7.765%', '7.979%', '7.401%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 4:
Federated model validation accuracy : 72.7000%
Leave-one-out validation accuracies :  ['72.7000%', '72.7000%', '72.7000%', '72.6000%', '72.5000%', '72.5000%', '72.5000%', '72.5000%', '72.6000%', '72.6000%', '72.4000%', '72.4000%', '72.5000%', '72.5000%', '72.9000%']
Computed and normalized credits:  tensor([0.0665, 0.0665, 0.0665, 0.0666, 0.0668, 0.0668, 0.0668, 0.0668, 0.0666,
        0.0666, 0.0669, 0.0669, 0.0668, 0.0667, 0.0661])
Federated model performance: Loss: 0.599802. Accuracy: 74.1604%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['60.727%', '61.925%', '63.037%', '64.834%', '65.540%', '66.460%', '67.102%', '69.262%', '69.348%', '70.332%', '70.182%', '71.123%', '71.294%', '71.444%', '70.952%']
Workers federated accuracies:  ['60.727%', '61.925%', '63.037%', '64.834%', '65.540%', '66.460%', '67.102%', '69.262%', '69.348%', '70.332%', '70.182%', '71.123%', '71.294%', '71.444%', '70.952%']
Workers improved  accuracies:  ['0.749%', '1.733%', '2.802%', '4.342%', '4.642%', '5.390%', '5.925%', '7.658%', '7.465%', '8.342%', '7.979%', '8.791%', '8.834%', '8.813%', '8.364%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 5:
Federated model validation accuracy : 72.7000%
Leave-one-out validation accuracies :  ['72.7000%', '72.7000%', '72.7000%', '72.8000%', '72.7000%', '72.7000%', '72.8000%', '72.9000%', '72.8000%', '72.9000%', '73.0000%', '73.1000%', '73.0000%', '73.0000%', '73.0000%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0669, 0.0667, 0.0669, 0.0669, 0.0668, 0.0666, 0.0667,
        0.0666, 0.0665, 0.0663, 0.0665, 0.0665, 0.0664])
Federated model performance: Loss: 0.627142. Accuracy: 74.1604%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['60.984%', '62.139%', '63.465%', '65.583%', '66.610%', '67.850%', '68.578%', '70.610%', '70.717%', '71.551%', '71.294%', '72.000%', '72.385%', '72.364%', '71.979%']
Workers federated accuracies:  ['60.984%', '62.139%', '63.465%', '65.583%', '66.610%', '67.850%', '68.578%', '70.610%', '70.717%', '71.551%', '71.294%', '72.000%', '72.385%', '72.364%', '71.979%']
Workers improved  accuracies:  ['1.005%', '1.947%', '3.230%', '5.091%', '5.711%', '6.781%', '7.401%', '9.005%', '8.834%', '9.561%', '9.091%', '9.668%', '9.925%', '9.733%', '9.390%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 6:
Federated model validation accuracy : 73.2000%
Leave-one-out validation accuracies :  ['73.2000%', '73.2000%', '73.2000%', '73.1000%', '73.1000%', '73.1000%', '73.2000%', '73.1000%', '73.1000%', '73.1000%', '73.1000%', '73.1000%', '73.1000%', '73.1000%', '73.3000%']
Computed and normalized credits:  tensor([0.0666, 0.0666, 0.0666, 0.0667, 0.0668, 0.0668, 0.0666, 0.0667, 0.0667,
        0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0664])
Federated model performance: Loss: 0.662332. Accuracy: 74.3743%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['61.262%', '62.524%', '64.321%', '66.417%', '67.487%', '68.706%', '69.626%', '71.529%', '71.209%', '72.278%', '71.679%', '72.663%', '73.262%', '73.283%', '72.770%']
Workers federated accuracies:  ['61.262%', '62.524%', '64.321%', '66.417%', '67.487%', '68.706%', '69.626%', '71.529%', '71.209%', '72.278%', '71.679%', '72.663%', '73.262%', '73.283%', '72.770%']
Workers improved  accuracies:  ['1.283%', '2.332%', '4.086%', '5.925%', '6.588%', '7.636%', '8.449%', '9.925%', '9.326%', '10.289%', '9.476%', '10.332%', '10.802%', '10.652%', '10.182%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 7:
Federated model validation accuracy : 73.1000%
Leave-one-out validation accuracies :  ['73.1000%', '73.0000%', '73.0000%', '73.1000%', '73.2000%', '73.1000%', '73.1000%', '73.1000%', '73.1000%', '73.0000%', '73.2000%', '73.2000%', '73.3000%', '73.3000%', '73.3000%']
Computed and normalized credits:  tensor([0.0667, 0.0669, 0.0669, 0.0667, 0.0666, 0.0667, 0.0667, 0.0667, 0.0667,
        0.0669, 0.0666, 0.0666, 0.0664, 0.0664, 0.0664])
Federated model performance: Loss: 0.702009. Accuracy: 74.4599%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['61.433%', '63.102%', '64.941%', '67.294%', '68.299%', '69.583%', '70.289%', '72.107%', '71.722%', '72.941%', '72.471%', '73.283%', '73.626%', '73.583%', '73.262%']
Workers federated accuracies:  ['61.433%', '63.102%', '64.941%', '67.294%', '68.299%', '69.583%', '70.289%', '72.107%', '71.722%', '72.941%', '72.471%', '73.283%', '73.626%', '73.583%', '73.262%']
Workers improved  accuracies:  ['1.455%', '2.909%', '4.706%', '6.802%', '7.401%', '8.513%', '9.112%', '10.503%', '9.840%', '10.952%', '10.267%', '10.952%', '11.166%', '10.952%', '10.674%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 8:
Federated model validation accuracy : 73.2000%
Leave-one-out validation accuracies :  ['73.2000%', '73.2000%', '73.3000%', '73.3000%', '73.3000%', '73.3000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0668, 0.0667, 0.0667, 0.0667, 0.0666, 0.0666, 0.0666,
        0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666])
Federated model performance: Loss: 0.744304. Accuracy: 74.4813%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['61.604%', '63.465%', '65.711%', '68.235%', '69.091%', '70.503%', '70.717%', '72.770%', '72.342%', '73.433%', '73.134%', '73.561%', '73.840%', '74.053%', '73.690%']
Workers federated accuracies:  ['61.604%', '63.465%', '65.711%', '68.235%', '69.091%', '70.503%', '70.717%', '72.770%', '72.342%', '73.433%', '73.134%', '73.561%', '73.840%', '74.053%', '73.690%']
Workers improved  accuracies:  ['1.626%', '3.273%', '5.476%', '7.743%', '8.193%', '9.433%', '9.540%', '11.166%', '10.460%', '11.444%', '10.930%', '11.230%', '11.380%', '11.422%', '11.102%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 9:
Federated model validation accuracy : 73.5000%
Leave-one-out validation accuracies :  ['73.5000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.3000%', '73.3000%', '73.3000%', '73.5000%', '73.5000%', '73.5000%', '73.5000%']
Computed and normalized credits:  tensor([0.0666, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0668,
        0.0668, 0.0668, 0.0665, 0.0665, 0.0665, 0.0665])
Federated model performance: Loss: 0.783379. Accuracy: 74.5882%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['61.904%', '63.914%', '66.225%', '69.005%', '70.053%', '71.273%', '71.016%', '73.134%', '72.813%', '73.668%', '73.519%', '73.840%', '74.246%', '74.460%', '74.075%']
Workers federated accuracies:  ['61.904%', '63.914%', '66.225%', '69.005%', '70.053%', '71.273%', '71.016%', '73.134%', '72.813%', '73.668%', '73.519%', '73.840%', '74.246%', '74.460%', '74.075%']
Workers improved  accuracies:  ['1.925%', '3.722%', '5.989%', '8.513%', '9.155%', '10.203%', '9.840%', '11.529%', '10.930%', '11.679%', '11.316%', '11.508%', '11.786%', '11.829%', '11.487%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Epoch 10:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.4000%', '73.4000%', '73.4000%', '73.4000%', '73.3000%', '73.4000%', '73.4000%', '73.5000%', '73.5000%', '73.5000%', '73.5000%', '73.5000%', '73.5000%', '73.8000%', '73.8000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0670, 0.0668, 0.0668, 0.0666, 0.0667,
        0.0667, 0.0667, 0.0666, 0.0666, 0.0662, 0.0662])
Federated model performance: Loss: 0.821967. Accuracy: 74.7808%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['62.139%', '64.428%', '66.909%', '69.519%', '70.738%', '71.872%', '71.658%', '73.647%', '73.219%', '74.118%', '73.818%', '74.139%', '74.952%', '74.909%', '74.353%']
Workers federated accuracies:  ['62.139%', '64.428%', '66.909%', '69.519%', '70.738%', '71.872%', '71.658%', '73.647%', '73.219%', '74.118%', '73.818%', '74.139%', '74.952%', '74.909%', '74.353%']
Workers improved  accuracies:  ['2.160%', '4.235%', '6.674%', '9.027%', '9.840%', '10.802%', '10.481%', '12.043%', '11.337%', '12.128%', '11.615%', '11.807%', '12.492%', '12.278%', '11.765%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.821967. Accuracy: 74.7808%.
Workers before    accuracies:  ['59.979%', '60.193%', '60.235%', '60.492%', '60.898%', '61.070%', '61.176%', '61.604%', '61.882%', '61.989%', '62.203%', '62.332%', '62.460%', '62.631%', '62.588%']
Workers standlone accuracies:  ['62.139%', '64.428%', '66.909%', '69.519%', '70.738%', '71.872%', '71.658%', '73.647%', '73.219%', '74.118%', '73.818%', '74.139%', '74.952%', '74.909%', '74.353%']
Workers federated accuracies:  ['62.139%', '64.428%', '66.909%', '69.519%', '70.738%', '71.872%', '71.658%', '73.647%', '73.219%', '74.118%', '73.818%', '74.139%', '74.952%', '74.909%', '74.353%']
Workers improved  accuracies:  ['2.160%', '4.235%', '6.674%', '9.027%', '9.840%', '10.802%', '10.481%', '12.043%', '11.337%', '12.128%', '11.615%', '11.807%', '12.492%', '12.278%', '11.765%']
Workers shard sizes:  [80, 160, 224, 304, 384, 464, 528, 608, 688, 752, 832, 912, 992, 1056, 1136]
Workers sharing_contributions :  tensor([ 5.3333, 10.6667, 14.9333, 20.2667, 25.6000, 30.9333, 35.2000, 40.5333,
        45.8667, 50.1333, 55.4667, 60.8000, 66.1333, 70.4000, 75.7333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.21798518350074253, 0.43511617082801335)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999999, 3.876914407497237e-103)
Correlation between test_acc & sharing contributions:  (0.8929175289880329, 7.4684445167696426e-06)
Correlation between test_acc improvements & sharing_contributions:  (0.8358582650173076, 0.00010389142698050295)
standalone_vs_final_corr [[0.9999999999999998], [1.0], [1.0], [0.9999999999999998], [0.9999999999999999]]
standalone_vs_final_corr_mean [1.0]
standalone_vs_final_corr_std [1.4895204919483638e-16]
sharingcontribution_vs_final_corr [[0.9432270628932461], [0.9547880450832053], [0.9533074406088271], [0.9278502747140907], [0.8929175289880329]]
sharingcontribution_vs_final_corr_mean [0.9344180704574804]
sharingcontribution_vs_final_corr_std [0.022868202386216806]
standalone_vs_federated_perturbed_corr [[0.5803124030807378], [0.019115368251505768], [-0.09468755227651371], [-0.3847626348783563], [-0.21798518350074253]]
standalone_vs_federated_perturbed_corr_mean [-0.0196015198646738]
standalone_vs_federated_perturbed_corr_std [0.3285520788393252]
federated_final_performance [0.751871645450592, 0.7655615210533142, 0.7623529434204102, 0.7555080056190491, 0.747807502746582]
federated_final_performance_mean 0.7566203236579895
federated_final_performance_std 0.006546158396439271
CFFL_best_worker [0.7375401258468628, 0.7413903474807739, 0.7206417322158813, 0.7433155179023743, 0.7495186924934387]
CFFL_best_worker_mean 0.7384812831878662
CFFL_best_worker_std 0.00972411682916793
standalone_best_worker [0.7375401258468628, 0.7413903474807739, 0.7206417322158813, 0.7433155179023743, 0.7495186924934387]
standalone_best_worker_mean 0.7384812831878662
standalone_best_worker_std 0.00972411682916793
