Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 15000, 'n_workers': 20, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.685137. Accuracy: 66.4385%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 72.2667%
Leave-one-out validation accuracies :  ['72.2667%', '72.4000%', '72.5333%', '72.7333%', '72.7333%', '72.8000%', '72.8667%', '72.9333%', '73.0667%', '73.2667%', '73.2000%', '73.4000%', '73.3333%', '73.2667%', '73.4667%', '73.3333%', '73.4000%', '73.5333%', '73.8000%', '74.0000%']
Computed and normalized credits:  tensor([0.0510, 0.0509, 0.0507, 0.0505, 0.0505, 0.0504, 0.0503, 0.0502, 0.0501,
        0.0498, 0.0499, 0.0497, 0.0497, 0.0498, 0.0496, 0.0497, 0.0497, 0.0495,
        0.0492, 0.0490])
Federated model performance: Loss: 0.585704. Accuracy: 74.2674%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['65.369%', '65.519%', '66.182%', '66.289%', '66.652%', '66.738%', '66.845%', '67.401%', '67.187%', '67.465%', '67.701%', '68.000%', '67.850%', '68.171%', '68.193%', '68.171%', '68.385%', '68.321%', '68.684%', '68.642%']
Workers federated accuracies:  ['65.369%', '65.519%', '66.182%', '66.289%', '66.652%', '66.738%', '66.845%', '67.401%', '67.187%', '67.465%', '67.701%', '68.000%', '67.850%', '68.171%', '68.193%', '68.171%', '68.385%', '68.321%', '68.684%', '68.642%']
Workers improved  accuracies:  ['0.150%', '0.171%', '0.513%', '0.642%', '0.834%', '0.770%', '0.856%', '1.091%', '0.898%', '1.027%', '1.112%', '1.198%', '1.048%', '1.326%', '1.326%', '1.262%', '1.305%', '1.262%', '1.326%', '1.433%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 2:
Federated model validation accuracy : 73.3333%
Leave-one-out validation accuracies :  ['73.3333%', '73.3333%', '73.3333%', '73.4667%', '73.5333%', '73.5333%', '73.4667%', '73.4000%', '73.4667%', '73.5333%', '73.6667%', '73.8667%', '74.0667%', '74.1333%', '74.2000%', '74.2000%', '74.3333%', '74.6000%', '74.7333%', '74.7333%']
Computed and normalized credits:  tensor([0.0507, 0.0507, 0.0507, 0.0505, 0.0504, 0.0504, 0.0505, 0.0505, 0.0504,
        0.0503, 0.0502, 0.0499, 0.0497, 0.0496, 0.0495, 0.0496, 0.0494, 0.0491,
        0.0489, 0.0489])
Federated model performance: Loss: 0.545728. Accuracy: 75.8717%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['65.583%', '65.775%', '66.674%', '66.845%', '67.273%', '67.337%', '67.722%', '68.235%', '68.107%', '68.193%', '68.406%', '68.813%', '68.556%', '69.241%', '69.134%', '69.262%', '69.369%', '69.476%', '70.267%', '69.882%']
Workers federated accuracies:  ['65.583%', '65.775%', '66.674%', '66.845%', '67.273%', '67.337%', '67.722%', '68.235%', '68.107%', '68.193%', '68.406%', '68.813%', '68.556%', '69.241%', '69.134%', '69.262%', '69.369%', '69.476%', '70.267%', '69.882%']
Workers improved  accuracies:  ['0.364%', '0.428%', '1.005%', '1.198%', '1.455%', '1.369%', '1.733%', '1.925%', '1.818%', '1.754%', '1.818%', '2.011%', '1.754%', '2.396%', '2.267%', '2.353%', '2.289%', '2.417%', '2.909%', '2.674%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 3:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2667%', '74.2000%', '74.2667%', '74.2667%', '74.2667%', '74.4667%', '74.4000%', '74.3333%', '74.6000%', '74.7333%', '74.6667%', '74.6667%', '74.7333%', '74.8000%', '74.8000%', '74.8000%', '74.9333%', '75.1333%', '75.2000%']
Computed and normalized credits:  tensor([0.0505, 0.0504, 0.0505, 0.0504, 0.0504, 0.0504, 0.0502, 0.0503, 0.0503,
        0.0500, 0.0498, 0.0499, 0.0499, 0.0498, 0.0497, 0.0497, 0.0497, 0.0495,
        0.0493, 0.0492])
Federated model performance: Loss: 0.539579. Accuracy: 76.2781%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['65.733%', '66.075%', '67.016%', '67.380%', '67.786%', '67.936%', '68.214%', '68.791%', '68.620%', '68.834%', '69.219%', '69.540%', '69.647%', '70.289%', '70.203%', '70.439%', '70.524%', '70.717%', '71.187%', '71.144%']
Workers federated accuracies:  ['65.733%', '66.075%', '67.016%', '67.380%', '67.786%', '67.936%', '68.214%', '68.791%', '68.620%', '68.834%', '69.219%', '69.540%', '69.647%', '70.289%', '70.203%', '70.439%', '70.524%', '70.717%', '71.187%', '71.144%']
Workers improved  accuracies:  ['0.513%', '0.727%', '1.348%', '1.733%', '1.968%', '1.968%', '2.225%', '2.481%', '2.332%', '2.396%', '2.631%', '2.738%', '2.845%', '3.444%', '3.337%', '3.529%', '3.444%', '3.658%', '3.829%', '3.936%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 4:
Federated model validation accuracy : 74.8000%
Leave-one-out validation accuracies :  ['74.8000%', '74.8000%', '74.8667%', '74.8667%', '74.8667%', '74.9333%', '75.0000%', '75.0000%', '75.1333%', '75.1333%', '75.2000%', '75.2667%', '75.4000%', '75.4000%', '75.3333%', '75.4000%', '75.4667%', '75.4667%', '75.6667%', '75.8000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0504, 0.0504, 0.0504, 0.0503, 0.0502, 0.0502, 0.0501,
        0.0501, 0.0500, 0.0499, 0.0497, 0.0497, 0.0498, 0.0497, 0.0497, 0.0496,
        0.0494, 0.0492])
Federated model performance: Loss: 0.552961. Accuracy: 76.5562%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['65.968%', '66.139%', '67.636%', '67.786%', '68.214%', '68.235%', '68.578%', '69.390%', '69.241%', '69.476%', '70.139%', '70.567%', '70.588%', '71.380%', '70.973%', '71.209%', '71.422%', '71.294%', '71.957%', '71.914%']
Workers federated accuracies:  ['65.968%', '66.139%', '67.636%', '67.786%', '68.214%', '68.235%', '68.578%', '69.390%', '69.241%', '69.476%', '70.139%', '70.567%', '70.588%', '71.380%', '70.973%', '71.209%', '71.422%', '71.294%', '71.957%', '71.914%']
Workers improved  accuracies:  ['0.749%', '0.791%', '1.968%', '2.139%', '2.396%', '2.267%', '2.588%', '3.080%', '2.952%', '3.037%', '3.551%', '3.765%', '3.786%', '4.535%', '4.107%', '4.299%', '4.342%', '4.235%', '4.599%', '4.706%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 5:
Federated model validation accuracy : 75.2667%
Leave-one-out validation accuracies :  ['75.3333%', '75.4667%', '75.4667%', '75.5333%', '75.4667%', '75.4667%', '75.4667%', '75.4667%', '75.4667%', '75.5333%', '75.4667%', '75.5333%', '75.6000%', '75.7333%', '75.8667%', '75.8000%', '75.8667%', '75.8000%', '75.7333%', '75.6667%']
Computed and normalized credits:  tensor([0.0503, 0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501,
        0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0497, 0.0497, 0.0497, 0.0497,
        0.0498, 0.0498])
Federated model performance: Loss: 0.577016. Accuracy: 76.8556%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['66.118%', '66.460%', '67.872%', '68.000%', '68.492%', '68.834%', '68.984%', '70.246%', '69.690%', '70.396%', '70.610%', '70.995%', '71.080%', '71.807%', '71.508%', '71.765%', '71.979%', '71.893%', '72.706%', '72.684%']
Workers federated accuracies:  ['66.118%', '66.460%', '67.872%', '68.000%', '68.492%', '68.834%', '68.984%', '70.246%', '69.690%', '70.396%', '70.610%', '70.995%', '71.080%', '71.807%', '71.508%', '71.765%', '71.979%', '71.893%', '72.706%', '72.684%']
Workers improved  accuracies:  ['0.898%', '1.112%', '2.203%', '2.353%', '2.674%', '2.866%', '2.995%', '3.936%', '3.401%', '3.957%', '4.021%', '4.193%', '4.278%', '4.963%', '4.642%', '4.856%', '4.898%', '4.834%', '5.348%', '5.476%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 6:
Federated model validation accuracy : 75.7333%
Leave-one-out validation accuracies :  ['75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.8000%', '75.8000%', '75.8000%', '75.8667%', '75.8667%', '75.7333%', '75.7333%', '75.6667%', '75.6667%', '75.6667%', '75.7333%', '75.7333%', '75.8000%', '75.8000%', '75.7333%', '75.6667%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499,
        0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499,
        0.0500, 0.0501])
Federated model performance: Loss: 0.607703. Accuracy: 77.0053%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['66.289%', '66.524%', '68.321%', '68.364%', '69.070%', '69.283%', '69.583%', '70.738%', '70.439%', '71.059%', '71.209%', '71.594%', '71.465%', '72.171%', '72.107%', '72.599%', '72.642%', '72.492%', '73.540%', '73.155%']
Workers federated accuracies:  ['66.289%', '66.524%', '68.321%', '68.364%', '69.070%', '69.283%', '69.583%', '70.738%', '70.439%', '71.059%', '71.209%', '71.594%', '71.465%', '72.171%', '72.107%', '72.599%', '72.642%', '72.492%', '73.540%', '73.155%']
Workers improved  accuracies:  ['1.070%', '1.176%', '2.652%', '2.717%', '3.251%', '3.316%', '3.594%', '4.428%', '4.150%', '4.620%', '4.620%', '4.791%', '4.663%', '5.326%', '5.241%', '5.690%', '5.562%', '5.433%', '6.182%', '5.947%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 7:
Federated model validation accuracy : 75.5333%
Leave-one-out validation accuracies :  ['75.5333%', '75.5333%', '75.6000%', '75.6667%', '75.6667%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.8000%', '75.7333%', '75.8000%', '75.8000%', '75.7333%', '75.7333%', '75.7333%', '75.6667%', '75.8000%', '75.8000%', '76.0000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499,
        0.0499, 0.0497])
Federated model performance: Loss: 0.641508. Accuracy: 77.3262%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['66.353%', '66.717%', '68.535%', '68.684%', '69.412%', '69.818%', '70.075%', '71.144%', '70.930%', '71.444%', '71.594%', '72.086%', '71.872%', '72.449%', '72.642%', '73.283%', '73.305%', '73.155%', '74.182%', '73.540%']
Workers federated accuracies:  ['66.353%', '66.717%', '68.535%', '68.684%', '69.412%', '69.818%', '70.075%', '71.144%', '70.930%', '71.444%', '71.594%', '72.086%', '71.872%', '72.449%', '72.642%', '73.283%', '73.305%', '73.155%', '74.182%', '73.540%']
Workers improved  accuracies:  ['1.134%', '1.369%', '2.866%', '3.037%', '3.594%', '3.850%', '4.086%', '4.834%', '4.642%', '5.005%', '5.005%', '5.283%', '5.070%', '5.604%', '5.775%', '6.374%', '6.225%', '6.096%', '6.824%', '6.332%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 8:
Federated model validation accuracy : 75.6667%
Leave-one-out validation accuracies :  ['75.6667%', '75.6667%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.8667%', '75.9333%', '76.0000%', '75.9333%', '75.9333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.2000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501,
        0.0500, 0.0499, 0.0500, 0.0500, 0.0498, 0.0498, 0.0498, 0.0498, 0.0498,
        0.0498, 0.0497])
Federated model performance: Loss: 0.675654. Accuracy: 77.3690%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['66.481%', '67.059%', '68.749%', '68.963%', '69.882%', '70.246%', '70.524%', '71.337%', '71.166%', '71.658%', '72.064%', '72.642%', '72.471%', '72.898%', '73.155%', '73.711%', '73.882%', '73.604%', '74.524%', '74.160%']
Workers federated accuracies:  ['66.481%', '67.059%', '68.749%', '68.963%', '69.882%', '70.246%', '70.524%', '71.337%', '71.166%', '71.658%', '72.064%', '72.642%', '72.471%', '72.898%', '73.155%', '73.711%', '73.882%', '73.604%', '74.524%', '74.160%']
Workers improved  accuracies:  ['1.262%', '1.711%', '3.080%', '3.316%', '4.064%', '4.278%', '4.535%', '5.027%', '4.877%', '5.219%', '5.476%', '5.840%', '5.668%', '6.053%', '6.289%', '6.802%', '6.802%', '6.545%', '7.166%', '6.952%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 9:
Federated model validation accuracy : 76.0667%
Leave-one-out validation accuracies :  ['76.0667%', '76.0000%', '76.0000%', '76.1333%', '76.1333%', '76.0667%', '76.0667%', '76.0667%', '76.2000%', '76.2000%', '76.2000%', '76.2000%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.0667%']
Computed and normalized credits:  tensor([0.0501, 0.0502, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499,
        0.0499, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500])
Federated model performance: Loss: 0.709981. Accuracy: 77.4759%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['66.631%', '67.337%', '69.005%', '69.241%', '70.267%', '70.802%', '71.016%', '71.765%', '71.529%', '71.979%', '72.364%', '72.920%', '72.898%', '73.369%', '73.733%', '74.032%', '74.246%', '74.096%', '74.952%', '74.289%']
Workers federated accuracies:  ['66.631%', '67.337%', '69.005%', '69.241%', '70.267%', '70.802%', '71.016%', '71.765%', '71.529%', '71.979%', '72.364%', '72.920%', '72.898%', '73.369%', '73.733%', '74.032%', '74.246%', '74.096%', '74.952%', '74.289%']
Workers improved  accuracies:  ['1.412%', '1.989%', '3.337%', '3.594%', '4.449%', '4.834%', '5.027%', '5.455%', '5.241%', '5.540%', '5.775%', '6.118%', '6.096%', '6.524%', '6.866%', '7.123%', '7.166%', '7.037%', '7.594%', '7.080%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 10:
Federated model validation accuracy : 76.1333%
Leave-one-out validation accuracies :  ['76.1333%', '76.1333%', '76.1333%', '76.2667%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.2000%', '76.2000%', '76.2000%', '76.2000%', '76.2000%', '76.1333%', '76.1333%', '76.2667%', '76.2000%', '76.2000%', '76.2667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
        0.0500, 0.0500])
Federated model performance: Loss: 0.744196. Accuracy: 77.6257%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['66.909%', '67.444%', '69.134%', '69.733%', '70.674%', '71.016%', '71.294%', '72.278%', '71.765%', '72.171%', '72.684%', '73.348%', '73.348%', '73.668%', '74.096%', '74.289%', '74.332%', '74.396%', '75.080%', '74.567%']
Workers federated accuracies:  ['66.909%', '67.444%', '69.134%', '69.733%', '70.674%', '71.016%', '71.294%', '72.278%', '71.765%', '72.171%', '72.684%', '73.348%', '73.348%', '73.668%', '74.096%', '74.289%', '74.332%', '74.396%', '75.080%', '74.567%']
Workers improved  accuracies:  ['1.690%', '2.096%', '3.465%', '4.086%', '4.856%', '5.048%', '5.305%', '5.968%', '5.476%', '5.733%', '6.096%', '6.545%', '6.545%', '6.824%', '7.230%', '7.380%', '7.251%', '7.337%', '7.722%', '7.358%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.744196. Accuracy: 77.6257%.
Workers before    accuracies:  ['65.219%', '65.348%', '65.668%', '65.647%', '65.818%', '65.968%', '65.989%', '66.310%', '66.289%', '66.439%', '66.588%', '66.802%', '66.802%', '66.845%', '66.866%', '66.909%', '67.080%', '67.059%', '67.358%', '67.209%']
Workers standlone accuracies:  ['66.909%', '67.444%', '69.134%', '69.733%', '70.674%', '71.016%', '71.294%', '72.278%', '71.765%', '72.171%', '72.684%', '73.348%', '73.348%', '73.668%', '74.096%', '74.289%', '74.332%', '74.396%', '75.080%', '74.567%']
Workers federated accuracies:  ['66.909%', '67.444%', '69.134%', '69.733%', '70.674%', '71.016%', '71.294%', '72.278%', '71.765%', '72.171%', '72.684%', '73.348%', '73.348%', '73.668%', '74.096%', '74.289%', '74.332%', '74.396%', '75.080%', '74.567%']
Workers improved  accuracies:  ['1.690%', '2.096%', '3.465%', '4.086%', '4.856%', '5.048%', '5.305%', '5.968%', '5.476%', '5.733%', '6.096%', '6.545%', '6.545%', '6.824%', '7.230%', '7.380%', '7.251%', '7.337%', '7.722%', '7.358%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]
Workers sharing_contributions :  tensor([ 4.0000,  7.2000, 10.4000, 13.6000, 16.8000, 20.0000, 23.2000, 26.4000,
        29.6000, 32.8000, 36.0000, 39.2000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 63.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.01710553788569575, 0.9429381977965776)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.956320343766319, 4.689603012416425e-11)
Correlation between test_acc improvements & sharing_contributions:  (0.937062311912697, 1.1695705490079363e-09)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.753817. Accuracy: 50.7594%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.7333%
Leave-one-out validation accuracies :  ['71.7333%', '71.8000%', '72.0667%', '72.3333%', '72.5333%', '72.8667%', '73.2000%', '72.8667%', '73.2000%', '73.6667%', '73.5333%', '73.3333%', '73.7333%', '73.8667%', '74.1333%', '74.2000%', '74.0000%', '73.8667%', '73.7333%', '73.6667%']
Computed and normalized credits:  tensor([0.0518, 0.0517, 0.0514, 0.0511, 0.0508, 0.0504, 0.0500, 0.0504, 0.0500,
        0.0495, 0.0496, 0.0499, 0.0494, 0.0492, 0.0489, 0.0488, 0.0491, 0.0492,
        0.0494, 0.0495])
Federated model performance: Loss: 0.570055. Accuracy: 72.0428%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['48.963%', '49.626%', '49.647%', '50.717%', '51.037%', '50.995%', '51.936%', '52.513%', '52.791%', '53.005%', '53.583%', '54.075%', '54.246%', '54.973%', '54.545%', '55.722%', '56.342%', '56.043%', '57.283%', '56.898%']
Workers federated accuracies:  ['48.963%', '49.626%', '49.647%', '50.717%', '51.037%', '50.995%', '51.936%', '52.513%', '52.791%', '53.005%', '53.583%', '54.075%', '54.246%', '54.973%', '54.545%', '55.722%', '56.342%', '56.043%', '57.283%', '56.898%']
Workers improved  accuracies:  ['0.107%', '0.471%', '0.492%', '1.155%', '1.348%', '1.283%', '1.968%', '2.053%', '2.289%', '2.374%', '2.460%', '2.717%', '2.674%', '3.144%', '2.824%', '3.422%', '3.594%', '3.465%', '4.043%', '3.957%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 2:
Federated model validation accuracy : 73.7333%
Leave-one-out validation accuracies :  ['73.7333%', '73.7333%', '73.8667%', '74.0000%', '74.1333%', '74.2667%', '74.2667%', '74.4000%', '74.4000%', '74.0667%', '74.0667%', '74.0667%', '74.0667%', '73.8667%', '73.7333%', '73.8667%', '74.0000%', '74.0667%', '74.1333%', '74.1333%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0503, 0.0501, 0.0500, 0.0498, 0.0497, 0.0496, 0.0496,
        0.0499, 0.0499, 0.0500, 0.0499, 0.0501, 0.0503, 0.0501, 0.0500, 0.0499,
        0.0498, 0.0498])
Federated model performance: Loss: 0.521304. Accuracy: 74.2246%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['49.198%', '50.118%', '50.545%', '52.086%', '52.214%', '52.449%', '53.497%', '54.246%', '54.652%', '54.802%', '56.064%', '57.027%', '57.390%', '58.053%', '57.604%', '59.358%', '60.150%', '60.064%', '61.390%', '61.005%']
Workers federated accuracies:  ['49.198%', '50.118%', '50.545%', '52.086%', '52.214%', '52.449%', '53.497%', '54.246%', '54.652%', '54.802%', '56.064%', '57.027%', '57.390%', '58.053%', '57.604%', '59.358%', '60.150%', '60.064%', '61.390%', '61.005%']
Workers improved  accuracies:  ['0.342%', '0.963%', '1.390%', '2.524%', '2.524%', '2.738%', '3.529%', '3.786%', '4.150%', '4.171%', '4.941%', '5.668%', '5.818%', '6.225%', '5.882%', '7.059%', '7.401%', '7.487%', '8.150%', '8.064%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 3:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.0000%', '74.0000%', '74.0000%', '74.0667%', '74.0000%', '73.9333%', '74.0000%', '74.0000%', '74.0667%', '74.1333%', '74.2000%', '74.2667%', '74.2000%', '74.2667%', '74.4667%', '74.4667%', '74.6667%', '74.5333%', '74.6000%', '74.6000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0502, 0.0503, 0.0503, 0.0502, 0.0502, 0.0501,
        0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0497, 0.0497, 0.0495, 0.0496,
        0.0496, 0.0496])
Federated model performance: Loss: 0.546227. Accuracy: 74.6096%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['49.519%', '51.059%', '51.123%', '53.283%', '53.668%', '53.604%', '54.759%', '55.914%', '56.813%', '57.005%', '58.717%', '59.829%', '60.086%', '61.326%', '60.706%', '62.225%', '62.995%', '63.166%', '64.599%', '64.064%']
Workers federated accuracies:  ['49.519%', '51.059%', '51.123%', '53.283%', '53.668%', '53.604%', '54.759%', '55.914%', '56.813%', '57.005%', '58.717%', '59.829%', '60.086%', '61.326%', '60.706%', '62.225%', '62.995%', '63.166%', '64.599%', '64.064%']
Workers improved  accuracies:  ['0.663%', '1.904%', '1.968%', '3.722%', '3.979%', '3.893%', '4.791%', '5.455%', '6.310%', '6.374%', '7.594%', '8.471%', '8.513%', '9.497%', '8.984%', '9.925%', '10.246%', '10.588%', '11.358%', '11.123%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 4:
Federated model validation accuracy : 74.2667%
Leave-one-out validation accuracies :  ['74.2667%', '74.2667%', '74.2667%', '74.4667%', '74.7333%', '74.8000%', '74.8000%', '74.6667%', '74.6667%', '74.6667%', '74.7333%', '74.7333%', '74.6667%', '74.8000%', '74.8000%', '74.8000%', '74.9333%', '74.8667%', '74.8667%', '74.8000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0505, 0.0503, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
        0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0498, 0.0498, 0.0497, 0.0498,
        0.0497, 0.0498])
Federated model performance: Loss: 0.604987. Accuracy: 74.7380%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['49.775%', '51.594%', '52.043%', '54.182%', '54.652%', '54.674%', '56.578%', '57.797%', '58.995%', '59.380%', '60.791%', '61.925%', '62.695%', '63.786%', '63.037%', '65.091%', '65.647%', '65.989%', '67.080%', '66.802%']
Workers federated accuracies:  ['49.775%', '51.594%', '52.043%', '54.182%', '54.652%', '54.674%', '56.578%', '57.797%', '58.995%', '59.380%', '60.791%', '61.925%', '62.695%', '63.786%', '63.037%', '65.091%', '65.647%', '65.989%', '67.080%', '66.802%']
Workers improved  accuracies:  ['0.920%', '2.439%', '2.888%', '4.620%', '4.963%', '4.963%', '6.610%', '7.337%', '8.492%', '8.749%', '9.668%', '10.567%', '11.123%', '11.957%', '11.316%', '12.791%', '12.898%', '13.412%', '13.840%', '13.861%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 5:
Federated model validation accuracy : 74.8667%
Leave-one-out validation accuracies :  ['74.8667%', '74.8667%', '74.8667%', '74.8667%', '74.8667%', '74.9333%', '74.9333%', '74.9333%', '74.8667%', '74.8667%', '74.8667%', '74.8667%', '74.9333%', '74.9333%', '74.9333%', '74.9333%', '74.8667%', '74.8000%', '74.8000%', '74.7333%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0501,
        0.0501, 0.0501])
Federated model performance: Loss: 0.678206. Accuracy: 74.9305%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['50.075%', '52.299%', '52.684%', '55.080%', '55.636%', '55.914%', '58.053%', '59.893%', '61.027%', '61.369%', '62.674%', '63.957%', '64.920%', '65.690%', '65.262%', '67.273%', '67.658%', '67.572%', '69.027%', '68.449%']
Workers federated accuracies:  ['50.075%', '52.299%', '52.684%', '55.080%', '55.636%', '55.914%', '58.053%', '59.893%', '61.027%', '61.369%', '62.674%', '63.957%', '64.920%', '65.690%', '65.262%', '67.273%', '67.658%', '67.572%', '69.027%', '68.449%']
Workers improved  accuracies:  ['1.219%', '3.144%', '3.529%', '5.519%', '5.947%', '6.203%', '8.086%', '9.433%', '10.524%', '10.738%', '11.551%', '12.599%', '13.348%', '13.861%', '13.540%', '14.973%', '14.909%', '14.995%', '15.786%', '15.508%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 6:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.0000%', '75.0000%', '74.9333%', '75.0000%', '75.0000%', '74.8667%', '74.8667%', '74.7333%', '74.7333%', '74.7333%', '74.8000%', '74.8667%', '75.0000%', '75.0667%', '75.0667%', '75.0000%', '75.0000%', '75.0000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0501, 0.0501,
        0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0498, 0.0498, 0.0499,
        0.0499, 0.0499])
Federated model performance: Loss: 0.756278. Accuracy: 74.9091%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['50.374%', '52.941%', '53.348%', '56.471%', '56.920%', '57.134%', '59.572%', '61.390%', '62.588%', '63.059%', '64.663%', '65.904%', '66.717%', '67.187%', '66.888%', '68.620%', '69.497%', '69.091%', '70.545%', '69.904%']
Workers federated accuracies:  ['50.374%', '52.941%', '53.348%', '56.471%', '56.920%', '57.134%', '59.572%', '61.390%', '62.588%', '63.059%', '64.663%', '65.904%', '66.717%', '67.187%', '66.888%', '68.620%', '69.497%', '69.091%', '70.545%', '69.904%']
Workers improved  accuracies:  ['1.519%', '3.786%', '4.193%', '6.909%', '7.230%', '7.422%', '9.604%', '10.930%', '12.086%', '12.428%', '13.540%', '14.545%', '15.144%', '15.358%', '15.166%', '16.321%', '16.749%', '16.513%', '17.305%', '16.963%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 7:
Federated model validation accuracy : 74.8667%
Leave-one-out validation accuracies :  ['74.8667%', '74.9333%', '75.0000%', '75.0000%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.1333%', '75.0667%', '75.0000%', '74.9333%', '74.9333%']
Computed and normalized credits:  tensor([0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
        0.0501, 0.0501])
Federated model performance: Loss: 0.835466. Accuracy: 74.9733%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['50.781%', '53.626%', '53.968%', '57.754%', '58.267%', '58.695%', '61.005%', '62.460%', '64.342%', '64.364%', '66.118%', '67.380%', '67.743%', '68.471%', '67.979%', '70.011%', '70.652%', '70.503%', '71.701%', '71.144%']
Workers federated accuracies:  ['50.781%', '53.626%', '53.968%', '57.754%', '58.267%', '58.695%', '61.005%', '62.460%', '64.342%', '64.364%', '66.118%', '67.380%', '67.743%', '68.471%', '67.979%', '70.011%', '70.652%', '70.503%', '71.701%', '71.144%']
Workers improved  accuracies:  ['1.925%', '4.471%', '4.813%', '8.193%', '8.578%', '8.984%', '11.037%', '12.000%', '13.840%', '13.733%', '14.995%', '16.021%', '16.171%', '16.642%', '16.257%', '17.711%', '17.904%', '17.925%', '18.460%', '18.203%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 8:
Federated model validation accuracy : 75.1333%
Leave-one-out validation accuracies :  ['75.1333%', '75.1333%', '75.1333%', '75.0667%', '75.0000%', '75.0667%', '75.0667%', '75.0667%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '74.9333%', '74.8667%', '74.8667%', '74.9333%', '75.0000%', '75.0000%', '74.9333%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0502, 0.0501, 0.0500,
        0.0500, 0.0501])
Federated model performance: Loss: 0.912622. Accuracy: 75.0160%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['51.166%', '54.075%', '54.631%', '58.674%', '59.422%', '59.850%', '62.160%', '63.829%', '65.647%', '65.775%', '67.144%', '68.770%', '68.941%', '69.668%', '69.241%', '70.995%', '71.765%', '71.551%', '72.898%', '72.021%']
Workers federated accuracies:  ['51.166%', '54.075%', '54.631%', '58.674%', '59.422%', '59.850%', '62.160%', '63.829%', '65.647%', '65.775%', '67.144%', '68.770%', '68.941%', '69.668%', '69.241%', '70.995%', '71.765%', '71.551%', '72.898%', '72.021%']
Workers improved  accuracies:  ['2.310%', '4.920%', '5.476%', '9.112%', '9.733%', '10.139%', '12.193%', '13.369%', '15.144%', '15.144%', '16.021%', '17.412%', '17.369%', '17.840%', '17.519%', '18.695%', '19.016%', '18.973%', '19.658%', '19.080%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 9:
Federated model validation accuracy : 74.8667%
Leave-one-out validation accuracies :  ['74.8667%', '74.8667%', '74.8667%', '74.8667%', '74.8667%', '74.9333%', '74.9333%', '74.9333%', '74.9333%', '74.9333%', '74.9333%', '74.9333%', '75.0000%', '75.0000%', '75.0000%', '74.9333%', '75.2667%', '75.3333%', '75.2667%', '75.2667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501,
        0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0497, 0.0496,
        0.0497, 0.0497])
Federated model performance: Loss: 0.987364. Accuracy: 75.1016%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['51.380%', '54.567%', '55.209%', '59.765%', '60.428%', '61.070%', '62.952%', '65.155%', '67.294%', '66.888%', '68.299%', '69.947%', '70.353%', '70.524%', '70.267%', '72.278%', '73.027%', '72.406%', '73.647%', '72.856%']
Workers federated accuracies:  ['51.380%', '54.567%', '55.209%', '59.765%', '60.428%', '61.070%', '62.952%', '65.155%', '67.294%', '66.888%', '68.299%', '69.947%', '70.353%', '70.524%', '70.267%', '72.278%', '73.027%', '72.406%', '73.647%', '72.856%']
Workers improved  accuracies:  ['2.524%', '5.412%', '6.053%', '10.203%', '10.738%', '11.358%', '12.984%', '14.695%', '16.791%', '16.257%', '17.176%', '18.588%', '18.781%', '18.695%', '18.545%', '19.979%', '20.278%', '19.829%', '20.406%', '19.914%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 10:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.2000%', '75.2000%', '75.2000%', '75.2667%', '75.3333%', '75.3333%', '75.3333%', '75.2667%', '75.2667%', '75.3333%', '75.2000%', '75.2667%', '75.2667%', '75.2667%', '75.2667%', '75.2667%', '75.2667%', '75.2667%', '75.3333%', '75.3333%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500,
        0.0499, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0499, 0.0499])
Federated model performance: Loss: 1.059190. Accuracy: 75.2086%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['51.658%', '55.230%', '55.722%', '60.642%', '61.369%', '62.225%', '64.385%', '66.396%', '68.513%', '67.829%', '69.241%', '71.059%', '71.251%', '71.444%', '71.123%', '73.176%', '73.626%', '72.834%', '74.460%', '73.305%']
Workers federated accuracies:  ['51.658%', '55.230%', '55.722%', '60.642%', '61.369%', '62.225%', '64.385%', '66.396%', '68.513%', '67.829%', '69.241%', '71.059%', '71.251%', '71.444%', '71.123%', '73.176%', '73.626%', '72.834%', '74.460%', '73.305%']
Workers improved  accuracies:  ['2.802%', '6.075%', '6.567%', '11.080%', '11.679%', '12.513%', '14.417%', '15.936%', '18.011%', '17.198%', '18.118%', '19.701%', '19.679%', '19.615%', '19.401%', '20.877%', '20.877%', '20.257%', '21.219%', '20.364%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Performance and Fairness analysis: 
Federated model performance: Loss: 1.059190. Accuracy: 75.2086%.
Workers before    accuracies:  ['48.856%', '49.155%', '49.155%', '49.561%', '49.690%', '49.711%', '49.968%', '50.460%', '50.503%', '50.631%', '51.123%', '51.358%', '51.572%', '51.829%', '51.722%', '52.299%', '52.749%', '52.578%', '53.241%', '52.941%']
Workers standlone accuracies:  ['51.658%', '55.230%', '55.722%', '60.642%', '61.369%', '62.225%', '64.385%', '66.396%', '68.513%', '67.829%', '69.241%', '71.059%', '71.251%', '71.444%', '71.123%', '73.176%', '73.626%', '72.834%', '74.460%', '73.305%']
Workers federated accuracies:  ['51.658%', '55.230%', '55.722%', '60.642%', '61.369%', '62.225%', '64.385%', '66.396%', '68.513%', '67.829%', '69.241%', '71.059%', '71.251%', '71.444%', '71.123%', '73.176%', '73.626%', '72.834%', '74.460%', '73.305%']
Workers improved  accuracies:  ['2.802%', '6.075%', '6.567%', '11.080%', '11.679%', '12.513%', '14.417%', '15.936%', '18.011%', '17.198%', '18.118%', '19.701%', '19.679%', '19.615%', '19.401%', '20.877%', '20.877%', '20.257%', '21.219%', '20.364%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]
Workers sharing_contributions :  tensor([ 4.0000,  7.2000, 10.4000, 13.6000, 16.8000, 20.0000, 23.2000, 26.4000,
        29.6000, 32.8000, 36.0000, 39.2000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 63.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.14092240461180408, 0.5534393255728455)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9479696661877335, 2.1958911342511594e-10)
Correlation between test_acc improvements & sharing_contributions:  (0.9183378598332794, 1.137187532002366e-08)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.763391. Accuracy: 51.2727%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 72.7333%
Leave-one-out validation accuracies :  ['72.8667%', '73.0000%', '73.0667%', '73.0000%', '73.2667%', '73.5333%', '73.5333%', '73.4667%', '73.8667%', '74.1333%', '74.2667%', '74.2000%', '74.3333%', '74.5333%', '75.0667%', '75.1333%', '75.2000%', '75.3333%', '75.6000%', '75.5333%']
Computed and normalized credits:  tensor([0.0515, 0.0514, 0.0513, 0.0514, 0.0510, 0.0507, 0.0507, 0.0508, 0.0503,
        0.0500, 0.0499, 0.0499, 0.0498, 0.0495, 0.0489, 0.0488, 0.0488, 0.0486,
        0.0483, 0.0484])
Federated model performance: Loss: 0.589405. Accuracy: 73.4332%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['49.433%', '49.968%', '50.118%', '51.016%', '51.294%', '51.144%', '52.150%', '52.706%', '53.070%', '53.647%', '54.160%', '54.652%', '54.674%', '55.294%', '55.016%', '55.914%', '56.642%', '56.428%', '57.112%', '57.091%']
Workers federated accuracies:  ['49.433%', '49.968%', '50.118%', '51.016%', '51.294%', '51.144%', '52.150%', '52.706%', '53.070%', '53.647%', '54.160%', '54.652%', '54.674%', '55.294%', '55.016%', '55.914%', '56.642%', '56.428%', '57.112%', '57.091%']
Workers improved  accuracies:  ['0.278%', '0.578%', '0.684%', '1.070%', '1.262%', '1.091%', '1.348%', '1.840%', '1.904%', '2.396%', '2.674%', '2.845%', '2.759%', '3.016%', '2.930%', '3.487%', '3.444%', '3.615%', '3.636%', '3.807%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 2:
Federated model validation accuracy : 74.9333%
Leave-one-out validation accuracies :  ['74.9333%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.2000%', '75.4000%', '75.3333%', '75.4667%', '75.3333%', '75.4000%', '75.4667%', '75.7333%', '75.6667%', '75.6000%', '75.5333%', '75.6000%', '75.6000%', '75.7333%', '75.8000%']
Computed and normalized credits:  tensor([0.0507, 0.0506, 0.0506, 0.0506, 0.0505, 0.0503, 0.0501, 0.0501, 0.0499,
        0.0501, 0.0500, 0.0499, 0.0496, 0.0496, 0.0497, 0.0497, 0.0496, 0.0496,
        0.0495, 0.0494])
Federated model performance: Loss: 0.528276. Accuracy: 74.6738%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['49.754%', '50.631%', '50.759%', '52.043%', '52.193%', '52.620%', '53.904%', '54.503%', '54.759%', '55.529%', '56.342%', '57.005%', '57.091%', '58.225%', '57.947%', '58.524%', '60.364%', '60.021%', '61.134%', '61.048%']
Workers federated accuracies:  ['49.754%', '50.631%', '50.759%', '52.043%', '52.193%', '52.620%', '53.904%', '54.503%', '54.759%', '55.529%', '56.342%', '57.005%', '57.091%', '58.225%', '57.947%', '58.524%', '60.364%', '60.021%', '61.134%', '61.048%']
Workers improved  accuracies:  ['0.599%', '1.241%', '1.326%', '2.096%', '2.160%', '2.567%', '3.102%', '3.636%', '3.594%', '4.278%', '4.856%', '5.198%', '5.176%', '5.947%', '5.861%', '6.096%', '7.166%', '7.209%', '7.658%', '7.765%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 3:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.8667%', '75.8000%', '75.8000%', '75.8000%', '75.9333%', '76.0000%', '76.0667%', '76.0000%', '75.6667%', '75.6000%', '75.7333%', '75.7333%', '75.8000%', '75.8667%', '75.9333%', '76.0000%', '76.0000%', '76.0000%', '75.8667%']
Computed and normalized credits:  tensor([0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0498, 0.0498,
        0.0502, 0.0503, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498, 0.0498,
        0.0498, 0.0499])
Federated model performance: Loss: 0.527271. Accuracy: 75.3369%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['50.439%', '51.144%', '51.807%', '53.155%', '53.626%', '53.647%', '55.080%', '56.086%', '56.299%', '57.390%', '58.588%', '59.508%', '59.658%', '61.326%', '60.492%', '62.759%', '65.882%', '64.963%', '66.225%', '66.289%']
Workers federated accuracies:  ['50.439%', '51.144%', '51.807%', '53.155%', '53.626%', '53.647%', '55.080%', '56.086%', '56.299%', '57.390%', '58.588%', '59.508%', '59.658%', '61.326%', '60.492%', '62.759%', '65.882%', '64.963%', '66.225%', '66.289%']
Workers improved  accuracies:  ['1.283%', '1.754%', '2.374%', '3.209%', '3.594%', '3.594%', '4.278%', '5.219%', '5.134%', '6.139%', '7.102%', '7.701%', '7.743%', '9.048%', '8.406%', '10.332%', '12.684%', '12.150%', '12.749%', '13.005%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 4:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '75.8667%', '75.8667%', '75.9333%', '75.9333%', '76.0000%', '76.0000%', '76.0667%', '76.0000%', '75.9333%', '75.9333%', '75.8000%', '75.8000%', '75.8000%', '75.7333%', '75.8000%', '75.7333%', '75.7333%', '75.7333%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0498, 0.0498, 0.0498,
        0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501,
        0.0501, 0.0501])
Federated model performance: Loss: 0.556014. Accuracy: 75.6791%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['50.759%', '51.551%', '52.299%', '54.139%', '54.930%', '54.717%', '56.578%', '57.390%', '58.289%', '59.316%', '61.176%', '63.508%', '62.802%', '65.134%', '64.513%', '66.674%', '69.176%', '68.513%', '69.540%', '69.390%']
Workers federated accuracies:  ['50.759%', '51.551%', '52.299%', '54.139%', '54.930%', '54.717%', '56.578%', '57.390%', '58.289%', '59.316%', '61.176%', '63.508%', '62.802%', '65.134%', '64.513%', '66.674%', '69.176%', '68.513%', '69.540%', '69.390%']
Workers improved  accuracies:  ['1.604%', '2.160%', '2.866%', '4.193%', '4.898%', '4.663%', '5.775%', '6.524%', '7.123%', '8.064%', '9.690%', '11.701%', '10.888%', '12.856%', '12.428%', '14.246%', '15.979%', '15.701%', '16.064%', '16.107%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 5:
Federated model validation accuracy : 75.9333%
Leave-one-out validation accuracies :  ['75.9333%', '75.9333%', '75.8667%', '75.8667%', '75.8667%', '75.8667%', '75.9333%', '75.8000%', '75.7333%', '75.7333%', '75.7333%', '75.6667%', '75.6667%', '75.6667%', '75.6667%', '75.7333%', '75.8000%', '75.8000%', '75.8667%', '75.8667%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0498, 0.0500, 0.0501,
        0.0501, 0.0501, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0500, 0.0500,
        0.0499, 0.0499])
Federated model performance: Loss: 0.599198. Accuracy: 75.9358%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['51.144%', '52.150%', '53.070%', '55.251%', '55.872%', '55.893%', '57.519%', '59.209%', '60.214%', '61.861%', '64.385%', '66.631%', '66.289%', '68.021%', '67.893%', '69.155%', '70.781%', '70.588%', '71.444%', '71.251%']
Workers federated accuracies:  ['51.144%', '52.150%', '53.070%', '55.251%', '55.872%', '55.893%', '57.519%', '59.209%', '60.214%', '61.861%', '64.385%', '66.631%', '66.289%', '68.021%', '67.893%', '69.155%', '70.781%', '70.588%', '71.444%', '71.251%']
Workers improved  accuracies:  ['1.989%', '2.759%', '3.636%', '5.305%', '5.840%', '5.840%', '6.717%', '8.342%', '9.048%', '10.610%', '12.898%', '14.824%', '14.374%', '15.743%', '15.807%', '16.727%', '17.583%', '17.775%', '17.968%', '17.968%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 6:
Federated model validation accuracy : 75.7333%
Leave-one-out validation accuracies :  ['75.7333%', '75.8000%', '75.8000%', '75.8000%', '75.8667%', '75.8667%', '75.8667%', '75.8667%', '75.9333%', '75.9333%', '75.8667%', '75.7333%', '75.8000%', '75.8667%', '75.8667%', '75.8667%', '75.8667%', '75.9333%', '75.9333%', '76.0000%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
        0.0499, 0.0500, 0.0502, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
        0.0499, 0.0498])
Federated model performance: Loss: 0.648855. Accuracy: 76.1283%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['51.316%', '52.578%', '53.989%', '56.064%', '57.070%', '56.920%', '58.588%', '61.455%', '62.717%', '64.984%', '66.952%', '68.706%', '68.684%', '70.011%', '69.925%', '70.674%', '72.214%', '71.743%', '73.027%', '72.428%']
Workers federated accuracies:  ['51.316%', '52.578%', '53.989%', '56.064%', '57.070%', '56.920%', '58.588%', '61.455%', '62.717%', '64.984%', '66.952%', '68.706%', '68.684%', '70.011%', '69.925%', '70.674%', '72.214%', '71.743%', '73.027%', '72.428%']
Workers improved  accuracies:  ['2.160%', '3.187%', '4.556%', '6.118%', '7.037%', '6.866%', '7.786%', '10.588%', '11.551%', '13.733%', '15.465%', '16.898%', '16.770%', '17.733%', '17.840%', '18.246%', '19.016%', '18.930%', '19.551%', '19.144%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 7:
Federated model validation accuracy : 75.9333%
Leave-one-out validation accuracies :  ['75.9333%', '75.9333%', '75.9333%', '75.9333%', '75.9333%', '76.0000%', '76.0000%', '75.9333%', '75.8667%', '75.8667%', '75.8000%', '75.7333%', '75.7333%', '75.7333%', '75.8000%', '75.8000%', '75.9333%', '75.9333%', '75.9333%', '76.0000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0500,
        0.0500, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0499,
        0.0499, 0.0499])
Federated model performance: Loss: 0.701323. Accuracy: 76.1497%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['51.594%', '53.283%', '54.631%', '56.706%', '57.968%', '57.775%', '60.150%', '63.979%', '65.390%', '67.316%', '68.963%', '70.096%', '70.267%', '71.273%', '71.230%', '72.021%', '73.112%', '72.791%', '74.053%', '73.091%']
Workers federated accuracies:  ['51.594%', '53.283%', '54.631%', '56.706%', '57.968%', '57.775%', '60.150%', '63.979%', '65.390%', '67.316%', '68.963%', '70.096%', '70.267%', '71.273%', '71.230%', '72.021%', '73.112%', '72.791%', '74.053%', '73.091%']
Workers improved  accuracies:  ['2.439%', '3.893%', '5.198%', '6.759%', '7.936%', '7.722%', '9.348%', '13.112%', '14.225%', '16.064%', '17.476%', '18.289%', '18.353%', '18.995%', '19.144%', '19.594%', '19.914%', '19.979%', '20.578%', '19.807%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 8:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '75.9333%', '75.9333%', '76.0000%', '76.0000%', '76.0000%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.2000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0499, 0.0499,
        0.0499, 0.0498])
Federated model performance: Loss: 0.753490. Accuracy: 76.3209%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['52.021%', '53.733%', '55.230%', '57.262%', '58.866%', '58.717%', '61.904%', '66.011%', '67.465%', '68.642%', '70.267%', '71.273%', '71.337%', '72.385%', '72.043%', '72.984%', '73.540%', '73.626%', '74.545%', '73.604%']
Workers federated accuracies:  ['52.021%', '53.733%', '55.230%', '57.262%', '58.866%', '58.717%', '61.904%', '66.011%', '67.465%', '68.642%', '70.267%', '71.273%', '71.337%', '72.385%', '72.043%', '72.984%', '73.540%', '73.626%', '74.545%', '73.604%']
Workers improved  accuracies:  ['2.866%', '4.342%', '5.797%', '7.316%', '8.834%', '8.663%', '11.102%', '15.144%', '16.299%', '17.390%', '18.781%', '19.465%', '19.422%', '20.107%', '19.957%', '20.556%', '20.342%', '20.813%', '21.070%', '20.321%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 9:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.2000%', '76.2667%', '76.2667%', '76.2667%', '76.2667%', '76.2000%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.2000%', '76.2000%', '76.2000%', '76.2667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499,
        0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0499])
Federated model performance: Loss: 0.804307. Accuracy: 76.4278%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['52.471%', '54.160%', '55.829%', '57.840%', '60.321%', '59.957%', '63.743%', '67.722%', '68.813%', '70.182%', '71.080%', '72.021%', '72.513%', '73.070%', '72.684%', '73.369%', '74.053%', '73.775%', '74.866%', '74.075%']
Workers federated accuracies:  ['52.471%', '54.160%', '55.829%', '57.840%', '60.321%', '59.957%', '63.743%', '67.722%', '68.813%', '70.182%', '71.080%', '72.021%', '72.513%', '73.070%', '72.684%', '73.369%', '74.053%', '73.775%', '74.866%', '74.075%']
Workers improved  accuracies:  ['3.316%', '4.770%', '6.396%', '7.893%', '10.289%', '9.904%', '12.941%', '16.856%', '17.647%', '18.930%', '19.594%', '20.214%', '20.599%', '20.791%', '20.599%', '20.941%', '20.856%', '20.963%', '21.390%', '20.791%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 10:
Federated model validation accuracy : 76.3333%
Leave-one-out validation accuracies :  ['76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.2000%', '76.2000%', '76.2667%', '76.2667%', '76.3333%', '76.3333%', '76.3333%', '76.4000%', '76.4000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
        0.0499, 0.0499])
Federated model performance: Loss: 0.853436. Accuracy: 76.4278%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['52.727%', '54.631%', '56.406%', '58.503%', '61.540%', '61.155%', '65.134%', '68.856%', '69.754%', '70.866%', '71.658%', '72.749%', '73.583%', '73.519%', '73.005%', '73.861%', '74.203%', '74.011%', '75.123%', '74.332%']
Workers federated accuracies:  ['52.727%', '54.631%', '56.406%', '58.503%', '61.540%', '61.155%', '65.134%', '68.856%', '69.754%', '70.866%', '71.658%', '72.749%', '73.583%', '73.519%', '73.005%', '73.861%', '74.203%', '74.011%', '75.123%', '74.332%']
Workers improved  accuracies:  ['3.572%', '5.241%', '6.973%', '8.556%', '11.508%', '11.102%', '14.332%', '17.989%', '18.588%', '19.615%', '20.171%', '20.941%', '21.668%', '21.241%', '20.920%', '21.433%', '21.005%', '21.198%', '21.647%', '21.048%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.853436. Accuracy: 76.4278%.
Workers before    accuracies:  ['49.155%', '49.390%', '49.433%', '49.947%', '50.032%', '50.053%', '50.802%', '50.866%', '51.166%', '51.251%', '51.487%', '51.807%', '51.914%', '52.278%', '52.086%', '52.428%', '53.198%', '52.813%', '53.476%', '53.283%']
Workers standlone accuracies:  ['52.727%', '54.631%', '56.406%', '58.503%', '61.540%', '61.155%', '65.134%', '68.856%', '69.754%', '70.866%', '71.658%', '72.749%', '73.583%', '73.519%', '73.005%', '73.861%', '74.203%', '74.011%', '75.123%', '74.332%']
Workers federated accuracies:  ['52.727%', '54.631%', '56.406%', '58.503%', '61.540%', '61.155%', '65.134%', '68.856%', '69.754%', '70.866%', '71.658%', '72.749%', '73.583%', '73.519%', '73.005%', '73.861%', '74.203%', '74.011%', '75.123%', '74.332%']
Workers improved  accuracies:  ['3.572%', '5.241%', '6.973%', '8.556%', '11.508%', '11.102%', '14.332%', '17.989%', '18.588%', '19.615%', '20.171%', '20.941%', '21.668%', '21.241%', '20.920%', '21.433%', '21.005%', '21.198%', '21.647%', '21.048%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]
Workers sharing_contributions :  tensor([ 4.0000,  7.2000, 10.4000, 13.6000, 16.8000, 20.0000, 23.2000, 26.4000,
        29.6000, 32.8000, 36.0000, 39.2000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 63.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.1485018112849907, 0.532077436777865)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9302357439832336, 2.8810415017041028e-09)
Correlation between test_acc improvements & sharing_contributions:  (0.9015596632262489, 5.740500212479905e-08)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.717716. Accuracy: 58.3743%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 72.8667%
Leave-one-out validation accuracies :  ['72.8000%', '72.7333%', '73.0000%', '73.0667%', '73.8000%', '74.0000%', '74.3333%', '74.3333%', '74.5333%', '74.8667%', '74.9333%', '75.1333%', '75.2667%', '75.4000%', '75.6667%', '75.5333%', '75.8000%', '75.9333%', '76.0000%', '75.8667%']
Computed and normalized credits:  tensor([0.0522, 0.0523, 0.0520, 0.0519, 0.0510, 0.0508, 0.0504, 0.0504, 0.0501,
        0.0497, 0.0497, 0.0494, 0.0493, 0.0491, 0.0488, 0.0489, 0.0486, 0.0485,
        0.0484, 0.0486])
Federated model performance: Loss: 0.591244. Accuracy: 71.3583%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['57.305%', '57.604%', '57.775%', '58.439%', '58.503%', '58.824%', '59.080%', '59.529%', '59.786%', '60.021%', '60.492%', '60.791%', '60.813%', '61.369%', '61.091%', '61.775%', '61.968%', '61.947%', '62.674%', '62.310%']
Workers federated accuracies:  ['57.305%', '57.604%', '57.775%', '58.439%', '58.503%', '58.824%', '59.080%', '59.529%', '59.786%', '60.021%', '60.492%', '60.791%', '60.813%', '61.369%', '61.091%', '61.775%', '61.968%', '61.947%', '62.674%', '62.310%']
Workers improved  accuracies:  ['0.235%', '0.342%', '0.364%', '0.642%', '0.663%', '0.941%', '1.070%', '1.390%', '1.626%', '1.690%', '1.775%', '1.904%', '2.075%', '2.289%', '2.160%', '2.310%', '2.439%', '2.396%', '2.717%', '2.588%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 2:
Federated model validation accuracy : 75.4667%
Leave-one-out validation accuracies :  ['75.5333%', '75.5333%', '75.6000%', '75.5333%', '75.6000%', '75.5333%', '75.5333%', '75.5333%', '75.6667%', '75.6000%', '75.7333%', '75.7333%', '75.8000%', '75.8000%', '75.8667%', '76.1333%', '76.3333%', '76.4000%', '76.3333%', '76.4000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0504, 0.0505, 0.0503, 0.0504, 0.0503, 0.0503, 0.0502,
        0.0502, 0.0501, 0.0500, 0.0499, 0.0499, 0.0498, 0.0495, 0.0493, 0.0492,
        0.0493, 0.0492])
Federated model performance: Loss: 0.533842. Accuracy: 74.5455%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['57.455%', '57.989%', '58.246%', '59.230%', '59.316%', '59.807%', '60.385%', '60.813%', '61.091%', '61.497%', '62.438%', '62.524%', '62.631%', '63.080%', '62.588%', '63.636%', '64.235%', '64.086%', '65.112%', '64.535%']
Workers federated accuracies:  ['57.455%', '57.989%', '58.246%', '59.230%', '59.316%', '59.807%', '60.385%', '60.813%', '61.091%', '61.497%', '62.438%', '62.524%', '62.631%', '63.080%', '62.588%', '63.636%', '64.235%', '64.086%', '65.112%', '64.535%']
Workers improved  accuracies:  ['0.385%', '0.727%', '0.834%', '1.433%', '1.476%', '1.925%', '2.374%', '2.674%', '2.930%', '3.166%', '3.722%', '3.636%', '3.893%', '4.000%', '3.658%', '4.171%', '4.706%', '4.535%', '5.155%', '4.813%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 3:
Federated model validation accuracy : 76.0667%
Leave-one-out validation accuracies :  ['76.0667%', '76.0667%', '76.0667%', '76.0000%', '76.0000%', '76.0000%', '76.1333%', '76.1333%', '76.2667%', '76.4000%', '76.4667%', '76.4000%', '76.3333%', '76.5333%', '76.5333%', '76.5333%', '76.6000%', '76.6667%', '76.6667%', '76.6667%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0504, 0.0504, 0.0504, 0.0502, 0.0502, 0.0501,
        0.0499, 0.0498, 0.0499, 0.0500, 0.0498, 0.0498, 0.0497, 0.0496, 0.0495,
        0.0496, 0.0495])
Federated model performance: Loss: 0.518548. Accuracy: 75.5508%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['57.690%', '58.310%', '58.717%', '60.000%', '60.150%', '60.749%', '61.326%', '61.690%', '62.225%', '62.759%', '63.786%', '63.850%', '64.128%', '64.898%', '64.278%', '65.305%', '66.032%', '65.626%', '66.802%', '66.353%']
Workers federated accuracies:  ['57.690%', '58.310%', '58.717%', '60.000%', '60.150%', '60.749%', '61.326%', '61.690%', '62.225%', '62.759%', '63.786%', '63.850%', '64.128%', '64.898%', '64.278%', '65.305%', '66.032%', '65.626%', '66.802%', '66.353%']
Workers improved  accuracies:  ['0.620%', '1.048%', '1.305%', '2.203%', '2.310%', '2.866%', '3.316%', '3.551%', '4.064%', '4.428%', '5.070%', '4.963%', '5.390%', '5.818%', '5.348%', '5.840%', '6.503%', '6.075%', '6.845%', '6.631%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 4:
Federated model validation accuracy : 76.5333%
Leave-one-out validation accuracies :  ['76.5333%', '76.5333%', '76.6000%', '76.6667%', '76.6667%', '76.7333%', '76.7333%', '76.7333%', '76.8000%', '76.7333%', '76.6000%', '76.6000%', '76.5333%', '76.5333%', '76.4000%', '76.4000%', '76.4000%', '76.4667%', '76.5333%', '76.6667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0498,
        0.0498, 0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0502, 0.0502, 0.0501,
        0.0500, 0.0499])
Federated model performance: Loss: 0.527453. Accuracy: 75.8503%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['57.904%', '58.631%', '59.166%', '60.877%', '60.813%', '61.519%', '62.203%', '62.695%', '63.123%', '64.000%', '65.155%', '65.262%', '65.882%', '66.610%', '65.904%', '66.995%', '67.273%', '67.016%', '68.064%', '67.636%']
Workers federated accuracies:  ['57.904%', '58.631%', '59.166%', '60.877%', '60.813%', '61.519%', '62.203%', '62.695%', '63.123%', '64.000%', '65.155%', '65.262%', '65.882%', '66.610%', '65.904%', '66.995%', '67.273%', '67.016%', '68.064%', '67.636%']
Workers improved  accuracies:  ['0.834%', '1.369%', '1.754%', '3.080%', '2.973%', '3.636%', '4.193%', '4.556%', '4.963%', '5.668%', '6.439%', '6.374%', '7.144%', '7.529%', '6.973%', '7.529%', '7.743%', '7.465%', '8.107%', '7.914%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 5:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.6667%', '76.6667%', '76.6667%', '76.7333%', '76.6000%', '76.6000%', '76.4667%', '76.4667%', '76.5333%', '76.5333%', '76.4667%', '76.4667%', '76.4000%', '76.3333%']
Computed and normalized credits:  tensor([0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0498,
        0.0498, 0.0499, 0.0499, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501,
        0.0502, 0.0502])
Federated model performance: Loss: 0.550236. Accuracy: 76.2353%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['58.011%', '59.016%', '59.636%', '61.455%', '61.647%', '62.374%', '63.166%', '63.701%', '64.471%', '65.048%', '66.139%', '66.246%', '66.759%', '67.572%', '67.037%', '68.086%', '68.171%', '68.064%', '69.519%', '68.920%']
Workers federated accuracies:  ['58.011%', '59.016%', '59.636%', '61.455%', '61.647%', '62.374%', '63.166%', '63.701%', '64.471%', '65.048%', '66.139%', '66.246%', '66.759%', '67.572%', '67.037%', '68.086%', '68.171%', '68.064%', '69.519%', '68.920%']
Workers improved  accuracies:  ['0.941%', '1.754%', '2.225%', '3.658%', '3.807%', '4.492%', '5.155%', '5.561%', '6.310%', '6.717%', '7.422%', '7.358%', '8.021%', '8.492%', '8.107%', '8.620%', '8.642%', '8.513%', '9.561%', '9.198%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 6:
Federated model validation accuracy : 76.4667%
Leave-one-out validation accuracies :  ['76.4667%', '76.5333%', '76.5333%', '76.6000%', '76.6667%', '76.6667%', '76.6667%', '76.6667%', '76.6000%', '76.6000%', '76.5333%', '76.5333%', '76.5333%', '76.4000%', '76.2000%', '76.3333%', '76.2000%', '76.2667%', '76.2667%', '76.4000%']
Computed and normalized credits:  tensor([0.0500, 0.0499, 0.0499, 0.0499, 0.0498, 0.0498, 0.0498, 0.0498, 0.0499,
        0.0498, 0.0499, 0.0499, 0.0500, 0.0501, 0.0503, 0.0502, 0.0503, 0.0503,
        0.0503, 0.0501])
Federated model performance: Loss: 0.580662. Accuracy: 76.5989%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['58.267%', '59.444%', '60.043%', '62.096%', '62.310%', '63.337%', '63.893%', '64.535%', '65.412%', '65.989%', '67.102%', '67.230%', '67.850%', '68.599%', '67.872%', '69.134%', '68.920%', '69.241%', '70.802%', '70.160%']
Workers federated accuracies:  ['58.267%', '59.444%', '60.043%', '62.096%', '62.310%', '63.337%', '63.893%', '64.535%', '65.412%', '65.989%', '67.102%', '67.230%', '67.850%', '68.599%', '67.872%', '69.134%', '68.920%', '69.241%', '70.802%', '70.160%']
Workers improved  accuracies:  ['1.198%', '2.182%', '2.631%', '4.299%', '4.471%', '5.455%', '5.882%', '6.396%', '7.251%', '7.658%', '8.385%', '8.342%', '9.112%', '9.519%', '8.941%', '9.668%', '9.390%', '9.690%', '10.845%', '10.439%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 7:
Federated model validation accuracy : 76.5333%
Leave-one-out validation accuracies :  ['76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.4667%', '76.4667%', '76.4667%', '76.4000%', '76.3333%', '76.2667%', '76.2667%', '76.4000%', '76.4667%', '76.4000%', '76.4667%', '76.5333%', '76.5333%', '76.5333%', '76.5333%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501,
        0.0501, 0.0502, 0.0502, 0.0501, 0.0500, 0.0501, 0.0500, 0.0499, 0.0499,
        0.0499, 0.0499])
Federated model performance: Loss: 0.615188. Accuracy: 76.7059%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['58.353%', '59.850%', '60.578%', '62.695%', '62.781%', '63.829%', '64.749%', '65.369%', '66.053%', '66.866%', '67.829%', '67.957%', '68.535%', '69.604%', '68.898%', '70.353%', '70.246%', '70.353%', '71.594%', '71.251%']
Workers federated accuracies:  ['58.353%', '59.850%', '60.578%', '62.695%', '62.781%', '63.829%', '64.749%', '65.369%', '66.053%', '66.866%', '67.829%', '67.957%', '68.535%', '69.604%', '68.898%', '70.353%', '70.246%', '70.353%', '71.594%', '71.251%']
Workers improved  accuracies:  ['1.283%', '2.588%', '3.166%', '4.898%', '4.941%', '5.947%', '6.738%', '7.230%', '7.893%', '8.535%', '9.112%', '9.070%', '9.797%', '10.524%', '9.968%', '10.888%', '10.717%', '10.802%', '11.636%', '11.529%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 8:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.4000%', '76.4000%', '76.4000%', '76.4667%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.4667%', '76.4667%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.6000%', '76.6000%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0499, 0.0499])
Federated model performance: Loss: 0.651006. Accuracy: 76.7701%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['58.460%', '60.107%', '60.920%', '63.294%', '63.230%', '64.684%', '65.369%', '66.182%', '66.759%', '67.422%', '68.877%', '68.856%', '69.369%', '70.481%', '69.604%', '71.080%', '71.273%', '71.380%', '72.321%', '71.957%']
Workers federated accuracies:  ['58.460%', '60.107%', '60.920%', '63.294%', '63.230%', '64.684%', '65.369%', '66.182%', '66.759%', '67.422%', '68.877%', '68.856%', '69.369%', '70.481%', '69.604%', '71.080%', '71.273%', '71.380%', '72.321%', '71.957%']
Workers improved  accuracies:  ['1.390%', '2.845%', '3.508%', '5.497%', '5.390%', '6.802%', '7.358%', '8.043%', '8.599%', '9.091%', '10.160%', '9.968%', '10.631%', '11.401%', '10.674%', '11.615%', '11.743%', '11.829%', '12.364%', '12.235%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 9:
Federated model validation accuracy : 76.5333%
Leave-one-out validation accuracies :  ['76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.5333%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.5333%', '76.5333%', '76.4667%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500,
        0.0500, 0.0501])
Federated model performance: Loss: 0.688032. Accuracy: 76.7914%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['58.717%', '60.642%', '61.348%', '63.850%', '64.150%', '65.070%', '65.947%', '66.588%', '67.294%', '68.064%', '69.626%', '69.583%', '70.353%', '71.358%', '70.439%', '71.850%', '72.021%', '72.064%', '73.027%', '72.578%']
Workers federated accuracies:  ['58.717%', '60.642%', '61.348%', '63.850%', '64.150%', '65.070%', '65.947%', '66.588%', '67.294%', '68.064%', '69.626%', '69.583%', '70.353%', '71.358%', '70.439%', '71.850%', '72.021%', '72.064%', '73.027%', '72.578%']
Workers improved  accuracies:  ['1.647%', '3.380%', '3.936%', '6.053%', '6.310%', '7.187%', '7.936%', '8.449%', '9.134%', '9.733%', '10.909%', '10.695%', '11.615%', '12.278%', '11.508%', '12.385%', '12.492%', '12.513%', '13.070%', '12.856%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 10:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.5333%', '76.5333%', '76.5333%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6667%', '76.6667%', '76.6667%', '76.7333%', '76.6667%', '76.6000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
        0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499,
        0.0499, 0.0500])
Federated model performance: Loss: 0.724024. Accuracy: 76.8770%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['58.952%', '60.877%', '61.626%', '64.278%', '64.684%', '65.647%', '66.781%', '67.123%', '67.893%', '68.856%', '70.396%', '70.631%', '71.251%', '72.021%', '71.251%', '72.385%', '72.556%', '72.578%', '73.497%', '72.984%']
Workers federated accuracies:  ['58.952%', '60.877%', '61.626%', '64.278%', '64.684%', '65.647%', '66.781%', '67.123%', '67.893%', '68.856%', '70.396%', '70.631%', '71.251%', '72.021%', '71.251%', '72.385%', '72.556%', '72.578%', '73.497%', '72.984%']
Workers improved  accuracies:  ['1.882%', '3.615%', '4.214%', '6.481%', '6.845%', '7.765%', '8.770%', '8.984%', '9.733%', '10.524%', '11.679%', '11.743%', '12.513%', '12.941%', '12.321%', '12.920%', '13.027%', '13.027%', '13.540%', '13.262%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.724024. Accuracy: 76.8770%.
Workers before    accuracies:  ['57.070%', '57.262%', '57.412%', '57.797%', '57.840%', '57.882%', '58.011%', '58.139%', '58.160%', '58.332%', '58.717%', '58.888%', '58.738%', '59.080%', '58.930%', '59.465%', '59.529%', '59.551%', '59.957%', '59.722%']
Workers standlone accuracies:  ['58.952%', '60.877%', '61.626%', '64.278%', '64.684%', '65.647%', '66.781%', '67.123%', '67.893%', '68.856%', '70.396%', '70.631%', '71.251%', '72.021%', '71.251%', '72.385%', '72.556%', '72.578%', '73.497%', '72.984%']
Workers federated accuracies:  ['58.952%', '60.877%', '61.626%', '64.278%', '64.684%', '65.647%', '66.781%', '67.123%', '67.893%', '68.856%', '70.396%', '70.631%', '71.251%', '72.021%', '71.251%', '72.385%', '72.556%', '72.578%', '73.497%', '72.984%']
Workers improved  accuracies:  ['1.882%', '3.615%', '4.214%', '6.481%', '6.845%', '7.765%', '8.770%', '8.984%', '9.733%', '10.524%', '11.679%', '11.743%', '12.513%', '12.941%', '12.321%', '12.920%', '13.027%', '13.027%', '13.540%', '13.262%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]
Workers sharing_contributions :  tensor([ 4.0000,  7.2000, 10.4000, 13.6000, 16.8000, 20.0000, 23.2000, 26.4000,
        29.6000, 32.8000, 36.0000, 39.2000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 63.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.05673649947875967, 0.8122018692788969)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999998, 1.2459683851238692e-139)
Correlation between test_acc & sharing contributions:  (0.9643691803989007, 7.724160286857429e-12)
Correlation between test_acc improvements & sharing_contributions:  (0.9477626668723063, 2.2740470134043404e-10)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.724022. Accuracy: 46.3529%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.7333%', '73.8000%', '73.9333%', '74.1333%', '74.8000%', '74.8667%', '75.0000%', '75.2667%', '75.2000%', '75.2667%', '75.3333%', '75.6000%', '75.8667%', '76.0000%', '76.2000%', '76.0667%', '76.0667%', '76.1333%', '76.1333%']
Computed and normalized credits:  tensor([0.0518, 0.0517, 0.0516, 0.0514, 0.0512, 0.0504, 0.0503, 0.0502, 0.0499,
        0.0499, 0.0499, 0.0498, 0.0495, 0.0492, 0.0490, 0.0488, 0.0489, 0.0489,
        0.0488, 0.0488])
Federated model performance: Loss: 0.552404. Accuracy: 73.7112%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['43.615%', '44.599%', '44.556%', '46.332%', '46.481%', '46.374%', '47.358%', '48.128%', '48.513%', '48.963%', '49.989%', '50.888%', '50.781%', '51.551%', '51.316%', '52.727%', '53.005%', '53.155%', '54.567%', '54.032%']
Workers federated accuracies:  ['43.615%', '44.599%', '44.556%', '46.332%', '46.481%', '46.374%', '47.358%', '48.128%', '48.513%', '48.963%', '49.989%', '50.888%', '50.781%', '51.551%', '51.316%', '52.727%', '53.005%', '53.155%', '54.567%', '54.032%']
Workers improved  accuracies:  ['0.492%', '1.005%', '0.898%', '1.947%', '2.053%', '1.775%', '2.096%', '2.417%', '2.567%', '2.802%', '3.294%', '3.487%', '3.487%', '4.021%', '3.829%', '4.642%', '4.642%', '4.941%', '5.711%', '5.390%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 2:
Federated model validation accuracy : 75.7333%
Leave-one-out validation accuracies :  ['75.8000%', '75.9333%', '76.0000%', '75.9333%', '76.0000%', '76.0000%', '76.2000%', '76.2000%', '76.2667%', '76.2667%', '76.2667%', '76.1333%', '76.0667%', '76.0000%', '76.0000%', '75.9333%', '76.1333%', '76.1333%', '76.2667%', '76.4000%']
Computed and normalized credits:  tensor([0.0505, 0.0503, 0.0503, 0.0503, 0.0502, 0.0501, 0.0499, 0.0499, 0.0498,
        0.0498, 0.0498, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499,
        0.0497, 0.0496])
Federated model performance: Loss: 0.492774. Accuracy: 75.3797%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['44.064%', '45.433%', '45.775%', '47.936%', '48.086%', '48.086%', '49.326%', '50.481%', '51.316%', '51.979%', '53.070%', '54.289%', '54.481%', '55.422%', '54.952%', '57.134%', '58.053%', '58.503%', '60.428%', '59.187%']
Workers federated accuracies:  ['44.064%', '45.433%', '45.775%', '47.936%', '48.086%', '48.086%', '49.326%', '50.481%', '51.316%', '51.979%', '53.070%', '54.289%', '54.481%', '55.422%', '54.952%', '57.134%', '58.053%', '58.503%', '60.428%', '59.187%']
Workers improved  accuracies:  ['0.941%', '1.840%', '2.118%', '3.551%', '3.658%', '3.487%', '4.064%', '4.770%', '5.369%', '5.818%', '6.374%', '6.888%', '7.187%', '7.893%', '7.465%', '9.048%', '9.690%', '10.289%', '11.572%', '10.545%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 3:
Federated model validation accuracy : 76.3333%
Leave-one-out validation accuracies :  ['76.3333%', '76.2667%', '76.2667%', '76.2667%', '76.2667%', '76.2667%', '76.2000%', '76.2000%', '76.2667%', '76.1333%', '76.2667%', '76.2667%', '76.4667%', '76.5333%', '76.6667%', '76.7333%', '76.7333%', '76.8000%', '76.9333%', '76.9333%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0503, 0.0503, 0.0502,
        0.0503, 0.0502, 0.0502, 0.0500, 0.0499, 0.0497, 0.0497, 0.0497, 0.0496,
        0.0494, 0.0494])
Federated model performance: Loss: 0.493092. Accuracy: 75.9144%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['44.513%', '46.396%', '46.695%', '49.155%', '49.305%', '49.604%', '51.636%', '52.727%', '54.096%', '54.545%', '56.749%', '58.267%', '58.032%', '59.743%', '59.294%', '61.775%', '62.952%', '62.930%', '65.005%', '64.428%']
Workers federated accuracies:  ['44.513%', '46.396%', '46.695%', '49.155%', '49.305%', '49.604%', '51.636%', '52.727%', '54.096%', '54.545%', '56.749%', '58.267%', '58.032%', '59.743%', '59.294%', '61.775%', '62.952%', '62.930%', '65.005%', '64.428%']
Workers improved  accuracies:  ['1.390%', '2.802%', '3.037%', '4.770%', '4.877%', '5.005%', '6.374%', '7.016%', '8.150%', '8.385%', '10.053%', '10.866%', '10.738%', '12.214%', '11.807%', '13.690%', '14.588%', '14.717%', '16.150%', '15.786%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 4:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6667%', '76.6667%', '76.6667%', '76.7333%', '76.8000%', '76.7333%', '76.8667%', '76.8667%', '76.9333%', '76.9333%', '76.8000%', '76.8000%', '76.8667%', '76.8000%', '76.8000%', '76.7333%', '76.8000%', '76.9333%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0499,
        0.0499, 0.0498, 0.0498, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500,
        0.0499, 0.0498])
Federated model performance: Loss: 0.522059. Accuracy: 76.4920%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['45.027%', '47.102%', '47.701%', '50.610%', '50.866%', '51.508%', '53.369%', '54.888%', '56.471%', '57.412%', '60.021%', '61.904%', '61.861%', '63.230%', '62.845%', '65.519%', '66.824%', '67.059%', '68.963%', '68.193%']
Workers federated accuracies:  ['45.027%', '47.102%', '47.701%', '50.610%', '50.866%', '51.508%', '53.369%', '54.888%', '56.471%', '57.412%', '60.021%', '61.904%', '61.861%', '63.230%', '62.845%', '65.519%', '66.824%', '67.059%', '68.963%', '68.193%']
Workers improved  accuracies:  ['1.904%', '3.508%', '4.043%', '6.225%', '6.439%', '6.909%', '8.107%', '9.176%', '10.524%', '11.251%', '13.326%', '14.503%', '14.567%', '15.701%', '15.358%', '17.433%', '18.460%', '18.845%', '20.107%', '19.551%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 5:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.8000%', '76.8667%', '76.8667%', '76.8667%', '76.8000%', '76.9333%', '76.9333%', '76.8000%', '76.8000%', '76.8000%', '76.8667%', '76.8667%', '76.9333%', '76.8667%', '76.8667%', '76.8667%', '76.9333%', '76.9333%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0499, 0.0499,
        0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
        0.0499, 0.0499])
Federated model performance: Loss: 0.562556. Accuracy: 76.7487%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['45.412%', '47.872%', '48.299%', '52.043%', '52.663%', '53.155%', '55.508%', '57.198%', '58.524%', '60.342%', '62.567%', '64.963%', '65.048%', '66.203%', '65.797%', '68.727%', '69.668%', '69.754%', '70.781%', '70.203%']
Workers federated accuracies:  ['45.412%', '47.872%', '48.299%', '52.043%', '52.663%', '53.155%', '55.508%', '57.198%', '58.524%', '60.342%', '62.567%', '64.963%', '65.048%', '66.203%', '65.797%', '68.727%', '69.668%', '69.754%', '70.781%', '70.203%']
Workers improved  accuracies:  ['2.289%', '4.278%', '4.642%', '7.658%', '8.235%', '8.556%', '10.246%', '11.487%', '12.578%', '14.182%', '15.872%', '17.561%', '17.754%', '18.674%', '18.310%', '20.642%', '21.305%', '21.540%', '21.925%', '21.561%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 6:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['77.0000%', '76.9333%', '76.9333%', '76.9333%', '76.9333%', '76.9333%', '77.0000%', '76.9333%', '76.9333%', '76.9333%', '76.9333%', '76.9333%', '76.8667%', '76.8667%', '76.8667%', '76.9333%', '77.0000%', '77.0667%', '77.0667%', '77.0667%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499,
        0.0499, 0.0499])
Federated model performance: Loss: 0.608799. Accuracy: 76.8128%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['45.968%', '48.385%', '49.005%', '53.155%', '53.989%', '54.439%', '57.775%', '59.230%', '61.112%', '63.337%', '65.134%', '67.807%', '67.765%', '68.578%', '68.877%', '70.567%', '71.037%', '70.909%', '72.107%', '71.701%']
Workers federated accuracies:  ['45.968%', '48.385%', '49.005%', '53.155%', '53.989%', '54.439%', '57.775%', '59.230%', '61.112%', '63.337%', '65.134%', '67.807%', '67.765%', '68.578%', '68.877%', '70.567%', '71.037%', '70.909%', '72.107%', '71.701%']
Workers improved  accuracies:  ['2.845%', '4.791%', '5.348%', '8.770%', '9.561%', '9.840%', '12.513%', '13.519%', '15.166%', '17.176%', '18.439%', '20.406%', '20.471%', '21.048%', '21.390%', '22.481%', '22.674%', '22.695%', '23.251%', '23.059%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 7:
Federated model validation accuracy : 76.9333%
Leave-one-out validation accuracies :  ['76.9333%', '76.9333%', '76.9333%', '76.9333%', '76.9333%', '76.9333%', '76.9333%', '76.8667%', '76.8667%', '76.9333%', '76.8667%', '76.9333%', '77.0000%', '77.1333%', '77.2000%', '77.2000%', '77.1333%', '77.2000%', '77.2000%', '77.3333%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0502,
        0.0501, 0.0502, 0.0501, 0.0500, 0.0499, 0.0498, 0.0498, 0.0499, 0.0498,
        0.0498, 0.0496])
Federated model performance: Loss: 0.657343. Accuracy: 76.7701%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['46.503%', '49.241%', '49.947%', '54.995%', '55.444%', '56.128%', '59.380%', '61.882%', '63.273%', '65.604%', '67.636%', '69.455%', '69.840%', '70.267%', '70.118%', '71.722%', '71.872%', '71.765%', '73.091%', '72.620%']
Workers federated accuracies:  ['46.503%', '49.241%', '49.947%', '54.995%', '55.444%', '56.128%', '59.380%', '61.882%', '63.273%', '65.604%', '67.636%', '69.455%', '69.840%', '70.267%', '70.118%', '71.722%', '71.872%', '71.765%', '73.091%', '72.620%']
Workers improved  accuracies:  ['3.380%', '5.647%', '6.289%', '10.610%', '11.016%', '11.529%', '14.118%', '16.171%', '17.326%', '19.444%', '20.941%', '22.053%', '22.545%', '22.738%', '22.631%', '23.636%', '23.508%', '23.551%', '24.235%', '23.979%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 8:
Federated model validation accuracy : 77.1333%
Leave-one-out validation accuracies :  ['77.1333%', '77.1333%', '77.0667%', '77.2000%', '77.2000%', '77.3333%', '77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.2667%', '77.4000%', '77.4000%', '77.4000%', '77.4667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0499, 0.0501, 0.0501, 0.0501,
        0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0498,
        0.0498, 0.0497])
Federated model performance: Loss: 0.705625. Accuracy: 76.7701%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['46.845%', '49.925%', '50.952%', '56.406%', '56.791%', '57.775%', '61.690%', '64.193%', '65.390%', '67.807%', '68.898%', '70.631%', '71.016%', '71.251%', '71.251%', '72.449%', '72.492%', '72.727%', '73.797%', '73.283%']
Workers federated accuracies:  ['46.845%', '49.925%', '50.952%', '56.406%', '56.791%', '57.775%', '61.690%', '64.193%', '65.390%', '67.807%', '68.898%', '70.631%', '71.016%', '71.251%', '71.251%', '72.449%', '72.492%', '72.727%', '73.797%', '73.283%']
Workers improved  accuracies:  ['3.722%', '6.332%', '7.294%', '12.021%', '12.364%', '13.176%', '16.428%', '18.481%', '19.444%', '21.647%', '22.203%', '23.230%', '23.722%', '23.722%', '23.765%', '24.364%', '24.128%', '24.513%', '24.941%', '24.642%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 9:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.3333%', '77.4000%', '77.4667%', '77.4000%', '77.4667%', '77.4667%', '77.4667%', '77.4000%', '77.4000%', '77.4667%', '77.4667%', '77.4667%', '77.4667%', '77.4667%', '77.4667%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499,
        0.0499, 0.0499])
Federated model performance: Loss: 0.752241. Accuracy: 76.8128%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['47.358%', '50.738%', '51.465%', '57.989%', '58.460%', '59.230%', '63.380%', '65.818%', '67.251%', '69.369%', '69.989%', '71.380%', '71.551%', '72.021%', '71.743%', '73.219%', '73.134%', '73.241%', '74.160%', '73.840%']
Workers federated accuracies:  ['47.358%', '50.738%', '51.465%', '57.989%', '58.460%', '59.230%', '63.380%', '65.818%', '67.251%', '69.369%', '69.989%', '71.380%', '71.551%', '72.021%', '71.743%', '73.219%', '73.134%', '73.241%', '74.160%', '73.840%']
Workers improved  accuracies:  ['4.235%', '7.144%', '7.807%', '13.604%', '14.032%', '14.631%', '18.118%', '20.107%', '21.305%', '23.209%', '23.294%', '23.979%', '24.257%', '24.492%', '24.257%', '25.134%', '24.770%', '25.027%', '25.305%', '25.198%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Epoch 10:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.4667%', '77.4667%', '77.4667%', '77.5333%', '77.5333%', '77.5333%', '77.5333%', '77.5333%', '77.5333%', '77.4667%', '77.5333%', '77.5333%', '77.6000%', '77.6000%', '77.5333%', '77.5333%', '77.6000%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500,
        0.0500, 0.0499])
Federated model performance: Loss: 0.798074. Accuracy: 76.8984%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['47.743%', '51.465%', '51.957%', '59.551%', '60.000%', '60.749%', '65.048%', '67.551%', '68.770%', '70.503%', '70.588%', '71.914%', '72.171%', '72.813%', '72.428%', '73.668%', '73.626%', '73.583%', '74.674%', '74.481%']
Workers federated accuracies:  ['47.743%', '51.465%', '51.957%', '59.551%', '60.000%', '60.749%', '65.048%', '67.551%', '68.770%', '70.503%', '70.588%', '71.914%', '72.171%', '72.813%', '72.428%', '73.668%', '73.626%', '73.583%', '74.674%', '74.481%']
Workers improved  accuracies:  ['4.620%', '7.872%', '8.299%', '15.166%', '15.572%', '16.150%', '19.786%', '21.840%', '22.824%', '24.342%', '23.893%', '24.513%', '24.877%', '25.283%', '24.941%', '25.583%', '25.262%', '25.369%', '25.818%', '25.840%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.798074. Accuracy: 76.8984%.
Workers before    accuracies:  ['43.123%', '43.594%', '43.658%', '44.385%', '44.428%', '44.599%', '45.262%', '45.711%', '45.947%', '46.160%', '46.695%', '47.401%', '47.294%', '47.529%', '47.487%', '48.086%', '48.364%', '48.214%', '48.856%', '48.642%']
Workers standlone accuracies:  ['47.743%', '51.465%', '51.957%', '59.551%', '60.000%', '60.749%', '65.048%', '67.551%', '68.770%', '70.503%', '70.588%', '71.914%', '72.171%', '72.813%', '72.428%', '73.668%', '73.626%', '73.583%', '74.674%', '74.481%']
Workers federated accuracies:  ['47.743%', '51.465%', '51.957%', '59.551%', '60.000%', '60.749%', '65.048%', '67.551%', '68.770%', '70.503%', '70.588%', '71.914%', '72.171%', '72.813%', '72.428%', '73.668%', '73.626%', '73.583%', '74.674%', '74.481%']
Workers improved  accuracies:  ['4.620%', '7.872%', '8.299%', '15.166%', '15.572%', '16.150%', '19.786%', '21.840%', '22.824%', '24.342%', '23.893%', '24.513%', '24.877%', '25.283%', '24.941%', '25.583%', '25.262%', '25.369%', '25.818%', '25.840%']
Workers shard sizes:  [80, 144, 208, 272, 336, 400, 464, 528, 592, 656, 720, 784, 832, 896, 960, 1024, 1088, 1152, 1216, 1264]
Workers sharing_contributions :  tensor([ 4.0000,  7.2000, 10.4000, 13.6000, 16.8000, 20.0000, 23.2000, 26.4000,
        29.6000, 32.8000, 36.0000, 39.2000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 63.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.2662848123902175, 0.2564494656795176)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9206132613320914, 8.893195159323503e-09)
Correlation between test_acc improvements & sharing_contributions:  (0.8856715756927626, 2.0786913967935414e-07)
standalone_vs_final_corr [[1.0], [1.0], [1.0], [0.9999999999999998], [1.0]]
standalone_vs_final_corr_mean [1.0]
standalone_vs_final_corr_std [9.930136612989092e-17]
sharingcontribution_vs_final_corr [[0.956320343766319], [0.9479696661877335], [0.9302357439832336], [0.9643691803989007], [0.9206132613320914]]
sharingcontribution_vs_final_corr_mean [0.9439016391336557]
sharingcontribution_vs_final_corr_std [0.016240680682787112]
standalone_vs_federated_perturbed_corr [[0.01710553788569575], [-0.14092240461180408], [-0.1485018112849907], [0.05673649947875967], [0.2662848123902175]]
standalone_vs_federated_perturbed_corr_mean [0.010140526771575625]
standalone_vs_federated_perturbed_corr_std [0.1521952639010994]
federated_final_performance [0.7762566804885864, 0.7520855665206909, 0.7642780542373657, 0.7687700390815735, 0.7689839601516724]
federated_final_performance_mean 0.7660748600959778
federated_final_performance_std 0.00797903710274473
CFFL_best_worker [0.7508021593093872, 0.744598925113678, 0.7512299418449402, 0.7349732518196106, 0.7467379570007324]
CFFL_best_worker_mean 0.7456684470176697
CFFL_best_worker_std 0.005898477017662495
standalone_best_worker [0.7508021593093872, 0.744598925113678, 0.7512299418449402, 0.7349732518196106, 0.7467379570007324]
standalone_best_worker_mean 0.7456684470176697
standalone_best_worker_std 0.005898477017662495
