Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 5000, 'n_workers': 15, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.826163. Accuracy: 46.5241%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 58.6000%
Leave-one-out validation accuracies :  ['58.8000%', '59.4000%', '59.6000%', '60.2000%', '61.0000%', '62.4000%', '62.2000%', '63.2000%', '63.4000%', '65.6000%', '66.2000%', '66.8000%', '67.8000%', '69.8000%', '69.0000%']
Computed and normalized credits:  tensor([0.0764, 0.0751, 0.0747, 0.0734, 0.0718, 0.0689, 0.0693, 0.0673, 0.0669,
        0.0627, 0.0616, 0.0606, 0.0588, 0.0554, 0.0568])
Federated model performance: Loss: 0.723179. Accuracy: 58.8877%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['45.561%', '46.032%', '46.096%', '46.439%', '46.610%', '47.123%', '47.636%', '47.422%', '48.171%', '48.299%', '48.321%', '48.556%', '49.219%', '49.112%', '49.904%']
Workers federated accuracies:  ['45.561%', '46.032%', '46.096%', '46.439%', '46.610%', '47.123%', '47.636%', '47.422%', '48.171%', '48.299%', '48.321%', '48.556%', '49.219%', '49.112%', '49.904%']
Workers improved  accuracies:  ['0.171%', '0.385%', '0.364%', '0.556%', '0.599%', '0.813%', '1.070%', '0.941%', '1.476%', '1.519%', '1.369%', '1.604%', '2.053%', '1.904%', '2.439%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 2:
Federated model validation accuracy : 65.8000%
Leave-one-out validation accuracies :  ['65.8000%', '66.2000%', '66.4000%', '66.8000%', '67.4000%', '67.4000%', '67.6000%', '68.2000%', '69.2000%', '69.4000%', '69.2000%', '69.6000%', '70.4000%', '71.0000%', '72.0000%']
Computed and normalized credits:  tensor([0.0725, 0.0716, 0.0712, 0.0703, 0.0691, 0.0687, 0.0684, 0.0671, 0.0654,
        0.0645, 0.0647, 0.0639, 0.0623, 0.0609, 0.0595])
Federated model performance: Loss: 0.645111. Accuracy: 66.6310%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['45.904%', '46.524%', '46.503%', '46.930%', '47.294%', '47.957%', '48.770%', '48.428%', '49.561%', '49.561%', '50.225%', '50.332%', '51.551%', '51.465%', '52.364%']
Workers federated accuracies:  ['45.904%', '46.524%', '46.503%', '46.930%', '47.294%', '47.957%', '48.770%', '48.428%', '49.561%', '49.561%', '50.225%', '50.332%', '51.551%', '51.465%', '52.364%']
Workers improved  accuracies:  ['0.513%', '0.877%', '0.770%', '1.048%', '1.283%', '1.647%', '2.203%', '1.947%', '2.866%', '2.781%', '3.273%', '3.380%', '4.385%', '4.257%', '4.898%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 3:
Federated model validation accuracy : 69.2000%
Leave-one-out validation accuracies :  ['69.2000%', '69.0000%', '69.0000%', '69.4000%', '69.6000%', '69.8000%', '70.2000%', '70.4000%', '71.0000%', '72.0000%', '71.8000%', '71.8000%', '72.2000%', '72.6000%', '72.8000%']
Computed and normalized credits:  tensor([0.0698, 0.0701, 0.0700, 0.0692, 0.0688, 0.0684, 0.0677, 0.0672, 0.0660,
        0.0643, 0.0647, 0.0646, 0.0638, 0.0630, 0.0625])
Federated model performance: Loss: 0.588914. Accuracy: 71.8503%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['46.032%', '46.738%', '46.845%', '47.572%', '47.872%', '49.048%', '50.503%', '49.861%', '51.059%', '51.166%', '52.128%', '52.428%', '53.283%', '53.476%', '53.904%']
Workers federated accuracies:  ['46.032%', '46.738%', '46.845%', '47.572%', '47.872%', '49.048%', '50.503%', '49.861%', '51.059%', '51.166%', '52.128%', '52.428%', '53.283%', '53.476%', '53.904%']
Workers improved  accuracies:  ['0.642%', '1.091%', '1.112%', '1.690%', '1.861%', '2.738%', '3.936%', '3.380%', '4.364%', '4.385%', '5.176%', '5.476%', '6.118%', '6.267%', '6.438%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 4:
Federated model validation accuracy : 71.8000%
Leave-one-out validation accuracies :  ['71.8000%', '71.8000%', '72.0000%', '72.0000%', '71.8000%', '71.8000%', '72.2000%', '72.4000%', '72.6000%', '72.8000%', '72.8000%', '72.8000%', '73.0000%', '73.0000%', '73.2000%']
Computed and normalized credits:  tensor([0.0680, 0.0680, 0.0677, 0.0676, 0.0678, 0.0678, 0.0671, 0.0667, 0.0663,
        0.0658, 0.0658, 0.0658, 0.0654, 0.0653, 0.0649])
Federated model performance: Loss: 0.552433. Accuracy: 73.3690%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['46.246%', '47.080%', '47.166%', '48.107%', '48.278%', '50.160%', '51.743%', '51.230%', '52.428%', '52.620%', '53.711%', '53.882%', '54.503%', '54.332%', '55.337%']
Workers federated accuracies:  ['46.246%', '47.080%', '47.166%', '48.107%', '48.278%', '50.160%', '51.743%', '51.230%', '52.428%', '52.620%', '53.711%', '53.882%', '54.503%', '54.332%', '55.337%']
Workers improved  accuracies:  ['0.856%', '1.433%', '1.433%', '2.225%', '2.267%', '3.850%', '5.176%', '4.749%', '5.733%', '5.840%', '6.759%', '6.930%', '7.337%', '7.123%', '7.872%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 5:
Federated model validation accuracy : 72.8000%
Leave-one-out validation accuracies :  ['72.8000%', '72.8000%', '72.8000%', '73.0000%', '72.8000%', '73.2000%', '73.0000%', '73.0000%', '73.2000%', '73.2000%', '73.4000%', '73.4000%', '73.0000%', '73.4000%', '73.6000%']
Computed and normalized credits:  tensor([0.0673, 0.0673, 0.0673, 0.0669, 0.0673, 0.0667, 0.0669, 0.0668, 0.0665,
        0.0664, 0.0661, 0.0661, 0.0667, 0.0661, 0.0657])
Federated model performance: Loss: 0.530594. Accuracy: 73.6043%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['46.460%', '47.658%', '47.551%', '48.642%', '48.920%', '51.551%', '52.920%', '52.513%', '53.733%', '53.754%', '54.674%', '55.080%', '55.957%', '55.807%', '57.048%']
Workers federated accuracies:  ['46.460%', '47.658%', '47.551%', '48.642%', '48.920%', '51.551%', '52.920%', '52.513%', '53.733%', '53.754%', '54.674%', '55.080%', '55.957%', '55.807%', '57.048%']
Workers improved  accuracies:  ['1.070%', '2.011%', '1.818%', '2.759%', '2.909%', '5.241%', '6.353%', '6.032%', '7.037%', '6.973%', '7.722%', '8.128%', '8.791%', '8.599%', '9.583%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 6:
Federated model validation accuracy : 73.2000%
Leave-one-out validation accuracies :  ['73.2000%', '73.2000%', '73.2000%', '73.0000%', '73.0000%', '73.0000%', '73.0000%', '73.2000%', '73.4000%', '73.4000%', '73.6000%', '73.6000%', '73.6000%', '74.0000%', '74.2000%']
Computed and normalized credits:  tensor([0.0670, 0.0670, 0.0670, 0.0673, 0.0673, 0.0672, 0.0673, 0.0669, 0.0666,
        0.0666, 0.0663, 0.0663, 0.0663, 0.0657, 0.0653])
Federated model performance: Loss: 0.520458. Accuracy: 73.8824%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['46.545%', '48.043%', '47.872%', '49.262%', '49.754%', '52.513%', '53.904%', '53.283%', '54.717%', '54.695%', '55.615%', '56.257%', '57.283%', '57.283%', '58.674%']
Workers federated accuracies:  ['46.545%', '48.043%', '47.872%', '49.262%', '49.754%', '52.513%', '53.904%', '53.283%', '54.717%', '54.695%', '55.615%', '56.257%', '57.283%', '57.283%', '58.674%']
Workers improved  accuracies:  ['1.155%', '2.396%', '2.139%', '3.380%', '3.743%', '6.203%', '7.337%', '6.802%', '8.021%', '7.914%', '8.663%', '9.305%', '10.118%', '10.075%', '11.209%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 7:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.8000%', '73.8000%', '74.0000%', '74.0000%', '73.8000%', '73.8000%', '73.8000%', '73.4000%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0666, 0.0665,
        0.0662, 0.0662, 0.0665, 0.0665, 0.0664, 0.0670])
Federated model performance: Loss: 0.519566. Accuracy: 74.1818%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['46.802%', '48.257%', '48.257%', '50.139%', '50.545%', '53.283%', '54.652%', '53.989%', '55.230%', '55.743%', '56.385%', '57.604%', '58.567%', '59.037%', '59.786%']
Workers federated accuracies:  ['46.802%', '48.257%', '48.257%', '50.139%', '50.545%', '53.283%', '54.652%', '53.989%', '55.230%', '55.743%', '56.385%', '57.604%', '58.567%', '59.037%', '59.786%']
Workers improved  accuracies:  ['1.412%', '2.610%', '2.524%', '4.257%', '4.535%', '6.973%', '8.086%', '7.508%', '8.535%', '8.963%', '9.433%', '10.652%', '11.401%', '11.829%', '12.321%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 8:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.8000%', '73.8000%', '74.0000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.6000%', '73.8000%', '74.0000%', '74.0000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0664, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
        0.0667, 0.0666, 0.0670, 0.0667, 0.0664, 0.0664])
Federated model performance: Loss: 0.525256. Accuracy: 74.2460%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['46.845%', '48.535%', '48.877%', '50.759%', '51.102%', '53.968%', '55.465%', '54.759%', '56.364%', '56.385%', '58.011%', '58.888%', '59.872%', '60.471%', '61.305%']
Workers federated accuracies:  ['46.845%', '48.535%', '48.877%', '50.759%', '51.102%', '53.968%', '55.465%', '54.759%', '56.364%', '56.385%', '58.011%', '58.888%', '59.872%', '60.471%', '61.305%']
Workers improved  accuracies:  ['1.455%', '2.888%', '3.144%', '4.877%', '5.091%', '7.658%', '8.898%', '8.278%', '9.668%', '9.604%', '11.059%', '11.936%', '12.706%', '13.262%', '13.840%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 9:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.6000%', '73.8000%', '73.8000%', '73.8000%', '74.0000%', '74.0000%', '73.8000%', '74.0000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0670, 0.0667,
        0.0667, 0.0667, 0.0664, 0.0664, 0.0667, 0.0664])
Federated model performance: Loss: 0.535927. Accuracy: 74.2888%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['46.995%', '48.727%', '49.283%', '51.487%', '51.807%', '54.524%', '56.043%', '55.679%', '57.262%', '57.390%', '59.358%', '59.936%', '60.299%', '61.754%', '62.610%']
Workers federated accuracies:  ['46.995%', '48.727%', '49.283%', '51.487%', '51.807%', '54.524%', '56.043%', '55.679%', '57.262%', '57.390%', '59.358%', '59.936%', '60.299%', '61.754%', '62.610%']
Workers improved  accuracies:  ['1.604%', '3.080%', '3.551%', '5.604%', '5.797%', '8.214%', '9.476%', '9.198%', '10.567%', '10.610%', '12.406%', '12.984%', '13.134%', '14.545%', '15.144%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 10:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '73.8000%', '73.6000%', '73.6000%', '73.8000%', '73.8000%', '73.6000%', '73.6000%']
Computed and normalized credits:  tensor([0.0665, 0.0665, 0.0664, 0.0665, 0.0665, 0.0665, 0.0665, 0.0665, 0.0668,
        0.0670, 0.0670, 0.0667, 0.0667, 0.0670, 0.0670])
Federated model performance: Loss: 0.550881. Accuracy: 74.4385%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['47.166%', '49.091%', '49.626%', '52.150%', '52.599%', '55.080%', '57.134%', '56.428%', '58.289%', '58.503%', '60.620%', '60.898%', '61.219%', '62.717%', '63.829%']
Workers federated accuracies:  ['47.166%', '49.091%', '49.626%', '52.150%', '52.599%', '55.080%', '57.134%', '56.428%', '58.289%', '58.503%', '60.620%', '60.898%', '61.219%', '62.717%', '63.829%']
Workers improved  accuracies:  ['1.775%', '3.444%', '3.893%', '6.267%', '6.588%', '8.770%', '10.567%', '9.947%', '11.594%', '11.722%', '13.668%', '13.947%', '14.053%', '15.508%', '16.364%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.550881. Accuracy: 74.4385%.
Workers before    accuracies:  ['45.390%', '45.647%', '45.733%', '45.882%', '46.011%', '46.310%', '46.567%', '46.481%', '46.695%', '46.781%', '46.952%', '46.952%', '47.166%', '47.209%', '47.465%']
Workers standlone accuracies:  ['47.166%', '49.091%', '49.626%', '52.150%', '52.599%', '55.080%', '57.134%', '56.428%', '58.289%', '58.503%', '60.620%', '60.898%', '61.219%', '62.717%', '63.829%']
Workers federated accuracies:  ['47.166%', '49.091%', '49.626%', '52.150%', '52.599%', '55.080%', '57.134%', '56.428%', '58.289%', '58.503%', '60.620%', '60.898%', '61.219%', '62.717%', '63.829%']
Workers improved  accuracies:  ['1.775%', '3.444%', '3.893%', '6.267%', '6.588%', '8.770%', '10.567%', '9.947%', '11.594%', '11.722%', '13.668%', '13.947%', '14.053%', '15.508%', '16.364%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]
Workers sharing_contributions :  tensor([ 3.2000,  5.3333,  7.4667, 10.6667, 12.8000, 16.0000, 18.1333, 20.2667,
        23.4667, 25.6000, 27.7333, 30.9333, 33.0667, 35.2000, 37.3333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.061126424572227396, 0.8286725535910803)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.988501200635738, 4.738398587695556e-12)
Correlation between test_acc improvements & sharing_contributions:  (0.9876112526299602, 7.676140053276386e-12)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.779054. Accuracy: 51.6791%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 68.8000%
Leave-one-out validation accuracies :  ['68.4000%', '68.8000%', '69.4000%', '69.8000%', '70.2000%', '70.6000%', '70.8000%', '72.0000%', '72.2000%', '72.4000%', '72.2000%', '73.0000%', '73.6000%', '74.0000%', '74.0000%']
Computed and normalized credits:  tensor([0.0717, 0.0710, 0.0700, 0.0693, 0.0686, 0.0680, 0.0677, 0.0657, 0.0654,
        0.0650, 0.0654, 0.0641, 0.0631, 0.0625, 0.0625])
Federated model performance: Loss: 0.699986. Accuracy: 64.6203%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['50.973%', '51.102%', '51.273%', '51.722%', '51.743%', '52.235%', '53.326%', '53.519%', '53.091%', '53.668%', '53.797%', '54.353%', '54.610%', '54.802%', '55.337%']
Workers federated accuracies:  ['50.973%', '51.102%', '51.273%', '51.722%', '51.743%', '52.235%', '53.326%', '53.519%', '53.091%', '53.668%', '53.797%', '54.353%', '54.610%', '54.802%', '55.337%']
Workers improved  accuracies:  ['0.428%', '0.321%', '0.342%', '0.620%', '0.556%', '0.856%', '1.540%', '1.647%', '1.412%', '1.604%', '1.754%', '2.011%', '2.203%', '2.075%', '1.989%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 2:
Federated model validation accuracy : 72.6000%
Leave-one-out validation accuracies :  ['72.8000%', '72.4000%', '72.4000%', '72.2000%', '72.2000%', '72.6000%', '73.0000%', '73.6000%', '74.2000%', '74.0000%', '73.8000%', '74.2000%', '75.0000%', '75.6000%', '76.2000%']
Computed and normalized credits:  tensor([0.0685, 0.0690, 0.0689, 0.0692, 0.0691, 0.0684, 0.0677, 0.0666, 0.0656,
        0.0659, 0.0662, 0.0654, 0.0641, 0.0632, 0.0623])
Federated model performance: Loss: 0.639934. Accuracy: 68.9412%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['51.144%', '51.358%', '51.679%', '52.278%', '52.428%', '53.390%', '54.610%', '54.567%', '54.396%', '55.037%', '55.123%', '55.893%', '56.257%', '56.663%', '58.118%']
Workers federated accuracies:  ['51.144%', '51.358%', '51.679%', '52.278%', '52.428%', '53.390%', '54.610%', '54.567%', '54.396%', '55.037%', '55.123%', '55.893%', '56.257%', '56.663%', '58.118%']
Workers improved  accuracies:  ['0.599%', '0.578%', '0.749%', '1.176%', '1.241%', '2.011%', '2.824%', '2.695%', '2.717%', '2.973%', '3.080%', '3.551%', '3.850%', '3.936%', '4.770%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 3:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.8000%', '74.0000%', '74.0000%', '73.8000%', '74.2000%', '74.8000%', '74.8000%', '76.0000%', '75.8000%', '76.0000%', '76.4000%', '76.4000%', '76.2000%', '76.2000%', '76.6000%']
Computed and normalized credits:  tensor([0.0691, 0.0689, 0.0689, 0.0692, 0.0686, 0.0676, 0.0675, 0.0655, 0.0657,
        0.0655, 0.0649, 0.0648, 0.0649, 0.0648, 0.0641])
Federated model performance: Loss: 0.596078. Accuracy: 71.8930%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['51.251%', '51.829%', '52.064%', '53.176%', '53.369%', '54.203%', '55.636%', '55.722%', '55.529%', '56.257%', '56.578%', '57.540%', '58.053%', '58.930%', '60.706%']
Workers federated accuracies:  ['51.251%', '51.829%', '52.064%', '53.176%', '53.369%', '54.203%', '55.636%', '55.722%', '55.529%', '56.257%', '56.578%', '57.540%', '58.053%', '58.930%', '60.706%']
Workers improved  accuracies:  ['0.706%', '1.048%', '1.134%', '2.075%', '2.182%', '2.824%', '3.850%', '3.850%', '3.850%', '4.193%', '4.535%', '5.198%', '5.647%', '6.203%', '7.358%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 4:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.2000%', '76.4000%', '76.2000%', '76.2000%', '76.0000%', '76.4000%', '76.2000%', '76.4000%', '76.4000%', '76.8000%', '76.8000%', '77.0000%', '77.2000%']
Computed and normalized credits:  tensor([0.0673, 0.0673, 0.0673, 0.0670, 0.0672, 0.0671, 0.0674, 0.0666, 0.0669,
        0.0666, 0.0665, 0.0659, 0.0659, 0.0656, 0.0653])
Federated model performance: Loss: 0.565764. Accuracy: 73.6471%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['51.551%', '52.299%', '52.535%', '53.775%', '53.925%', '55.316%', '57.070%', '57.433%', '56.920%', '57.733%', '58.267%', '59.658%', '60.406%', '60.941%', '63.337%']
Workers federated accuracies:  ['51.551%', '52.299%', '52.535%', '53.775%', '53.925%', '55.316%', '57.070%', '57.433%', '56.920%', '57.733%', '58.267%', '59.658%', '60.406%', '60.941%', '63.337%']
Workers improved  accuracies:  ['1.005%', '1.519%', '1.604%', '2.674%', '2.738%', '3.936%', '5.283%', '5.561%', '5.241%', '5.668%', '6.225%', '7.316%', '8.000%', '8.214%', '9.989%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 5:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '77.0000%', '77.0000%', '77.0000%', '77.2000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%']
Computed and normalized credits:  tensor([0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0667, 0.0666, 0.0667,
        0.0663, 0.0661, 0.0660, 0.0660, 0.0659, 0.0659])
Federated model performance: Loss: 0.546827. Accuracy: 74.3529%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['51.957%', '52.599%', '52.920%', '54.439%', '54.567%', '55.914%', '58.289%', '58.674%', '58.203%', '59.551%', '59.722%', '61.690%', '62.481%', '63.209%', '65.070%']
Workers federated accuracies:  ['51.957%', '52.599%', '52.920%', '54.439%', '54.567%', '55.914%', '58.289%', '58.674%', '58.203%', '59.551%', '59.722%', '61.690%', '62.481%', '63.209%', '65.070%']
Workers improved  accuracies:  ['1.412%', '1.818%', '1.989%', '3.337%', '3.380%', '4.535%', '6.503%', '6.802%', '6.524%', '7.487%', '7.679%', '9.348%', '10.075%', '10.481%', '11.722%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 6:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.2000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.2000%', '77.4000%', '77.4000%', '77.6000%', '77.6000%']
Computed and normalized credits:  tensor([0.0670, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
        0.0666, 0.0669, 0.0666, 0.0666, 0.0663, 0.0663])
Federated model performance: Loss: 0.536491. Accuracy: 74.5882%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['52.150%', '53.048%', '53.241%', '54.824%', '55.102%', '56.920%', '59.658%', '60.043%', '59.465%', '60.877%', '61.476%', '63.337%', '64.193%', '64.770%', '66.225%']
Workers federated accuracies:  ['52.150%', '53.048%', '53.241%', '54.824%', '55.102%', '56.920%', '59.658%', '60.043%', '59.465%', '60.877%', '61.476%', '63.337%', '64.193%', '64.770%', '66.225%']
Workers improved  accuracies:  ['1.604%', '2.267%', '2.310%', '3.722%', '3.914%', '5.540%', '7.872%', '8.171%', '7.786%', '8.813%', '9.433%', '10.995%', '11.786%', '12.043%', '12.877%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 7:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.6000%', '77.8000%', '77.8000%', '77.8000%', '78.0000%', '78.0000%']
Computed and normalized credits:  tensor([0.0670, 0.0670, 0.0670, 0.0670, 0.0670, 0.0670, 0.0670, 0.0667, 0.0667,
        0.0667, 0.0664, 0.0664, 0.0664, 0.0661, 0.0661])
Federated model performance: Loss: 0.533375. Accuracy: 74.5668%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['52.406%', '53.219%', '53.668%', '55.487%', '55.508%', '57.861%', '61.112%', '61.733%', '60.898%', '62.674%', '63.123%', '64.620%', '65.412%', '65.754%', '67.037%']
Workers federated accuracies:  ['52.406%', '53.219%', '53.668%', '55.487%', '55.508%', '57.861%', '61.112%', '61.733%', '60.898%', '62.674%', '63.123%', '64.620%', '65.412%', '65.754%', '67.037%']
Workers improved  accuracies:  ['1.861%', '2.439%', '2.738%', '4.385%', '4.321%', '6.481%', '9.326%', '9.861%', '9.219%', '10.610%', '11.080%', '12.278%', '13.005%', '13.027%', '13.690%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 8:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0669, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666,
        0.0666, 0.0666, 0.0666, 0.0666, 0.0665, 0.0665])
Federated model performance: Loss: 0.535894. Accuracy: 74.7808%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['52.620%', '53.583%', '54.118%', '56.150%', '56.235%', '58.738%', '62.545%', '63.080%', '61.925%', '63.850%', '64.513%', '65.626%', '66.460%', '66.652%', '68.128%']
Workers federated accuracies:  ['52.620%', '53.583%', '54.118%', '56.150%', '56.235%', '58.738%', '62.545%', '63.080%', '61.925%', '63.850%', '64.513%', '65.626%', '66.460%', '66.652%', '68.128%']
Workers improved  accuracies:  ['2.075%', '2.802%', '3.187%', '5.048%', '5.048%', '7.358%', '10.759%', '11.209%', '10.246%', '11.786%', '12.471%', '13.283%', '14.053%', '13.925%', '14.781%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 9:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '77.8000%', '77.8000%', '78.0000%', '78.2000%', '78.0000%', '78.2000%', '78.6000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0670,
        0.0670, 0.0667, 0.0664, 0.0667, 0.0664, 0.0659])
Federated model performance: Loss: 0.541810. Accuracy: 74.9305%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['52.898%', '53.840%', '54.567%', '56.642%', '56.856%', '59.850%', '63.594%', '64.193%', '63.016%', '64.428%', '65.348%', '66.481%', '67.144%', '67.187%', '68.513%']
Workers federated accuracies:  ['52.898%', '53.840%', '54.567%', '56.642%', '56.856%', '59.850%', '63.594%', '64.193%', '63.016%', '64.428%', '65.348%', '66.481%', '67.144%', '67.187%', '68.513%']
Workers improved  accuracies:  ['2.353%', '3.059%', '3.636%', '5.540%', '5.668%', '8.471%', '11.807%', '12.321%', '11.337%', '12.364%', '13.305%', '14.139%', '14.738%', '14.460%', '15.166%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 10:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.2000%', '78.4000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.4000%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.0670, 0.0670, 0.0670, 0.0670, 0.0667, 0.0664, 0.0667, 0.0667, 0.0668,
        0.0668, 0.0667, 0.0664, 0.0664, 0.0661, 0.0661])
Federated model performance: Loss: 0.551069. Accuracy: 75.0374%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['53.134%', '54.011%', '54.888%', '57.390%', '57.519%', '60.856%', '64.513%', '64.727%', '64.043%', '65.326%', '65.925%', '67.166%', '67.594%', '67.786%', '69.027%']
Workers federated accuracies:  ['53.134%', '54.011%', '54.888%', '57.390%', '57.519%', '60.856%', '64.513%', '64.727%', '64.043%', '65.326%', '65.925%', '67.166%', '67.594%', '67.786%', '69.027%']
Workers improved  accuracies:  ['2.588%', '3.230%', '3.957%', '6.289%', '6.332%', '9.476%', '12.727%', '12.856%', '12.364%', '13.262%', '13.882%', '14.824%', '15.187%', '15.059%', '15.679%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.551069. Accuracy: 75.0374%.
Workers before    accuracies:  ['50.545%', '50.781%', '50.930%', '51.102%', '51.187%', '51.380%', '51.786%', '51.872%', '51.679%', '52.064%', '52.043%', '52.342%', '52.406%', '52.727%', '53.348%']
Workers standlone accuracies:  ['53.134%', '54.011%', '54.888%', '57.390%', '57.519%', '60.856%', '64.513%', '64.727%', '64.043%', '65.326%', '65.925%', '67.166%', '67.594%', '67.786%', '69.027%']
Workers federated accuracies:  ['53.134%', '54.011%', '54.888%', '57.390%', '57.519%', '60.856%', '64.513%', '64.727%', '64.043%', '65.326%', '65.925%', '67.166%', '67.594%', '67.786%', '69.027%']
Workers improved  accuracies:  ['2.588%', '3.230%', '3.957%', '6.289%', '6.332%', '9.476%', '12.727%', '12.856%', '12.364%', '13.262%', '13.882%', '14.824%', '15.187%', '15.059%', '15.679%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]
Workers sharing_contributions :  tensor([ 3.2000,  5.3333,  7.4667, 10.6667, 12.8000, 16.0000, 18.1333, 20.2667,
        23.4667, 25.6000, 27.7333, 30.9333, 33.0667, 35.2000, 37.3333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.05401803178184257, 0.848369520323163)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999999, 3.876914407497237e-103)
Correlation between test_acc & sharing contributions:  (0.9663736118009771, 4.805082059293521e-09)
Correlation between test_acc improvements & sharing_contributions:  (0.9553861748429038, 2.939534722453621e-08)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.739149. Accuracy: 53.0053%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 61.2000%
Leave-one-out validation accuracies :  ['61.0000%', '61.2000%', '61.8000%', '62.4000%', '63.0000%', '63.8000%', '65.6000%', '67.6000%', '69.0000%', '70.8000%', '71.2000%', '72.0000%', '73.2000%', '74.2000%', '75.2000%']
Computed and normalized credits:  tensor([0.0791, 0.0786, 0.0774, 0.0761, 0.0749, 0.0732, 0.0697, 0.0659, 0.0633,
        0.0602, 0.0595, 0.0582, 0.0562, 0.0547, 0.0532])
Federated model performance: Loss: 0.675557. Accuracy: 60.7701%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['52.599%', '52.535%', '52.770%', '53.176%', '53.198%', '53.519%', '54.139%', '53.861%', '54.203%', '54.439%', '54.267%', '55.016%', '54.802%', '55.123%', '55.807%']
Workers federated accuracies:  ['52.599%', '52.535%', '52.770%', '53.176%', '53.198%', '53.519%', '54.139%', '53.861%', '54.203%', '54.439%', '54.267%', '55.016%', '54.802%', '55.123%', '55.807%']
Workers improved  accuracies:  ['0.257%', '0.128%', '0.342%', '0.513%', '0.556%', '0.642%', '0.984%', '0.856%', '1.027%', '1.155%', '1.070%', '1.476%', '1.369%', '1.519%', '1.711%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 2:
Federated model validation accuracy : 70.8000%
Leave-one-out validation accuracies :  ['71.0000%', '71.0000%', '71.2000%', '71.8000%', '71.6000%', '72.4000%', '73.6000%', '73.6000%', '74.4000%', '74.6000%', '74.8000%', '75.6000%', '75.8000%', '76.0000%', '76.0000%']
Computed and normalized credits:  tensor([0.0723, 0.0723, 0.0718, 0.0706, 0.0708, 0.0693, 0.0669, 0.0665, 0.0649,
        0.0642, 0.0638, 0.0624, 0.0618, 0.0613, 0.0611])
Federated model performance: Loss: 0.624307. Accuracy: 67.9786%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['52.706%', '52.813%', '53.155%', '53.540%', '53.668%', '54.225%', '55.037%', '54.781%', '55.123%', '55.508%', '55.337%', '56.321%', '55.979%', '56.278%', '57.604%']
Workers federated accuracies:  ['52.706%', '52.813%', '53.155%', '53.540%', '53.668%', '54.225%', '55.037%', '54.781%', '55.123%', '55.508%', '55.337%', '56.321%', '55.979%', '56.278%', '57.604%']
Workers improved  accuracies:  ['0.364%', '0.406%', '0.727%', '0.877%', '1.027%', '1.348%', '1.882%', '1.775%', '1.947%', '2.225%', '2.139%', '2.781%', '2.545%', '2.674%', '3.508%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 3:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.2000%', '75.8000%', '75.8000%', '75.4000%', '76.0000%', '76.0000%', '75.6000%', '75.6000%', '76.0000%', '76.2000%', '76.2000%', '77.2000%', '77.2000%']
Computed and normalized credits:  tensor([0.0687, 0.0686, 0.0683, 0.0673, 0.0673, 0.0677, 0.0665, 0.0665, 0.0669,
        0.0668, 0.0661, 0.0657, 0.0656, 0.0641, 0.0641])
Federated model performance: Loss: 0.584069. Accuracy: 71.1444%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['52.920%', '53.070%', '53.369%', '54.096%', '54.246%', '54.759%', '55.850%', '55.508%', '56.021%', '56.535%', '56.385%', '57.668%', '57.433%', '57.690%', '58.610%']
Workers federated accuracies:  ['52.920%', '53.070%', '53.369%', '54.096%', '54.246%', '54.759%', '55.850%', '55.508%', '56.021%', '56.535%', '56.385%', '57.668%', '57.433%', '57.690%', '58.610%']
Workers improved  accuracies:  ['0.578%', '0.663%', '0.941%', '1.433%', '1.604%', '1.882%', '2.695%', '2.503%', '2.845%', '3.251%', '3.187%', '4.128%', '4.000%', '4.086%', '4.513%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 4:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '76.0000%', '76.2000%', '76.0000%', '75.8000%', '76.2000%', '76.8000%', '77.0000%', '77.0000%', '77.6000%', '77.8000%', '78.0000%', '78.0000%', '78.4000%']
Computed and normalized credits:  tensor([0.0682, 0.0682, 0.0681, 0.0677, 0.0680, 0.0683, 0.0676, 0.0667, 0.0665,
        0.0665, 0.0655, 0.0652, 0.0649, 0.0647, 0.0641])
Federated model performance: Loss: 0.552682. Accuracy: 73.0267%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['53.091%', '53.262%', '53.797%', '54.759%', '54.674%', '55.444%', '56.791%', '56.278%', '56.877%', '57.626%', '57.604%', '58.481%', '58.524%', '58.503%', '60.021%']
Workers federated accuracies:  ['53.091%', '53.262%', '53.797%', '54.759%', '54.674%', '55.444%', '56.791%', '56.278%', '56.877%', '57.626%', '57.604%', '58.481%', '58.524%', '58.503%', '60.021%']
Workers improved  accuracies:  ['0.749%', '0.856%', '1.369%', '2.096%', '2.032%', '2.567%', '3.636%', '3.273%', '3.701%', '4.342%', '4.406%', '4.941%', '5.091%', '4.898%', '5.925%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 5:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.8000%', '77.8000%', '78.0000%', '78.0000%', '78.4000%', '78.6000%', '78.4000%', '78.4000%', '78.4000%', '78.6000%', '79.2000%']
Computed and normalized credits:  tensor([0.0679, 0.0679, 0.0676, 0.0675, 0.0673, 0.0673, 0.0669, 0.0668, 0.0662,
        0.0659, 0.0661, 0.0661, 0.0660, 0.0657, 0.0648])
Federated model performance: Loss: 0.529499. Accuracy: 74.2674%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['53.326%', '53.497%', '54.289%', '55.144%', '55.037%', '56.043%', '57.476%', '57.005%', '57.968%', '58.503%', '57.989%', '59.294%', '59.251%', '59.422%', '61.561%']
Workers federated accuracies:  ['53.326%', '53.497%', '54.289%', '55.144%', '55.037%', '56.043%', '57.476%', '57.005%', '57.968%', '58.503%', '57.989%', '59.294%', '59.251%', '59.422%', '61.561%']
Workers improved  accuracies:  ['0.984%', '1.091%', '1.861%', '2.481%', '2.396%', '3.166%', '4.321%', '4.000%', '4.791%', '5.219%', '4.791%', '5.754%', '5.818%', '5.818%', '7.465%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 6:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.2000%', '78.4000%', '78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.0000%', '78.0000%', '78.8000%', '78.8000%', '79.0000%', '79.2000%', '79.4000%', '79.6000%']
Computed and normalized credits:  tensor([0.0671, 0.0674, 0.0670, 0.0673, 0.0673, 0.0673, 0.0670, 0.0675, 0.0674,
        0.0663, 0.0663, 0.0660, 0.0657, 0.0654, 0.0650])
Federated model performance: Loss: 0.513622. Accuracy: 74.8235%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['53.476%', '53.711%', '54.374%', '55.487%', '55.465%', '56.342%', '58.246%', '57.476%', '58.610%', '58.952%', '59.037%', '60.257%', '59.979%', '60.513%', '63.209%']
Workers federated accuracies:  ['53.476%', '53.711%', '54.374%', '55.487%', '55.465%', '56.342%', '58.246%', '57.476%', '58.610%', '58.952%', '59.037%', '60.257%', '59.979%', '60.513%', '63.209%']
Workers improved  accuracies:  ['1.134%', '1.305%', '1.947%', '2.824%', '2.824%', '3.465%', '5.091%', '4.471%', '5.433%', '5.668%', '5.840%', '6.717%', '6.545%', '6.909%', '9.112%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 7:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '79.2000%', '79.2000%', '79.2000%', '79.0000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.4000%', '79.8000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%']
Computed and normalized credits:  tensor([0.0672, 0.0670, 0.0669, 0.0670, 0.0672, 0.0670, 0.0669, 0.0670, 0.0670,
        0.0666, 0.0660, 0.0663, 0.0662, 0.0659, 0.0659])
Federated model performance: Loss: 0.502457. Accuracy: 75.1872%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['53.668%', '53.947%', '54.588%', '56.021%', '55.893%', '56.941%', '58.695%', '58.225%', '59.144%', '59.572%', '59.701%', '61.262%', '61.112%', '61.561%', '64.428%']
Workers federated accuracies:  ['53.668%', '53.947%', '54.588%', '56.021%', '55.893%', '56.941%', '58.695%', '58.225%', '59.144%', '59.572%', '59.701%', '61.262%', '61.112%', '61.561%', '64.428%']
Workers improved  accuracies:  ['1.326%', '1.540%', '2.160%', '3.358%', '3.251%', '4.064%', '5.540%', '5.219%', '5.968%', '6.289%', '6.503%', '7.722%', '7.679%', '7.957%', '10.332%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 8:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.6000%', '79.6000%', '79.8000%', '79.8000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%', '80.0000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0665, 0.0665, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668,
        0.0668, 0.0667, 0.0667, 0.0664, 0.0664, 0.0661])
Federated model performance: Loss: 0.495924. Accuracy: 75.7005%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['53.775%', '54.203%', '54.909%', '56.385%', '56.492%', '57.455%', '59.316%', '58.759%', '59.936%', '60.513%', '60.278%', '62.396%', '62.374%', '62.652%', '65.797%']
Workers federated accuracies:  ['53.775%', '54.203%', '54.909%', '56.385%', '56.492%', '57.455%', '59.316%', '58.759%', '59.936%', '60.513%', '60.278%', '62.396%', '62.374%', '62.652%', '65.797%']
Workers improved  accuracies:  ['1.433%', '1.797%', '2.481%', '3.722%', '3.850%', '4.578%', '6.160%', '5.754%', '6.759%', '7.230%', '7.080%', '8.856%', '8.941%', '9.048%', '11.701%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 9:
Federated model validation accuracy : 79.8000%
Leave-one-out validation accuracies :  ['79.8000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%', '79.6000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%']
Computed and normalized credits:  tensor([0.0666, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0666, 0.0666,
        0.0668, 0.0665, 0.0665, 0.0665, 0.0665, 0.0665])
Federated model performance: Loss: 0.493423. Accuracy: 75.9144%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['54.096%', '54.545%', '55.037%', '56.706%', '56.770%', '57.818%', '59.893%', '59.337%', '60.920%', '61.433%', '61.241%', '63.337%', '63.401%', '63.850%', '67.166%']
Workers federated accuracies:  ['54.096%', '54.545%', '55.037%', '56.706%', '56.770%', '57.818%', '59.893%', '59.337%', '60.920%', '61.433%', '61.241%', '63.337%', '63.401%', '63.850%', '67.166%']
Workers improved  accuracies:  ['1.754%', '2.139%', '2.610%', '4.043%', '4.128%', '4.941%', '6.738%', '6.332%', '7.743%', '8.150%', '8.043%', '9.797%', '9.968%', '10.246%', '13.070%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 10:
Federated model validation accuracy : 79.8000%
Leave-one-out validation accuracies :  ['79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
        0.0667, 0.0667, 0.0667, 0.0666, 0.0666, 0.0666])
Federated model performance: Loss: 0.494254. Accuracy: 76.0642%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['54.267%', '54.802%', '55.401%', '57.198%', '57.176%', '58.310%', '60.727%', '59.786%', '62.332%', '62.225%', '62.032%', '63.957%', '64.299%', '64.984%', '68.257%']
Workers federated accuracies:  ['54.267%', '54.802%', '55.401%', '57.198%', '57.176%', '58.310%', '60.727%', '59.786%', '62.332%', '62.225%', '62.032%', '63.957%', '64.299%', '64.984%', '68.257%']
Workers improved  accuracies:  ['1.925%', '2.396%', '2.973%', '4.535%', '4.535%', '5.433%', '7.572%', '6.781%', '9.155%', '8.941%', '8.834%', '10.417%', '10.866%', '11.380%', '14.160%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.494254. Accuracy: 76.0642%.
Workers before    accuracies:  ['52.342%', '52.406%', '52.428%', '52.663%', '52.642%', '52.877%', '53.155%', '53.005%', '53.176%', '53.283%', '53.198%', '53.540%', '53.433%', '53.604%', '54.096%']
Workers standlone accuracies:  ['54.267%', '54.802%', '55.401%', '57.198%', '57.176%', '58.310%', '60.727%', '59.786%', '62.332%', '62.225%', '62.032%', '63.957%', '64.299%', '64.984%', '68.257%']
Workers federated accuracies:  ['54.267%', '54.802%', '55.401%', '57.198%', '57.176%', '58.310%', '60.727%', '59.786%', '62.332%', '62.225%', '62.032%', '63.957%', '64.299%', '64.984%', '68.257%']
Workers improved  accuracies:  ['1.925%', '2.396%', '2.973%', '4.535%', '4.535%', '5.433%', '7.572%', '6.781%', '9.155%', '8.941%', '8.834%', '10.417%', '10.866%', '11.380%', '14.160%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]
Workers sharing_contributions :  tensor([ 3.2000,  5.3333,  7.4667, 10.6667, 12.8000, 16.0000, 18.1333, 20.2667,
        23.4667, 25.6000, 27.7333, 30.9333, 33.0667, 35.2000, 37.3333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.25312889185151305, 0.3626831836392852)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9828997070157381, 6.167119340476645e-11)
Correlation between test_acc improvements & sharing_contributions:  (0.9838097190924342, 4.331725884390808e-11)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.744350. Accuracy: 50.5455%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 62.6000%
Leave-one-out validation accuracies :  ['62.6000%', '63.0000%', '63.2000%', '63.4000%', '63.8000%', '64.0000%', '64.8000%', '66.0000%', '66.0000%', '67.4000%', '68.0000%', '68.2000%', '69.4000%', '70.2000%', '70.4000%']
Computed and normalized credits:  tensor([0.0729, 0.0722, 0.0718, 0.0714, 0.0707, 0.0703, 0.0688, 0.0666, 0.0666,
        0.0641, 0.0630, 0.0627, 0.0607, 0.0593, 0.0590])
Federated model performance: Loss: 0.672501. Accuracy: 62.3743%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['49.433%', '49.647%', '49.861%', '50.545%', '50.824%', '51.102%', '52.428%', '52.342%', '52.556%', '52.663%', '52.663%', '53.326%', '53.497%', '53.925%', '54.973%']
Workers federated accuracies:  ['49.433%', '49.647%', '49.861%', '50.545%', '50.824%', '51.102%', '52.428%', '52.342%', '52.556%', '52.663%', '52.663%', '53.326%', '53.497%', '53.925%', '54.973%']
Workers improved  accuracies:  ['0.278%', '0.428%', '0.492%', '0.770%', '0.963%', '1.283%', '1.711%', '1.818%', '1.733%', '1.754%', '1.754%', '2.075%', '2.139%', '2.182%', '2.909%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 2:
Federated model validation accuracy : 68.0000%
Leave-one-out validation accuracies :  ['68.0000%', '68.0000%', '67.8000%', '68.4000%', '68.4000%', '68.8000%', '69.8000%', '70.0000%', '70.2000%', '70.6000%', '71.0000%', '72.0000%', '72.6000%', '73.0000%', '74.2000%']
Computed and normalized credits:  tensor([0.0711, 0.0710, 0.0713, 0.0702, 0.0701, 0.0694, 0.0675, 0.0669, 0.0666,
        0.0656, 0.0648, 0.0632, 0.0620, 0.0612, 0.0593])
Federated model performance: Loss: 0.617740. Accuracy: 68.1283%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['49.797%', '50.182%', '50.439%', '51.251%', '51.636%', '52.278%', '53.775%', '53.455%', '54.075%', '54.225%', '53.989%', '55.444%', '55.679%', '56.599%', '58.203%']
Workers federated accuracies:  ['49.797%', '50.182%', '50.439%', '51.251%', '51.636%', '52.278%', '53.775%', '53.455%', '54.075%', '54.225%', '53.989%', '55.444%', '55.679%', '56.599%', '58.203%']
Workers improved  accuracies:  ['0.642%', '0.963%', '1.070%', '1.476%', '1.775%', '2.460%', '3.059%', '2.930%', '3.251%', '3.316%', '3.080%', '4.193%', '4.321%', '4.856%', '6.139%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 3:
Federated model validation accuracy : 70.6000%
Leave-one-out validation accuracies :  ['70.6000%', '71.0000%', '71.0000%', '71.0000%', '71.6000%', '72.4000%', '72.8000%', '72.4000%', '73.6000%', '74.2000%', '74.2000%', '74.8000%', '74.8000%', '75.2000%', '75.4000%']
Computed and normalized credits:  tensor([0.0711, 0.0704, 0.0704, 0.0703, 0.0693, 0.0679, 0.0671, 0.0676, 0.0657,
        0.0646, 0.0645, 0.0634, 0.0632, 0.0625, 0.0620])
Federated model performance: Loss: 0.577416. Accuracy: 71.8717%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['50.182%', '50.567%', '51.059%', '52.171%', '52.599%', '53.219%', '55.508%', '55.273%', '55.551%', '55.893%', '55.807%', '57.626%', '57.668%', '59.037%', '60.599%']
Workers federated accuracies:  ['50.182%', '50.567%', '51.059%', '52.171%', '52.599%', '53.219%', '55.508%', '55.273%', '55.551%', '55.893%', '55.807%', '57.626%', '57.668%', '59.037%', '60.599%']
Workers improved  accuracies:  ['1.027%', '1.348%', '1.690%', '2.396%', '2.738%', '3.401%', '4.791%', '4.749%', '4.727%', '4.984%', '4.898%', '6.374%', '6.310%', '7.294%', '8.535%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 4:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.2000%', '74.4000%', '74.4000%', '74.4000%', '74.6000%', '74.8000%', '75.2000%', '75.2000%', '75.0000%', '74.8000%', '75.2000%', '75.2000%', '75.4000%', '75.6000%', '75.6000%']
Computed and normalized credits:  tensor([0.0683, 0.0679, 0.0679, 0.0679, 0.0675, 0.0670, 0.0663, 0.0664, 0.0664,
        0.0666, 0.0660, 0.0659, 0.0656, 0.0652, 0.0651])
Federated model performance: Loss: 0.549489. Accuracy: 73.0267%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['50.503%', '51.059%', '51.465%', '52.856%', '53.326%', '54.652%', '57.326%', '56.856%', '57.262%', '57.733%', '57.476%', '59.572%', '59.487%', '61.027%', '62.011%']
Workers federated accuracies:  ['50.503%', '51.059%', '51.465%', '52.856%', '53.326%', '54.652%', '57.326%', '56.856%', '57.262%', '57.733%', '57.476%', '59.572%', '59.487%', '61.027%', '62.011%']
Workers improved  accuracies:  ['1.348%', '1.840%', '2.096%', '3.080%', '3.465%', '4.834%', '6.610%', '6.332%', '6.439%', '6.824%', '6.567%', '8.321%', '8.128%', '9.283%', '9.947%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 5:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.2000%', '75.2000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.2000%', '75.2000%', '75.2000%', '75.6000%', '75.8000%', '76.2000%', '76.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.0676, 0.0673, 0.0673, 0.0670, 0.0669, 0.0669, 0.0668, 0.0671, 0.0671,
        0.0671, 0.0664, 0.0661, 0.0655, 0.0655, 0.0655])
Federated model performance: Loss: 0.531483. Accuracy: 73.8182%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['50.845%', '51.337%', '51.936%', '53.433%', '53.947%', '55.594%', '58.824%', '58.353%', '58.717%', '59.337%', '59.059%', '61.305%', '61.241%', '62.353%', '63.251%']
Workers federated accuracies:  ['50.845%', '51.337%', '51.936%', '53.433%', '53.947%', '55.594%', '58.824%', '58.353%', '58.717%', '59.337%', '59.059%', '61.305%', '61.241%', '62.353%', '63.251%']
Workers improved  accuracies:  ['1.690%', '2.118%', '2.567%', '3.658%', '4.086%', '5.775%', '8.107%', '7.829%', '7.893%', '8.428%', '8.150%', '10.053%', '9.882%', '10.610%', '11.187%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 6:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.2000%', '75.4000%', '75.6000%', '75.6000%', '75.6000%', '75.8000%', '76.0000%', '76.0000%', '76.2000%', '76.4000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%']
Computed and normalized credits:  tensor([0.0680, 0.0677, 0.0674, 0.0674, 0.0674, 0.0671, 0.0668, 0.0668, 0.0665,
        0.0662, 0.0658, 0.0658, 0.0657, 0.0657, 0.0657])
Federated model performance: Loss: 0.521279. Accuracy: 74.1818%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['51.209%', '51.872%', '52.299%', '54.332%', '55.080%', '56.578%', '60.257%', '59.594%', '59.957%', '60.556%', '60.214%', '62.332%', '62.289%', '63.487%', '64.342%']
Workers federated accuracies:  ['51.209%', '51.872%', '52.299%', '54.332%', '55.080%', '56.578%', '60.257%', '59.594%', '59.957%', '60.556%', '60.214%', '62.332%', '62.289%', '63.487%', '64.342%']
Workers improved  accuracies:  ['2.053%', '2.652%', '2.930%', '4.556%', '5.219%', '6.759%', '9.540%', '9.070%', '9.134%', '9.647%', '9.305%', '11.080%', '10.930%', '11.743%', '12.278%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 7:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.4000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.8000%', '76.8000%']
Computed and normalized credits:  tensor([0.0674, 0.0673, 0.0670, 0.0667, 0.0667, 0.0667, 0.0666, 0.0666, 0.0666,
        0.0666, 0.0665, 0.0665, 0.0665, 0.0662, 0.0662])
Federated model performance: Loss: 0.516899. Accuracy: 74.5027%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['51.615%', '52.150%', '52.684%', '55.102%', '56.000%', '57.519%', '61.176%', '60.791%', '61.476%', '61.561%', '61.476%', '63.102%', '62.973%', '64.193%', '65.112%']
Workers federated accuracies:  ['51.615%', '52.150%', '52.684%', '55.102%', '56.000%', '57.519%', '61.176%', '60.791%', '61.476%', '61.561%', '61.476%', '63.102%', '62.973%', '64.193%', '65.112%']
Workers improved  accuracies:  ['2.460%', '2.930%', '3.316%', '5.326%', '6.139%', '7.701%', '10.460%', '10.267%', '10.652%', '10.652%', '10.567%', '11.850%', '11.615%', '12.449%', '13.048%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 8:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%', '77.0000%', '77.2000%', '77.4000%', '77.4000%']
Computed and normalized credits:  tensor([0.0671, 0.0671, 0.0671, 0.0670, 0.0670, 0.0670, 0.0667, 0.0667, 0.0667,
        0.0667, 0.0667, 0.0664, 0.0661, 0.0658, 0.0658])
Federated model performance: Loss: 0.517063. Accuracy: 74.8235%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['51.786%', '52.578%', '53.134%', '55.893%', '56.813%', '58.567%', '61.754%', '61.476%', '62.438%', '62.332%', '62.396%', '64.021%', '63.872%', '65.241%', '66.139%']
Workers federated accuracies:  ['51.786%', '52.578%', '53.134%', '55.893%', '56.813%', '58.567%', '61.754%', '61.476%', '62.438%', '62.332%', '62.396%', '64.021%', '63.872%', '65.241%', '66.139%']
Workers improved  accuracies:  ['2.631%', '3.358%', '3.765%', '6.118%', '6.952%', '8.749%', '11.037%', '10.952%', '11.615%', '11.422%', '11.487%', '12.770%', '12.513%', '13.497%', '14.075%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 9:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.8000%', '76.8000%', '77.0000%', '77.2000%', '77.2000%', '77.2000%', '77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%']
Computed and normalized credits:  tensor([0.0674, 0.0674, 0.0673, 0.0673, 0.0671, 0.0668, 0.0667, 0.0667, 0.0664,
        0.0664, 0.0662, 0.0661, 0.0661, 0.0660, 0.0660])
Federated model performance: Loss: 0.520746. Accuracy: 75.0588%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['52.107%', '52.877%', '53.604%', '56.770%', '57.668%', '59.444%', '62.396%', '62.011%', '62.995%', '62.952%', '63.294%', '64.791%', '64.856%', '66.396%', '67.080%']
Workers federated accuracies:  ['52.107%', '52.877%', '53.604%', '56.770%', '57.668%', '59.444%', '62.396%', '62.011%', '62.995%', '62.952%', '63.294%', '64.791%', '64.856%', '66.396%', '67.080%']
Workers improved  accuracies:  ['2.952%', '3.658%', '4.235%', '6.995%', '7.807%', '9.626%', '11.679%', '11.487%', '12.171%', '12.043%', '12.385%', '13.540%', '13.497%', '14.652%', '15.016%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 10:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%']
Computed and normalized credits:  tensor([0.0671, 0.0671, 0.0671, 0.0671, 0.0668, 0.0667, 0.0667, 0.0667, 0.0667,
        0.0664, 0.0664, 0.0664, 0.0664, 0.0663, 0.0663])
Federated model performance: Loss: 0.527720. Accuracy: 75.1444%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['52.342%', '53.155%', '54.032%', '57.433%', '58.674%', '60.107%', '63.102%', '62.610%', '63.465%', '63.401%', '63.872%', '65.668%', '65.690%', '67.209%', '67.765%']
Workers federated accuracies:  ['52.342%', '53.155%', '54.032%', '57.433%', '58.674%', '60.107%', '63.102%', '62.610%', '63.465%', '63.401%', '63.872%', '65.668%', '65.690%', '67.209%', '67.765%']
Workers improved  accuracies:  ['3.187%', '3.936%', '4.663%', '7.658%', '8.813%', '10.289%', '12.385%', '12.086%', '12.642%', '12.492%', '12.963%', '14.417%', '14.332%', '15.465%', '15.701%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.527720. Accuracy: 75.1444%.
Workers before    accuracies:  ['49.155%', '49.219%', '49.369%', '49.775%', '49.861%', '49.818%', '50.717%', '50.524%', '50.824%', '50.909%', '50.909%', '51.251%', '51.358%', '51.743%', '52.064%']
Workers standlone accuracies:  ['52.342%', '53.155%', '54.032%', '57.433%', '58.674%', '60.107%', '63.102%', '62.610%', '63.465%', '63.401%', '63.872%', '65.668%', '65.690%', '67.209%', '67.765%']
Workers federated accuracies:  ['52.342%', '53.155%', '54.032%', '57.433%', '58.674%', '60.107%', '63.102%', '62.610%', '63.465%', '63.401%', '63.872%', '65.668%', '65.690%', '67.209%', '67.765%']
Workers improved  accuracies:  ['3.187%', '3.936%', '4.663%', '7.658%', '8.813%', '10.289%', '12.385%', '12.086%', '12.642%', '12.492%', '12.963%', '14.417%', '14.332%', '15.465%', '15.701%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]
Workers sharing_contributions :  tensor([ 3.2000,  5.3333,  7.4667, 10.6667, 12.8000, 16.0000, 18.1333, 20.2667,
        23.4667, 25.6000, 27.7333, 30.9333, 33.0667, 35.2000, 37.3333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.3490665036689998, 0.202231906420561)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9696116446799597, 2.50767295897472e-09)
Correlation between test_acc improvements & sharing_contributions:  (0.9594974274143963, 1.583771925289422e-08)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.694221. Accuracy: 58.8235%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 68.2000%
Leave-one-out validation accuracies :  ['68.2000%', '68.4000%', '68.8000%', '69.2000%', '69.2000%', '69.4000%', '70.6000%', '70.8000%', '71.4000%', '71.6000%', '72.4000%', '73.4000%', '74.0000%', '75.0000%', '75.4000%']
Computed and normalized credits:  tensor([0.0717, 0.0713, 0.0706, 0.0699, 0.0699, 0.0696, 0.0676, 0.0672, 0.0662,
        0.0659, 0.0646, 0.0630, 0.0621, 0.0605, 0.0599])
Federated model performance: Loss: 0.639947. Accuracy: 66.7594%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['58.139%', '58.225%', '58.524%', '58.738%', '58.888%', '59.444%', '60.000%', '59.936%', '59.765%', '60.193%', '60.043%', '60.663%', '60.449%', '60.898%', '61.412%']
Workers federated accuracies:  ['58.139%', '58.225%', '58.524%', '58.738%', '58.888%', '59.444%', '60.000%', '59.936%', '59.765%', '60.193%', '60.043%', '60.663%', '60.449%', '60.898%', '61.412%']
Workers improved  accuracies:  ['0.128%', '0.257%', '0.299%', '0.385%', '0.513%', '0.834%', '1.112%', '1.048%', '0.984%', '1.198%', '1.112%', '1.241%', '1.176%', '1.412%', '1.476%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 2:
Federated model validation accuracy : 72.8000%
Leave-one-out validation accuracies :  ['73.0000%', '73.2000%', '73.2000%', '73.4000%', '73.6000%', '73.8000%', '74.0000%', '74.8000%', '75.0000%', '75.6000%', '76.0000%', '76.2000%', '76.2000%', '77.0000%', '77.2000%']
Computed and normalized credits:  tensor([0.0701, 0.0697, 0.0696, 0.0692, 0.0689, 0.0686, 0.0680, 0.0667, 0.0663,
        0.0653, 0.0646, 0.0641, 0.0640, 0.0626, 0.0622])
Federated model performance: Loss: 0.596567. Accuracy: 70.5455%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['58.332%', '58.396%', '58.866%', '59.487%', '59.422%', '60.043%', '60.791%', '60.642%', '60.535%', '60.984%', '61.005%', '61.733%', '61.754%', '62.203%', '63.166%']
Workers federated accuracies:  ['58.332%', '58.396%', '58.866%', '59.487%', '59.422%', '60.043%', '60.791%', '60.642%', '60.535%', '60.984%', '61.005%', '61.733%', '61.754%', '62.203%', '63.166%']
Workers improved  accuracies:  ['0.321%', '0.428%', '0.642%', '1.134%', '1.048%', '1.433%', '1.904%', '1.754%', '1.754%', '1.989%', '2.075%', '2.310%', '2.481%', '2.717%', '3.230%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 3:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '76.0000%', '76.0000%', '76.0000%', '76.2000%', '76.4000%', '76.6000%', '76.8000%', '77.2000%', '77.4000%', '78.0000%', '77.8000%', '77.8000%', '78.0000%', '78.0000%']
Computed and normalized credits:  tensor([0.0687, 0.0684, 0.0684, 0.0683, 0.0680, 0.0677, 0.0673, 0.0669, 0.0662,
        0.0658, 0.0649, 0.0651, 0.0651, 0.0646, 0.0646])
Federated model performance: Loss: 0.563054. Accuracy: 72.2139%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['58.396%', '58.481%', '59.059%', '59.936%', '59.893%', '60.684%', '61.583%', '61.412%', '61.305%', '61.882%', '61.775%', '63.102%', '62.973%', '63.615%', '64.749%']
Workers federated accuracies:  ['58.396%', '58.481%', '59.059%', '59.936%', '59.893%', '60.684%', '61.583%', '61.412%', '61.305%', '61.882%', '61.775%', '63.102%', '62.973%', '63.615%', '64.749%']
Workers improved  accuracies:  ['0.385%', '0.513%', '0.834%', '1.583%', '1.519%', '2.075%', '2.695%', '2.524%', '2.524%', '2.888%', '2.845%', '3.679%', '3.701%', '4.128%', '4.813%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 4:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '78.0000%', '77.8000%', '77.8000%', '78.2000%', '78.4000%', '78.4000%', '78.6000%']
Computed and normalized credits:  tensor([0.0674, 0.0673, 0.0673, 0.0673, 0.0670, 0.0670, 0.0669, 0.0669, 0.0665,
        0.0667, 0.0666, 0.0661, 0.0658, 0.0657, 0.0654])
Federated model performance: Loss: 0.537762. Accuracy: 73.4973%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['58.545%', '58.652%', '59.465%', '60.150%', '60.342%', '61.348%', '62.503%', '62.203%', '62.011%', '63.080%', '62.631%', '64.128%', '64.214%', '65.027%', '66.289%']
Workers federated accuracies:  ['58.545%', '58.652%', '59.465%', '60.150%', '60.342%', '61.348%', '62.503%', '62.203%', '62.011%', '63.080%', '62.631%', '64.128%', '64.214%', '65.027%', '66.289%']
Workers improved  accuracies:  ['0.535%', '0.684%', '1.241%', '1.797%', '1.968%', '2.738%', '3.615%', '3.316%', '3.230%', '4.086%', '3.701%', '4.706%', '4.941%', '5.540%', '6.353%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 5:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '77.8000%', '77.8000%', '77.8000%', '78.0000%', '78.0000%', '78.2000%', '78.2000%', '78.6000%', '78.8000%', '78.6000%', '78.8000%', '78.8000%', '79.2000%']
Computed and normalized credits:  tensor([0.0672, 0.0672, 0.0675, 0.0675, 0.0674, 0.0671, 0.0671, 0.0668, 0.0668,
        0.0663, 0.0660, 0.0662, 0.0659, 0.0659, 0.0653])
Federated model performance: Loss: 0.519608. Accuracy: 74.0963%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['58.824%', '58.888%', '59.872%', '60.706%', '60.749%', '62.011%', '63.358%', '63.187%', '62.652%', '64.171%', '63.636%', '65.476%', '65.219%', '66.160%', '67.294%']
Workers federated accuracies:  ['58.824%', '58.888%', '59.872%', '60.706%', '60.749%', '62.011%', '63.358%', '63.187%', '62.652%', '64.171%', '63.636%', '65.476%', '65.219%', '66.160%', '67.294%']
Workers improved  accuracies:  ['0.813%', '0.920%', '1.647%', '2.353%', '2.374%', '3.401%', '4.471%', '4.299%', '3.872%', '5.176%', '4.706%', '6.053%', '5.947%', '6.674%', '7.358%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 6:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.6000%', '78.6000%', '79.0000%', '79.0000%', '79.4000%', '79.4000%', '79.6000%', '79.6000%', '79.8000%', '79.6000%']
Computed and normalized credits:  tensor([0.0669, 0.0672, 0.0672, 0.0672, 0.0672, 0.0674, 0.0674, 0.0669, 0.0668,
        0.0662, 0.0662, 0.0659, 0.0659, 0.0656, 0.0658])
Federated model performance: Loss: 0.506873. Accuracy: 75.0160%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['58.973%', '59.144%', '60.043%', '61.134%', '61.241%', '62.631%', '64.193%', '64.235%', '63.273%', '65.134%', '64.813%', '66.439%', '66.182%', '67.422%', '68.449%']
Workers federated accuracies:  ['58.973%', '59.144%', '60.043%', '61.134%', '61.241%', '62.631%', '64.193%', '64.235%', '63.273%', '65.134%', '64.813%', '66.439%', '66.182%', '67.422%', '68.449%']
Workers improved  accuracies:  ['0.963%', '1.176%', '1.818%', '2.781%', '2.866%', '4.021%', '5.305%', '5.348%', '4.492%', '6.139%', '5.882%', '7.016%', '6.909%', '7.936%', '8.513%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 7:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%', '80.0000%', '79.8000%']
Computed and normalized credits:  tensor([0.0672, 0.0672, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0666,
        0.0665, 0.0665, 0.0662, 0.0662, 0.0659, 0.0662])
Federated model performance: Loss: 0.498484. Accuracy: 75.4439%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['59.209%', '59.337%', '60.406%', '61.369%', '61.412%', '63.166%', '65.112%', '65.048%', '63.979%', '65.968%', '65.733%', '67.508%', '67.209%', '68.449%', '69.283%']
Workers federated accuracies:  ['59.209%', '59.337%', '60.406%', '61.369%', '61.412%', '63.166%', '65.112%', '65.048%', '63.979%', '65.968%', '65.733%', '67.508%', '67.209%', '68.449%', '69.283%']
Workers improved  accuracies:  ['1.198%', '1.369%', '2.182%', '3.016%', '3.037%', '4.556%', '6.225%', '6.160%', '5.198%', '6.973%', '6.802%', '8.086%', '7.936%', '8.963%', '9.348%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 8:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '80.0000%', '79.8000%', '80.0000%', '80.0000%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0666, 0.0666,
        0.0666, 0.0666, 0.0663, 0.0665, 0.0662, 0.0663])
Federated model performance: Loss: 0.494161. Accuracy: 75.9358%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['59.380%', '59.508%', '60.642%', '61.754%', '61.668%', '63.872%', '66.032%', '65.775%', '64.556%', '66.866%', '66.460%', '68.107%', '67.979%', '69.283%', '69.947%']
Workers federated accuracies:  ['59.380%', '59.508%', '60.642%', '61.754%', '61.668%', '63.872%', '66.032%', '65.775%', '64.556%', '66.866%', '66.460%', '68.107%', '67.979%', '69.283%', '69.947%']
Workers improved  accuracies:  ['1.369%', '1.540%', '2.417%', '3.401%', '3.294%', '5.262%', '7.144%', '6.888%', '5.775%', '7.872%', '7.529%', '8.684%', '8.706%', '9.797%', '10.011%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 9:
Federated model validation accuracy : 79.8000%
Leave-one-out validation accuracies :  ['79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '79.8000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0666, 0.0665, 0.0665,
        0.0665, 0.0665, 0.0665, 0.0665, 0.0665, 0.0668])
Federated model performance: Loss: 0.492875. Accuracy: 76.1711%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['59.594%', '59.658%', '60.941%', '62.267%', '62.139%', '64.556%', '66.567%', '66.353%', '65.241%', '67.487%', '67.273%', '69.005%', '68.877%', '69.904%', '70.460%']
Workers federated accuracies:  ['59.594%', '59.658%', '60.941%', '62.267%', '62.139%', '64.556%', '66.567%', '66.353%', '65.241%', '67.487%', '67.273%', '69.005%', '68.877%', '69.904%', '70.460%']
Workers improved  accuracies:  ['1.583%', '1.690%', '2.717%', '3.914%', '3.765%', '5.947%', '7.679%', '7.465%', '6.460%', '8.492%', '8.342%', '9.583%', '9.604%', '10.417%', '10.524%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 10:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.6000%']
Computed and normalized credits:  tensor([0.0665, 0.0665, 0.0665, 0.0665, 0.0665, 0.0665, 0.0665, 0.0665, 0.0668,
        0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0671])
Federated model performance: Loss: 0.493802. Accuracy: 76.2995%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['59.701%', '59.786%', '61.070%', '62.610%', '62.588%', '65.091%', '67.251%', '67.059%', '65.989%', '68.107%', '67.701%', '69.390%', '69.390%', '70.567%', '70.888%']
Workers federated accuracies:  ['59.701%', '59.786%', '61.070%', '62.610%', '62.588%', '65.091%', '67.251%', '67.059%', '65.989%', '68.107%', '67.701%', '69.390%', '69.390%', '70.567%', '70.888%']
Workers improved  accuracies:  ['1.690%', '1.818%', '2.845%', '4.257%', '4.214%', '6.481%', '8.364%', '8.171%', '7.209%', '9.112%', '8.770%', '9.968%', '10.118%', '11.080%', '10.952%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.493802. Accuracy: 76.2995%.
Workers before    accuracies:  ['58.011%', '57.968%', '58.225%', '58.353%', '58.374%', '58.610%', '58.888%', '58.888%', '58.781%', '58.995%', '58.930%', '59.422%', '59.273%', '59.487%', '59.936%']
Workers standlone accuracies:  ['59.701%', '59.786%', '61.070%', '62.610%', '62.588%', '65.091%', '67.251%', '67.059%', '65.989%', '68.107%', '67.701%', '69.390%', '69.390%', '70.567%', '70.888%']
Workers federated accuracies:  ['59.701%', '59.786%', '61.070%', '62.610%', '62.588%', '65.091%', '67.251%', '67.059%', '65.989%', '68.107%', '67.701%', '69.390%', '69.390%', '70.567%', '70.888%']
Workers improved  accuracies:  ['1.690%', '1.818%', '2.845%', '4.257%', '4.214%', '6.481%', '8.364%', '8.171%', '7.209%', '9.112%', '8.770%', '9.968%', '10.118%', '11.080%', '10.952%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]
Workers sharing_contributions :  tensor([ 3.2000,  5.3333,  7.4667, 10.6667, 12.8000, 16.0000, 18.1333, 20.2667,
        23.4667, 25.6000, 27.7333, 30.9333, 33.0667, 35.2000, 37.3333])
Correlation between stand alone test acc & perturbed federated test acc:  (0.474354842227793, 0.07401796881755093)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999999, 3.876914407497237e-103)
Correlation between test_acc & sharing contributions:  (0.972742994017106, 1.2461227176401806e-09)
Correlation between test_acc improvements & sharing_contributions:  (0.967494177860852, 3.8654688038959156e-09)
standalone_vs_final_corr [[1.0], [0.9999999999999999], [1.0], [1.0], [0.9999999999999999]]
standalone_vs_final_corr_mean [1.0]
standalone_vs_final_corr_std [7.021666937153402e-17]
sharingcontribution_vs_final_corr [[0.988501200635738], [0.9663736118009771], [0.9828997070157381], [0.9696116446799597], [0.972742994017106]]
sharingcontribution_vs_final_corr_mean [0.9760258316299038]
sharingcontribution_vs_final_corr_std [0.008342291763040481]
standalone_vs_federated_perturbed_corr [[-0.061126424572227396], [-0.05401803178184257], [-0.25312889185151305], [-0.3490665036689998], [0.474354842227793]]
standalone_vs_federated_perturbed_corr_mean [-0.048597001929357966]
standalone_vs_federated_perturbed_corr_std [0.2848789991468615]
federated_final_performance [0.7443850040435791, 0.7503743171691895, 0.7606416940689087, 0.7514438629150391, 0.762994647026062]
federated_final_performance_mean 0.7539679050445557
federated_final_performance_std 0.006886772608796306
CFFL_best_worker [0.6382887959480286, 0.6902673840522766, 0.6825668215751648, 0.677647054195404, 0.7088770270347595]
CFFL_best_worker_mean 0.6795294165611268
CFFL_best_worker_std 0.023195448226761055
standalone_best_worker [0.6382887959480286, 0.6902673840522766, 0.6825668215751648, 0.677647054195404, 0.7088770270347595]
standalone_best_worker_mean 0.6795294165611268
standalone_best_worker_std 0.023195448226761055
