Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'mnist', 'sample_size_cap': 12000, 'n_workers': 20, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 64, 'train_val_split_ratio': 0.9, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.MLP_Net'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.005, 'dssgd_lr': 0.005, 'std_lr': 0.005, 'lr': 0.1, 'grad_clip': 0.001, 'gamma': 0.977, 'pretrain_epochs': 5, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'largest_criterion': 'layer', 'device_ids': [0]}
MNIST data shape torch.Size([60000, 1, 32, 32]), targets shape torch.Size([60000])
MNIST data shape torch.Size([10000, 1, 32, 32]), targets shape torch.Size([10000])
------
Train to split size: 12000. Validation size: 6000. Test size: 10000
------
Experiment : No.1/1
Shard sizes are:  [71, 127, 183, 238, 294, 350, 406, 461, 517, 573, 628, 684, 740, 795, 851, 907, 963, 1018, 1074, 1120]
CFFL server model validation accuracy : 7.2000%
CFFL server model test accuracy : 7.2200%

Epoch 1:
credits, credit threshold: tensor(0.0333)
tensor([0.0364, 0.0496, 0.0447, 0.0598, 0.0514, 0.0596, 0.0546, 0.0560, 0.0555,
        0.0532, 0.0525, 0.0503, 0.0532, 0.0455, 0.0442, 0.0477, 0.0467, 0.0475,
        0.0456, 0.0459])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0364, 0.0491, 0.0489, 0.0623, 0.0526, 0.0646, 0.0556, 0.0534, 0.0576,
        0.0515, 0.0522, 0.0488, 0.0514, 0.0415, 0.0445, 0.0453, 0.0454, 0.0481,
        0.0456, 0.0452])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.650%', '10.780%', '13.540%', '12.600%', '13.720%', '14.550%', '14.780%', '22.910%', '23.260%', '22.320%', '27.130%', '30.390%', '31.960%', '34.460%', '36.010%', '37.730%', '40.040%', '33.380%', '40.980%', '35.970%']
Workers DSSGD     accuracies:  ['9.060%', '11.860%', '17.110%', '21.800%', '27.520%', '37.450%', '45.710%', '50.380%', '53.360%', '54.020%', '54.680%', '54.750%', '54.310%', '54.760%', '52.900%', '52.370%', '50.420%', '49.840%', '48.780%', '47.370%']

Workers before    accuracies:  ['7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%']
Workers CFFL      accuracies:  ['50.230%', '59.980%', '67.280%', '65.010%', '67.620%', '59.660%', '75.260%', '63.990%', '63.990%', '78.010%', '75.290%', '75.550%', '69.800%', '76.010%', '65.730%', '78.020%', '77.390%', '80.210%', '84.400%', '86.670%']

Workers before pr accuracies:  ['9.550%', '10.790%', '13.530%', '12.620%', '13.850%', '14.350%', '15.020%', '23.870%', '23.020%', '22.360%', '27.160%', '30.730%', '31.610%', '34.440%', '36.310%', '37.440%', '38.750%', '33.460%', '41.130%', '35.920%']
Workers CFFL pret accuracies:  ['35.620%', '53.280%', '65.820%', '62.920%', '62.290%', '57.810%', '70.400%', '64.010%', '63.140%', '78.670%', '74.130%', '72.080%', '70.180%', '74.320%', '67.970%', '76.970%', '80.150%', '79.540%', '83.370%', '84.550%']

Epoch 21:
credits, credit threshold: tensor(0.0333)
tensor([0.0491, 0.0494, 0.0495, 0.0500, 0.0500, 0.0498, 0.0501, 0.0498, 0.0500,
        0.0502, 0.0498, 0.0501, 0.0502, 0.0502, 0.0501, 0.0503, 0.0505, 0.0505,
        0.0503, 0.0501])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0487, 0.0497, 0.0497, 0.0498, 0.0499, 0.0501, 0.0500, 0.0499, 0.0501,
        0.0502, 0.0502, 0.0499, 0.0502, 0.0501, 0.0503, 0.0501, 0.0501, 0.0504,
        0.0503, 0.0503])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['46.430%', '49.860%', '61.190%', '69.840%', '74.180%', '79.410%', '81.360%', '80.500%', '84.290%', '84.030%', '85.140%', '85.940%', '86.150%', '86.770%', '87.210%', '87.870%', '88.020%', '87.730%', '88.280%', '88.750%']
Workers DSSGD     accuracies:  ['75.460%', '75.190%', '74.740%', '74.290%', '73.650%', '72.740%', '71.950%', '71.080%', '70.070%', '69.360%', '68.960%', '68.320%', '67.990%', '67.910%', '67.800%', '68.300%', '68.800%', '69.420%', '69.770%', '70.370%']

Workers before    accuracies:  ['7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%']
Workers CFFL      accuracies:  ['63.040%', '64.850%', '62.510%', '67.370%', '62.100%', '66.140%', '66.470%', '68.100%', '67.930%', '66.070%', '64.760%', '71.530%', '68.150%', '65.870%', '67.160%', '63.850%', '66.630%', '63.950%', '60.110%', '65.970%']

Workers before pr accuracies:  ['9.550%', '10.790%', '13.530%', '12.620%', '13.850%', '14.350%', '15.020%', '23.870%', '23.020%', '22.360%', '27.160%', '30.730%', '31.610%', '34.440%', '36.310%', '37.440%', '38.750%', '33.460%', '41.130%', '35.920%']
Workers CFFL pret accuracies:  ['57.970%', '66.100%', '62.710%', '61.610%', '64.430%', '69.190%', '69.480%', '64.840%', '67.520%', '66.250%', '68.580%', '67.930%', '69.880%', '69.270%', '67.200%', '68.220%', '71.310%', '70.420%', '68.660%', '70.650%']

Epoch 41:
credits, credit threshold: tensor(0.0333)
tensor([0.0500, 0.0499, 0.0500, 0.0498, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501,
        0.0498, 0.0500, 0.0501, 0.0499, 0.0502, 0.0502, 0.0499, 0.0502, 0.0499,
        0.0499, 0.0501])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0498, 0.0499, 0.0498, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0499, 0.0501, 0.0499, 0.0501, 0.0500, 0.0500, 0.0501,
        0.0501, 0.0499])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['53.320%', '57.770%', '72.550%', '79.860%', '80.360%', '83.590%', '84.780%', '83.800%', '86.530%', '86.270%', '86.580%', '87.530%', '87.260%', '87.740%', '88.100%', '88.320%', '88.690%', '88.390%', '88.580%', '89.470%']
Workers DSSGD     accuracies:  ['86.980%', '87.090%', '87.320%', '87.580%', '87.890%', '88.160%', '88.440%', '88.550%', '88.920%', '88.890%', '88.670%', '88.260%', '87.810%', '87.080%', '86.130%', '85.240%', '84.310%', '83.370%', '82.590%', '82.130%']

Workers before    accuracies:  ['7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%']
Workers CFFL      accuracies:  ['79.650%', '78.290%', '77.700%', '79.290%', '74.050%', '76.700%', '78.610%', '77.060%', '79.940%', '77.800%', '77.200%', '80.460%', '78.420%', '79.330%', '78.200%', '79.490%', '83.260%', '79.610%', '79.050%', '81.290%']

Workers before pr accuracies:  ['9.550%', '10.790%', '13.530%', '12.620%', '13.850%', '14.350%', '15.020%', '23.870%', '23.020%', '22.360%', '27.160%', '30.730%', '31.610%', '34.440%', '36.310%', '37.440%', '38.750%', '33.460%', '41.130%', '35.920%']
Workers CFFL pret accuracies:  ['63.190%', '73.740%', '68.420%', '73.130%', '69.110%', '73.470%', '71.600%', '75.500%', '69.400%', '69.400%', '64.590%', '85.430%', '69.010%', '73.560%', '75.380%', '71.730%', '68.530%', '71.880%', '73.750%', '72.240%']

Epoch 61:
credits, credit threshold: tensor(0.0333)
tensor([0.0495, 0.0500, 0.0495, 0.0502, 0.0501, 0.0501, 0.0497, 0.0502, 0.0500,
        0.0503, 0.0501, 0.0499, 0.0499, 0.0502, 0.0500, 0.0497, 0.0502, 0.0502,
        0.0499, 0.0501])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0502, 0.0500, 0.0501,
        0.0500, 0.0501])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['57.960%', '63.140%', '75.310%', '81.910%', '81.730%', '84.610%', '85.410%', '84.530%', '87.100%', '86.620%', '86.770%', '87.640%', '87.610%', '88.000%', '88.260%', '88.510%', '88.770%', '88.510%', '88.630%', '89.470%']
Workers DSSGD     accuracies:  ['91.860%', '91.830%', '91.830%', '91.890%', '91.920%', '92.030%', '92.000%', '91.980%', '92.140%', '92.180%', '92.240%', '92.410%', '92.760%', '92.980%', '93.200%', '93.200%', '93.360%', '93.410%', '93.320%', '93.270%']

Workers before    accuracies:  ['7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%']
Workers CFFL      accuracies:  ['78.620%', '82.420%', '85.370%', '87.340%', '84.660%', '87.050%', '86.950%', '83.410%', '86.950%', '86.950%', '88.200%', '88.400%', '88.350%', '87.570%', '86.620%', '88.810%', '87.770%', '85.300%', '86.330%', '87.950%']

Workers before pr accuracies:  ['9.550%', '10.790%', '13.530%', '12.620%', '13.850%', '14.350%', '15.020%', '23.870%', '23.020%', '22.360%', '27.160%', '30.730%', '31.610%', '34.440%', '36.310%', '37.440%', '38.750%', '33.460%', '41.130%', '35.920%']
Workers CFFL pret accuracies:  ['82.870%', '86.660%', '88.530%', '88.980%', '88.040%', '89.490%', '89.980%', '88.640%', '90.220%', '90.400%', '90.020%', '90.990%', '90.180%', '90.490%', '91.240%', '91.170%', '91.590%', '92.240%', '91.550%', '91.770%']

Epoch 81:
credits, credit threshold: tensor(0.0333)
tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['60.080%', '66.140%', '76.280%', '82.610%', '82.050%', '84.940%', '85.730%', '84.510%', '87.170%', '86.740%', '86.830%', '87.740%', '87.660%', '88.110%', '88.270%', '88.570%', '89.000%', '88.550%', '88.660%', '89.510%']
Workers DSSGD     accuracies:  ['93.720%', '93.720%', '93.710%', '93.700%', '93.760%', '93.740%', '93.690%', '93.710%', '93.730%', '93.750%', '93.800%', '93.840%', '93.840%', '93.850%', '93.860%', '93.850%', '93.910%', '93.950%', '93.930%', '93.930%']

Workers before    accuracies:  ['7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%', '7.220%']
Workers CFFL      accuracies:  ['81.040%', '86.670%', '88.000%', '89.840%', '88.970%', '89.600%', '90.570%', '88.640%', '90.270%', '90.970%', '90.960%', '91.390%', '90.950%', '91.120%', '91.760%', '91.640%', '91.250%', '92.310%', '91.560%', '92.120%']

Workers before pr accuracies:  ['9.550%', '10.790%', '13.530%', '12.620%', '13.850%', '14.350%', '15.020%', '23.870%', '23.020%', '22.360%', '27.160%', '30.730%', '31.610%', '34.440%', '36.310%', '37.440%', '38.750%', '33.460%', '41.130%', '35.920%']
Workers CFFL pret accuracies:  ['83.390%', '86.800%', '88.700%', '89.050%', '88.250%', '89.650%', '90.080%', '88.820%', '90.430%', '90.710%', '90.220%', '90.950%', '90.490%', '90.960%', '91.240%', '91.360%', '91.710%', '92.220%', '91.560%', '91.750%']
pretraining 2.4283030033111572
evaluation after pretraining 5.4974284172058105
workers local training 575.736129283905
gradient clipping and filtering 180.51359939575195
gradient clipping and filtering for pretrain 178.42595076560974
server aggregation dssgd 175.8609323501587
credit updates 0.780658483505249
aggregate gradients and update FL model 1.2316703796386719
assign updates 27.064491987228394
performance update 1097.3452777862549
total seconds 2244.8844418525696
Time_dict-----
{"pretraining": 2.4283030033111572, "evaluation after pretraining": 5.4974284172058105, "workers local training": 575.736129283905, "gradient clipping and filtering": 180.51359939575195, "gradient clipping and filtering for pretrain": 178.42595076560974, "server aggregation dssgd": 175.8609323501587, "credit updates": 0.780658483505249, "aggregate gradients and update FL model": 1.2316703796386719, "assign updates": 27.064491987228394, "performance update": 1097.3452777862549}
-----
Performance and Fairness analysis:
Worker credits : [0.05000636354088783, 0.05000636354088783, 0.050010234117507935, 0.0500144436955452, 0.0500144436955452, 0.050010405480861664, 0.049990441650152206, 0.049967553466558456, 0.049987345933914185, 0.05001138523221016, 0.04998673126101494, 0.04996752738952637, 0.05001528188586235, 0.050010569393634796, 0.04999123141169548, 0.05001060664653778, 0.04996754974126816, 0.05000635236501694, 0.050014521926641464, 0.05001059174537659]
Number of reputable parties:  20
Worker credits pretrain: [0.04999731853604317, 0.0499882698059082, 0.0499953031539917, 0.049997225403785706, 0.05000589042901993, 0.049997612833976746, 0.04999931901693344, 0.049995679408311844, 0.04999541491270065, 0.050008367747068405, 0.049988552927970886, 0.0499841645359993, 0.05000799521803856, 0.05001923441886902, 0.05000081658363342, 0.04999902844429016, 0.04999830946326256, 0.04999769851565361, 0.05001741275191307, 0.0500064492225647]
Number of reputable parties with pretrain:  20
----Results without pretrain
standalone_best_worker  -  0.8862999677658081
CFFL_best_worker  -  0.9231999516487122
rr_dssgd_best  -  0.9422000050544739
standlone_vs_rrdssgd  -  [0.26157762667754664]
standalone_vs_final  -  [0.951364010098493]
----
----Results with pretrain
standalone_best_worker  -  0.8862999677658081
CFFL_best_worker  -  0.9220999479293823
rr_dssgd_best  -  0.9422000050544739
standlone_vs_rrdssgd  -  [0.26157762667754664]
standalone_vs_final  -  [0.9500278876734716]
----
for all without pretraining:
standalone_vs_final_mean [0.951364010098493]
standlone_vs_rrdssgd_mean [0.26157762667754664]
rr_dssgd_best_mean 0.9422000050544739
CFFL_best_worker_mean 0.9231999516487122
standalone_best_worker_mean 0.8862999677658081

for all the pretraining included:
standalone_vs_final_mean [0.9500278876734716]
standlone_vs_rrdssgd_mean [0.26157762667754664]
rr_dssgd_best_mean 0.9422000050544739
CFFL_best_worker_mean 0.9220999479293823
standalone_best_worker_mean 0.8862999677658081
