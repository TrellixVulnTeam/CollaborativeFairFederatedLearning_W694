Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'save_gpu': True, 'dataset': 'mr', 'sample_size_cap': 5000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 32, 'train_val_split_ratio': 0.9, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNN_Text'>, 'embed_num': 20000, 'embed_dim': 300, 'class_num': 2, 'kernel_num': 128, 'kernel_sizes': [3, 4, 5], 'optimizer_fn': <class 'torch.optim.adam.Adam'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 1e-05, 'dssgd_lr': 0.0001, 'lr': 0.0001, 'grad_clip': 1, 'gamma': 1, 'pretrain_epochs': 1, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_ids': [0]} 

Model embedding arguments: Namespace(class_num=2, embed_dim=128, embed_num=21109, kernel_num=128, kernel_sizes=[3, 4, 5], label_field=<torchtext.data.field.LabelField object at 0x7f88f00b1290>, static=False, text_field=<torchtext.data.field.Field object at 0x7f88f00b1a90>)

Experiment : No.1/5
CFFL server model validation accuracy : 48.7805%
CFFL server model test accuracy : 50.2814%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1932, 0.1941, 0.1951, 0.2179, 0.1997])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1978, 0.1988, 0.1998, 0.2018, 0.2018])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['53.471%', '51.782%', '55.535%', '54.784%', '52.908%']
Workers DSSGD     accuracies:  ['53.471%', '54.221%', '55.722%', '57.786%', '58.537%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['59.099%', '59.099%', '59.099%', '59.099%', '59.099%']

Workers before pr accuracies:  ['51.595%', '50.657%', '52.908%', '53.846%', '51.970%']
Workers CFFL pret accuracies:  ['54.409%', '55.159%', '55.347%', '55.535%', '54.972%']

Epoch 21:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2299, 0.2643, 0.2692, 0.2366])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1820, 0.1915, 0.2034, 0.2272, 0.1959])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['54.221%', '58.537%', '64.916%', '66.604%', '60.225%']
Workers DSSGD     accuracies:  ['54.034%', '50.657%', '50.469%', '50.469%', '50.469%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['62.852%', '51.782%', '51.782%', '51.782%', '51.782%']

Workers before pr accuracies:  ['51.595%', '50.657%', '52.908%', '53.846%', '51.970%']
Workers CFFL pret accuracies:  ['50.094%', '50.094%', '50.094%', '50.094%', '50.094%']

Epoch 41:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2505, 0.2516, 0.2486, 0.2493])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1833, 0.1948, 0.2126, 0.2136, 0.1957])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['53.471%', '60.788%', '66.041%', '68.856%', '62.852%']
Workers DSSGD     accuracies:  ['66.604%', '63.415%', '60.600%', '64.916%', '68.293%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['64.353%', '67.730%', '67.355%', '66.979%', '67.167%']

Workers before pr accuracies:  ['51.595%', '50.657%', '52.908%', '53.846%', '51.970%']
Workers CFFL pret accuracies:  ['53.283%', '53.283%', '53.096%', '53.096%', '53.283%']

Epoch 61:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2459, 0.2552, 0.2510, 0.2479])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1869, 0.1948, 0.2121, 0.2066, 0.1995])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['53.659%', '60.413%', '67.167%', '70.919%', '63.602%']
Workers DSSGD     accuracies:  ['71.670%', '71.295%', '71.107%', '68.480%', '68.480%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['64.165%', '69.606%', '69.606%', '69.794%', '69.794%']

Workers before pr accuracies:  ['51.595%', '50.657%', '52.908%', '53.846%', '51.970%']
Workers CFFL pret accuracies:  ['56.285%', '56.098%', '55.535%', '55.722%', '56.098%']

Epoch 81:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2500, 0.2469, 0.2521, 0.2510])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1859, 0.1998, 0.2055, 0.2073, 0.2014])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['53.659%', '60.976%', '66.229%', '70.544%', '63.790%']
Workers DSSGD     accuracies:  ['73.171%', '72.983%', '73.734%', '73.921%', '72.608%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['63.977%', '72.045%', '71.482%', '71.482%', '71.670%']

Workers before pr accuracies:  ['51.595%', '50.657%', '52.908%', '53.846%', '51.970%']
Workers CFFL pret accuracies:  ['62.664%', '62.664%', '62.289%', '62.477%', '62.289%']
pretraining 3.8515830039978027
evaluation after pretraining 0.3269340991973877
workers local training 3641.593663454056
server aggregation 65.0555510520935
server aggregation with pretraining 66.24691271781921
server aggregation dssgd 35.20471262931824
fed model eval on valid loader 3.5402584075927734
credit updates 0.639641284942627
assign updates 12.929579734802246
performance update 36.53308820724487
total seconds 3865.9219245910645
Time_dict-----
{"pretraining": 3.8515830039978027, "evaluation after pretraining": 0.3269340991973877, "workers local training": 3641.593663454056, "server aggregation": 65.0555510520935, "server aggregation with pretraining": 66.24691271781921, "server aggregation dssgd": 35.20471262931824, "fed model eval on valid loader": 3.5402584075927734, "credit updates": 0.639641284942627, "assign updates": 12.929579734802246, "performance update": 36.53308820724487}
-----
Performance and Fairness analysis: 
Worker credits : [0.0, 0.2489246428012848, 0.24897228181362152, 0.2530989348888397, 0.24900411069393158]
Number of reputable parties:  4
Worker credits pretrain: [0.1998548060655594, 0.19988436996936798, 0.19907166063785553, 0.20133550465106964, 0.19985361397266388]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.709193229675293
CFFL_best_worker  -  0.7242026329040527
rr_dssgd_best  -  0.7485928535461426
standlone_vs_rrdssgd  -  [0.57286006075642]
standalone_vs_final  -  [0.820992316134293]
----
----Results with pretrain
standalone_best_worker  -  0.5253283381462097
CFFL_best_worker  -  0.7185741066932678
rr_dssgd_best  -  0.7429643273353577
standlone_vs_rrdssgd  -  [0.57286006075642]
standalone_vs_final  -  [-0.9775223883604306]
----

Experiment : No.2/5
CFFL server model validation accuracy : 53.8462%
CFFL server model test accuracy : 49.7186%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1869, 0.1986, 0.2117, 0.2126, 0.1902])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2000, 0.2072, 0.1955, 0.1964, 0.2009])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['49.719%', '50.281%', '51.970%', '53.659%', '49.719%']
Workers DSSGD     accuracies:  ['49.906%', '56.660%', '56.473%', '58.349%', '58.537%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['58.349%', '57.974%', '58.349%', '58.349%', '58.537%']

Workers before pr accuracies:  ['49.719%', '50.844%', '49.719%', '49.719%', '50.469%']
Workers CFFL pret accuracies:  ['53.846%', '52.158%', '51.970%', '52.158%', '52.158%']

Epoch 21:
credits, credit threshold: tensor(0.1667)
tensor([0.1820, 0.1990, 0.2039, 0.2152, 0.2000])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.2222)
tensor([0.0000, 0.2305, 0.2464, 0.2892, 0.2339])
Reputable parties pretrain:  [1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['54.034%', '59.662%', '61.914%', '65.666%', '59.287%']
Workers DSSGD     accuracies:  ['50.657%', '50.469%', '60.600%', '50.281%', '49.531%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['61.914%', '61.726%', '62.101%', '62.101%', '61.914%']

Workers before pr accuracies:  ['49.719%', '50.844%', '49.719%', '49.719%', '50.469%']
Workers CFFL pret accuracies:  ['58.537%', '52.720%', '52.720%', '52.908%', '52.720%']

Epoch 41:
credits, credit threshold: tensor(0.1667)
tensor([0.2001, 0.2001, 0.1999, 0.1999, 0.2000])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties pretrain:  [3]
Below are testset accuracies: ---
Workers standalone accuracies:  ['54.409%', '61.726%', '62.289%', '67.917%', '61.914%']
Workers DSSGD     accuracies:  ['67.167%', '68.293%', '65.478%', '63.039%', '63.227%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['66.979%', '66.417%', '67.167%', '67.167%', '67.542%']

Workers before pr accuracies:  ['49.719%', '50.844%', '49.719%', '49.719%', '50.469%']
Workers CFFL pret accuracies:  ['56.848%', '65.854%', '65.103%', '66.792%', '64.916%']

Epoch 61:
credits, credit threshold: tensor(0.1667)
tensor([0.2005, 0.2005, 0.2014, 0.1999, 0.1977])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties pretrain:  [3]
Below are testset accuracies: ---
Workers standalone accuracies:  ['54.597%', '62.852%', '63.039%', '68.293%', '60.600%']
Workers DSSGD     accuracies:  ['70.544%', '70.544%', '72.233%', '71.107%', '69.794%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['71.295%', '71.107%', '70.356%', '71.107%', '70.732%']

Workers before pr accuracies:  ['49.719%', '50.844%', '49.719%', '49.719%', '50.469%']
Workers CFFL pret accuracies:  ['56.848%', '66.792%', '65.478%', '67.917%', '66.229%']

Epoch 81:
credits, credit threshold: tensor(0.1667)
tensor([0.2003, 0.1988, 0.1996, 0.2018, 0.1995])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties pretrain:  [3]
Below are testset accuracies: ---
Workers standalone accuracies:  ['55.159%', '63.977%', '63.227%', '68.668%', '62.289%']
Workers DSSGD     accuracies:  ['71.107%', '71.107%', '71.482%', '71.107%', '71.107%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['70.919%', '70.544%', '70.732%', '70.732%', '70.732%']

Workers before pr accuracies:  ['49.719%', '50.844%', '49.719%', '49.719%', '50.469%']
Workers CFFL pret accuracies:  ['57.223%', '67.355%', '66.041%', '68.668%', '66.417%']
pretraining 2.328904867172241
evaluation after pretraining 0.2925078868865967
workers local training 3660.1344397068024
server aggregation 64.99290728569031
server aggregation with pretraining 66.75873684883118
server aggregation dssgd 35.26825189590454
fed model eval on valid loader 3.7444820404052734
credit updates 0.5641977787017822
assign updates 13.149345397949219
performance update 36.34280490875244
total seconds 3883.576578617096
Time_dict-----
{"pretraining": 2.328904867172241, "evaluation after pretraining": 0.2925078868865967, "workers local training": 3660.1344397068024, "server aggregation": 64.99290728569031, "server aggregation with pretraining": 66.75873684883118, "server aggregation dssgd": 35.26825189590454, "fed model eval on valid loader": 3.7444820404052734, "credit updates": 0.5641977787017822, "assign updates": 13.149345397949219, "performance update": 36.34280490875244}
-----
Performance and Fairness analysis: 
Worker credits : [0.20027633011341095, 0.20030592381954193, 0.20097044110298157, 0.19814373552799225, 0.2003035992383957]
Number of reputable parties:  5
Worker credits pretrain: [0.0, 0.0, 0.0, 1.0, 0.0]
Number of reputable parties with pretrain:  1
----Results without pretrain
standalone_best_worker  -  0.6285178065299988
CFFL_best_worker  -  0.7242026329040527
rr_dssgd_best  -  0.7016885280609131
standlone_vs_rrdssgd  -  [0.16491498169209082]
standalone_vs_final  -  [0.12155371151628647]
----
----Results with pretrain
standalone_best_worker  -  0.6604127883911133
CFFL_best_worker  -  0.692307710647583
rr_dssgd_best  -  0.7035647034645081
standlone_vs_rrdssgd  -  [0.16491498169209082]
standalone_vs_final  -  [0.9797124712894405]
----

Experiment : No.3/5
CFFL server model validation accuracy : 51.4071%
CFFL server model test accuracy : 49.5310%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1959, 0.1941, 0.2060, 0.2089, 0.1950])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2023, 0.1975, 0.2004, 0.1994, 0.2004])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['50.844%', '49.156%', '53.096%', '51.970%', '49.156%']
Workers DSSGD     accuracies:  ['50.469%', '51.595%', '52.158%', '53.283%', '50.657%']

Workers before    accuracies:  ['49.531%', '49.531%', '49.531%', '49.531%', '49.531%']
Workers CFFL      accuracies:  ['54.409%', '54.409%', '54.034%', '54.034%', '54.409%']

Workers before pr accuracies:  ['49.531%', '50.281%', '51.220%', '50.469%', '50.281%']
Workers CFFL pret accuracies:  ['50.469%', '50.469%', '50.469%', '50.469%', '50.469%']

Epoch 21:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1900, 0.1928, 0.2011, 0.2242, 0.1920])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['51.595%', '57.786%', '65.291%', '65.666%', '57.411%']
Workers DSSGD     accuracies:  ['50.094%', '51.032%', '61.538%', '52.533%', '50.657%']

Workers before    accuracies:  ['49.531%', '49.531%', '49.531%', '49.531%', '49.531%']
Workers CFFL      accuracies:  ['58.161%', '51.595%', '63.039%', '69.606%', '54.221%']

Workers before pr accuracies:  ['49.531%', '50.281%', '51.220%', '50.469%', '50.281%']
Workers CFFL pret accuracies:  ['53.096%', '52.720%', '52.720%', '52.533%', '52.720%']

Epoch 41:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1846, 0.1924, 0.2046, 0.2253, 0.1932])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['53.096%', '59.662%', '68.856%', '67.355%', '58.161%']
Workers DSSGD     accuracies:  ['62.101%', '63.415%', '67.355%', '66.604%', '64.540%']

Workers before    accuracies:  ['49.531%', '49.531%', '49.531%', '49.531%', '49.531%']
Workers CFFL      accuracies:  ['60.225%', '57.223%', '64.165%', '70.169%', '56.848%']

Workers before pr accuracies:  ['49.531%', '50.281%', '51.220%', '50.469%', '50.281%']
Workers CFFL pret accuracies:  ['57.599%', '56.848%', '56.848%', '56.473%', '56.848%']

Epoch 61:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1848, 0.1940, 0.2066, 0.2181, 0.1965])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['52.908%', '60.788%', '69.231%', '66.792%', '60.413%']
Workers DSSGD     accuracies:  ['69.418%', '68.668%', '69.418%', '70.356%', '70.356%']

Workers before    accuracies:  ['49.531%', '49.531%', '49.531%', '49.531%', '49.531%']
Workers CFFL      accuracies:  ['60.600%', '59.287%', '65.478%', '72.045%', '58.349%']

Workers before pr accuracies:  ['49.531%', '50.281%', '51.220%', '50.469%', '50.281%']
Workers CFFL pret accuracies:  ['59.099%', '59.099%', '58.724%', '58.349%', '59.099%']

Epoch 81:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 1., 0.])
Reputable parties:  [3]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1922, 0.1984, 0.1975, 0.2135, 0.1985])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['54.409%', '61.163%', '67.542%', '69.231%', '60.600%']
Workers DSSGD     accuracies:  ['70.544%', '70.356%', '70.169%', '69.794%', '69.981%']

Workers before    accuracies:  ['49.531%', '49.531%', '49.531%', '49.531%', '49.531%']
Workers CFFL      accuracies:  ['60.600%', '59.287%', '65.854%', '71.295%', '60.038%']

Workers before pr accuracies:  ['49.531%', '50.281%', '51.220%', '50.469%', '50.281%']
Workers CFFL pret accuracies:  ['64.728%', '65.103%', '65.478%', '65.291%', '65.291%']
pretraining 2.3250467777252197
evaluation after pretraining 0.26608991622924805
workers local training 3658.112293243408
server aggregation 65.29596662521362
server aggregation with pretraining 66.42530345916748
server aggregation dssgd 35.357088804244995
fed model eval on valid loader 3.5562078952789307
credit updates 0.6362440586090088
assign updates 13.21302342414856
performance update 36.015559673309326
total seconds 3881.2028238773346
Time_dict-----
{"pretraining": 2.3250467777252197, "evaluation after pretraining": 0.26608991622924805, "workers local training": 3658.112293243408, "server aggregation": 65.29596662521362, "server aggregation with pretraining": 66.42530345916748, "server aggregation dssgd": 35.357088804244995, "fed model eval on valid loader": 3.5562078952789307, "credit updates": 0.6362440586090088, "assign updates": 13.21302342414856, "performance update": 36.015559673309326}
-----
Performance and Fairness analysis: 
Worker credits : [0.0, 0.0, 0.0, 1.0, 0.0]
Number of reputable parties:  1
Worker credits pretrain: [0.19953271746635437, 0.2016860693693161, 0.20033878087997437, 0.1981923133134842, 0.20025016367435455]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.6829268336296082
CFFL_best_worker  -  0.7242026329040527
rr_dssgd_best  -  0.709193229675293
standlone_vs_rrdssgd  -  [0.6670653050054063]
standalone_vs_final  -  [0.7212552357938551]
----
----Results with pretrain
standalone_best_worker  -  0.692307710647583
CFFL_best_worker  -  0.705440878868103
rr_dssgd_best  -  0.7129455804824829
standlone_vs_rrdssgd  -  [0.6670653050054063]
standalone_vs_final  -  [-0.20329991733163633]
----

Experiment : No.4/5
CFFL server model validation accuracy : 48.0300%
CFFL server model test accuracy : 49.7186%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1971, 0.1898, 0.1971, 0.2094, 0.2065])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1975, 0.1986, 0.2016, 0.2016, 0.2006])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['53.283%', '53.846%', '54.034%', '55.159%', '52.158%']
Workers DSSGD     accuracies:  ['54.972%', '56.660%', '54.972%', '54.972%', '51.595%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['55.159%', '56.098%', '55.159%', '54.784%', '54.784%']

Workers before pr accuracies:  ['50.094%', '49.343%', '52.720%', '54.409%', '49.156%']
Workers CFFL pret accuracies:  ['52.533%', '50.469%', '50.094%', '49.719%', '50.469%']

Epoch 21:
credits, credit threshold: tensor(0.1667)
tensor([0.1777, 0.1942, 0.2141, 0.2188, 0.1953])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1841, 0.1896, 0.2079, 0.2279, 0.1905])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['54.784%', '58.349%', '61.538%', '65.478%', '59.662%']
Workers DSSGD     accuracies:  ['50.281%', '50.657%', '61.538%', '52.533%', '50.281%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['50.469%', '50.469%', '50.469%', '50.469%', '50.469%']

Workers before pr accuracies:  ['50.094%', '49.343%', '52.720%', '54.409%', '49.156%']
Workers CFFL pret accuracies:  ['50.469%', '50.469%', '50.094%', '50.094%', '50.281%']

Epoch 41:
credits, credit threshold: tensor(0.1667)
tensor([0.1884, 0.2028, 0.2017, 0.2011, 0.2060])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1788, 0.1921, 0.2109, 0.2228, 0.1954])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['56.473%', '58.349%', '65.666%', '67.167%', '59.287%']
Workers DSSGD     accuracies:  ['62.477%', '63.415%', '66.417%', '66.604%', '67.355%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['60.413%', '60.038%', '60.225%', '60.225%', '60.038%']

Workers before pr accuracies:  ['50.094%', '49.343%', '52.720%', '54.409%', '49.156%']
Workers CFFL pret accuracies:  ['53.096%', '53.283%', '53.283%', '52.908%', '52.908%']

Epoch 61:
credits, credit threshold: tensor(0.1667)
tensor([0.1999, 0.1993, 0.2000, 0.2008, 0.2000])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1818, 0.1938, 0.2048, 0.2201, 0.1995])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['56.660%', '58.161%', '64.165%', '68.856%', '60.413%']
Workers DSSGD     accuracies:  ['69.794%', '69.418%', '68.856%', '69.981%', '69.981%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['69.606%', '69.418%', '69.418%', '69.418%', '69.231%']

Workers before pr accuracies:  ['50.094%', '49.343%', '52.720%', '54.409%', '49.156%']
Workers CFFL pret accuracies:  ['56.848%', '56.660%', '56.848%', '56.660%', '56.848%']

Epoch 81:
credits, credit threshold: tensor(0.1667)
tensor([0.2007, 0.2000, 0.2014, 0.2001, 0.1978])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1898, 0.1947, 0.2081, 0.2133, 0.1940])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['56.473%', '59.475%', '63.039%', '67.730%', '61.914%']
Workers DSSGD     accuracies:  ['68.668%', '69.043%', '69.231%', '70.919%', '70.919%']

Workers before    accuracies:  ['49.719%', '49.719%', '49.719%', '49.719%', '49.719%']
Workers CFFL      accuracies:  ['70.544%', '70.169%', '70.732%', '70.544%', '69.794%']

Workers before pr accuracies:  ['50.094%', '49.343%', '52.720%', '54.409%', '49.156%']
Workers CFFL pret accuracies:  ['65.291%', '65.103%', '64.540%', '63.977%', '65.291%']
pretraining 2.3234291076660156
evaluation after pretraining 0.27260398864746094
workers local training 3658.0327858924866
server aggregation 65.4576587677002
server aggregation with pretraining 66.73533129692078
server aggregation dssgd 35.21254873275757
fed model eval on valid loader 3.6246626377105713
credit updates 0.59482741355896
assign updates 13.705680131912231
performance update 36.46010780334473
total seconds 3882.419635772705
Time_dict-----
{"pretraining": 2.3234291076660156, "evaluation after pretraining": 0.27260398864746094, "workers local training": 3658.0327858924866, "server aggregation": 65.4576587677002, "server aggregation with pretraining": 66.73533129692078, "server aggregation dssgd": 35.21254873275757, "fed model eval on valid loader": 3.6246626377105713, "credit updates": 0.59482741355896, "assign updates": 13.705680131912231, "performance update": 36.46010780334473}
-----
Performance and Fairness analysis: 
Worker credits : [0.1996813863515854, 0.1983119696378708, 0.1996481865644455, 0.2033773809671402, 0.19898106157779694]
Number of reputable parties:  5
Worker credits pretrain: [0.19998309016227722, 0.20001037418842316, 0.1985265165567398, 0.20146963000297546, 0.20001041889190674]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.6641650795936584
CFFL_best_worker  -  0.7166979312896729
rr_dssgd_best  -  0.692307710647583
standlone_vs_rrdssgd  -  [-0.444212670962397]
standalone_vs_final  -  [0.8899875935640483]
----
----Results with pretrain
standalone_best_worker  -  0.6566604375839233
CFFL_best_worker  -  0.6810506582260132
rr_dssgd_best  -  0.7110694050788879
standlone_vs_rrdssgd  -  [-0.444212670962397]
standalone_vs_final  -  [0.975398643743272]
----

Experiment : No.5/5
CFFL server model validation accuracy : 48.5929%
CFFL server model test accuracy : 50.2814%

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.1955, 0.1946, 0.2018, 0.2045, 0.2036])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2058, 0.1998, 0.1968, 0.1958, 0.2018])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['48.780%', '51.782%', '54.972%', '56.848%', '51.407%']
Workers DSSGD     accuracies:  ['50.469%', '53.846%', '54.034%', '55.159%', '52.158%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['56.098%', '56.098%', '55.910%', '55.910%', '55.910%']

Workers before pr accuracies:  ['50.281%', '50.281%', '51.782%', '48.780%', '49.906%']
Workers CFFL pret accuracies:  ['53.846%', '51.220%', '49.906%', '49.531%', '50.844%']

Epoch 21:
credits, credit threshold: tensor(0.1667)
tensor([0.1867, 0.1940, 0.2083, 0.2092, 0.2017])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1886, 0.1925, 0.2045, 0.2221, 0.1924])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['55.722%', '60.225%', '61.914%', '67.167%', '60.976%']
Workers DSSGD     accuracies:  ['51.220%', '53.846%', '62.289%', '52.533%', '50.657%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['55.910%', '55.910%', '56.098%', '55.535%', '55.910%']

Workers before pr accuracies:  ['50.281%', '50.281%', '51.782%', '48.780%', '49.906%']
Workers CFFL pret accuracies:  ['50.281%', '50.094%', '50.094%', '50.094%', '50.094%']

Epoch 41:
credits, credit threshold: tensor(0.1667)
tensor([0.1953, 0.2013, 0.2014, 0.2007, 0.2014])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1932, 0.1925, 0.1997, 0.2170, 0.1976])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['57.411%', '61.914%', '63.227%', '67.917%', '63.227%']
Workers DSSGD     accuracies:  ['63.227%', '63.790%', '63.977%', '66.604%', '66.417%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['66.792%', '66.792%', '66.792%', '67.355%', '66.604%']

Workers before pr accuracies:  ['50.281%', '50.281%', '51.782%', '48.780%', '49.906%']
Workers CFFL pret accuracies:  ['54.034%', '53.846%', '53.846%', '53.659%', '53.846%']

Epoch 61:
credits, credit threshold: tensor(0.1667)
tensor([0.1931, 0.2003, 0.2028, 0.2057, 0.1981])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1914, 0.1958, 0.2045, 0.2125, 0.1958])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['57.411%', '61.726%', '63.977%', '69.418%', '63.415%']
Workers DSSGD     accuracies:  ['67.917%', '66.979%', '66.229%', '66.979%', '67.355%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['62.664%', '62.852%', '63.227%', '63.977%', '62.664%']

Workers before pr accuracies:  ['50.281%', '50.281%', '51.782%', '48.780%', '49.906%']
Workers CFFL pret accuracies:  ['57.974%', '57.599%', '56.848%', '57.223%', '57.599%']

Epoch 81:
credits, credit threshold: tensor(0.1667)
tensor([0.1992, 0.1971, 0.2030, 0.2038, 0.1970])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1886, 0.1977, 0.2012, 0.2123, 0.2002])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['57.599%', '62.664%', '64.916%', '67.917%', '62.477%']
Workers DSSGD     accuracies:  ['69.606%', '68.293%', '68.856%', '67.730%', '67.542%']

Workers before    accuracies:  ['50.281%', '50.281%', '50.281%', '50.281%', '50.281%']
Workers CFFL      accuracies:  ['66.604%', '66.979%', '67.355%', '67.542%', '66.604%']

Workers before pr accuracies:  ['50.281%', '50.281%', '51.782%', '48.780%', '49.906%']
Workers CFFL pret accuracies:  ['62.101%', '61.914%', '61.351%', '60.976%', '62.101%']
pretraining 2.358854293823242
evaluation after pretraining 0.27880001068115234
workers local training 3657.8373992443085
server aggregation 65.05843567848206
server aggregation with pretraining 66.71545696258545
server aggregation dssgd 35.687743186950684
fed model eval on valid loader 3.4554030895233154
credit updates 0.6172125339508057
assign updates 13.766150712966919
performance update 36.438172817230225
total seconds 3882.2136285305023
Time_dict-----
{"pretraining": 2.358854293823242, "evaluation after pretraining": 0.27880001068115234, "workers local training": 3657.8373992443085, "server aggregation": 65.05843567848206, "server aggregation with pretraining": 66.71545696258545, "server aggregation dssgd": 35.687743186950684, "fed model eval on valid loader": 3.4554030895233154, "credit updates": 0.6172125339508057, "assign updates": 13.766150712966919, "performance update": 36.438172817230225}
-----
Performance and Fairness analysis: 
Worker credits : [0.19966822862625122, 0.19897139072418213, 0.19972434639930725, 0.1990627497434616, 0.2025732696056366]
Number of reputable parties:  5
Worker credits pretrain: [0.19973109662532806, 0.2006031721830368, 0.20367039740085602, 0.19455036520957947, 0.20144489407539368]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.6885553598403931
CFFL_best_worker  -  0.6979362368583679
rr_dssgd_best  -  0.7148217558860779
standlone_vs_rrdssgd  -  [0.27443330579772474]
standalone_vs_final  -  [0.9539462229377347]
----
----Results with pretrain
standalone_best_worker  -  0.6885553598403931
CFFL_best_worker  -  0.6848030090332031
rr_dssgd_best  -  0.7148217558860779
standlone_vs_rrdssgd  -  [0.27443330579772474]
standalone_vs_final  -  [0.858650926662849]
----


|        |   Distriubted |     CFFL |   CFFL pretrain |
|:-------|--------------:|---------:|----------------:|
| P5_0.1 |      0.247012 | 0.701547 |        0.326588 |
|               |   P5_0.1 |
|:--------------|---------:|
| Distributed   | 0.714071 |
| Standalone    | 0.684428 |
| CFFL          | 0.710694 |
| CFFL pretrain | 0.688555 |


Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'save_gpu': True, 'dataset': 'mr', 'sample_size_cap': 5000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 128, 'train_val_split_ratio': 0.9, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNN_Text'>, 'embed_num': 20000, 'embed_dim': 300, 'class_num': 2, 'kernel_num': 128, 'kernel_sizes': [3, 3, 3], 'static': False, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.0001, 'dssgd_lr': 0.0001, 'lr': 0.001, 'grad_clip': 0.001, 'gamma': 1, 'pretrain_epochs': 5, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'credit-sum', 'largest_criterion': 'all', 'device_ids': [0]}
Model embedding arguments: Namespace(class_num=2, embed_dim=300, embed_num=21109, kernel_num=128, kernel_sizes=[3, 3, 3], label_field=<torchtext.data.field.LabelField object at 0x7fc25b737910>, static=False, text_field=<torchtext.data.field.Field object at 0x7fc25b737710>)
Experiment : No.1/1
Shard sizes are:  [227, 1073, 1919, 2766, 3611]
CFFL server model validation accuracy : 49.3433%
CFFL server model test accuracy : 54.4090%

Epoch 1:
credits, credit threshold: tensor(0.1333)
tensor([0.1983, 0.2030, 0.1973, 0.2002, 0.2011])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1971, 0.2016, 0.2007, 0.1989, 0.2016])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['54.597%', '54.597%', '54.784%', '52.533%', '52.345%']
Workers DSSGD     accuracies:  ['54.784%', '54.972%', '52.720%', '52.158%', '50.844%']

Workers before    accuracies:  ['54.597%', '54.597%', '54.597%', '54.597%', '54.597%']
Workers CFFL      accuracies:  ['54.409%', '54.972%', '54.221%', '51.782%', '51.595%']

Workers before pr accuracies:  ['54.784%', '53.096%', '51.970%', '53.096%', '51.970%']
Workers CFFL pret accuracies:  ['54.784%', '53.096%', '51.782%', '53.096%', '51.970%']

Epoch 21:
credits, credit threshold: tensor(0.1333)
tensor([0.2052, 0.1991, 0.1984, 0.1983, 0.1989])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1923, 0.2002, 0.2032, 0.2014, 0.2029])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['52.158%', '52.533%', '51.970%', '51.595%', '51.220%']
Workers DSSGD     accuracies:  ['53.846%', '52.908%', '52.345%', '53.096%', '53.471%']

Workers before    accuracies:  ['54.597%', '54.597%', '54.597%', '54.597%', '54.597%']
Workers CFFL      accuracies:  ['57.786%', '57.974%', '60.225%', '58.161%', '58.161%']

Workers before pr accuracies:  ['54.784%', '53.096%', '51.970%', '53.096%', '51.970%']
Workers CFFL pret accuracies:  ['53.283%', '53.471%', '54.409%', '53.471%', '52.908%']

Epoch 41:
credits, credit threshold: tensor(0.1333)
tensor([0.2047, 0.1943, 0.1974, 0.2004, 0.2032])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2002, 0.1993, 0.1970, 0.2014, 0.2020])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['53.283%', '52.720%', '53.659%', '52.345%', '51.782%']
Workers DSSGD     accuracies:  ['53.659%', '52.908%', '53.283%', '53.471%', '53.846%']

Workers before    accuracies:  ['54.597%', '54.597%', '54.597%', '54.597%', '54.597%']
Workers CFFL      accuracies:  ['61.351%', '60.600%', '62.477%', '60.976%', '59.662%']

Workers before pr accuracies:  ['54.784%', '53.096%', '51.970%', '53.096%', '51.970%']
Workers CFFL pret accuracies:  ['54.409%', '54.784%', '54.221%', '54.034%', '54.784%']

Epoch 61:
credits, credit threshold: tensor(0.1333)
tensor([0.2047, 0.1945, 0.1980, 0.2000, 0.2027])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2022, 0.1993, 0.1982, 0.2000, 0.2003])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['51.407%', '52.533%', '53.096%', '53.659%', '52.533%']
Workers DSSGD     accuracies:  ['53.659%', '54.221%', '54.034%', '53.846%', '54.221%']

Workers before    accuracies:  ['54.597%', '54.597%', '54.597%', '54.597%', '54.597%']
Workers CFFL      accuracies:  ['62.101%', '62.289%', '61.914%', '60.600%', '59.287%']

Workers before pr accuracies:  ['54.784%', '53.096%', '51.970%', '53.096%', '51.970%']
Workers CFFL pret accuracies:  ['55.910%', '56.848%', '55.347%', '55.347%', '55.347%']

Epoch 81:
credits, credit threshold: tensor(0.1333)
tensor([0.2017, 0.1976, 0.2004, 0.1977, 0.2027])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2019, 0.2009, 0.1993, 0.1981, 0.1999])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['51.407%', '53.283%', '52.908%', '54.034%', '53.096%']
Workers DSSGD     accuracies:  ['55.159%', '54.784%', '55.347%', '55.347%', '54.597%']

Workers before    accuracies:  ['54.597%', '54.597%', '54.597%', '54.597%', '54.597%']
Workers CFFL      accuracies:  ['61.351%', '62.289%', '63.039%', '61.538%', '60.225%']

Workers before pr accuracies:  ['54.784%', '53.096%', '51.970%', '53.096%', '51.970%']
Workers CFFL pret accuracies:  ['57.599%', '57.411%', '55.910%', '55.910%', '54.972%']
pretraining 8.878731966018677
evaluation after pretraining 0.409503698348999
workers local training 1961.1985864639282
server aggregation 103.33326244354248
server aggregation with pretraining 104.1430127620697
server aggregation dssgd 70.16434025764465
fed model eval on valid loader 5.550117492675781
credit updates 1.1803812980651855
assign updates 27.56846833229065
performance update 57.70892548561096
total seconds 2340.1353302001953
Time_dict-----
{"pretraining": 8.878731966018677, "evaluation after pretraining": 0.409503698348999, "workers local training": 1961.1985864639282, "server aggregation": 103.33326244354248, "server aggregation with pretraining": 104.1430127620697, "server aggregation dssgd": 70.16434025764465, "fed model eval on valid loader": 5.550117492675781, "credit updates": 1.1803812980651855, "assign updates": 27.56846833229065, "performance update": 57.70892548561096}
-----
Performance and Fairness analysis: 
Worker credits : [0.200132817029953, 0.19843903183937073, 0.20012113451957703, 0.20145449042320251, 0.1998525708913803]
Number of reputable parties:  5
Worker credits pretrain: [0.20334789156913757, 0.20108507573604584, 0.19911694526672363, 0.19885964691638947, 0.19759048521518707]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.5328330397605896
CFFL_best_worker  -  0.6341463327407837
rr_dssgd_best  -  0.5628517866134644
standlone_vs_rrdssgd  -  [0.5842557322743336]
standalone_vs_final  -  [-0.03644599521179988]
----
----Results with pretrain
standalone_best_worker  -  0.5328330397605896
CFFL_best_worker  -  0.5797373652458191
rr_dssgd_best  -  0.5628517866134644
standlone_vs_rrdssgd  -  [0.5842557322743336]
standalone_vs_final  -  [-0.6549722170790808]
----
for all without pretraining:
standalone_vs_final_mean [-0.03644599521179988]
standlone_vs_rrdssgd_mean [0.5842557322743336]
rr_dssgd_best_mean 0.5628517866134644
CFFL_best_worker_mean 0.6341463327407837
standalone_best_worker_mean 0.5328330397605896

for all the pretraining included:
standalone_vs_final_mean [-0.6549722170790808]
standlone_vs_rrdssgd_mean [0.5842557322743336]
rr_dssgd_best_mean 0.5628517866134644
CFFL_best_worker_mean 0.5797373652458191
standalone_best_worker_mean 0.5328330397605896
[Finished in 2349.5s]