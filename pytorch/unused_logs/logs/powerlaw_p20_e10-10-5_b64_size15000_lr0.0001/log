Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 15000, 'n_workers': 20, 'split': 'powerlaw', 'sharing_lambda': 0.1, 'batch_size': 64, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 10, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.689881. Accuracy: 57.0909%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 66.5333%
Leave-one-out validation accuracies :  ['66.5333%', '66.6000%', '66.8667%', '67.1333%', '67.6667%', '67.7333%', '67.8667%', '67.9333%', '68.1333%', '68.6667%', '69.0667%', '69.4000%', '69.8000%', '70.0667%', '70.4000%', '70.7333%', '71.0667%', '71.6000%', '72.0000%', '72.2667%']
Computed and normalized credits:  tensor([0.0534, 0.0533, 0.0529, 0.0526, 0.0518, 0.0517, 0.0516, 0.0515, 0.0512,
        0.0505, 0.0500, 0.0495, 0.0490, 0.0487, 0.0482, 0.0478, 0.0474, 0.0467,
        0.0462, 0.0459])
Federated model performance: Loss: 0.642310. Accuracy: 65.6043%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['56.620%', '56.684%', '56.642%', '56.941%', '56.963%', '57.134%', '57.241%', '57.476%', '57.369%', '57.668%', '57.840%', '57.797%', '57.711%', '58.139%', '58.032%', '58.310%', '58.353%', '58.353%', '58.695%', '58.567%']
Workers federated accuracies:  ['64.535%', '64.599%', '64.770%', '65.134%', '65.176%', '65.412%', '65.283%', '65.754%', '65.668%', '65.754%', '66.011%', '66.032%', '65.775%', '66.246%', '66.289%', '66.310%', '66.481%', '66.332%', '66.995%', '66.759%']
Workers improved  accuracies:  ['8.000%', '8.043%', '8.107%', '8.428%', '8.406%', '8.535%', '8.257%', '8.791%', '8.663%', '8.663%', '8.791%', '8.706%', '8.599%', '8.791%', '8.941%', '8.791%', '8.898%', '8.663%', '9.070%', '9.112%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 69.8000%
Leave-one-out validation accuracies :  ['69.8667%', '69.8000%', '69.9333%', '69.9333%', '70.0667%', '70.0667%', '70.1333%', '70.4000%', '70.5333%', '70.8000%', '70.6667%', '71.2667%', '71.4667%', '71.6000%', '72.0667%', '72.3333%', '72.4667%', '72.4667%', '72.7333%', '73.4667%']
Computed and normalized credits:  tensor([0.0518, 0.0519, 0.0517, 0.0517, 0.0515, 0.0514, 0.0513, 0.0510, 0.0508,
        0.0504, 0.0505, 0.0497, 0.0494, 0.0493, 0.0486, 0.0483, 0.0481, 0.0480,
        0.0476, 0.0467])
Federated model performance: Loss: 0.609777. Accuracy: 70.2460%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['56.684%', '56.663%', '56.877%', '57.112%', '57.219%', '57.455%', '57.540%', '57.775%', '57.797%', '57.989%', '58.481%', '58.460%', '58.310%', '58.759%', '58.588%', '58.824%', '59.144%', '59.123%', '59.786%', '59.380%']
Workers federated accuracies:  ['69.861%', '69.925%', '70.053%', '70.053%', '70.139%', '70.310%', '70.246%', '70.439%', '70.396%', '70.417%', '70.652%', '70.610%', '70.524%', '70.717%', '70.759%', '70.802%', '70.888%', '70.866%', '71.080%', '71.016%']
Workers improved  accuracies:  ['13.326%', '13.369%', '13.390%', '13.348%', '13.369%', '13.433%', '13.219%', '13.476%', '13.390%', '13.326%', '13.433%', '13.283%', '13.348%', '13.262%', '13.412%', '13.283%', '13.305%', '13.198%', '13.155%', '13.369%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 71.4000%
Leave-one-out validation accuracies :  ['71.4000%', '71.4667%', '71.4000%', '71.4000%', '71.4667%', '71.4667%', '71.8000%', '72.0000%', '72.0667%', '72.2667%', '72.5333%', '72.6000%', '72.7333%', '72.9333%', '72.9333%', '73.0667%', '73.2667%', '73.6000%', '73.7333%', '74.0667%']
Computed and normalized credits:  tensor([0.0514, 0.0513, 0.0514, 0.0514, 0.0513, 0.0513, 0.0509, 0.0506, 0.0505,
        0.0502, 0.0499, 0.0497, 0.0496, 0.0493, 0.0492, 0.0490, 0.0488, 0.0484,
        0.0482, 0.0477])
Federated model performance: Loss: 0.587013. Accuracy: 72.3850%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['56.706%', '56.877%', '56.984%', '57.369%', '57.497%', '57.711%', '57.840%', '58.289%', '58.310%', '58.417%', '59.037%', '59.294%', '58.717%', '59.551%', '59.422%', '59.701%', '60.193%', '60.107%', '60.642%', '60.321%']
Workers federated accuracies:  ['71.957%', '71.979%', '72.107%', '72.214%', '72.235%', '72.342%', '72.385%', '72.406%', '72.449%', '72.749%', '72.791%', '72.770%', '72.642%', '72.877%', '72.791%', '72.877%', '73.027%', '73.091%', '73.198%', '73.048%']
Workers improved  accuracies:  ['15.422%', '15.422%', '15.444%', '15.508%', '15.465%', '15.465%', '15.358%', '15.444%', '15.444%', '15.658%', '15.572%', '15.444%', '15.465%', '15.422%', '15.444%', '15.358%', '15.444%', '15.422%', '15.273%', '15.401%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 73.0667%
Leave-one-out validation accuracies :  ['73.0667%', '73.0667%', '73.0667%', '73.2000%', '73.2000%', '73.1333%', '73.1333%', '73.2000%', '73.2000%', '73.1333%', '73.2667%', '73.6000%', '73.6667%', '73.8667%', '74.1333%', '74.1333%', '74.2667%', '74.3333%', '74.4667%', '74.6000%']
Computed and normalized credits:  tensor([0.0507, 0.0507, 0.0507, 0.0506, 0.0506, 0.0506, 0.0506, 0.0505, 0.0505,
        0.0505, 0.0504, 0.0500, 0.0499, 0.0496, 0.0493, 0.0493, 0.0491, 0.0490,
        0.0488, 0.0486])
Federated model performance: Loss: 0.569906. Accuracy: 73.8824%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['56.813%', '56.984%', '57.198%', '57.583%', '57.690%', '58.182%', '58.353%', '58.802%', '58.652%', '59.059%', '59.743%', '60.043%', '59.422%', '60.406%', '60.193%', '60.513%', '60.877%', '60.770%', '61.668%', '61.070%']
Workers federated accuracies:  ['73.583%', '73.604%', '73.711%', '73.775%', '73.775%', '73.797%', '73.925%', '73.925%', '73.861%', '73.968%', '74.032%', '74.096%', '74.053%', '74.096%', '74.118%', '74.160%', '74.139%', '74.203%', '74.353%', '74.246%']
Workers improved  accuracies:  ['17.048%', '17.048%', '17.048%', '17.070%', '17.005%', '16.920%', '16.898%', '16.963%', '16.856%', '16.877%', '16.813%', '16.770%', '16.877%', '16.642%', '16.770%', '16.642%', '16.556%', '16.535%', '16.428%', '16.599%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 73.8667%
Leave-one-out validation accuracies :  ['73.8667%', '73.8667%', '73.9333%', '74.0667%', '74.0667%', '74.1333%', '74.2000%', '74.1333%', '74.2667%', '74.3333%', '74.2667%', '74.3333%', '74.3333%', '74.4667%', '74.7333%', '74.7333%', '74.9333%', '75.0667%', '75.4000%', '75.4667%']
Computed and normalized credits:  tensor([0.0507, 0.0507, 0.0506, 0.0505, 0.0505, 0.0504, 0.0503, 0.0504, 0.0502,
        0.0502, 0.0502, 0.0501, 0.0501, 0.0499, 0.0496, 0.0496, 0.0493, 0.0492,
        0.0488, 0.0487])
Federated model performance: Loss: 0.556735. Accuracy: 74.6096%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['56.877%', '57.091%', '57.219%', '57.861%', '57.925%', '58.545%', '58.652%', '59.380%', '59.380%', '59.401%', '60.406%', '60.663%', '60.021%', '61.048%', '60.941%', '61.176%', '61.904%', '61.647%', '62.503%', '61.925%']
Workers federated accuracies:  ['74.396%', '74.396%', '74.396%', '74.545%', '74.460%', '74.652%', '74.631%', '74.674%', '74.781%', '74.845%', '74.717%', '74.995%', '74.824%', '74.888%', '74.973%', '74.845%', '75.016%', '74.995%', '75.144%', '74.909%']
Workers improved  accuracies:  ['17.861%', '17.840%', '17.733%', '17.840%', '17.690%', '17.775%', '17.604%', '17.711%', '17.775%', '17.754%', '17.497%', '17.668%', '17.647%', '17.433%', '17.626%', '17.326%', '17.433%', '17.326%', '17.219%', '17.262%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 74.5333%
Leave-one-out validation accuracies :  ['74.5333%', '74.5333%', '74.5333%', '74.5333%', '74.6667%', '74.7333%', '74.6667%', '74.7333%', '74.8000%', '74.9333%', '74.9333%', '75.2000%', '75.4667%', '75.6000%', '75.5333%', '75.7333%', '75.7333%', '75.7333%', '75.8000%', '75.8000%']
Computed and normalized credits:  tensor([0.0507, 0.0507, 0.0507, 0.0507, 0.0506, 0.0505, 0.0505, 0.0505, 0.0504,
        0.0502, 0.0502, 0.0499, 0.0496, 0.0494, 0.0495, 0.0492, 0.0492, 0.0492,
        0.0491, 0.0491])
Federated model performance: Loss: 0.546115. Accuracy: 75.0802%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['56.963%', '57.198%', '57.476%', '58.096%', '58.225%', '58.995%', '59.123%', '60.000%', '59.893%', '60.107%', '60.920%', '61.412%', '60.706%', '61.861%', '61.412%', '61.754%', '62.588%', '62.396%', '63.251%', '62.866%']
Workers federated accuracies:  ['75.016%', '75.037%', '75.080%', '75.102%', '75.080%', '75.144%', '75.166%', '75.316%', '75.380%', '75.230%', '75.358%', '75.551%', '75.273%', '75.551%', '75.551%', '75.551%', '75.636%', '75.701%', '75.636%', '75.508%']
Workers improved  accuracies:  ['18.481%', '18.481%', '18.417%', '18.396%', '18.310%', '18.267%', '18.139%', '18.353%', '18.374%', '18.139%', '18.139%', '18.225%', '18.096%', '18.096%', '18.203%', '18.032%', '18.053%', '18.032%', '17.711%', '17.861%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 75.2667%
Leave-one-out validation accuracies :  ['75.2667%', '75.2667%', '75.2667%', '75.3333%', '75.4667%', '75.4667%', '75.4667%', '75.6000%', '75.6000%', '75.7333%', '75.8000%', '75.8667%', '75.8667%', '75.8667%', '75.9333%', '75.9333%', '75.8000%', '75.8000%', '75.8000%', '75.7333%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0505, 0.0504, 0.0503, 0.0502, 0.0502, 0.0501, 0.0501,
        0.0499, 0.0498, 0.0497, 0.0497, 0.0497, 0.0496, 0.0496, 0.0498, 0.0497,
        0.0497, 0.0498])
Federated model performance: Loss: 0.537328. Accuracy: 75.7005%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['57.091%', '57.348%', '57.668%', '58.246%', '58.588%', '59.273%', '59.529%', '60.449%', '60.364%', '60.706%', '61.626%', '61.947%', '61.048%', '62.053%', '62.032%', '62.588%', '63.358%', '63.230%', '64.299%', '63.829%']
Workers federated accuracies:  ['75.465%', '75.444%', '75.508%', '75.444%', '75.572%', '75.658%', '75.594%', '75.572%', '75.765%', '75.701%', '75.658%', '75.765%', '75.743%', '75.807%', '75.893%', '75.914%', '75.872%', '75.893%', '76.000%', '75.914%']
Workers improved  accuracies:  ['18.930%', '18.888%', '18.845%', '18.738%', '18.802%', '18.781%', '18.567%', '18.610%', '18.759%', '18.610%', '18.439%', '18.439%', '18.567%', '18.353%', '18.545%', '18.396%', '18.289%', '18.225%', '18.075%', '18.267%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 75.7333%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '75.9333%', '75.9333%', '75.9333%', '76.0000%', '75.9333%', '75.8000%', '75.7333%', '75.7333%', '75.8000%', '75.8000%', '75.8000%', '75.8667%', '75.8667%', '75.9333%', '76.0000%', '76.0667%', '76.1333%', '76.2000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0502,
        0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0498,
        0.0497, 0.0496])
Federated model performance: Loss: 0.529803. Accuracy: 75.7861%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['57.134%', '57.433%', '57.904%', '58.503%', '58.909%', '59.679%', '60.021%', '61.048%', '60.877%', '61.176%', '62.160%', '62.481%', '61.626%', '63.037%', '62.738%', '63.294%', '64.043%', '63.914%', '65.091%', '64.727%']
Workers federated accuracies:  ['75.679%', '75.722%', '75.807%', '75.701%', '75.743%', '75.807%', '75.807%', '75.872%', '75.957%', '76.021%', '75.914%', '76.064%', '75.979%', '75.914%', '76.000%', '76.086%', '76.043%', '76.128%', '76.128%', '76.064%']
Workers improved  accuracies:  ['19.144%', '19.166%', '19.144%', '18.995%', '18.973%', '18.930%', '18.781%', '18.909%', '18.952%', '18.930%', '18.695%', '18.738%', '18.802%', '18.460%', '18.652%', '18.567%', '18.460%', '18.460%', '18.203%', '18.417%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 75.8667%
Leave-one-out validation accuracies :  ['75.8000%', '75.8667%', '76.0000%', '75.9333%', '75.8667%', '75.8667%', '75.8667%', '75.9333%', '75.9333%', '76.1333%', '76.2000%', '76.1333%', '76.0667%', '76.2000%', '76.2667%', '76.4667%', '76.5333%', '76.5333%', '76.5333%', '76.4667%']
Computed and normalized credits:  tensor([0.0504, 0.0503, 0.0501, 0.0502, 0.0503, 0.0503, 0.0503, 0.0502, 0.0502,
        0.0500, 0.0499, 0.0500, 0.0501, 0.0499, 0.0498, 0.0496, 0.0495, 0.0495,
        0.0495, 0.0496])
Federated model performance: Loss: 0.523250. Accuracy: 76.0642%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['57.198%', '57.583%', '58.096%', '58.824%', '59.209%', '59.914%', '60.471%', '61.348%', '61.134%', '61.604%', '62.845%', '63.273%', '62.289%', '63.765%', '63.401%', '64.171%', '64.791%', '64.877%', '66.203%', '65.476%']
Workers federated accuracies:  ['75.829%', '75.872%', '75.957%', '76.021%', '76.021%', '76.000%', '76.000%', '75.979%', '76.171%', '76.171%', '76.128%', '76.235%', '76.235%', '76.235%', '76.278%', '76.364%', '76.214%', '76.364%', '76.364%', '76.278%']
Workers improved  accuracies:  ['19.294%', '19.316%', '19.294%', '19.316%', '19.251%', '19.123%', '18.973%', '19.016%', '19.166%', '19.080%', '18.909%', '18.909%', '19.059%', '18.781%', '18.930%', '18.845%', '18.631%', '18.695%', '18.439%', '18.631%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 76.0667%
Leave-one-out validation accuracies :  ['76.0667%', '76.1333%', '76.2000%', '76.1333%', '76.2667%', '76.2667%', '76.3333%', '76.3333%', '76.4000%', '76.4667%', '76.4667%', '76.4667%', '76.5333%', '76.4667%', '76.6000%', '76.6000%', '76.4667%', '76.6000%', '76.6000%', '76.6667%']
Computed and normalized credits:  tensor([0.0504, 0.0503, 0.0502, 0.0503, 0.0502, 0.0502, 0.0501, 0.0501, 0.0500,
        0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0498, 0.0497, 0.0499, 0.0497,
        0.0497, 0.0497])
Federated model performance: Loss: 0.517687. Accuracy: 76.2995%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['57.348%', '57.668%', '58.332%', '59.166%', '59.615%', '60.235%', '61.005%', '61.711%', '61.711%', '61.882%', '63.316%', '63.914%', '62.802%', '64.599%', '64.342%', '64.813%', '65.497%', '65.668%', '67.273%', '66.353%']
Workers federated accuracies:  ['76.086%', '76.086%', '76.150%', '76.193%', '76.128%', '76.214%', '76.214%', '76.150%', '76.406%', '76.214%', '76.214%', '76.342%', '76.364%', '76.449%', '76.428%', '76.556%', '76.578%', '76.535%', '76.556%', '76.449%']
Workers improved  accuracies:  ['19.551%', '19.529%', '19.487%', '19.487%', '19.358%', '19.337%', '19.187%', '19.187%', '19.401%', '19.123%', '18.995%', '19.016%', '19.187%', '18.995%', '19.080%', '19.037%', '18.995%', '18.866%', '18.631%', '18.802%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.517687. Accuracy: 76.2995%.
Workers before    accuracies:  ['56.535%', '56.556%', '56.663%', '56.706%', '56.770%', '56.877%', '57.027%', '56.963%', '57.005%', '57.091%', '57.219%', '57.326%', '57.176%', '57.455%', '57.348%', '57.519%', '57.583%', '57.668%', '57.925%', '57.647%']
Workers standlone accuracies:  ['57.348%', '57.668%', '58.332%', '59.166%', '59.615%', '60.235%', '61.005%', '61.711%', '61.711%', '61.882%', '63.316%', '63.914%', '62.802%', '64.599%', '64.342%', '64.813%', '65.497%', '65.668%', '67.273%', '66.353%']
Workers federated accuracies:  ['76.086%', '76.086%', '76.150%', '76.193%', '76.128%', '76.214%', '76.214%', '76.150%', '76.406%', '76.214%', '76.214%', '76.342%', '76.364%', '76.449%', '76.428%', '76.556%', '76.578%', '76.535%', '76.556%', '76.449%']
Workers improved  accuracies:  ['19.551%', '19.529%', '19.487%', '19.487%', '19.358%', '19.337%', '19.187%', '19.187%', '19.401%', '19.123%', '18.995%', '19.016%', '19.187%', '18.995%', '19.080%', '19.037%', '18.995%', '18.866%', '18.631%', '18.802%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.28372129390963574, 0.22541820321086356)
Correlation between stand alone test acc & collaborative final model acc:  (0.899409787792305, 6.916511134677324e-08)
Correlation between test_acc & sharing contributions:  (0.9071160423984559, 3.474605613781853e-08)
Correlation between test_acc improvements & sharing_contributions:  (-0.9371004108170595, 1.1633778808913393e-09)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.694046. Accuracy: 60.4492%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 65.6667%
Leave-one-out validation accuracies :  ['65.8000%', '66.0000%', '65.8000%', '65.8000%', '66.2000%', '66.4000%', '66.5333%', '66.7333%', '66.8667%', '67.5333%', '68.1333%', '68.3333%', '68.5333%', '68.8000%', '68.8667%', '69.4000%', '70.0667%', '70.2667%', '70.7333%', '70.9333%']
Computed and normalized credits:  tensor([0.0528, 0.0525, 0.0528, 0.0528, 0.0522, 0.0520, 0.0518, 0.0515, 0.0513,
        0.0504, 0.0496, 0.0494, 0.0491, 0.0488, 0.0487, 0.0480, 0.0471, 0.0469,
        0.0463, 0.0460])
Federated model performance: Loss: 0.654752. Accuracy: 64.8984%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['59.658%', '59.957%', '59.914%', '60.428%', '60.385%', '60.406%', '60.578%', '60.663%', '60.663%', '60.813%', '61.112%', '61.070%', '61.070%', '61.219%', '61.155%', '61.604%', '61.797%', '61.626%', '61.989%', '61.904%']
Workers federated accuracies:  ['64.278%', '64.492%', '64.492%', '64.727%', '64.684%', '64.791%', '64.856%', '64.963%', '64.963%', '64.984%', '65.176%', '65.155%', '65.176%', '65.241%', '65.262%', '65.369%', '65.690%', '65.390%', '65.818%', '65.668%']
Workers improved  accuracies:  ['4.642%', '4.770%', '4.727%', '4.663%', '4.663%', '4.770%', '4.749%', '4.599%', '4.556%', '4.620%', '4.599%', '4.556%', '4.599%', '4.471%', '4.599%', '4.513%', '4.642%', '4.449%', '4.727%', '4.578%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 68.5333%
Leave-one-out validation accuracies :  ['68.5333%', '68.6000%', '68.7333%', '68.9333%', '68.8667%', '68.8667%', '68.9333%', '69.0667%', '69.4000%', '69.8667%', '70.2000%', '70.4000%', '70.6000%', '70.9333%', '70.8000%', '71.1333%', '71.6000%', '71.6000%', '71.6667%', '71.7333%']
Computed and normalized credits:  tensor([0.0521, 0.0520, 0.0519, 0.0516, 0.0517, 0.0516, 0.0515, 0.0513, 0.0509,
        0.0502, 0.0497, 0.0495, 0.0492, 0.0487, 0.0489, 0.0484, 0.0478, 0.0477,
        0.0476, 0.0475])
Federated model performance: Loss: 0.623910. Accuracy: 68.5134%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['59.765%', '60.235%', '60.043%', '60.620%', '60.556%', '60.663%', '60.791%', '61.091%', '61.219%', '61.091%', '61.604%', '61.711%', '61.711%', '61.947%', '61.818%', '62.225%', '62.332%', '62.203%', '62.503%', '62.524%']
Workers federated accuracies:  ['67.914%', '68.000%', '68.064%', '68.385%', '68.321%', '68.492%', '68.492%', '68.684%', '68.620%', '68.663%', '68.877%', '68.877%', '68.941%', '69.091%', '68.898%', '69.198%', '69.198%', '69.219%', '69.433%', '69.390%']
Workers improved  accuracies:  ['8.278%', '8.278%', '8.299%', '8.321%', '8.299%', '8.471%', '8.385%', '8.321%', '8.214%', '8.299%', '8.299%', '8.278%', '8.364%', '8.321%', '8.235%', '8.342%', '8.150%', '8.278%', '8.342%', '8.299%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 70.8000%
Leave-one-out validation accuracies :  ['70.8000%', '70.8667%', '70.9333%', '70.9333%', '71.0000%', '71.0000%', '71.1333%', '71.2000%', '71.2000%', '71.5333%', '71.7333%', '71.7333%', '71.6000%', '71.7333%', '71.8667%', '72.0000%', '72.4000%', '72.6667%', '72.6000%', '72.7333%']
Computed and normalized credits:  tensor([0.0512, 0.0511, 0.0510, 0.0509, 0.0509, 0.0509, 0.0507, 0.0506, 0.0505,
        0.0501, 0.0498, 0.0498, 0.0499, 0.0497, 0.0496, 0.0493, 0.0488, 0.0485,
        0.0486, 0.0484])
Federated model performance: Loss: 0.599630. Accuracy: 70.5241%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['59.936%', '60.257%', '60.385%', '60.791%', '60.877%', '60.834%', '61.112%', '61.412%', '61.604%', '61.604%', '62.075%', '62.118%', '62.139%', '62.481%', '62.225%', '62.674%', '62.909%', '62.824%', '63.465%', '63.166%']
Workers federated accuracies:  ['70.053%', '70.289%', '70.374%', '70.460%', '70.417%', '70.481%', '70.567%', '70.610%', '70.652%', '70.738%', '70.909%', '70.952%', '70.995%', '70.973%', '70.995%', '71.166%', '71.144%', '71.059%', '71.251%', '71.209%']
Workers improved  accuracies:  ['10.417%', '10.567%', '10.610%', '10.396%', '10.396%', '10.460%', '10.460%', '10.246%', '10.246%', '10.374%', '10.332%', '10.353%', '10.417%', '10.203%', '10.332%', '10.310%', '10.096%', '10.118%', '10.160%', '10.118%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 71.9333%
Leave-one-out validation accuracies :  ['71.9333%', '71.9333%', '71.8667%', '71.8667%', '72.0000%', '71.9333%', '72.0667%', '72.1333%', '72.1333%', '72.2000%', '72.1333%', '72.2667%', '72.5333%', '72.8000%', '72.8000%', '72.9333%', '73.1333%', '73.0667%', '73.0667%', '73.4000%']
Computed and normalized credits:  tensor([0.0507, 0.0507, 0.0507, 0.0507, 0.0506, 0.0506, 0.0505, 0.0504, 0.0504,
        0.0503, 0.0503, 0.0501, 0.0498, 0.0495, 0.0495, 0.0493, 0.0490, 0.0491,
        0.0491, 0.0487])
Federated model performance: Loss: 0.580241. Accuracy: 71.7861%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['60.128%', '60.406%', '60.599%', '61.048%', '61.091%', '60.984%', '61.497%', '61.775%', '62.032%', '61.989%', '62.353%', '62.588%', '62.545%', '62.845%', '62.717%', '63.358%', '63.743%', '63.273%', '64.043%', '63.850%']
Workers federated accuracies:  ['71.444%', '71.636%', '71.679%', '71.701%', '71.743%', '71.807%', '71.829%', '71.786%', '71.893%', '71.957%', '71.957%', '72.086%', '72.021%', '72.128%', '72.021%', '72.364%', '72.428%', '72.321%', '72.471%', '72.492%']
Workers improved  accuracies:  ['11.807%', '11.914%', '11.914%', '11.636%', '11.722%', '11.786%', '11.722%', '11.422%', '11.487%', '11.594%', '11.380%', '11.487%', '11.444%', '11.358%', '11.358%', '11.508%', '11.380%', '11.380%', '11.380%', '11.401%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 72.2667%
Leave-one-out validation accuracies :  ['72.2667%', '72.3333%', '72.4667%', '72.6000%', '72.6667%', '72.6667%', '72.7333%', '72.9333%', '72.9333%', '73.0667%', '73.2000%', '73.2000%', '73.3333%', '73.2667%', '73.2667%', '73.4667%', '73.9333%', '74.0667%', '74.2667%', '74.4667%']
Computed and normalized credits:  tensor([0.0511, 0.0510, 0.0509, 0.0507, 0.0506, 0.0506, 0.0505, 0.0503, 0.0503,
        0.0501, 0.0500, 0.0500, 0.0498, 0.0498, 0.0498, 0.0496, 0.0490, 0.0488,
        0.0486, 0.0483])
Federated model performance: Loss: 0.564608. Accuracy: 72.7059%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['60.171%', '60.492%', '60.706%', '61.348%', '61.283%', '61.476%', '61.733%', '62.011%', '62.246%', '62.246%', '62.952%', '63.016%', '62.888%', '63.529%', '63.294%', '64.064%', '64.043%', '64.000%', '64.642%', '64.428%']
Workers federated accuracies:  ['72.257%', '72.385%', '72.513%', '72.620%', '72.663%', '72.599%', '72.813%', '72.834%', '72.984%', '72.941%', '73.048%', '73.027%', '73.027%', '72.920%', '73.070%', '73.091%', '73.155%', '73.005%', '73.176%', '73.176%']
Workers improved  accuracies:  ['12.620%', '12.663%', '12.749%', '12.556%', '12.642%', '12.578%', '12.706%', '12.471%', '12.578%', '12.578%', '12.471%', '12.428%', '12.449%', '12.150%', '12.406%', '12.235%', '12.107%', '12.064%', '12.086%', '12.086%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 73.4667%
Leave-one-out validation accuracies :  ['73.4667%', '73.5333%', '73.5333%', '73.4667%', '73.4667%', '73.5333%', '73.6667%', '73.7333%', '73.7333%', '74.0000%', '74.0667%', '74.3333%', '74.4667%', '74.4667%', '74.6000%', '74.7333%', '74.8667%', '75.1333%', '75.2000%', '75.4000%']
Computed and normalized credits:  tensor([0.0509, 0.0508, 0.0508, 0.0509, 0.0509, 0.0508, 0.0506, 0.0505, 0.0505,
        0.0502, 0.0501, 0.0498, 0.0496, 0.0496, 0.0495, 0.0493, 0.0491, 0.0488,
        0.0487, 0.0484])
Federated model performance: Loss: 0.551606. Accuracy: 73.3904%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['60.235%', '60.599%', '60.898%', '61.668%', '61.497%', '61.733%', '62.096%', '62.289%', '62.610%', '62.610%', '63.572%', '63.594%', '63.337%', '64.107%', '63.850%', '64.578%', '64.642%', '64.471%', '65.155%', '65.112%']
Workers federated accuracies:  ['73.091%', '73.134%', '73.198%', '73.369%', '73.283%', '73.433%', '73.305%', '73.262%', '73.433%', '73.540%', '73.497%', '73.540%', '73.647%', '73.540%', '73.540%', '73.668%', '73.840%', '73.733%', '73.925%', '73.925%']
Workers improved  accuracies:  ['13.455%', '13.412%', '13.433%', '13.305%', '13.262%', '13.412%', '13.198%', '12.898%', '13.027%', '13.176%', '12.920%', '12.941%', '13.070%', '12.770%', '12.877%', '12.813%', '12.791%', '12.791%', '12.834%', '12.834%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.4667%', '74.4667%', '74.4667%', '74.4000%', '74.3333%', '74.4000%', '74.6667%', '74.8000%', '74.6667%', '74.8000%', '74.8000%', '74.9333%', '74.9333%', '75.0667%', '75.2000%', '75.5333%', '75.6000%', '75.6667%', '75.6667%', '75.6667%']
Computed and normalized credits:  tensor([0.0506, 0.0506, 0.0506, 0.0507, 0.0508, 0.0507, 0.0504, 0.0502, 0.0503,
        0.0502, 0.0502, 0.0500, 0.0500, 0.0498, 0.0496, 0.0492, 0.0491, 0.0490,
        0.0490, 0.0490])
Federated model performance: Loss: 0.540430. Accuracy: 74.0107%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['60.321%', '60.749%', '61.048%', '61.947%', '61.797%', '61.925%', '62.332%', '62.460%', '62.866%', '62.995%', '63.979%', '63.893%', '63.914%', '64.321%', '64.086%', '65.134%', '65.091%', '65.027%', '65.733%', '65.604%']
Workers federated accuracies:  ['73.840%', '73.840%', '73.925%', '73.904%', '74.053%', '73.968%', '73.968%', '73.797%', '74.053%', '73.968%', '74.096%', '74.139%', '74.225%', '74.096%', '74.182%', '74.310%', '74.267%', '74.075%', '74.396%', '74.225%']
Workers improved  accuracies:  ['14.203%', '14.118%', '14.160%', '13.840%', '14.032%', '13.947%', '13.861%', '13.433%', '13.647%', '13.604%', '13.519%', '13.540%', '13.647%', '13.326%', '13.519%', '13.455%', '13.219%', '13.134%', '13.305%', '13.134%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 75.1333%
Leave-one-out validation accuracies :  ['75.1333%', '75.1333%', '75.2000%', '75.2667%', '75.2667%', '75.3333%', '75.3333%', '75.4000%', '75.4667%', '75.5333%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.7333%', '75.8667%', '75.9333%', '75.8667%', '75.8667%', '75.7333%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0504, 0.0504, 0.0504, 0.0503, 0.0502, 0.0502, 0.0501,
        0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0497, 0.0495, 0.0495, 0.0495,
        0.0495, 0.0497])
Federated model performance: Loss: 0.530799. Accuracy: 74.4599%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['60.428%', '60.898%', '61.176%', '62.118%', '62.032%', '62.225%', '62.481%', '62.952%', '63.251%', '63.487%', '64.193%', '64.342%', '64.385%', '64.749%', '64.492%', '65.540%', '65.711%', '65.219%', '66.267%', '66.246%']
Workers federated accuracies:  ['74.374%', '74.353%', '74.353%', '74.310%', '74.353%', '74.396%', '74.353%', '74.417%', '74.503%', '74.481%', '74.545%', '74.567%', '74.652%', '74.695%', '74.759%', '74.781%', '74.824%', '74.652%', '74.824%', '74.845%']
Workers improved  accuracies:  ['14.738%', '14.631%', '14.588%', '14.246%', '14.332%', '14.374%', '14.246%', '14.053%', '14.096%', '14.118%', '13.968%', '13.968%', '14.075%', '13.925%', '14.096%', '13.925%', '13.775%', '13.711%', '13.733%', '13.754%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 75.7333%
Leave-one-out validation accuracies :  ['75.7333%', '75.8000%', '75.8000%', '75.8667%', '75.9333%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '75.9333%', '75.9333%', '76.0000%', '75.9333%', '76.0000%', '76.1333%', '76.1333%', '76.1333%', '76.0000%', '75.9333%']
Computed and normalized credits:  tensor([0.0503, 0.0502, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0498, 0.0498, 0.0498,
        0.0499, 0.0500])
Federated model performance: Loss: 0.522578. Accuracy: 74.7808%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['60.578%', '61.176%', '61.241%', '62.353%', '62.289%', '62.310%', '62.845%', '63.337%', '63.722%', '63.914%', '64.513%', '64.706%', '64.727%', '65.198%', '64.898%', '65.882%', '66.353%', '65.604%', '66.845%', '66.588%']
Workers federated accuracies:  ['74.545%', '74.631%', '74.738%', '74.717%', '74.888%', '74.738%', '74.930%', '74.802%', '74.845%', '74.930%', '74.973%', '75.080%', '75.037%', '75.059%', '75.037%', '75.123%', '75.209%', '75.251%', '75.358%', '75.337%']
Workers improved  accuracies:  ['14.909%', '14.909%', '14.973%', '14.652%', '14.866%', '14.717%', '14.824%', '14.438%', '14.439%', '14.567%', '14.396%', '14.481%', '14.460%', '14.289%', '14.374%', '14.267%', '14.160%', '14.310%', '14.267%', '14.246%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 75.9333%
Leave-one-out validation accuracies :  ['75.9333%', '75.9333%', '75.9333%', '76.0000%', '76.0000%', '75.9333%', '75.9333%', '76.0667%', '76.0667%', '76.0000%', '76.0000%', '76.0667%', '76.0000%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.1333%', '76.1333%', '76.1333%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499,
        0.0499, 0.0499])
Federated model performance: Loss: 0.515530. Accuracy: 75.2513%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['60.535%', '61.198%', '61.326%', '62.524%', '62.610%', '62.524%', '63.123%', '63.743%', '64.128%', '64.150%', '64.834%', '65.112%', '65.048%', '65.647%', '65.198%', '66.417%', '66.695%', '66.203%', '67.273%', '66.973%']
Workers federated accuracies:  ['74.952%', '74.973%', '75.123%', '75.080%', '75.144%', '75.187%', '75.273%', '75.187%', '75.251%', '75.316%', '75.358%', '75.294%', '75.465%', '75.316%', '75.294%', '75.508%', '75.615%', '75.401%', '75.636%', '75.594%']
Workers improved  accuracies:  ['15.316%', '15.251%', '15.358%', '15.016%', '15.123%', '15.166%', '15.166%', '14.824%', '14.845%', '14.952%', '14.781%', '14.695%', '14.888%', '14.545%', '14.631%', '14.652%', '14.567%', '14.460%', '14.545%', '14.503%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.515530. Accuracy: 75.2513%.
Workers before    accuracies:  ['59.636%', '59.722%', '59.765%', '60.064%', '60.021%', '60.021%', '60.107%', '60.364%', '60.406%', '60.364%', '60.578%', '60.599%', '60.578%', '60.770%', '60.663%', '60.856%', '61.048%', '60.941%', '61.091%', '61.091%']
Workers standlone accuracies:  ['60.535%', '61.198%', '61.326%', '62.524%', '62.610%', '62.524%', '63.123%', '63.743%', '64.128%', '64.150%', '64.834%', '65.112%', '65.048%', '65.647%', '65.198%', '66.417%', '66.695%', '66.203%', '67.273%', '66.973%']
Workers federated accuracies:  ['74.952%', '74.973%', '75.123%', '75.080%', '75.144%', '75.187%', '75.273%', '75.187%', '75.251%', '75.316%', '75.358%', '75.294%', '75.465%', '75.316%', '75.294%', '75.508%', '75.615%', '75.401%', '75.636%', '75.594%']
Workers improved  accuracies:  ['15.316%', '15.251%', '15.358%', '15.016%', '15.123%', '15.166%', '15.166%', '14.824%', '14.845%', '14.952%', '14.781%', '14.695%', '14.888%', '14.545%', '14.631%', '14.652%', '14.567%', '14.460%', '14.545%', '14.503%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.12401806945949212, 0.6024140412789719)
Correlation between stand alone test acc & collaborative final model acc:  (0.9408956732879339, 6.738334113119983e-10)
Correlation between test_acc & sharing contributions:  (0.9326065821889277, 2.1292461960058756e-09)
Correlation between test_acc improvements & sharing_contributions:  (-0.9428959172158267, 4.979531053682514e-10)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.711433. Accuracy: 54.8663%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 63.7333%
Leave-one-out validation accuracies :  ['63.8000%', '64.2667%', '64.4000%', '64.5333%', '65.0000%', '65.3333%', '66.0000%', '66.6667%', '67.2667%', '67.6667%', '68.3333%', '68.5333%', '69.2667%', '70.6000%', '71.4000%', '71.4667%', '72.2000%', '72.8667%', '73.0667%', '73.3333%']
Computed and normalized credits:  tensor([0.0564, 0.0557, 0.0555, 0.0553, 0.0546, 0.0541, 0.0531, 0.0521, 0.0513,
        0.0507, 0.0498, 0.0495, 0.0485, 0.0467, 0.0457, 0.0456, 0.0447, 0.0439,
        0.0436, 0.0433])
Federated model performance: Loss: 0.652869. Accuracy: 61.4332%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.524%', '54.567%', '54.652%', '54.652%', '54.738%', '54.674%', '54.845%', '54.952%', '55.080%', '55.080%', '55.230%', '55.380%', '55.508%', '55.594%', '55.487%', '55.786%', '55.914%', '55.807%', '56.171%', '56.171%']
Workers federated accuracies:  ['60.684%', '60.791%', '60.877%', '61.070%', '61.176%', '61.134%', '61.155%', '61.326%', '61.626%', '61.519%', '61.668%', '61.647%', '61.711%', '61.818%', '61.775%', '61.989%', '62.160%', '62.118%', '62.481%', '62.374%']
Workers improved  accuracies:  ['6.225%', '6.310%', '6.353%', '6.460%', '6.588%', '6.417%', '6.460%', '6.610%', '6.952%', '6.802%', '6.759%', '6.631%', '6.717%', '6.717%', '6.738%', '6.802%', '6.845%', '6.845%', '7.016%', '6.909%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 69.0667%
Leave-one-out validation accuracies :  ['69.1333%', '69.3333%', '69.6667%', '69.8667%', '70.3333%', '70.4667%', '70.7333%', '71.2000%', '71.7333%', '71.6667%', '71.9333%', '72.7333%', '73.0667%', '73.3333%', '73.6000%', '73.6000%', '73.7333%', '73.7333%', '74.2667%', '74.4000%']
Computed and normalized credits:  tensor([0.0542, 0.0539, 0.0534, 0.0531, 0.0525, 0.0522, 0.0518, 0.0511, 0.0503,
        0.0504, 0.0499, 0.0489, 0.0484, 0.0479, 0.0475, 0.0475, 0.0472, 0.0471,
        0.0465, 0.0463])
Federated model performance: Loss: 0.612300. Accuracy: 67.2941%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.481%', '54.631%', '54.652%', '54.824%', '54.930%', '54.930%', '55.144%', '55.337%', '55.294%', '55.529%', '55.658%', '55.893%', '55.979%', '56.064%', '56.107%', '56.513%', '56.856%', '56.684%', '57.070%', '57.112%']
Workers federated accuracies:  ['66.866%', '66.909%', '66.909%', '67.037%', '67.037%', '67.080%', '67.273%', '67.294%', '67.529%', '67.422%', '67.722%', '67.722%', '67.850%', '67.872%', '67.872%', '68.021%', '68.214%', '68.150%', '68.471%', '68.321%']
Workers improved  accuracies:  ['12.406%', '12.428%', '12.385%', '12.428%', '12.449%', '12.364%', '12.578%', '12.578%', '12.856%', '12.706%', '12.813%', '12.706%', '12.856%', '12.770%', '12.834%', '12.834%', '12.898%', '12.877%', '13.005%', '12.856%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 72.8000%
Leave-one-out validation accuracies :  ['72.8667%', '73.0000%', '72.9333%', '73.1333%', '73.1333%', '73.2000%', '73.2000%', '73.6667%', '73.6667%', '73.4667%', '73.5333%', '73.8000%', '74.0000%', '74.3333%', '74.4667%', '74.5333%', '74.6667%', '74.3333%', '74.7333%', '74.8667%']
Computed and normalized credits:  tensor([0.0515, 0.0513, 0.0513, 0.0511, 0.0510, 0.0509, 0.0508, 0.0502, 0.0502,
        0.0504, 0.0503, 0.0499, 0.0496, 0.0491, 0.0489, 0.0489, 0.0487, 0.0491,
        0.0485, 0.0484])
Federated model performance: Loss: 0.583370. Accuracy: 70.4385%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.567%', '54.631%', '54.802%', '54.973%', '55.187%', '55.187%', '55.358%', '55.658%', '55.615%', '55.872%', '56.021%', '56.449%', '56.578%', '56.898%', '56.684%', '57.305%', '57.497%', '57.412%', '57.989%', '57.947%']
Workers federated accuracies:  ['70.032%', '70.139%', '70.118%', '70.267%', '70.310%', '70.417%', '70.417%', '70.503%', '70.631%', '70.759%', '70.738%', '70.802%', '70.995%', '70.802%', '70.845%', '70.973%', '71.294%', '71.123%', '71.594%', '71.337%']
Workers improved  accuracies:  ['15.572%', '15.658%', '15.594%', '15.658%', '15.722%', '15.701%', '15.722%', '15.786%', '15.957%', '16.043%', '15.829%', '15.786%', '16.000%', '15.701%', '15.807%', '15.786%', '15.979%', '15.850%', '16.128%', '15.872%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 73.7333%
Leave-one-out validation accuracies :  ['73.8667%', '74.0667%', '74.0667%', '74.0000%', '74.2000%', '74.3333%', '74.5333%', '74.4667%', '74.6000%', '74.7333%', '74.5333%', '74.8667%', '74.8000%', '74.8667%', '74.8667%', '74.9333%', '75.0667%', '75.1333%', '75.2667%', '75.3333%']
Computed and normalized credits:  tensor([0.0510, 0.0508, 0.0508, 0.0508, 0.0506, 0.0504, 0.0502, 0.0502, 0.0500,
        0.0499, 0.0501, 0.0497, 0.0498, 0.0496, 0.0496, 0.0495, 0.0494, 0.0493,
        0.0491, 0.0490])
Federated model performance: Loss: 0.562208. Accuracy: 72.7487%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.567%', '54.717%', '54.888%', '55.209%', '55.380%', '55.380%', '55.743%', '55.872%', '55.872%', '56.364%', '56.663%', '57.198%', '57.241%', '57.519%', '57.176%', '57.840%', '58.246%', '58.203%', '58.610%', '58.717%']
Workers federated accuracies:  ['72.299%', '72.235%', '72.257%', '72.428%', '72.364%', '72.449%', '72.513%', '72.556%', '72.770%', '72.834%', '72.813%', '72.920%', '73.027%', '72.877%', '72.813%', '73.176%', '73.283%', '73.091%', '73.348%', '73.262%']
Workers improved  accuracies:  ['17.840%', '17.754%', '17.733%', '17.818%', '17.775%', '17.733%', '17.818%', '17.840%', '18.096%', '18.118%', '17.904%', '17.904%', '18.032%', '17.775%', '17.775%', '17.989%', '17.968%', '17.818%', '17.882%', '17.797%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 75.0667%
Leave-one-out validation accuracies :  ['75.0667%', '75.0000%', '75.0000%', '75.0667%', '75.0000%', '75.0667%', '75.0667%', '74.9333%', '74.9333%', '74.9333%', '75.0667%', '75.1333%', '75.0667%', '75.2000%', '75.2000%', '75.3333%', '75.5333%', '75.3333%', '75.3333%', '75.3333%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0501, 0.0502, 0.0502,
        0.0502, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0497, 0.0495, 0.0497,
        0.0497, 0.0497])
Federated model performance: Loss: 0.545738. Accuracy: 73.7754%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.674%', '54.866%', '54.995%', '55.401%', '55.679%', '55.658%', '56.000%', '56.385%', '56.513%', '56.749%', '57.305%', '57.583%', '57.711%', '57.989%', '57.840%', '58.588%', '58.888%', '58.717%', '59.337%', '59.337%']
Workers federated accuracies:  ['73.348%', '73.497%', '73.455%', '73.604%', '73.519%', '73.668%', '73.647%', '73.583%', '73.818%', '73.840%', '73.711%', '73.925%', '73.925%', '73.904%', '73.861%', '74.139%', '74.139%', '74.011%', '74.267%', '74.203%']
Workers improved  accuracies:  ['18.888%', '19.016%', '18.930%', '18.995%', '18.930%', '18.952%', '18.952%', '18.866%', '19.144%', '19.123%', '18.802%', '18.909%', '18.930%', '18.802%', '18.824%', '18.952%', '18.824%', '18.738%', '18.802%', '18.738%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 75.1333%
Leave-one-out validation accuracies :  ['75.2000%', '75.2000%', '75.2000%', '75.2667%', '75.2667%', '75.2000%', '75.2667%', '75.2000%', '75.3333%', '75.4000%', '75.4000%', '75.4667%', '75.4667%', '75.6000%', '75.6000%', '75.6667%', '75.5333%', '75.6667%', '75.7333%', '75.8000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0502, 0.0502, 0.0503, 0.0502, 0.0503, 0.0501,
        0.0500, 0.0500, 0.0499, 0.0500, 0.0498, 0.0498, 0.0497, 0.0498, 0.0497,
        0.0496, 0.0495])
Federated model performance: Loss: 0.532726. Accuracy: 74.5241%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.781%', '55.016%', '55.037%', '55.615%', '55.850%', '55.850%', '56.214%', '56.620%', '56.877%', '57.198%', '57.604%', '58.267%', '58.203%', '58.674%', '58.396%', '58.973%', '59.529%', '59.230%', '60.043%', '59.893%']
Workers federated accuracies:  ['74.160%', '74.053%', '74.139%', '74.160%', '74.160%', '74.246%', '74.225%', '74.374%', '74.503%', '74.460%', '74.481%', '74.545%', '74.674%', '74.631%', '74.545%', '74.759%', '74.824%', '74.695%', '74.952%', '74.866%']
Workers improved  accuracies:  ['19.701%', '19.572%', '19.615%', '19.551%', '19.572%', '19.529%', '19.529%', '19.658%', '19.829%', '19.743%', '19.572%', '19.529%', '19.679%', '19.529%', '19.508%', '19.572%', '19.508%', '19.422%', '19.487%', '19.401%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.6000%', '75.6667%', '75.6000%', '75.5333%', '75.5333%', '75.6000%', '75.5333%', '75.5333%', '75.5333%', '75.5333%', '75.5333%', '75.4667%', '75.6000%', '75.6000%', '75.5333%', '75.6667%', '75.7333%', '75.7333%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0501, 0.0501, 0.0500, 0.0501,
        0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499,
        0.0498, 0.0498])
Federated model performance: Loss: 0.522556. Accuracy: 74.9519%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.845%', '55.123%', '55.144%', '55.872%', '56.214%', '56.128%', '56.663%', '57.155%', '57.348%', '57.540%', '58.203%', '58.802%', '58.802%', '59.123%', '58.845%', '59.658%', '60.000%', '59.914%', '60.834%', '60.492%']
Workers federated accuracies:  ['74.567%', '74.695%', '74.802%', '74.695%', '74.802%', '74.824%', '74.888%', '74.717%', '74.888%', '75.144%', '75.037%', '75.080%', '75.123%', '75.230%', '75.037%', '75.294%', '75.251%', '75.187%', '75.422%', '75.251%']
Workers improved  accuracies:  ['20.107%', '20.214%', '20.278%', '20.086%', '20.214%', '20.107%', '20.193%', '20.000%', '20.214%', '20.428%', '20.128%', '20.064%', '20.128%', '20.128%', '20.000%', '20.107%', '19.936%', '19.914%', '19.957%', '19.786%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 75.5333%
Leave-one-out validation accuracies :  ['75.5333%', '75.5333%', '75.4667%', '75.4667%', '75.4667%', '75.5333%', '75.7333%', '75.8000%', '75.6667%', '75.7333%', '75.7333%', '75.8000%', '75.9333%', '76.0667%', '76.0667%', '76.1333%', '76.1333%', '76.1333%', '76.2000%', '76.2667%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0504, 0.0504, 0.0504, 0.0503, 0.0501, 0.0500, 0.0502,
        0.0501, 0.0501, 0.0500, 0.0499, 0.0497, 0.0497, 0.0496, 0.0496, 0.0496,
        0.0496, 0.0495])
Federated model performance: Loss: 0.513535. Accuracy: 75.3583%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.930%', '55.337%', '55.422%', '56.064%', '56.471%', '56.299%', '57.070%', '57.561%', '57.733%', '57.989%', '58.396%', '59.187%', '59.251%', '59.936%', '59.316%', '60.193%', '60.492%', '60.535%', '61.519%', '61.134%']
Workers federated accuracies:  ['74.973%', '75.123%', '75.187%', '75.166%', '75.166%', '75.273%', '75.337%', '75.380%', '75.380%', '75.487%', '75.401%', '75.444%', '75.401%', '75.487%', '75.444%', '75.465%', '75.529%', '75.444%', '75.529%', '75.594%']
Workers improved  accuracies:  ['20.513%', '20.642%', '20.663%', '20.556%', '20.578%', '20.556%', '20.642%', '20.663%', '20.706%', '20.770%', '20.492%', '20.428%', '20.406%', '20.385%', '20.406%', '20.278%', '20.214%', '20.171%', '20.064%', '20.128%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '75.7333%', '75.8000%', '75.8000%', '75.9333%', '76.0000%', '76.0667%', '76.0667%', '76.0667%', '76.1333%', '76.1333%', '76.1333%', '76.2000%', '76.3333%', '76.3333%', '76.2000%', '76.2000%', '76.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0504, 0.0503, 0.0503, 0.0502, 0.0501, 0.0500, 0.0500,
        0.0500, 0.0499, 0.0499, 0.0499, 0.0498, 0.0497, 0.0497, 0.0498, 0.0498,
        0.0498, 0.0498])
Federated model performance: Loss: 0.505956. Accuracy: 75.8075%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['54.930%', '55.380%', '55.465%', '56.086%', '56.749%', '56.556%', '57.369%', '57.861%', '58.118%', '58.460%', '59.166%', '59.636%', '59.743%', '60.257%', '59.765%', '60.513%', '61.219%', '61.070%', '62.332%', '62.053%']
Workers federated accuracies:  ['75.487%', '75.508%', '75.444%', '75.487%', '75.422%', '75.551%', '75.465%', '75.594%', '75.529%', '75.594%', '75.594%', '75.615%', '75.679%', '75.679%', '75.572%', '75.743%', '75.743%', '75.594%', '75.743%', '75.701%']
Workers improved  accuracies:  ['21.027%', '21.027%', '20.920%', '20.877%', '20.834%', '20.834%', '20.770%', '20.877%', '20.856%', '20.877%', '20.684%', '20.599%', '20.684%', '20.578%', '20.535%', '20.556%', '20.428%', '20.321%', '20.278%', '20.235%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 76.1333%
Leave-one-out validation accuracies :  ['76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.2000%', '76.2000%', '76.2667%', '76.2667%', '76.3333%', '76.2667%', '76.3333%', '76.3333%', '76.4667%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501,
        0.0501, 0.0500, 0.0501, 0.0500, 0.0500, 0.0498, 0.0497, 0.0497, 0.0497,
        0.0497, 0.0497])
Federated model performance: Loss: 0.499611. Accuracy: 75.9144%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['55.037%', '55.572%', '55.594%', '56.535%', '57.027%', '56.684%', '57.626%', '58.053%', '58.374%', '58.695%', '59.422%', '59.979%', '60.278%', '60.599%', '60.257%', '61.412%', '61.925%', '61.754%', '63.037%', '62.610%']
Workers federated accuracies:  ['75.551%', '75.594%', '75.722%', '75.615%', '75.636%', '75.743%', '75.658%', '75.829%', '75.701%', '75.807%', '75.722%', '75.786%', '75.914%', '75.829%', '75.829%', '75.829%', '75.957%', '75.872%', '76.021%', '75.850%']
Workers improved  accuracies:  ['21.091%', '21.112%', '21.198%', '21.005%', '21.048%', '21.027%', '20.963%', '21.112%', '21.027%', '21.091%', '20.813%', '20.770%', '20.920%', '20.727%', '20.791%', '20.642%', '20.642%', '20.599%', '20.556%', '20.385%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.499611. Accuracy: 75.9144%.
Workers before    accuracies:  ['54.460%', '54.481%', '54.524%', '54.610%', '54.588%', '54.717%', '54.695%', '54.717%', '54.674%', '54.717%', '54.909%', '55.016%', '54.995%', '55.102%', '55.037%', '55.187%', '55.316%', '55.273%', '55.465%', '55.465%']
Workers standlone accuracies:  ['55.037%', '55.572%', '55.594%', '56.535%', '57.027%', '56.684%', '57.626%', '58.053%', '58.374%', '58.695%', '59.422%', '59.979%', '60.278%', '60.599%', '60.257%', '61.412%', '61.925%', '61.754%', '63.037%', '62.610%']
Workers federated accuracies:  ['75.551%', '75.594%', '75.722%', '75.615%', '75.636%', '75.743%', '75.658%', '75.829%', '75.701%', '75.807%', '75.722%', '75.786%', '75.914%', '75.829%', '75.829%', '75.829%', '75.957%', '75.872%', '76.021%', '75.850%']
Workers improved  accuracies:  ['21.091%', '21.112%', '21.198%', '21.005%', '21.048%', '21.027%', '20.963%', '21.112%', '21.027%', '21.091%', '20.813%', '20.770%', '20.920%', '20.727%', '20.791%', '20.642%', '20.642%', '20.599%', '20.556%', '20.385%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.3122996324798215, 0.18007109000799712)
Correlation between stand alone test acc & collaborative final model acc:  (0.8717494970611315, 5.546415678420611e-07)
Correlation between test_acc & sharing contributions:  (0.8650823145115291, 8.53246633966555e-07)
Correlation between test_acc improvements & sharing_contributions:  (-0.9121636740733533, 2.1414436708177297e-08)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.838832. Accuracy: 45.2193%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 53.6000%
Leave-one-out validation accuracies :  ['53.6667%', '53.7333%', '53.6000%', '53.8667%', '54.2000%', '54.6667%', '55.3333%', '55.8000%', '56.4667%', '57.6000%', '58.0667%', '58.8000%', '60.2667%', '61.8000%', '63.6000%', '64.8000%', '66.4000%', '66.6000%', '67.2667%', '68.1333%']
Computed and normalized credits:  tensor([0.0592, 0.0591, 0.0594, 0.0589, 0.0582, 0.0574, 0.0562, 0.0553, 0.0541,
        0.0521, 0.0513, 0.0501, 0.0477, 0.0453, 0.0427, 0.0410, 0.0389, 0.0386,
        0.0378, 0.0367])
Federated model performance: Loss: 0.757605. Accuracy: 51.5508%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['44.706%', '44.941%', '44.856%', '45.091%', '45.155%', '45.112%', '45.305%', '45.412%', '45.433%', '45.497%', '45.818%', '45.882%', '45.754%', '45.989%', '45.925%', '46.139%', '46.353%', '46.289%', '46.503%', '46.481%']
Workers federated accuracies:  ['50.631%', '50.695%', '50.759%', '51.059%', '51.209%', '51.144%', '51.316%', '51.422%', '51.508%', '51.594%', '51.807%', '51.914%', '51.893%', '52.171%', '52.128%', '52.364%', '52.406%', '52.406%', '52.727%', '52.642%']
Workers improved  accuracies:  ['5.989%', '5.904%', '5.947%', '6.182%', '6.246%', '6.225%', '6.267%', '6.225%', '6.353%', '6.374%', '6.545%', '6.545%', '6.545%', '6.802%', '6.738%', '6.738%', '6.652%', '6.695%', '6.930%', '6.781%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 60.0000%
Leave-one-out validation accuracies :  ['59.9333%', '60.4667%', '60.8000%', '61.2667%', '61.4667%', '62.3333%', '62.8000%', '63.4667%', '64.6000%', '65.2667%', '65.8667%', '66.8667%', '67.4000%', '67.7333%', '67.8667%', '68.0000%', '68.4667%', '68.8667%', '69.4000%', '69.8667%']
Computed and normalized credits:  tensor([0.0589, 0.0580, 0.0575, 0.0567, 0.0563, 0.0549, 0.0540, 0.0529, 0.0510,
        0.0498, 0.0489, 0.0473, 0.0463, 0.0456, 0.0452, 0.0448, 0.0439, 0.0434,
        0.0426, 0.0419])
Federated model performance: Loss: 0.700941. Accuracy: 59.9144%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['44.770%', '45.005%', '44.941%', '45.283%', '45.348%', '45.305%', '45.561%', '45.818%', '45.840%', '45.861%', '46.310%', '46.396%', '46.374%', '46.481%', '46.439%', '46.759%', '46.695%', '46.824%', '46.930%', '47.059%']
Workers federated accuracies:  ['58.417%', '59.102%', '58.930%', '59.487%', '59.444%', '59.508%', '59.829%', '59.765%', '60.086%', '60.299%', '60.535%', '60.727%', '60.513%', '61.027%', '60.663%', '60.877%', '61.348%', '61.134%', '61.797%', '61.540%']
Workers improved  accuracies:  ['13.775%', '14.310%', '14.118%', '14.610%', '14.481%', '14.588%', '14.781%', '14.567%', '14.930%', '15.080%', '15.273%', '15.358%', '15.166%', '15.658%', '15.273%', '15.251%', '15.594%', '15.422%', '16.000%', '15.679%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 66.9333%
Leave-one-out validation accuracies :  ['66.9333%', '67.0667%', '67.1333%', '67.2000%', '67.4667%', '67.8000%', '67.9333%', '68.1333%', '68.0667%', '68.2000%', '68.2667%', '68.5333%', '69.0667%', '69.0667%', '69.4667%', '69.7333%', '70.0000%', '70.4667%', '70.6000%', '71.0667%']
Computed and normalized credits:  tensor([0.0530, 0.0528, 0.0526, 0.0525, 0.0521, 0.0515, 0.0512, 0.0509, 0.0508,
        0.0505, 0.0503, 0.0498, 0.0490, 0.0490, 0.0484, 0.0481, 0.0476, 0.0470,
        0.0468, 0.0461])
Federated model performance: Loss: 0.658949. Accuracy: 66.5027%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['44.898%', '45.091%', '45.091%', '45.433%', '45.497%', '45.540%', '45.925%', '46.011%', '46.118%', '46.332%', '46.610%', '46.674%', '46.717%', '46.824%', '46.674%', '47.251%', '47.508%', '47.465%', '47.850%', '47.936%']
Workers federated accuracies:  ['65.626%', '65.947%', '65.840%', '66.225%', '66.353%', '66.332%', '66.503%', '66.588%', '66.545%', '66.567%', '66.909%', '66.824%', '66.995%', '66.802%', '66.824%', '67.166%', '67.380%', '67.166%', '67.444%', '67.529%']
Workers improved  accuracies:  ['20.984%', '21.155%', '21.027%', '21.348%', '21.390%', '21.412%', '21.455%', '21.390%', '21.390%', '21.348%', '21.647%', '21.455%', '21.647%', '21.433%', '21.433%', '21.540%', '21.626%', '21.455%', '21.647%', '21.668%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 68.2667%
Leave-one-out validation accuracies :  ['68.2000%', '68.2667%', '68.4000%', '68.6000%', '69.0000%', '69.0000%', '69.1333%', '69.4000%', '69.6000%', '69.8667%', '70.0667%', '70.0667%', '70.2667%', '70.6667%', '71.0667%', '71.3333%', '71.6667%', '71.7333%', '71.8667%', '72.3333%']
Computed and normalized credits:  tensor([0.0526, 0.0525, 0.0523, 0.0520, 0.0515, 0.0514, 0.0512, 0.0509, 0.0506,
        0.0502, 0.0500, 0.0499, 0.0496, 0.0491, 0.0485, 0.0482, 0.0477, 0.0476,
        0.0474, 0.0467])
Federated model performance: Loss: 0.627887. Accuracy: 68.2995%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['44.963%', '45.176%', '45.198%', '45.626%', '45.797%', '45.840%', '46.118%', '46.524%', '46.439%', '46.503%', '46.824%', '47.144%', '47.016%', '47.487%', '47.059%', '47.829%', '48.150%', '48.150%', '48.877%', '48.727%']
Workers federated accuracies:  ['68.086%', '68.150%', '68.171%', '68.364%', '68.278%', '68.235%', '68.428%', '68.535%', '68.620%', '68.727%', '68.813%', '68.856%', '68.984%', '69.027%', '68.963%', '69.112%', '69.176%', '69.262%', '69.326%', '69.369%']
Workers improved  accuracies:  ['23.444%', '23.358%', '23.358%', '23.487%', '23.316%', '23.316%', '23.380%', '23.337%', '23.465%', '23.508%', '23.551%', '23.487%', '23.636%', '23.658%', '23.572%', '23.487%', '23.422%', '23.551%', '23.529%', '23.508%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 70.2667%
Leave-one-out validation accuracies :  ['70.2667%', '70.4000%', '70.4000%', '70.5333%', '70.7333%', '70.9333%', '71.2667%', '71.4000%', '71.6000%', '71.6667%', '72.0000%', '72.0667%', '72.0667%', '72.4667%', '72.4667%', '72.8667%', '73.1333%', '73.2000%', '73.4000%', '73.7333%']
Computed and normalized credits:  tensor([0.0522, 0.0520, 0.0520, 0.0518, 0.0515, 0.0512, 0.0508, 0.0506, 0.0503,
        0.0502, 0.0498, 0.0497, 0.0497, 0.0491, 0.0491, 0.0486, 0.0482, 0.0481,
        0.0478, 0.0474])
Federated model performance: Loss: 0.603430. Accuracy: 70.3957%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['45.005%', '45.262%', '45.283%', '45.840%', '46.203%', '46.096%', '46.439%', '46.695%', '46.674%', '46.738%', '47.529%', '47.722%', '47.636%', '48.128%', '47.786%', '48.492%', '48.856%', '48.834%', '49.455%', '49.348%']
Workers federated accuracies:  ['69.690%', '69.861%', '69.989%', '70.118%', '70.246%', '70.246%', '70.503%', '70.695%', '70.717%', '70.909%', '70.930%', '71.209%', '71.102%', '71.465%', '71.337%', '71.551%', '71.636%', '71.572%', '71.594%', '71.765%']
Workers improved  accuracies:  ['25.048%', '25.070%', '25.176%', '25.241%', '25.283%', '25.326%', '25.455%', '25.497%', '25.561%', '25.690%', '25.668%', '25.840%', '25.754%', '26.096%', '25.947%', '25.925%', '25.882%', '25.861%', '25.797%', '25.904%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 72.2667%
Leave-one-out validation accuracies :  ['72.2667%', '72.2667%', '72.3333%', '72.4667%', '72.5333%', '72.6000%', '72.8000%', '72.8667%', '72.9333%', '72.9333%', '73.1333%', '73.2000%', '73.4000%', '73.6667%', '73.8667%', '73.9333%', '74.1333%', '74.3333%', '74.3333%', '74.5333%']
Computed and normalized credits:  tensor([0.0513, 0.0513, 0.0512, 0.0511, 0.0510, 0.0509, 0.0506, 0.0505, 0.0504,
        0.0504, 0.0501, 0.0500, 0.0498, 0.0494, 0.0492, 0.0490, 0.0488, 0.0485,
        0.0485, 0.0482])
Federated model performance: Loss: 0.584196. Accuracy: 72.0856%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['45.155%', '45.326%', '45.412%', '46.011%', '46.332%', '46.310%', '46.588%', '46.952%', '46.824%', '47.080%', '47.914%', '48.342%', '48.086%', '48.920%', '48.406%', '49.176%', '49.455%', '49.455%', '50.417%', '50.075%']
Workers federated accuracies:  ['71.572%', '71.658%', '71.636%', '71.893%', '72.043%', '71.872%', '72.086%', '72.193%', '72.150%', '72.214%', '72.364%', '72.385%', '72.342%', '72.492%', '72.428%', '72.663%', '72.620%', '72.727%', '72.684%', '72.727%']
Workers improved  accuracies:  ['26.930%', '26.866%', '26.824%', '27.016%', '27.080%', '26.952%', '27.037%', '26.995%', '26.995%', '26.995%', '27.102%', '27.016%', '26.995%', '27.123%', '27.037%', '27.037%', '26.866%', '27.016%', '26.888%', '26.866%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.4000%', '73.4667%', '73.4667%', '73.5333%', '73.5333%', '73.6000%', '73.6000%', '73.8000%', '74.0000%', '74.0000%', '74.2667%', '74.2667%', '74.3333%', '74.5333%', '74.5333%', '74.6000%', '74.9333%', '74.8667%', '74.9333%', '75.1333%']
Computed and normalized credits:  tensor([0.0510, 0.0509, 0.0509, 0.0508, 0.0508, 0.0507, 0.0507, 0.0504, 0.0502,
        0.0502, 0.0499, 0.0498, 0.0497, 0.0495, 0.0495, 0.0494, 0.0490, 0.0490,
        0.0489, 0.0487])
Federated model performance: Loss: 0.568753. Accuracy: 72.8342%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['45.176%', '45.476%', '45.626%', '46.310%', '46.460%', '46.610%', '46.781%', '47.380%', '47.294%', '47.594%', '48.364%', '48.941%', '48.663%', '49.326%', '48.877%', '49.626%', '50.075%', '50.096%', '51.337%', '50.952%']
Workers federated accuracies:  ['72.449%', '72.663%', '72.599%', '72.856%', '72.856%', '72.727%', '72.813%', '72.856%', '72.856%', '73.027%', '73.005%', '73.091%', '73.155%', '73.241%', '73.348%', '73.455%', '73.455%', '73.476%', '73.519%', '73.882%']
Workers improved  accuracies:  ['27.807%', '27.872%', '27.786%', '27.979%', '27.893%', '27.807%', '27.765%', '27.658%', '27.701%', '27.807%', '27.743%', '27.722%', '27.807%', '27.872%', '27.957%', '27.829%', '27.701%', '27.765%', '27.722%', '28.021%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 74.4667%
Leave-one-out validation accuracies :  ['74.4667%', '74.4667%', '74.4000%', '74.4000%', '74.4667%', '74.4667%', '74.5333%', '74.5333%', '74.6000%', '74.6667%', '74.7333%', '75.0000%', '74.9333%', '75.0667%', '75.2000%', '75.2000%', '75.4000%', '75.4000%', '75.3333%', '75.4000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0506, 0.0506, 0.0505, 0.0505, 0.0504, 0.0504, 0.0503,
        0.0502, 0.0501, 0.0498, 0.0499, 0.0497, 0.0495, 0.0495, 0.0493, 0.0493,
        0.0493, 0.0492])
Federated model performance: Loss: 0.556140. Accuracy: 73.8182%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['45.198%', '45.583%', '45.754%', '46.481%', '46.695%', '46.759%', '46.973%', '47.743%', '47.615%', '48.021%', '48.727%', '49.262%', '49.176%', '49.968%', '49.390%', '50.460%', '51.102%', '50.738%', '52.107%', '51.850%']
Workers federated accuracies:  ['73.176%', '73.326%', '73.283%', '73.561%', '73.690%', '73.626%', '73.861%', '73.797%', '73.840%', '74.053%', '73.882%', '74.053%', '74.160%', '74.182%', '74.289%', '74.567%', '74.545%', '74.524%', '74.503%', '74.652%']
Workers improved  accuracies:  ['28.535%', '28.535%', '28.471%', '28.684%', '28.727%', '28.706%', '28.813%', '28.599%', '28.684%', '28.834%', '28.620%', '28.684%', '28.813%', '28.813%', '28.898%', '28.941%', '28.791%', '28.813%', '28.706%', '28.791%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 74.9333%
Leave-one-out validation accuracies :  ['74.9333%', '74.9333%', '74.9333%', '75.0000%', '75.0667%', '75.1333%', '75.2667%', '75.3333%', '75.2667%', '75.3333%', '75.3333%', '75.4000%', '75.3333%', '75.4000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.6667%', '75.6667%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0505, 0.0504, 0.0503, 0.0503, 0.0501, 0.0500, 0.0501,
        0.0500, 0.0500, 0.0499, 0.0500, 0.0499, 0.0496, 0.0496, 0.0496, 0.0496,
        0.0495, 0.0495])
Federated model performance: Loss: 0.545518. Accuracy: 74.6524%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['45.241%', '45.690%', '45.968%', '46.674%', '46.973%', '46.866%', '47.273%', '48.064%', '47.979%', '48.449%', '49.390%', '49.775%', '49.561%', '50.524%', '50.011%', '51.187%', '51.743%', '51.722%', '52.770%', '52.727%']
Workers federated accuracies:  ['74.032%', '74.160%', '74.203%', '74.396%', '74.460%', '74.374%', '74.524%', '74.652%', '74.588%', '74.631%', '74.567%', '74.652%', '74.717%', '74.759%', '74.759%', '74.824%', '74.759%', '74.802%', '74.824%', '74.952%']
Workers improved  accuracies:  ['29.390%', '29.369%', '29.390%', '29.519%', '29.497%', '29.455%', '29.476%', '29.455%', '29.433%', '29.412%', '29.305%', '29.283%', '29.369%', '29.390%', '29.369%', '29.198%', '29.005%', '29.091%', '29.027%', '29.091%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.8000%', '75.8667%', '75.9333%', '75.9333%', '75.9333%', '76.0667%', '76.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0501, 0.0501, 0.0501, 0.0501,
        0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0498, 0.0498, 0.0497,
        0.0495, 0.0495])
Federated model performance: Loss: 0.536583. Accuracy: 74.8449%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['45.219%', '45.754%', '46.075%', '46.738%', '47.230%', '47.187%', '47.658%', '48.406%', '48.471%', '48.941%', '49.882%', '50.353%', '50.075%', '51.209%', '50.610%', '51.914%', '52.535%', '52.428%', '53.476%', '53.519%']
Workers federated accuracies:  ['74.374%', '74.524%', '74.503%', '74.652%', '74.738%', '74.695%', '74.674%', '74.781%', '74.695%', '74.930%', '74.824%', '74.995%', '75.102%', '74.973%', '75.144%', '75.273%', '75.316%', '75.273%', '75.401%', '75.551%']
Workers improved  accuracies:  ['29.733%', '29.733%', '29.690%', '29.775%', '29.775%', '29.775%', '29.626%', '29.583%', '29.540%', '29.711%', '29.561%', '29.626%', '29.754%', '29.604%', '29.754%', '29.647%', '29.561%', '29.561%', '29.604%', '29.690%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.536583. Accuracy: 74.8449%.
Workers before    accuracies:  ['44.642%', '44.791%', '44.813%', '44.877%', '44.963%', '44.920%', '45.048%', '45.198%', '45.155%', '45.219%', '45.262%', '45.369%', '45.348%', '45.369%', '45.390%', '45.626%', '45.754%', '45.711%', '45.797%', '45.861%']
Workers standlone accuracies:  ['45.219%', '45.754%', '46.075%', '46.738%', '47.230%', '47.187%', '47.658%', '48.406%', '48.471%', '48.941%', '49.882%', '50.353%', '50.075%', '51.209%', '50.610%', '51.914%', '52.535%', '52.428%', '53.476%', '53.519%']
Workers federated accuracies:  ['74.374%', '74.524%', '74.503%', '74.652%', '74.738%', '74.695%', '74.674%', '74.781%', '74.695%', '74.930%', '74.824%', '74.995%', '75.102%', '74.973%', '75.144%', '75.273%', '75.316%', '75.273%', '75.401%', '75.551%']
Workers improved  accuracies:  ['29.733%', '29.733%', '29.690%', '29.775%', '29.775%', '29.775%', '29.626%', '29.583%', '29.540%', '29.711%', '29.561%', '29.626%', '29.754%', '29.604%', '29.754%', '29.647%', '29.561%', '29.561%', '29.604%', '29.690%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.013211521514355777, 0.9559142475132246)
Correlation between stand alone test acc & collaborative final model acc:  (0.9695456295250297, 1.916337400172445e-12)
Correlation between test_acc & sharing contributions:  (0.9696998319865406, 1.83178649392021e-12)
Correlation between test_acc improvements & sharing_contributions:  (-0.47441600736492273, 0.03456113756875102)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.708419. Accuracy: 57.0695%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 66.0000%
Leave-one-out validation accuracies :  ['65.8667%', '66.2000%', '66.4667%', '66.4000%', '66.8000%', '66.9333%', '67.4000%', '67.4667%', '67.7333%', '67.9333%', '68.5333%', '68.6000%', '69.4000%', '69.6667%', '70.2667%', '70.8667%', '71.3333%', '71.6000%', '72.2667%', '72.2000%']
Computed and normalized credits:  tensor([0.0538, 0.0533, 0.0530, 0.0530, 0.0525, 0.0523, 0.0517, 0.0516, 0.0512,
        0.0510, 0.0502, 0.0501, 0.0490, 0.0487, 0.0479, 0.0471, 0.0466, 0.0462,
        0.0454, 0.0455])
Federated model performance: Loss: 0.664147. Accuracy: 65.7540%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['55.893%', '56.064%', '56.128%', '56.599%', '56.813%', '56.834%', '57.112%', '57.390%', '57.668%', '57.775%', '58.332%', '58.439%', '58.289%', '58.503%', '58.460%', '58.909%', '59.187%', '59.144%', '59.636%', '59.209%']
Workers federated accuracies:  ['65.219%', '65.262%', '65.348%', '65.476%', '65.647%', '65.668%', '65.668%', '65.733%', '65.904%', '65.861%', '66.160%', '66.310%', '66.139%', '66.289%', '66.289%', '66.481%', '66.674%', '66.631%', '66.909%', '66.845%']
Workers improved  accuracies:  ['9.455%', '9.369%', '9.412%', '9.369%', '9.348%', '9.390%', '9.048%', '9.070%', '8.963%', '8.920%', '8.920%', '8.856%', '8.834%', '8.749%', '8.877%', '8.684%', '8.642%', '8.706%', '8.492%', '8.663%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 69.2667%
Leave-one-out validation accuracies :  ['69.2667%', '69.3333%', '69.4000%', '69.6000%', '69.8667%', '70.2000%', '70.4667%', '70.6667%', '70.8000%', '70.8000%', '71.0667%', '71.3333%', '71.6000%', '71.8000%', '72.0667%', '72.2667%', '72.6667%', '72.9333%', '73.0667%', '72.9333%']
Computed and normalized credits:  tensor([0.0527, 0.0525, 0.0524, 0.0522, 0.0518, 0.0513, 0.0509, 0.0507, 0.0505,
        0.0505, 0.0500, 0.0497, 0.0493, 0.0490, 0.0486, 0.0483, 0.0477, 0.0474,
        0.0471, 0.0473])
Federated model performance: Loss: 0.633346. Accuracy: 69.7326%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['56.000%', '56.299%', '56.385%', '57.112%', '57.369%', '57.176%', '57.754%', '58.032%', '58.374%', '58.503%', '59.166%', '59.166%', '59.166%', '59.209%', '59.187%', '59.701%', '60.000%', '59.957%', '60.791%', '60.599%']
Workers federated accuracies:  ['69.155%', '69.155%', '69.198%', '69.433%', '69.519%', '69.519%', '69.733%', '69.626%', '69.797%', '69.690%', '69.840%', '70.011%', '69.925%', '70.032%', '70.139%', '70.160%', '70.396%', '70.610%', '70.802%', '70.567%']
Workers improved  accuracies:  ['13.390%', '13.262%', '13.262%', '13.326%', '13.219%', '13.241%', '13.112%', '12.963%', '12.856%', '12.749%', '12.599%', '12.556%', '12.620%', '12.492%', '12.727%', '12.364%', '12.364%', '12.684%', '12.385%', '12.385%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 71.6000%
Leave-one-out validation accuracies :  ['71.6667%', '71.8000%', '72.0000%', '72.0667%', '72.0667%', '72.2000%', '72.2000%', '72.0667%', '72.1333%', '72.1333%', '72.2000%', '72.5333%', '72.7333%', '73.0667%', '73.1333%', '73.1333%', '73.2667%', '73.5333%', '73.5333%', '73.7333%']
Computed and normalized credits:  tensor([0.0513, 0.0512, 0.0509, 0.0508, 0.0508, 0.0506, 0.0505, 0.0507, 0.0506,
        0.0506, 0.0504, 0.0500, 0.0497, 0.0493, 0.0492, 0.0492, 0.0489, 0.0486,
        0.0486, 0.0483])
Federated model performance: Loss: 0.610126. Accuracy: 72.1283%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['56.086%', '56.535%', '56.727%', '57.412%', '57.840%', '57.561%', '58.353%', '58.717%', '58.995%', '59.187%', '59.594%', '59.893%', '59.722%', '60.021%', '60.021%', '60.749%', '61.091%', '61.155%', '61.797%', '61.711%']
Workers federated accuracies:  ['72.128%', '72.064%', '72.086%', '72.107%', '72.214%', '72.086%', '72.150%', '72.235%', '72.278%', '72.513%', '72.449%', '72.428%', '72.449%', '72.578%', '72.535%', '72.663%', '72.642%', '72.770%', '72.813%', '72.727%']
Workers improved  accuracies:  ['16.364%', '16.171%', '16.150%', '16.000%', '15.914%', '15.807%', '15.529%', '15.572%', '15.337%', '15.572%', '15.209%', '14.973%', '15.144%', '15.037%', '15.123%', '14.866%', '14.610%', '14.845%', '14.396%', '14.545%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 72.6667%
Leave-one-out validation accuracies :  ['72.6667%', '72.7333%', '72.7333%', '72.9333%', '73.0667%', '73.1333%', '73.0667%', '73.2000%', '73.2000%', '73.1333%', '73.1333%', '73.1333%', '73.3333%', '73.2667%', '73.6000%', '73.7333%', '73.8667%', '73.8000%', '74.0000%', '74.2667%']
Computed and normalized credits:  tensor([0.0509, 0.0508, 0.0508, 0.0505, 0.0503, 0.0502, 0.0503, 0.0502, 0.0502,
        0.0502, 0.0502, 0.0502, 0.0499, 0.0500, 0.0496, 0.0494, 0.0492, 0.0493,
        0.0490, 0.0487])
Federated model performance: Loss: 0.592381. Accuracy: 73.3048%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['56.235%', '56.963%', '57.005%', '57.882%', '58.203%', '58.310%', '58.781%', '58.973%', '59.401%', '59.722%', '60.578%', '60.834%', '60.620%', '60.856%', '60.984%', '61.561%', '62.203%', '62.310%', '63.251%', '62.802%']
Workers federated accuracies:  ['72.834%', '73.005%', '73.005%', '72.984%', '73.155%', '73.305%', '73.134%', '73.369%', '73.348%', '73.540%', '73.476%', '73.519%', '73.540%', '73.626%', '73.583%', '73.647%', '73.647%', '73.690%', '73.818%', '73.754%']
Workers improved  accuracies:  ['17.070%', '17.112%', '17.070%', '16.877%', '16.856%', '17.027%', '16.513%', '16.706%', '16.406%', '16.599%', '16.235%', '16.064%', '16.235%', '16.086%', '16.171%', '15.850%', '15.615%', '15.765%', '15.401%', '15.572%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 73.3333%
Leave-one-out validation accuracies :  ['73.3333%', '73.3333%', '73.4000%', '73.5333%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6667%', '73.8000%', '73.7333%', '73.7333%', '73.9333%', '74.0000%', '74.1333%', '74.3333%', '74.5333%', '74.6667%', '74.7333%', '74.5333%']
Computed and normalized credits:  tensor([0.0507, 0.0507, 0.0506, 0.0505, 0.0504, 0.0504, 0.0504, 0.0504, 0.0503,
        0.0501, 0.0502, 0.0502, 0.0499, 0.0499, 0.0497, 0.0494, 0.0492, 0.0490,
        0.0489, 0.0491])
Federated model performance: Loss: 0.578281. Accuracy: 73.9251%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['56.535%', '57.176%', '57.326%', '58.374%', '58.930%', '58.567%', '59.273%', '59.551%', '59.979%', '60.471%', '61.412%', '61.626%', '61.412%', '61.711%', '61.647%', '62.631%', '63.401%', '63.508%', '64.193%', '64.064%']
Workers federated accuracies:  ['73.583%', '73.711%', '73.690%', '73.775%', '73.882%', '73.818%', '73.925%', '73.861%', '73.968%', '74.011%', '74.118%', '73.968%', '74.225%', '74.289%', '74.289%', '74.353%', '74.289%', '74.417%', '74.588%', '74.374%']
Workers improved  accuracies:  ['17.818%', '17.818%', '17.754%', '17.668%', '17.583%', '17.540%', '17.305%', '17.198%', '17.027%', '17.070%', '16.877%', '16.513%', '16.920%', '16.749%', '16.877%', '16.556%', '16.257%', '16.492%', '16.171%', '16.193%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['73.9333%', '73.8667%', '73.9333%', '73.9333%', '74.1333%', '74.3333%', '74.2667%', '74.2667%', '74.4667%', '74.4667%', '74.5333%', '74.6000%', '74.6667%', '74.8000%', '74.6667%', '74.6000%', '74.8000%', '74.8000%', '74.8000%', '74.8667%']
Computed and normalized credits:  tensor([0.0507, 0.0507, 0.0506, 0.0506, 0.0504, 0.0502, 0.0502, 0.0502, 0.0500,
        0.0500, 0.0499, 0.0498, 0.0497, 0.0496, 0.0497, 0.0498, 0.0495, 0.0495,
        0.0495, 0.0494])
Federated model performance: Loss: 0.567014. Accuracy: 74.6952%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['56.706%', '57.433%', '57.647%', '58.738%', '59.209%', '58.845%', '59.636%', '60.235%', '60.684%', '61.048%', '62.032%', '62.567%', '62.182%', '62.567%', '62.588%', '63.636%', '64.235%', '64.556%', '65.027%', '64.963%']
Workers federated accuracies:  ['74.118%', '74.118%', '74.267%', '74.310%', '74.610%', '74.460%', '74.503%', '74.524%', '74.610%', '74.738%', '74.717%', '74.866%', '74.759%', '74.995%', '74.781%', '74.824%', '74.888%', '74.909%', '75.037%', '75.080%']
Workers improved  accuracies:  ['18.353%', '18.225%', '18.332%', '18.203%', '18.310%', '18.182%', '17.882%', '17.861%', '17.668%', '17.797%', '17.476%', '17.412%', '17.455%', '17.455%', '17.369%', '17.027%', '16.856%', '16.984%', '16.620%', '16.898%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 74.6667%
Leave-one-out validation accuracies :  ['74.6667%', '74.6667%', '74.6000%', '74.6000%', '74.5333%', '74.6000%', '74.7333%', '74.7333%', '74.6000%', '74.6667%', '74.8000%', '74.8000%', '74.8000%', '74.7333%', '74.8000%', '74.8000%', '74.8667%', '74.8000%', '74.8667%', '74.8667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0502, 0.0502, 0.0503, 0.0502, 0.0500, 0.0500, 0.0501,
        0.0501, 0.0499, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0498, 0.0499,
        0.0498, 0.0498])
Federated model performance: Loss: 0.557698. Accuracy: 75.3583%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['56.834%', '57.668%', '57.818%', '59.080%', '59.444%', '59.294%', '60.385%', '60.791%', '61.283%', '61.519%', '62.845%', '63.251%', '62.973%', '63.636%', '63.316%', '64.321%', '65.134%', '65.412%', '65.818%', '65.797%']
Workers federated accuracies:  ['74.824%', '74.866%', '74.888%', '74.995%', '75.123%', '75.016%', '75.016%', '74.930%', '75.144%', '75.187%', '75.230%', '75.337%', '75.273%', '75.444%', '75.294%', '75.401%', '75.422%', '75.316%', '75.422%', '75.465%']
Workers improved  accuracies:  ['19.059%', '18.973%', '18.952%', '18.888%', '18.824%', '18.738%', '18.396%', '18.267%', '18.203%', '18.246%', '17.989%', '17.882%', '17.968%', '17.904%', '17.882%', '17.604%', '17.390%', '17.390%', '17.005%', '17.283%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 74.8667%
Leave-one-out validation accuracies :  ['74.8667%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '74.9333%', '75.0667%', '75.0667%', '74.9333%', '75.0667%', '75.0667%', '75.0000%', '75.0000%', '75.0000%', '75.0667%', '75.0000%', '75.0000%', '75.0000%', '75.1333%', '75.1333%']
Computed and normalized credits:  tensor([0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501, 0.0499, 0.0499, 0.0501,
        0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
        0.0498, 0.0498])
Federated model performance: Loss: 0.549699. Accuracy: 75.5508%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['57.198%', '57.840%', '58.011%', '59.294%', '59.979%', '59.615%', '60.749%', '61.326%', '61.690%', '62.182%', '63.765%', '64.128%', '63.487%', '64.278%', '64.064%', '65.005%', '65.647%', '66.032%', '66.717%', '66.588%']
Workers federated accuracies:  ['75.166%', '75.166%', '75.209%', '75.230%', '75.273%', '75.337%', '75.251%', '75.316%', '75.444%', '75.358%', '75.465%', '75.422%', '75.487%', '75.508%', '75.508%', '75.508%', '75.551%', '75.508%', '75.529%', '75.658%']
Workers improved  accuracies:  ['19.401%', '19.273%', '19.273%', '19.123%', '18.973%', '19.059%', '18.631%', '18.652%', '18.503%', '18.417%', '18.225%', '17.968%', '18.182%', '17.968%', '18.096%', '17.711%', '17.519%', '17.583%', '17.112%', '17.476%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0667%', '75.0000%', '75.0667%', '75.0667%', '75.2000%', '75.4000%', '75.4000%', '75.4667%', '75.4667%', '75.6000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0502,
        0.0501, 0.0501, 0.0502, 0.0501, 0.0501, 0.0499, 0.0497, 0.0497, 0.0496,
        0.0496, 0.0495])
Federated model performance: Loss: 0.542847. Accuracy: 75.7433%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['57.305%', '58.160%', '58.203%', '59.508%', '60.235%', '60.214%', '61.112%', '61.861%', '62.332%', '62.909%', '64.406%', '64.727%', '64.214%', '65.005%', '64.791%', '65.647%', '66.759%', '66.695%', '67.401%', '67.102%']
Workers federated accuracies:  ['75.273%', '75.273%', '75.316%', '75.337%', '75.465%', '75.465%', '75.422%', '75.487%', '75.465%', '75.508%', '75.636%', '75.658%', '75.615%', '75.722%', '75.636%', '75.636%', '75.743%', '75.722%', '75.743%', '75.743%']
Workers improved  accuracies:  ['19.508%', '19.380%', '19.380%', '19.230%', '19.166%', '19.187%', '18.802%', '18.824%', '18.524%', '18.567%', '18.396%', '18.203%', '18.310%', '18.182%', '18.225%', '17.840%', '17.711%', '17.797%', '17.326%', '17.562%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 75.3333%
Leave-one-out validation accuracies :  ['75.2667%', '75.2667%', '75.3333%', '75.4000%', '75.4667%', '75.4000%', '75.5333%', '75.5333%', '75.4667%', '75.5333%', '75.5333%', '75.4667%', '75.4667%', '75.5333%', '75.5333%', '75.6667%', '75.6667%', '75.7333%', '75.8000%', '75.8000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0502, 0.0502, 0.0501, 0.0502, 0.0500, 0.0500, 0.0501,
        0.0500, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0498, 0.0498, 0.0497,
        0.0496, 0.0496])
Federated model performance: Loss: 0.536875. Accuracy: 75.8931%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['57.647%', '58.332%', '58.567%', '59.807%', '60.663%', '60.620%', '61.540%', '62.481%', '63.037%', '63.487%', '65.005%', '65.412%', '64.813%', '65.604%', '65.561%', '66.353%', '67.230%', '67.102%', '67.957%', '67.615%']
Workers federated accuracies:  ['75.465%', '75.422%', '75.594%', '75.615%', '75.743%', '75.679%', '75.658%', '75.679%', '75.615%', '75.722%', '75.786%', '75.765%', '75.829%', '76.107%', '75.829%', '75.914%', '75.872%', '75.979%', '76.021%', '75.914%']
Workers improved  accuracies:  ['19.701%', '19.529%', '19.658%', '19.508%', '19.444%', '19.401%', '19.037%', '19.016%', '18.674%', '18.781%', '18.545%', '18.310%', '18.524%', '18.567%', '18.417%', '18.118%', '17.840%', '18.053%', '17.604%', '17.733%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.536875. Accuracy: 75.8931%.
Workers before    accuracies:  ['55.765%', '55.893%', '55.936%', '56.107%', '56.299%', '56.278%', '56.620%', '56.663%', '56.941%', '56.941%', '57.241%', '57.455%', '57.305%', '57.540%', '57.412%', '57.797%', '58.032%', '57.925%', '58.417%', '58.182%']
Workers standlone accuracies:  ['57.647%', '58.332%', '58.567%', '59.807%', '60.663%', '60.620%', '61.540%', '62.481%', '63.037%', '63.487%', '65.005%', '65.412%', '64.813%', '65.604%', '65.561%', '66.353%', '67.230%', '67.102%', '67.957%', '67.615%']
Workers federated accuracies:  ['75.465%', '75.422%', '75.594%', '75.615%', '75.743%', '75.679%', '75.658%', '75.679%', '75.615%', '75.722%', '75.786%', '75.765%', '75.829%', '76.107%', '75.829%', '75.914%', '75.872%', '75.979%', '76.021%', '75.914%']
Workers improved  accuracies:  ['19.701%', '19.529%', '19.658%', '19.508%', '19.444%', '19.401%', '19.037%', '19.016%', '18.674%', '18.781%', '18.545%', '18.310%', '18.524%', '18.567%', '18.417%', '18.118%', '17.840%', '18.053%', '17.604%', '17.733%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.11677073932632362, 0.6239410975533984)
Correlation between stand alone test acc & collaborative final model acc:  (0.8844218218094633, 2.281564298608677e-07)
Correlation between test_acc & sharing contributions:  (0.8792516571378338, 3.317264599832802e-07)
Correlation between test_acc improvements & sharing_contributions:  (-0.9802692892126081, 4.007315260576677e-14)
standalone_vs_final_corr [[0.899409787792305], [0.9408956732879339], [0.8717494970611315], [0.9695456295250297], [0.8844218218094633]]
standalone_vs_final_corr_mean [0.9132044818951727]
standalone_vs_final_corr_std [0.0365468955496678]
sharingcontribution_vs_final_corr [[0.9071160423984559], [0.9326065821889277], [0.8650823145115291], [0.9696998319865406], [0.8792516571378338]]
sharingcontribution_vs_final_corr_mean [0.9107512856446573]
sharingcontribution_vs_final_corr_std [0.03753313633776054]
standalone_vs_federated_perturbed_corr [[0.28372129390963574], [0.12401806945949212], [-0.3122996324798215], [0.013211521514355777], [-0.11677073932632362]]
standalone_vs_federated_perturbed_corr_mean [-0.0016238973845322969]
standalone_vs_federated_perturbed_corr_std [0.20357115673258427]
federated_final_performance [0.762994647026062, 0.7525133490562439, 0.7591443657875061, 0.7484492063522339, 0.758930504322052]
federated_final_performance_mean 0.7564064145088196
federated_final_performance_std 0.005210476649141566
CFFL_best_worker [0.7657753825187683, 0.7563636302947998, 0.7602139115333557, 0.7555080056190491, 0.7610695362091064]
CFFL_best_worker_mean 0.7597860932350159
CFFL_best_worker_std 0.0036801393102883903
standalone_best_worker [0.6727272868156433, 0.6727272868156433, 0.6303743124008179, 0.5351871848106384, 0.6795721650123596]
standalone_best_worker_mean 0.6381176471710205
standalone_best_worker_std 0.054348451085941094
