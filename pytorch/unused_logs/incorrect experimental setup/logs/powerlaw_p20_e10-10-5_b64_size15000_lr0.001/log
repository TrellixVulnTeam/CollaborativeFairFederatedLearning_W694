Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 15000, 'n_workers': 20, 'split': 'powerlaw', 'sharing_lambda': 0.1, 'batch_size': 64, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.001, 'pretrain_epochs': 10, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.747025. Accuracy: 53.3476%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 74.6667%
Leave-one-out validation accuracies :  ['74.7333%', '74.7333%', '74.9333%', '75.0667%', '75.2000%', '74.8667%', '74.6000%', '74.4000%', '74.6000%', '74.6000%', '74.6667%', '74.4667%', '74.4000%', '74.4667%', '74.2000%', '74.2000%', '74.2667%', '74.4667%', '74.7333%', '74.7333%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0496, 0.0495, 0.0493, 0.0497, 0.0500, 0.0502, 0.0500,
        0.0500, 0.0499, 0.0502, 0.0502, 0.0502, 0.0505, 0.0505, 0.0504, 0.0502,
        0.0499, 0.0499])
Federated model performance: Loss: 0.561677. Accuracy: 75.7005%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['44.663%', '45.433%', '48.684%', '49.476%', '51.380%', '53.283%', '54.503%', '58.610%', '59.059%', '60.856%', '62.631%', '64.364%', '62.438%', '65.476%', '65.561%', '65.840%', '66.332%', '66.203%', '68.535%', '67.722%']
Workers federated accuracies:  ['75.529%', '75.679%', '75.615%', '75.765%', '75.722%', '75.765%', '75.679%', '75.829%', '76.021%', '75.850%', '75.936%', '75.850%', '76.150%', '75.979%', '76.257%', '76.086%', '75.914%', '76.086%', '76.193%', '76.257%']
Workers improved  accuracies:  ['32.364%', '31.722%', '29.818%', '29.112%', '27.508%', '26.439%', '25.519%', '23.358%', '23.251%', '22.203%', '20.000%', '18.032%', '20.385%', '17.005%', '17.112%', '16.193%', '15.037%', '15.037%', '13.497%', '14.075%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6667%', '76.6667%', '76.7333%', '76.8000%', '76.9333%', '76.8667%', '76.8000%', '76.8667%', '76.8667%', '76.8667%', '77.2000%', '77.8000%', '77.9333%', '78.0000%', '78.4667%', '78.1333%', '77.8667%', '78.2667%', '78.5333%']
Computed and normalized credits:  tensor([0.0508, 0.0507, 0.0507, 0.0506, 0.0505, 0.0504, 0.0505, 0.0506, 0.0505,
        0.0505, 0.0505, 0.0502, 0.0495, 0.0494, 0.0493, 0.0488, 0.0492, 0.0494,
        0.0490, 0.0487])
Federated model performance: Loss: 0.511999. Accuracy: 77.9893%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['46.053%', '47.144%', '50.631%', '52.214%', '55.166%', '58.481%', '60.043%', '63.080%', '63.850%', '64.449%', '66.738%', '68.171%', '66.246%', '69.241%', '69.968%', '70.203%', '70.545%', '70.182%', '72.941%', '72.064%']
Workers federated accuracies:  ['77.241%', '77.455%', '77.540%', '77.455%', '77.540%', '77.711%', '77.604%', '77.754%', '77.818%', '77.626%', '77.455%', '77.433%', '77.925%', '77.604%', '77.668%', '77.668%', '77.690%', '77.882%', '77.711%', '77.925%']
Workers improved  accuracies:  ['34.075%', '33.497%', '31.743%', '30.802%', '29.326%', '28.385%', '27.444%', '25.283%', '25.048%', '23.979%', '21.519%', '19.615%', '22.160%', '18.631%', '18.524%', '17.775%', '16.813%', '16.834%', '15.016%', '15.743%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.2000%', '77.2667%', '77.2667%', '77.2667%', '77.1333%', '77.4667%', '77.5333%', '77.4000%', '77.4667%', '77.5333%', '77.5333%', '77.6667%', '77.7333%', '77.7333%', '78.0000%', '78.1333%', '78.2000%', '78.6000%', '78.8000%', '78.8667%']
Computed and normalized credits:  tensor([0.0507, 0.0506, 0.0506, 0.0506, 0.0507, 0.0503, 0.0503, 0.0504, 0.0504,
        0.0503, 0.0503, 0.0501, 0.0500, 0.0499, 0.0496, 0.0495, 0.0494, 0.0490,
        0.0487, 0.0486])
Federated model performance: Loss: 0.488233. Accuracy: 79.0160%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['47.102%', '48.813%', '53.198%', '55.337%', '59.465%', '61.947%', '63.444%', '66.460%', '66.588%', '67.936%', '69.947%', '71.380%', '69.861%', '72.000%', '72.663%', '72.706%', '73.027%', '72.856%', '74.524%', '73.968%']
Workers federated accuracies:  ['78.053%', '78.160%', '78.439%', '78.310%', '78.225%', '78.460%', '78.289%', '78.246%', '78.439%', '78.289%', '78.225%', '78.203%', '78.524%', '77.968%', '78.289%', '78.203%', '78.353%', '78.396%', '78.246%', '78.545%']
Workers improved  accuracies:  ['34.888%', '34.203%', '32.642%', '31.658%', '30.011%', '29.134%', '28.128%', '25.775%', '25.668%', '24.642%', '22.289%', '20.385%', '22.759%', '18.995%', '19.144%', '18.310%', '17.476%', '17.348%', '15.551%', '16.364%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 77.6667%
Leave-one-out validation accuracies :  ['77.6667%', '77.6000%', '77.8000%', '77.7333%', '77.8000%', '77.8000%', '77.7333%', '77.7333%', '77.6000%', '77.6000%', '77.9333%', '78.0667%', '78.0000%', '78.3333%', '78.3333%', '78.5333%', '78.6000%', '78.8000%', '78.7333%', '78.8000%']
Computed and normalized credits:  tensor([0.0505, 0.0506, 0.0503, 0.0504, 0.0504, 0.0503, 0.0504, 0.0504, 0.0505,
        0.0505, 0.0502, 0.0500, 0.0501, 0.0497, 0.0497, 0.0494, 0.0494, 0.0491,
        0.0491, 0.0491])
Federated model performance: Loss: 0.472468. Accuracy: 79.4652%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['48.021%', '50.246%', '56.278%', '58.417%', '62.503%', '64.834%', '66.267%', '69.412%', '69.198%', '70.011%', '72.406%', '72.406%', '72.535%', '73.262%', '74.396%', '74.053%', '74.289%', '74.481%', '75.658%', '75.251%']
Workers federated accuracies:  ['78.524%', '78.631%', '78.781%', '78.738%', '78.674%', '78.802%', '78.460%', '78.759%', '78.802%', '78.717%', '78.674%', '78.289%', '79.016%', '78.267%', '78.759%', '78.588%', '78.695%', '78.738%', '78.481%', '79.037%']
Workers improved  accuracies:  ['35.358%', '34.674%', '32.984%', '32.086%', '30.460%', '29.476%', '28.299%', '26.289%', '26.032%', '25.070%', '22.738%', '20.471%', '23.251%', '19.294%', '19.615%', '18.695%', '17.818%', '17.690%', '15.786%', '16.856%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 78.3333%
Leave-one-out validation accuracies :  ['78.3333%', '78.3333%', '78.3333%', '78.2667%', '78.4000%', '78.2000%', '78.1333%', '78.2667%', '78.4000%', '78.4667%', '78.6667%', '78.8667%', '78.8667%', '79.0667%', '79.2000%', '79.1333%', '79.0667%', '78.9333%', '79.0000%', '78.9333%']
Computed and normalized credits:  tensor([0.0504, 0.0504, 0.0504, 0.0504, 0.0503, 0.0505, 0.0506, 0.0504, 0.0503,
        0.0502, 0.0500, 0.0498, 0.0498, 0.0495, 0.0494, 0.0494, 0.0495, 0.0496,
        0.0495, 0.0496])
Federated model performance: Loss: 0.460764. Accuracy: 79.7647%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['49.112%', '51.765%', '59.251%', '60.984%', '65.005%', '66.610%', '68.193%', '71.636%', '70.759%', '71.316%', '74.053%', '73.561%', '74.032%', '74.374%', '75.273%', '74.866%', '74.845%', '75.337%', '76.193%', '75.850%']
Workers federated accuracies:  ['78.738%', '78.973%', '79.016%', '78.909%', '78.781%', '78.995%', '78.909%', '79.102%', '79.016%', '78.930%', '79.059%', '78.567%', '79.422%', '78.545%', '79.187%', '78.995%', '79.037%', '78.930%', '79.016%', '79.251%']
Workers improved  accuracies:  ['35.572%', '35.016%', '33.219%', '32.257%', '30.567%', '29.668%', '28.749%', '26.631%', '26.246%', '25.283%', '23.123%', '20.749%', '23.658%', '19.572%', '20.043%', '19.102%', '18.160%', '17.882%', '16.321%', '17.070%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0667%', '79.0667%', '79.0667%', '78.9333%', '79.0667%', '79.0667%', '79.0667%', '79.0667%', '79.1333%', '79.2667%', '79.2667%', '79.2000%', '79.3333%', '79.2667%', '79.0667%', '79.1333%', '79.0000%', '79.2000%', '79.1333%', '79.2667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0503, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
        0.0499, 0.0499, 0.0499, 0.0498, 0.0498, 0.0500, 0.0499, 0.0501, 0.0499,
        0.0500, 0.0498])
Federated model performance: Loss: 0.453275. Accuracy: 80.0428%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['50.075%', '53.433%', '61.882%', '63.037%', '67.123%', '68.727%', '70.075%', '72.556%', '72.813%', '72.364%', '74.695%', '74.053%', '74.588%', '74.995%', '75.872%', '75.422%', '75.337%', '76.021%', '76.620%', '76.214%']
Workers federated accuracies:  ['78.845%', '79.037%', '79.080%', '78.952%', '78.995%', '79.102%', '79.016%', '79.444%', '79.316%', '78.995%', '79.230%', '78.674%', '79.594%', '78.695%', '79.594%', '79.187%', '79.059%', '79.273%', '79.123%', '79.508%']
Workers improved  accuracies:  ['35.679%', '35.080%', '33.283%', '32.299%', '30.781%', '29.775%', '28.856%', '26.973%', '26.545%', '25.348%', '23.294%', '20.856%', '23.829%', '19.722%', '20.449%', '19.294%', '18.182%', '18.225%', '16.428%', '17.326%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 79.1333%
Leave-one-out validation accuracies :  ['79.1333%', '79.1333%', '79.1333%', '79.4000%', '79.2000%', '79.2000%', '79.2000%', '79.2667%', '79.2667%', '79.2000%', '79.4000%', '79.4000%', '79.2667%', '79.4000%', '79.2000%', '79.0667%', '79.2000%', '79.1333%', '79.0667%', '79.2000%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0498, 0.0498, 0.0499, 0.0498, 0.0500, 0.0502, 0.0500, 0.0501,
        0.0502, 0.0500])
Federated model performance: Loss: 0.446646. Accuracy: 80.0856%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['51.251%', '55.508%', '63.337%', '64.834%', '69.626%', '70.118%', '71.465%', '73.668%', '73.711%', '73.155%', '75.187%', '74.289%', '75.358%', '75.251%', '76.342%', '75.658%', '75.850%', '76.492%', '76.791%', '76.984%']
Workers federated accuracies:  ['78.759%', '79.059%', '79.187%', '79.059%', '79.251%', '79.316%', '78.995%', '79.572%', '79.358%', '79.123%', '79.380%', '78.695%', '79.743%', '78.866%', '79.786%', '79.209%', '79.144%', '79.273%', '79.273%', '79.765%']
Workers improved  accuracies:  ['35.594%', '35.102%', '33.390%', '32.406%', '31.037%', '29.989%', '28.834%', '27.102%', '26.588%', '25.476%', '23.444%', '20.877%', '23.979%', '19.893%', '20.642%', '19.316%', '18.267%', '18.225%', '16.578%', '17.583%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 79.2667%
Leave-one-out validation accuracies :  ['79.2667%', '79.4000%', '79.3333%', '79.2667%', '79.4000%', '79.4000%', '79.4000%', '79.2667%', '79.0667%', '78.9333%', '79.0667%', '79.2667%', '79.4667%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.1333%', '79.2000%', '79.4000%']
Computed and normalized credits:  tensor([0.0500, 0.0499, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0502,
        0.0504, 0.0502, 0.0500, 0.0498, 0.0499, 0.0499, 0.0499, 0.0499, 0.0502,
        0.0501, 0.0499])
Federated model performance: Loss: 0.444984. Accuracy: 80.0856%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['52.150%', '57.262%', '64.749%', '66.439%', '71.294%', '71.636%', '72.471%', '74.567%', '74.203%', '73.818%', '75.529%', '74.524%', '76.000%', '75.914%', '76.706%', '76.000%', '76.214%', '76.556%', '77.112%', '77.647%']
Workers federated accuracies:  ['78.738%', '79.059%', '79.251%', '79.187%', '79.294%', '79.251%', '79.187%', '79.615%', '79.380%', '79.187%', '79.508%', '78.802%', '79.679%', '79.080%', '79.722%', '79.487%', '79.337%', '79.615%', '79.508%', '80.064%']
Workers improved  accuracies:  ['35.572%', '35.102%', '33.455%', '32.535%', '31.080%', '29.925%', '29.027%', '27.144%', '26.610%', '25.540%', '23.572%', '20.984%', '23.914%', '20.107%', '20.578%', '19.594%', '18.460%', '18.567%', '16.813%', '17.882%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 79.0667%
Leave-one-out validation accuracies :  ['79.1333%', '79.2000%', '79.2000%', '79.2000%', '79.2667%', '79.3333%', '79.3333%', '79.2667%', '79.2000%', '79.3333%', '79.2000%', '79.2667%', '79.4000%', '79.5333%', '79.5333%', '79.4000%', '79.4667%', '79.3333%', '79.4000%', '79.2667%']
Computed and normalized credits:  tensor([0.0502, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
        0.0500, 0.0501, 0.0501, 0.0499, 0.0498, 0.0498, 0.0499, 0.0498, 0.0500,
        0.0499, 0.0500])
Federated model performance: Loss: 0.444457. Accuracy: 79.9358%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['53.733%', '58.759%', '66.096%', '67.679%', '72.321%', '72.642%', '73.412%', '75.102%', '74.738%', '74.417%', '75.914%', '74.866%', '76.342%', '76.193%', '76.941%', '76.385%', '76.471%', '76.963%', '77.262%', '77.904%']
Workers federated accuracies:  ['79.059%', '79.123%', '79.380%', '79.251%', '79.594%', '79.465%', '79.230%', '79.658%', '79.380%', '79.209%', '79.615%', '78.952%', '79.765%', '79.144%', '80.128%', '79.722%', '79.487%', '79.615%', '79.850%', '80.235%']
Workers improved  accuracies:  ['35.893%', '35.166%', '33.583%', '32.599%', '31.380%', '30.139%', '29.070%', '27.187%', '26.610%', '25.561%', '23.679%', '21.134%', '24.000%', '20.171%', '20.984%', '19.829%', '18.610%', '18.567%', '17.155%', '18.053%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4667%', '79.4667%', '79.5333%', '79.6000%', '79.6667%', '79.6000%', '79.5333%', '79.5333%', '79.5333%', '79.6000%', '79.6000%', '79.6000%', '79.5333%', '79.5333%', '79.5333%', '79.5333%', '79.6667%', '79.6667%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0499, 0.0499])
Federated model performance: Loss: 0.445001. Accuracy: 79.6578%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['54.802%', '60.299%', '67.487%', '68.535%', '73.283%', '73.369%', '73.904%', '75.487%', '75.209%', '74.866%', '76.150%', '75.016%', '76.856%', '76.471%', '77.241%', '76.770%', '76.834%', '77.219%', '77.519%', '77.947%']
Workers federated accuracies:  ['79.166%', '79.144%', '79.551%', '79.316%', '79.722%', '79.529%', '79.380%', '79.765%', '79.380%', '79.187%', '79.701%', '79.209%', '79.979%', '79.187%', '80.193%', '79.872%', '79.594%', '79.979%', '80.107%', '80.706%']
Workers improved  accuracies:  ['36.000%', '35.187%', '33.754%', '32.663%', '31.508%', '30.203%', '29.219%', '27.294%', '26.610%', '25.540%', '23.765%', '21.390%', '24.214%', '20.214%', '21.048%', '19.979%', '18.717%', '18.930%', '17.412%', '18.524%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.445001. Accuracy: 79.6578%.
Workers before    accuracies:  ['43.166%', '43.957%', '45.797%', '46.652%', '48.214%', '49.326%', '50.160%', '52.471%', '52.770%', '53.647%', '55.936%', '57.818%', '55.765%', '58.973%', '59.144%', '59.893%', '60.877%', '61.048%', '62.695%', '62.182%']
Workers standlone accuracies:  ['54.802%', '60.299%', '67.487%', '68.535%', '73.283%', '73.369%', '73.904%', '75.487%', '75.209%', '74.866%', '76.150%', '75.016%', '76.856%', '76.471%', '77.241%', '76.770%', '76.834%', '77.219%', '77.519%', '77.947%']
Workers federated accuracies:  ['79.166%', '79.144%', '79.551%', '79.316%', '79.722%', '79.529%', '79.380%', '79.765%', '79.380%', '79.187%', '79.701%', '79.209%', '79.979%', '79.187%', '80.193%', '79.872%', '79.594%', '79.979%', '80.107%', '80.706%']
Workers improved  accuracies:  ['36.000%', '35.187%', '33.754%', '32.663%', '31.508%', '30.203%', '29.219%', '27.294%', '26.610%', '25.540%', '23.765%', '21.390%', '24.214%', '20.214%', '21.048%', '19.979%', '18.717%', '18.930%', '17.412%', '18.524%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.1818608675491088, 0.4428608688628515)
Correlation between stand alone test acc & collaborative final model acc:  (0.5474798819840652, 0.012468658775093917)
Correlation between test_acc & sharing contributions:  (0.6655034505328259, 0.0013625074437142468)
Correlation between test_acc improvements & sharing_contributions:  (-0.9851957740832009, 3.074670675884687e-15)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.669239. Accuracy: 62.0535%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.8667%', '76.6000%', '76.4000%', '76.3333%', '76.4667%', '76.8000%', '77.0000%', '76.8667%', '76.9333%', '77.3333%', '77.1333%', '77.1333%', '77.0667%', '77.2000%', '77.2667%', '77.4667%', '77.4000%', '77.2667%', '77.4000%', '77.5333%']
Computed and normalized credits:  tensor([0.0502, 0.0505, 0.0507, 0.0508, 0.0506, 0.0502, 0.0500, 0.0502, 0.0501,
        0.0497, 0.0499, 0.0499, 0.0500, 0.0498, 0.0497, 0.0495, 0.0496, 0.0497,
        0.0496, 0.0494])
Federated model performance: Loss: 0.488093. Accuracy: 76.2353%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['51.850%', '54.096%', '54.781%', '59.037%', '60.150%', '60.385%', '62.503%', '64.021%', '65.283%', '66.332%', '68.663%', '69.497%', '69.369%', '70.096%', '69.241%', '71.187%', '71.765%', '72.043%', '72.364%', '72.342%']
Workers federated accuracies:  ['76.000%', '76.000%', '76.128%', '76.107%', '76.278%', '76.171%', '76.385%', '76.235%', '76.513%', '76.364%', '76.321%', '76.235%', '76.449%', '76.214%', '76.471%', '76.578%', '76.342%', '76.342%', '76.556%', '76.471%']
Workers improved  accuracies:  ['26.118%', '24.257%', '24.064%', '20.428%', '19.936%', '20.043%', '18.396%', '16.471%', '16.428%', '14.759%', '13.134%', '11.487%', '12.107%', '10.738%', '11.850%', '9.647%', '8.535%', '8.471%', '7.957%', '7.487%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 77.9333%
Leave-one-out validation accuracies :  ['77.8000%', '77.7333%', '77.8667%', '77.8667%', '77.8667%', '78.0000%', '78.0000%', '78.0667%', '78.0667%', '78.0000%', '78.2667%', '78.0667%', '78.4667%', '78.4667%', '78.6000%', '78.6000%', '78.5333%', '78.3333%', '78.6667%', '78.6000%']
Computed and normalized credits:  tensor([0.0504, 0.0505, 0.0504, 0.0504, 0.0504, 0.0502, 0.0502, 0.0502, 0.0501,
        0.0502, 0.0499, 0.0501, 0.0497, 0.0497, 0.0495, 0.0495, 0.0496, 0.0498,
        0.0494, 0.0495])
Federated model performance: Loss: 0.464414. Accuracy: 77.8182%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['53.091%', '56.449%', '57.455%', '62.652%', '63.786%', '63.679%', '66.053%', '67.872%', '69.005%', '70.032%', '71.615%', '71.893%', '71.936%', '72.578%', '72.064%', '73.155%', '73.561%', '73.818%', '74.310%', '73.989%']
Workers federated accuracies:  ['77.519%', '77.241%', '77.690%', '77.455%', '77.561%', '77.519%', '77.455%', '77.305%', '77.775%', '77.626%', '77.626%', '77.626%', '77.540%', '77.455%', '77.476%', '77.626%', '77.668%', '77.690%', '77.904%', '77.818%']
Workers improved  accuracies:  ['27.636%', '25.497%', '25.626%', '21.775%', '21.219%', '21.390%', '19.465%', '17.540%', '17.690%', '16.021%', '14.439%', '12.877%', '13.198%', '11.979%', '12.856%', '10.695%', '9.861%', '9.818%', '9.305%', '8.834%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.0667%', '78.2000%', '78.2000%', '78.2667%', '78.2667%', '78.2667%', '78.2667%', '78.2667%', '78.2667%', '78.3333%', '78.4667%', '78.4000%', '78.4667%', '78.4667%', '78.2667%', '78.3333%', '78.1333%', '78.1333%', '78.2000%', '78.6667%']
Computed and normalized credits:  tensor([0.0503, 0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
        0.0500, 0.0498, 0.0499, 0.0498, 0.0498, 0.0500, 0.0499, 0.0501, 0.0502,
        0.0501, 0.0496])
Federated model performance: Loss: 0.454246. Accuracy: 78.2032%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['54.139%', '58.567%', '60.043%', '64.834%', '66.545%', '66.075%', '68.749%', '70.310%', '71.294%', '71.872%', '73.241%', '73.305%', '73.497%', '73.519%', '73.390%', '74.075%', '74.439%', '74.439%', '75.316%', '74.930%']
Workers federated accuracies:  ['77.561%', '77.561%', '77.711%', '77.604%', '77.840%', '77.904%', '77.861%', '77.775%', '77.989%', '77.840%', '78.011%', '78.160%', '77.904%', '77.968%', '78.053%', '77.947%', '78.032%', '77.989%', '78.267%', '78.246%']
Workers improved  accuracies:  ['27.679%', '25.818%', '25.647%', '21.925%', '21.497%', '21.775%', '19.872%', '18.011%', '17.904%', '16.235%', '14.824%', '13.412%', '13.561%', '12.492%', '13.433%', '11.016%', '10.225%', '10.118%', '9.668%', '9.262%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.0667%', '78.0000%', '78.0000%', '78.0667%', '78.2667%', '78.2000%', '78.4000%', '78.3333%', '78.1333%', '78.0667%', '77.7333%', '77.6667%', '77.8667%', '77.8000%', '78.0667%', '78.4000%', '78.3333%', '78.1333%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0498, 0.0499, 0.0497,
        0.0497, 0.0499, 0.0500, 0.0504, 0.0504, 0.0502, 0.0503, 0.0500, 0.0497,
        0.0497, 0.0499])
Federated model performance: Loss: 0.447772. Accuracy: 78.7380%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['55.743%', '60.620%', '62.053%', '67.166%', '68.749%', '68.107%', '70.674%', '71.914%', '72.428%', '72.898%', '73.733%', '74.310%', '74.332%', '74.652%', '74.246%', '74.845%', '75.187%', '75.209%', '76.128%', '75.701%']
Workers federated accuracies:  ['77.840%', '77.647%', '77.989%', '78.053%', '78.203%', '78.096%', '78.267%', '78.032%', '78.353%', '78.246%', '78.332%', '78.267%', '78.246%', '78.139%', '78.289%', '78.417%', '78.567%', '78.310%', '78.674%', '78.610%']
Workers improved  accuracies:  ['27.957%', '25.904%', '25.925%', '22.374%', '21.861%', '21.968%', '20.278%', '18.267%', '18.267%', '16.642%', '15.144%', '13.519%', '13.904%', '12.663%', '13.668%', '11.487%', '10.759%', '10.439%', '10.075%', '9.626%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 78.2667%
Leave-one-out validation accuracies :  ['78.2667%', '78.2667%', '78.2667%', '78.2667%', '78.2667%', '78.2667%', '78.0667%', '78.0667%', '78.2000%', '78.4000%', '78.6000%', '78.4000%', '78.3333%', '78.4000%', '78.2667%', '78.5333%', '78.7333%', '78.8667%', '78.8667%', '78.6000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0503, 0.0503, 0.0502,
        0.0500, 0.0498, 0.0500, 0.0501, 0.0500, 0.0502, 0.0499, 0.0496, 0.0495,
        0.0495, 0.0498])
Federated model performance: Loss: 0.445288. Accuracy: 79.2513%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['57.604%', '62.374%', '63.850%', '68.791%', '70.460%', '69.668%', '71.850%', '72.898%', '73.561%', '74.118%', '74.203%', '74.781%', '74.952%', '75.187%', '74.952%', '75.487%', '75.679%', '75.807%', '76.642%', '76.214%']
Workers federated accuracies:  ['78.032%', '78.096%', '78.160%', '78.374%', '78.289%', '78.203%', '78.417%', '78.353%', '78.545%', '78.289%', '78.503%', '78.567%', '78.695%', '78.524%', '78.717%', '78.717%', '78.845%', '78.824%', '78.845%', '78.781%']
Workers improved  accuracies:  ['28.150%', '26.353%', '26.096%', '22.695%', '21.947%', '22.075%', '20.428%', '18.588%', '18.460%', '16.684%', '15.316%', '13.818%', '14.353%', '13.048%', '14.096%', '11.786%', '11.037%', '10.952%', '10.246%', '9.797%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 78.3333%
Leave-one-out validation accuracies :  ['78.3333%', '78.5333%', '78.5333%', '78.4000%', '78.4667%', '78.4000%', '78.5333%', '78.6000%', '78.9333%', '78.6000%', '78.5333%', '78.1333%', '78.3333%', '78.2000%', '78.2000%', '78.0667%', '78.1333%', '78.0667%', '78.2000%', '78.4000%']
Computed and normalized credits:  tensor([0.0501, 0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0499, 0.0498, 0.0494,
        0.0498, 0.0498, 0.0503, 0.0501, 0.0502, 0.0502, 0.0503, 0.0502, 0.0503,
        0.0501, 0.0500])
Federated model performance: Loss: 0.444219. Accuracy: 79.3369%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['59.294%', '63.615%', '65.733%', '70.096%', '72.000%', '70.759%', '72.642%', '73.604%', '73.904%', '74.610%', '74.588%', '75.422%', '75.465%', '75.765%', '75.722%', '75.807%', '76.150%', '76.128%', '77.155%', '76.663%']
Workers federated accuracies:  ['78.374%', '78.310%', '78.503%', '78.417%', '78.824%', '78.738%', '78.695%', '78.610%', '78.802%', '78.695%', '78.888%', '78.866%', '78.930%', '78.824%', '79.102%', '78.888%', '78.973%', '79.080%', '79.166%', '78.952%']
Workers improved  accuracies:  ['28.492%', '26.567%', '26.439%', '22.738%', '22.481%', '22.610%', '20.706%', '18.845%', '18.717%', '17.091%', '15.701%', '14.118%', '14.588%', '13.348%', '14.481%', '11.957%', '11.166%', '11.209%', '10.567%', '9.968%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 77.8667%
Leave-one-out validation accuracies :  ['77.8667%', '77.8000%', '77.8000%', '77.8000%', '77.8667%', '77.8000%', '77.9333%', '78.0667%', '78.0667%', '78.1333%', '77.9333%', '77.9333%', '77.8667%', '77.9333%', '77.9333%', '77.8667%', '77.9333%', '77.9333%', '77.8000%', '77.7333%']
Computed and normalized credits:  tensor([0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500, 0.0498, 0.0498,
        0.0497, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500,
        0.0501, 0.0502])
Federated model performance: Loss: 0.443685. Accuracy: 79.1872%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['60.492%', '64.984%', '67.166%', '70.909%', '72.898%', '71.594%', '73.390%', '73.925%', '74.439%', '74.845%', '74.973%', '75.893%', '75.701%', '76.235%', '76.171%', '76.299%', '76.342%', '76.471%', '77.390%', '76.727%']
Workers federated accuracies:  ['78.674%', '78.503%', '78.610%', '78.610%', '79.187%', '78.888%', '78.845%', '78.866%', '78.845%', '79.037%', '79.144%', '78.973%', '79.037%', '78.995%', '79.358%', '79.059%', '79.230%', '79.102%', '79.273%', '79.209%']
Workers improved  accuracies:  ['28.791%', '26.759%', '26.545%', '22.930%', '22.845%', '22.759%', '20.856%', '19.102%', '18.759%', '17.433%', '15.957%', '14.225%', '14.695%', '13.519%', '14.738%', '12.128%', '11.422%', '11.230%', '10.674%', '10.225%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.0667%', '78.0667%', '78.0667%', '78.0667%', '77.9333%', '78.0000%', '77.9333%', '78.0667%', '78.0000%', '78.0000%', '77.9333%', '77.8667%', '77.9333%', '77.8667%', '77.8000%', '77.7333%', '77.8000%', '77.8667%', '77.6000%', '77.6000%']
Computed and normalized credits:  tensor([0.0498, 0.0498, 0.0498, 0.0498, 0.0500, 0.0499, 0.0500, 0.0498, 0.0499,
        0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0501, 0.0500,
        0.0503, 0.0504])
Federated model performance: Loss: 0.446488. Accuracy: 79.1658%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['61.989%', '66.096%', '68.428%', '71.872%', '73.369%', '72.342%', '73.818%', '74.524%', '75.187%', '75.037%', '75.380%', '76.193%', '76.043%', '76.406%', '76.556%', '76.642%', '76.471%', '76.620%', '77.647%', '77.176%']
Workers federated accuracies:  ['78.503%', '78.610%', '78.567%', '78.695%', '79.037%', '78.824%', '79.016%', '78.802%', '79.187%', '79.102%', '79.251%', '79.209%', '79.166%', '78.995%', '79.594%', '79.273%', '79.594%', '79.166%', '79.701%', '79.358%']
Workers improved  accuracies:  ['28.620%', '26.866%', '26.503%', '23.016%', '22.695%', '22.695%', '21.027%', '19.037%', '19.102%', '17.497%', '16.064%', '14.460%', '14.824%', '13.519%', '14.973%', '12.342%', '11.786%', '11.294%', '11.102%', '10.374%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 77.6667%
Leave-one-out validation accuracies :  ['77.6667%', '77.7333%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.6000%', '77.7333%', '77.8667%', '77.7333%', '77.6667%', '77.7333%', '77.6667%', '77.5333%', '77.5333%', '77.7333%', '77.6667%', '77.6000%', '77.4667%', '77.4667%']
Computed and normalized credits:  tensor([0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0499, 0.0498,
        0.0499, 0.0500, 0.0499, 0.0500, 0.0502, 0.0502, 0.0500, 0.0500, 0.0501,
        0.0503, 0.0503])
Federated model performance: Loss: 0.449598. Accuracy: 79.3369%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['63.251%', '67.037%', '69.433%', '72.984%', '74.011%', '73.369%', '74.439%', '74.802%', '75.551%', '75.594%', '75.679%', '76.578%', '76.364%', '76.642%', '76.941%', '76.834%', '76.706%', '76.898%', '77.882%', '77.326%']
Workers federated accuracies:  ['78.567%', '78.610%', '78.631%', '78.802%', '79.144%', '78.824%', '79.102%', '78.952%', '79.209%', '79.059%', '79.294%', '79.273%', '79.166%', '79.123%', '79.722%', '79.465%', '79.636%', '79.444%', '79.872%', '79.487%']
Workers improved  accuracies:  ['28.684%', '26.866%', '26.567%', '23.123%', '22.802%', '22.695%', '21.112%', '19.187%', '19.123%', '17.455%', '16.107%', '14.524%', '14.824%', '13.647%', '15.102%', '12.535%', '11.829%', '11.572%', '11.273%', '10.503%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 77.6667%
Leave-one-out validation accuracies :  ['77.7333%', '77.8000%', '77.6000%', '77.6667%', '77.8000%', '77.8667%', '77.9333%', '77.9333%', '77.9333%', '77.8667%', '77.9333%', '78.0667%', '77.8667%', '77.8000%', '77.7333%', '77.7333%', '77.6667%', '77.5333%', '77.4667%', '77.4667%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0502, 0.0501, 0.0500, 0.0499, 0.0498, 0.0498, 0.0498,
        0.0499, 0.0498, 0.0497, 0.0499, 0.0500, 0.0501, 0.0500, 0.0501, 0.0503,
        0.0504, 0.0504])
Federated model performance: Loss: 0.454238. Accuracy: 79.0802%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['64.321%', '67.829%', '70.118%', '73.326%', '74.203%', '74.332%', '74.759%', '75.102%', '75.658%', '75.701%', '75.957%', '76.749%', '76.513%', '76.749%', '77.219%', '77.048%', '76.856%', '76.963%', '78.053%', '77.519%']
Workers federated accuracies:  ['78.588%', '78.588%', '78.695%', '78.930%', '79.316%', '78.824%', '79.209%', '79.037%', '79.273%', '79.251%', '79.337%', '79.380%', '79.273%', '79.123%', '79.679%', '79.508%', '79.636%', '79.487%', '79.914%', '79.615%']
Workers improved  accuracies:  ['28.706%', '26.845%', '26.631%', '23.251%', '22.973%', '22.695%', '21.219%', '19.273%', '19.187%', '17.647%', '16.150%', '14.631%', '14.930%', '13.647%', '15.059%', '12.578%', '11.829%', '11.615%', '11.316%', '10.631%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.454238. Accuracy: 79.0802%.
Workers before    accuracies:  ['49.882%', '51.743%', '52.064%', '55.679%', '56.342%', '56.128%', '57.989%', '59.765%', '60.086%', '61.604%', '63.187%', '64.749%', '64.342%', '65.476%', '64.620%', '66.930%', '67.807%', '67.872%', '68.599%', '68.984%']
Workers standlone accuracies:  ['64.321%', '67.829%', '70.118%', '73.326%', '74.203%', '74.332%', '74.759%', '75.102%', '75.658%', '75.701%', '75.957%', '76.749%', '76.513%', '76.749%', '77.219%', '77.048%', '76.856%', '76.963%', '78.053%', '77.519%']
Workers federated accuracies:  ['78.588%', '78.588%', '78.695%', '78.930%', '79.316%', '78.824%', '79.209%', '79.037%', '79.273%', '79.251%', '79.337%', '79.380%', '79.273%', '79.123%', '79.679%', '79.508%', '79.636%', '79.487%', '79.914%', '79.615%']
Workers improved  accuracies:  ['28.706%', '26.845%', '26.631%', '23.251%', '22.973%', '22.695%', '21.219%', '19.273%', '19.187%', '17.647%', '16.150%', '14.631%', '14.930%', '13.647%', '15.059%', '12.578%', '11.829%', '11.615%', '11.316%', '10.631%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.008676517643858676, 0.9710395162789207)
Correlation between stand alone test acc & collaborative final model acc:  (0.850810296469408, 1.9970705105077377e-06)
Correlation between test_acc & sharing contributions:  (0.8978503524879752, 7.897179357599632e-08)
Correlation between test_acc improvements & sharing_contributions:  (-0.9842914401293509, 5.22554574242827e-15)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.656561. Accuracy: 61.3690%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 75.9333%
Leave-one-out validation accuracies :  ['75.9333%', '75.9333%', '75.8667%', '75.8000%', '75.8667%', '76.0000%', '75.8000%', '75.4667%', '75.5333%', '75.6000%', '75.7333%', '75.8000%', '75.8000%', '75.7333%', '75.6667%', '75.6667%', '75.7333%', '75.8667%', '75.9333%', '75.9333%']
Computed and normalized credits:  tensor([0.0498, 0.0498, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500, 0.0504, 0.0503,
        0.0502, 0.0501, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0499,
        0.0498, 0.0498])
Federated model performance: Loss: 0.472711. Accuracy: 75.4011%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['55.701%', '56.877%', '57.027%', '60.086%', '60.193%', '60.770%', '61.519%', '62.567%', '63.743%', '64.471%', '65.754%', '67.166%', '66.396%', '67.529%', '67.422%', '69.070%', '70.845%', '69.968%', '71.187%', '71.316%']
Workers federated accuracies:  ['75.209%', '75.316%', '75.358%', '75.444%', '75.615%', '75.465%', '75.615%', '75.401%', '75.679%', '75.337%', '75.444%', '75.422%', '75.850%', '75.572%', '75.594%', '75.594%', '75.487%', '75.529%', '75.893%', '75.572%']
Workers improved  accuracies:  ['20.684%', '20.043%', '19.829%', '17.818%', '17.754%', '16.920%', '16.235%', '15.422%', '14.481%', '13.668%', '12.877%', '12.385%', '12.941%', '11.979%', '12.278%', '11.380%', '10.374%', '10.396%', '9.455%', '9.262%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 77.7333%
Leave-one-out validation accuracies :  ['77.6667%', '77.6667%', '77.5333%', '77.4667%', '77.4667%', '77.8000%', '78.0000%', '78.2667%', '77.7333%', '77.9333%', '78.2667%', '78.4667%', '78.2000%', '77.9333%', '77.8667%', '77.8000%', '77.7333%', '77.6000%', '77.5333%', '77.1333%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0503, 0.0504, 0.0504, 0.0500, 0.0498, 0.0495, 0.0501,
        0.0499, 0.0495, 0.0493, 0.0496, 0.0499, 0.0499, 0.0500, 0.0501, 0.0502,
        0.0503, 0.0507])
Federated model performance: Loss: 0.453574. Accuracy: 77.8824%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['56.449%', '58.652%', '58.802%', '61.604%', '62.374%', '62.610%', '63.722%', '65.390%', '66.417%', '67.294%', '69.326%', '70.824%', '70.118%', '71.230%', '71.465%', '72.385%', '72.920%', '72.235%', '73.668%', '73.455%']
Workers federated accuracies:  ['77.283%', '77.283%', '77.198%', '77.348%', '77.583%', '77.390%', '77.390%', '77.305%', '77.348%', '77.326%', '77.390%', '77.348%', '77.626%', '77.390%', '77.519%', '77.668%', '77.369%', '77.326%', '77.540%', '77.604%']
Workers improved  accuracies:  ['22.759%', '22.011%', '21.668%', '19.722%', '19.722%', '18.845%', '18.011%', '17.326%', '16.150%', '15.658%', '14.824%', '14.310%', '14.717%', '13.797%', '14.203%', '13.455%', '12.257%', '12.193%', '11.102%', '11.294%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 77.6667%
Leave-one-out validation accuracies :  ['77.6667%', '77.6667%', '77.8000%', '77.7333%', '77.6667%', '77.8000%', '78.1333%', '78.2000%', '78.0667%', '78.4000%', '78.7333%', '78.6000%', '78.4000%', '78.4667%', '78.5333%', '78.6000%', '78.6000%', '78.8667%', '78.8000%', '78.2667%']
Computed and normalized credits:  tensor([0.0507, 0.0507, 0.0505, 0.0506, 0.0507, 0.0505, 0.0501, 0.0500, 0.0502,
        0.0498, 0.0494, 0.0495, 0.0498, 0.0497, 0.0497, 0.0496, 0.0496, 0.0493,
        0.0494, 0.0500])
Federated model performance: Loss: 0.447457. Accuracy: 78.5241%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['57.433%', '59.615%', '60.278%', '63.380%', '63.893%', '64.791%', '66.310%', '68.620%', '69.369%', '70.866%', '71.529%', '72.599%', '71.936%', '72.834%', '73.134%', '73.690%', '74.246%', '73.754%', '74.759%', '74.588%']
Workers federated accuracies:  ['77.626%', '77.540%', '77.604%', '77.668%', '77.925%', '77.775%', '77.947%', '77.690%', '77.904%', '77.861%', '78.032%', '78.053%', '78.053%', '78.160%', '78.139%', '78.332%', '78.246%', '77.968%', '78.246%', '78.182%']
Workers improved  accuracies:  ['23.102%', '22.267%', '22.075%', '20.043%', '20.064%', '19.230%', '18.567%', '17.711%', '16.706%', '16.193%', '15.465%', '15.016%', '15.144%', '14.567%', '14.824%', '14.118%', '13.134%', '12.834%', '11.807%', '11.872%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 78.8667%
Leave-one-out validation accuracies :  ['78.8667%', '78.8667%', '78.9333%', '78.8667%', '78.8000%', '78.7333%', '78.6667%', '78.7333%', '78.6667%', '78.6667%', '79.0667%', '79.2000%', '79.2667%', '79.2667%', '79.2000%', '79.1333%', '79.0000%', '79.2667%', '79.0000%', '78.6667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0501, 0.0502, 0.0503, 0.0503, 0.0502, 0.0503,
        0.0503, 0.0498, 0.0497, 0.0496, 0.0496, 0.0497, 0.0498, 0.0499, 0.0496,
        0.0499, 0.0503])
Federated model performance: Loss: 0.445137. Accuracy: 78.8235%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['58.695%', '60.706%', '61.497%', '64.834%', '65.476%', '66.802%', '69.348%', '70.460%', '71.508%', '72.492%', '72.749%', '73.540%', '73.241%', '74.075%', '74.246%', '74.738%', '75.080%', '74.481%', '75.658%', '75.487%']
Workers federated accuracies:  ['77.797%', '77.861%', '78.032%', '78.118%', '78.225%', '78.139%', '78.182%', '77.989%', '78.118%', '78.246%', '78.289%', '78.396%', '78.417%', '78.567%', '78.439%', '78.503%', '78.545%', '78.417%', '78.503%', '78.588%']
Workers improved  accuracies:  ['23.273%', '22.588%', '22.503%', '20.492%', '20.364%', '19.594%', '18.802%', '18.011%', '16.920%', '16.578%', '15.722%', '15.358%', '15.508%', '14.973%', '15.123%', '14.289%', '13.433%', '13.283%', '12.064%', '12.278%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '78.9333%', '79.0000%', '79.1333%', '79.2000%', '79.0000%', '79.0000%', '79.2000%', '79.2667%', '79.2667%', '79.2000%', '79.2667%', '79.2000%', '79.0667%', '78.9333%', '78.8000%', '78.8000%', '78.8000%', '78.6667%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0501, 0.0499, 0.0498, 0.0501, 0.0501, 0.0499,
        0.0498, 0.0497, 0.0498, 0.0497, 0.0498, 0.0499, 0.0501, 0.0502, 0.0502,
        0.0502, 0.0504])
Federated model performance: Loss: 0.445826. Accuracy: 79.0160%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['59.358%', '61.668%', '62.503%', '66.802%', '67.401%', '68.706%', '71.166%', '72.107%', '72.535%', '73.134%', '73.519%', '74.374%', '74.032%', '75.037%', '75.037%', '75.572%', '75.765%', '75.209%', '76.193%', '76.214%']
Workers federated accuracies:  ['78.075%', '78.182%', '78.332%', '78.246%', '78.481%', '78.545%', '78.588%', '78.353%', '78.396%', '78.610%', '78.503%', '78.674%', '78.802%', '78.738%', '78.781%', '78.674%', '78.824%', '78.695%', '78.759%', '78.888%']
Workers improved  accuracies:  ['23.551%', '22.909%', '22.802%', '20.620%', '20.620%', '20.000%', '19.209%', '18.374%', '17.198%', '16.941%', '15.936%', '15.636%', '15.893%', '15.144%', '15.465%', '14.460%', '13.711%', '13.561%', '12.321%', '12.578%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 78.9333%
Leave-one-out validation accuracies :  ['78.9333%', '79.0000%', '79.0000%', '78.9333%', '78.9333%', '78.8667%', '78.9333%', '78.8667%', '79.0000%', '79.0000%', '78.7333%', '78.7333%', '78.7333%', '78.4667%', '78.6000%', '78.4667%', '78.6000%', '78.4000%', '78.4667%', '78.4000%']
Computed and normalized credits:  tensor([0.0498, 0.0497, 0.0497, 0.0498, 0.0498, 0.0499, 0.0498, 0.0499, 0.0497,
        0.0497, 0.0500, 0.0500, 0.0500, 0.0503, 0.0502, 0.0503, 0.0502, 0.0504,
        0.0503, 0.0504])
Federated model performance: Loss: 0.448365. Accuracy: 79.2727%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['60.171%', '62.332%', '63.594%', '68.257%', '69.070%', '70.246%', '72.214%', '72.599%', '73.134%', '73.733%', '74.310%', '75.209%', '74.717%', '75.401%', '75.380%', '76.193%', '76.364%', '75.658%', '76.299%', '76.706%']
Workers federated accuracies:  ['78.203%', '78.246%', '78.396%', '78.524%', '78.845%', '78.695%', '78.738%', '78.503%', '78.695%', '78.909%', '78.866%', '78.909%', '79.209%', '78.845%', '79.209%', '79.059%', '78.930%', '78.802%', '79.166%', '79.123%']
Workers improved  accuracies:  ['23.679%', '22.973%', '22.866%', '20.898%', '20.984%', '20.150%', '19.358%', '18.524%', '17.497%', '17.241%', '16.299%', '15.872%', '16.299%', '15.251%', '15.893%', '14.845%', '13.818%', '13.668%', '12.727%', '12.813%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 78.5333%
Leave-one-out validation accuracies :  ['78.6000%', '78.5333%', '78.6000%', '78.5333%', '78.4667%', '78.6000%', '78.6000%', '78.7333%', '78.8667%', '79.0000%', '78.8000%', '78.8667%', '78.9333%', '78.8000%', '78.6000%', '78.5333%', '78.4000%', '78.2667%', '78.3333%', '78.3333%']
Computed and normalized credits:  tensor([0.0500, 0.0501, 0.0500, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497,
        0.0496, 0.0498, 0.0497, 0.0497, 0.0498, 0.0500, 0.0501, 0.0503, 0.0504,
        0.0503, 0.0503])
Federated model performance: Loss: 0.452443. Accuracy: 79.0802%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['60.770%', '63.144%', '64.620%', '69.882%', '70.396%', '71.123%', '72.834%', '73.668%', '73.754%', '74.567%', '74.781%', '75.765%', '75.273%', '75.829%', '75.786%', '76.599%', '76.513%', '75.872%', '76.727%', '76.898%']
Workers federated accuracies:  ['78.460%', '78.524%', '78.460%', '78.717%', '79.166%', '78.674%', '78.781%', '78.759%', '79.037%', '78.995%', '79.080%', '79.037%', '79.337%', '79.144%', '79.209%', '79.187%', '79.294%', '79.102%', '79.251%', '79.316%']
Workers improved  accuracies:  ['23.936%', '23.251%', '22.930%', '21.091%', '21.305%', '20.128%', '19.401%', '18.781%', '17.840%', '17.326%', '16.513%', '16.000%', '16.428%', '15.551%', '15.893%', '14.973%', '14.182%', '13.968%', '12.813%', '13.005%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6667%', '78.8000%', '78.8000%', '78.7333%', '78.6000%', '78.5333%', '78.6000%', '78.6000%', '78.6667%', '78.6667%', '78.6667%', '78.6667%', '78.4667%', '78.4000%', '78.4667%', '78.4000%', '78.3333%', '78.0667%', '77.9333%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0497, 0.0497, 0.0498, 0.0499, 0.0500, 0.0499, 0.0499,
        0.0498, 0.0498, 0.0498, 0.0498, 0.0501, 0.0501, 0.0501, 0.0502, 0.0503,
        0.0505, 0.0507])
Federated model performance: Loss: 0.457474. Accuracy: 79.0374%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['61.647%', '64.086%', '65.412%', '71.209%', '71.508%', '71.829%', '73.476%', '74.310%', '74.567%', '74.866%', '75.102%', '75.893%', '75.594%', '76.150%', '76.107%', '76.877%', '76.727%', '76.235%', '76.941%', '77.112%']
Workers federated accuracies:  ['78.695%', '78.610%', '78.652%', '78.995%', '79.316%', '78.781%', '78.759%', '78.930%', '79.209%', '79.166%', '79.187%', '79.080%', '79.273%', '79.187%', '79.273%', '79.401%', '79.444%', '79.294%', '79.251%', '79.465%']
Workers improved  accuracies:  ['24.171%', '23.337%', '23.123%', '21.369%', '21.455%', '20.235%', '19.380%', '18.952%', '18.011%', '17.497%', '16.620%', '16.043%', '16.364%', '15.594%', '15.957%', '15.187%', '14.332%', '14.160%', '12.813%', '13.155%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 78.3333%
Leave-one-out validation accuracies :  ['78.4000%', '78.4667%', '78.4667%', '78.5333%', '78.4000%', '78.2667%', '78.2667%', '78.3333%', '78.3333%', '78.2000%', '78.1333%', '78.2000%', '78.2667%', '78.2000%', '77.9333%', '78.0000%', '78.1333%', '77.9333%', '77.7333%', '77.8000%']
Computed and normalized credits:  tensor([0.0498, 0.0497, 0.0497, 0.0496, 0.0498, 0.0499, 0.0499, 0.0498, 0.0498,
        0.0500, 0.0501, 0.0500, 0.0499, 0.0500, 0.0503, 0.0502, 0.0501, 0.0503,
        0.0506, 0.0505])
Federated model performance: Loss: 0.463873. Accuracy: 78.8877%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['62.203%', '65.112%', '66.652%', '71.936%', '72.492%', '72.449%', '74.139%', '74.674%', '74.759%', '75.273%', '75.294%', '76.193%', '76.000%', '76.364%', '76.193%', '77.241%', '76.727%', '76.193%', '77.219%', '77.241%']
Workers federated accuracies:  ['78.631%', '78.717%', '78.652%', '79.187%', '79.316%', '78.824%', '78.866%', '79.059%', '79.316%', '79.316%', '79.251%', '79.358%', '79.551%', '79.337%', '79.422%', '79.401%', '79.658%', '79.422%', '79.465%', '79.422%']
Workers improved  accuracies:  ['24.107%', '23.444%', '23.123%', '21.561%', '21.455%', '20.278%', '19.487%', '19.080%', '18.118%', '17.647%', '16.684%', '16.321%', '16.642%', '15.743%', '16.107%', '15.187%', '14.545%', '14.289%', '13.027%', '13.112%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['77.9333%', '78.0000%', '77.9333%', '78.0000%', '78.0000%', '78.0667%', '78.2000%', '78.1333%', '78.1333%', '77.8667%', '77.8667%', '77.6667%', '77.6667%', '77.8000%', '77.8000%', '77.6667%', '77.7333%', '77.6667%', '77.6667%', '77.8667%']
Computed and normalized credits:  tensor([0.0499, 0.0498, 0.0499, 0.0498, 0.0499, 0.0498, 0.0496, 0.0497, 0.0497,
        0.0500, 0.0500, 0.0502, 0.0502, 0.0501, 0.0501, 0.0503, 0.0502, 0.0503,
        0.0503, 0.0501])
Federated model performance: Loss: 0.471851. Accuracy: 78.8449%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['62.652%', '65.733%', '67.914%', '72.535%', '73.262%', '72.749%', '74.524%', '74.759%', '75.273%', '75.422%', '75.465%', '76.471%', '76.428%', '76.556%', '76.513%', '77.326%', '76.877%', '76.449%', '77.262%', '77.412%']
Workers federated accuracies:  ['78.759%', '78.588%', '78.738%', '79.337%', '79.615%', '78.930%', '78.973%', '79.230%', '79.422%', '79.401%', '79.251%', '79.615%', '79.551%', '79.615%', '79.551%', '79.551%', '79.722%', '79.529%', '79.551%', '79.572%']
Workers improved  accuracies:  ['24.235%', '23.316%', '23.209%', '21.711%', '21.754%', '20.385%', '19.594%', '19.251%', '18.225%', '17.733%', '16.684%', '16.578%', '16.642%', '16.021%', '16.235%', '15.337%', '14.610%', '14.396%', '13.112%', '13.262%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.471851. Accuracy: 78.8449%.
Workers before    accuracies:  ['54.524%', '55.273%', '55.529%', '57.626%', '57.861%', '58.545%', '59.380%', '59.979%', '61.198%', '61.668%', '62.567%', '63.037%', '62.909%', '63.594%', '63.316%', '64.214%', '65.112%', '65.134%', '66.439%', '66.310%']
Workers standlone accuracies:  ['62.652%', '65.733%', '67.914%', '72.535%', '73.262%', '72.749%', '74.524%', '74.759%', '75.273%', '75.422%', '75.465%', '76.471%', '76.428%', '76.556%', '76.513%', '77.326%', '76.877%', '76.449%', '77.262%', '77.412%']
Workers federated accuracies:  ['78.759%', '78.588%', '78.738%', '79.337%', '79.615%', '78.930%', '78.973%', '79.230%', '79.422%', '79.401%', '79.251%', '79.615%', '79.551%', '79.615%', '79.551%', '79.551%', '79.722%', '79.529%', '79.551%', '79.572%']
Workers improved  accuracies:  ['24.235%', '23.316%', '23.209%', '21.711%', '21.754%', '20.385%', '19.594%', '19.251%', '18.225%', '17.733%', '16.684%', '16.578%', '16.642%', '16.021%', '16.235%', '15.337%', '14.610%', '14.396%', '13.112%', '13.262%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.08248511385053445, 0.7295514240109658)
Correlation between stand alone test acc & collaborative final model acc:  (0.8548356316572666, 1.5855739086074098e-06)
Correlation between test_acc & sharing contributions:  (0.7822407160956615, 4.59743578637682e-05)
Correlation between test_acc improvements & sharing_contributions:  (-0.9908969660385238, 3.9442195406238294e-17)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.601566. Accuracy: 70.1390%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6667%', '77.6000%', '77.4000%', '77.8000%', '77.6667%', '77.8667%', '78.1333%', '78.3333%', '78.0667%', '77.9333%', '77.8667%', '77.8000%', '78.0667%', '78.1333%', '78.1333%', '78.0667%', '78.0000%', '78.1333%', '77.9333%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0506, 0.0501, 0.0503, 0.0500, 0.0498, 0.0495,
        0.0498, 0.0500, 0.0500, 0.0501, 0.0498, 0.0498, 0.0498, 0.0498, 0.0499,
        0.0498, 0.0500])
Federated model performance: Loss: 0.482352. Accuracy: 76.1925%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['67.209%', '67.658%', '67.936%', '69.305%', '69.497%', '69.947%', '70.738%', '70.567%', '71.444%', '70.995%', '71.743%', '72.107%', '72.086%', '72.791%', '71.701%', '72.749%', '72.684%', '72.920%', '73.476%', '73.198%']
Workers federated accuracies:  ['75.786%', '75.872%', '75.893%', '76.107%', '76.235%', '76.428%', '76.342%', '76.321%', '76.364%', '76.257%', '76.342%', '76.535%', '76.364%', '76.449%', '76.535%', '76.791%', '76.856%', '76.449%', '76.813%', '76.834%']
Workers improved  accuracies:  ['8.877%', '8.620%', '8.235%', '7.957%', '7.979%', '7.722%', '7.187%', '7.059%', '6.353%', '6.588%', '5.711%', '5.519%', '5.540%', '5.091%', '5.904%', '5.326%', '5.433%', '4.963%', '4.791%', '4.963%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 78.3333%
Leave-one-out validation accuracies :  ['78.4000%', '78.3333%', '78.4667%', '78.4667%', '78.4667%', '78.5333%', '78.4000%', '78.4667%', '78.4667%', '78.4667%', '78.4667%', '78.4000%', '78.6000%', '78.6000%', '78.6667%', '78.7333%', '78.8667%', '79.0667%', '79.1333%', '78.9333%']
Computed and normalized credits:  tensor([0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0501, 0.0502, 0.0501, 0.0501,
        0.0501, 0.0501, 0.0502, 0.0500, 0.0500, 0.0499, 0.0498, 0.0497, 0.0495,
        0.0494, 0.0496])
Federated model performance: Loss: 0.461849. Accuracy: 78.0107%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['67.422%', '68.385%', '68.620%', '70.374%', '70.631%', '71.251%', '71.401%', '71.187%', '72.406%', '72.385%', '73.155%', '73.262%', '73.433%', '73.947%', '72.834%', '73.840%', '73.733%', '74.011%', '74.246%', '74.289%']
Workers federated accuracies:  ['77.497%', '77.390%', '77.797%', '77.840%', '77.754%', '77.968%', '78.182%', '77.797%', '78.032%', '77.840%', '78.075%', '78.053%', '78.203%', '78.139%', '77.989%', '78.118%', '78.310%', '78.267%', '78.289%', '78.267%']
Workers improved  accuracies:  ['10.588%', '10.139%', '10.139%', '9.690%', '9.497%', '9.262%', '9.027%', '8.535%', '8.021%', '8.171%', '7.444%', '7.037%', '7.380%', '6.781%', '7.358%', '6.652%', '6.888%', '6.781%', '6.267%', '6.396%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '78.9333%', '79.0667%', '78.9333%', '78.9333%', '78.6667%', '78.6667%', '78.8000%', '78.9333%', '79.0667%', '78.8667%', '79.1333%', '79.1333%', '79.2000%', '79.1333%', '78.9333%', '79.0000%', '79.0000%', '79.2000%', '79.2667%']
Computed and normalized credits:  tensor([0.0500, 0.0501, 0.0499, 0.0501, 0.0501, 0.0504, 0.0504, 0.0502, 0.0501,
        0.0499, 0.0501, 0.0499, 0.0498, 0.0498, 0.0498, 0.0500, 0.0500, 0.0499,
        0.0497, 0.0497])
Federated model performance: Loss: 0.451445. Accuracy: 78.6952%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['67.936%', '68.856%', '69.326%', '71.016%', '71.529%', '72.043%', '72.278%', '71.979%', '73.369%', '73.112%', '74.011%', '73.989%', '74.011%', '74.460%', '73.754%', '74.524%', '74.353%', '74.631%', '74.952%', '74.781%']
Workers federated accuracies:  ['78.481%', '78.417%', '78.503%', '78.481%', '78.588%', '78.545%', '78.631%', '78.503%', '78.738%', '78.524%', '78.674%', '78.738%', '78.930%', '78.674%', '78.824%', '78.824%', '78.909%', '78.802%', '78.845%', '78.781%']
Workers improved  accuracies:  ['11.572%', '11.166%', '10.845%', '10.332%', '10.332%', '9.840%', '9.476%', '9.241%', '8.727%', '8.856%', '8.043%', '7.722%', '8.107%', '7.316%', '8.193%', '7.358%', '7.487%', '7.316%', '6.824%', '6.909%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.6667%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.9333%', '78.8667%', '78.9333%', '79.0000%', '79.0667%', '79.0667%', '79.1333%', '79.1333%', '79.1333%', '79.0000%', '79.0667%', '79.0000%', '79.0000%', '79.1333%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0502, 0.0502, 0.0502, 0.0502, 0.0501, 0.0501, 0.0500,
        0.0499, 0.0499, 0.0499, 0.0498, 0.0498, 0.0498, 0.0500, 0.0499, 0.0499,
        0.0499, 0.0498])
Federated model performance: Loss: 0.444360. Accuracy: 78.7807%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['68.385%', '69.433%', '70.374%', '71.487%', '71.893%', '72.449%', '72.984%', '72.727%', '74.075%', '73.711%', '74.374%', '74.353%', '74.524%', '74.952%', '74.267%', '75.294%', '74.973%', '74.930%', '75.615%', '75.444%']
Workers federated accuracies:  ['78.824%', '78.888%', '78.930%', '78.952%', '78.909%', '78.888%', '79.102%', '78.824%', '79.016%', '78.824%', '79.059%', '79.016%', '79.273%', '78.930%', '79.166%', '79.102%', '79.187%', '79.230%', '79.209%', '79.209%']
Workers improved  accuracies:  ['11.914%', '11.636%', '11.273%', '10.802%', '10.652%', '10.182%', '9.947%', '9.561%', '9.005%', '9.155%', '8.428%', '8.000%', '8.449%', '7.572%', '8.535%', '7.636%', '7.765%', '7.743%', '7.187%', '7.337%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 79.0667%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '79.0667%', '78.9333%', '78.9333%', '78.9333%', '79.0000%', '79.1333%', '78.9333%', '79.2000%', '79.2000%', '79.2000%', '79.2667%', '79.4667%', '79.3333%', '79.3333%', '79.2000%', '79.1333%', '79.2000%', '78.9333%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0501, 0.0502, 0.0502, 0.0502, 0.0501, 0.0500, 0.0502,
        0.0499, 0.0499, 0.0499, 0.0498, 0.0496, 0.0498, 0.0498, 0.0499, 0.0500,
        0.0499, 0.0502])
Federated model performance: Loss: 0.438858. Accuracy: 78.7807%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['68.642%', '69.989%', '70.824%', '71.829%', '72.385%', '72.856%', '73.519%', '73.326%', '74.503%', '74.118%', '74.759%', '75.016%', '74.930%', '75.230%', '74.759%', '75.850%', '75.294%', '75.273%', '75.893%', '75.914%']
Workers federated accuracies:  ['79.016%', '79.144%', '79.080%', '79.037%', '79.422%', '79.059%', '79.316%', '79.166%', '79.144%', '79.059%', '79.166%', '79.273%', '79.337%', '79.316%', '79.294%', '79.037%', '79.251%', '79.487%', '79.358%', '79.636%']
Workers improved  accuracies:  ['12.107%', '11.893%', '11.422%', '10.888%', '11.166%', '10.353%', '10.160%', '9.904%', '9.134%', '9.390%', '8.535%', '8.257%', '8.513%', '7.957%', '8.663%', '7.572%', '7.829%', '8.000%', '7.337%', '7.765%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 79.1333%
Leave-one-out validation accuracies :  ['79.2000%', '79.0000%', '79.0667%', '79.1333%', '79.1333%', '79.1333%', '79.1333%', '79.2667%', '79.2667%', '79.0667%', '79.1333%', '79.1333%', '79.0667%', '78.8667%', '78.7333%', '78.8667%', '78.8667%', '79.0000%', '78.8667%', '79.0000%']
Computed and normalized credits:  tensor([0.0498, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0498, 0.0498,
        0.0500, 0.0499, 0.0499, 0.0500, 0.0502, 0.0503, 0.0502, 0.0502, 0.0500,
        0.0502, 0.0501])
Federated model performance: Loss: 0.435753. Accuracy: 78.9946%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['69.198%', '70.417%', '71.144%', '72.342%', '72.877%', '73.390%', '74.203%', '73.861%', '74.652%', '74.310%', '75.059%', '75.316%', '75.251%', '75.487%', '75.187%', '76.064%', '75.615%', '75.487%', '76.321%', '76.214%']
Workers federated accuracies:  ['79.059%', '79.166%', '79.337%', '79.187%', '79.615%', '79.380%', '79.444%', '79.251%', '79.380%', '79.401%', '79.251%', '79.358%', '79.508%', '79.551%', '79.358%', '79.187%', '79.422%', '79.529%', '79.380%', '79.807%']
Workers improved  accuracies:  ['12.150%', '11.914%', '11.679%', '11.037%', '11.358%', '10.674%', '10.289%', '9.989%', '9.369%', '9.733%', '8.620%', '8.342%', '8.684%', '8.193%', '8.727%', '7.722%', '8.000%', '8.043%', '7.358%', '7.936%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 78.9333%
Leave-one-out validation accuracies :  ['78.9333%', '78.9333%', '78.9333%', '79.0667%', '79.0667%', '79.2000%', '79.1333%', '79.0667%', '79.2000%', '79.2667%', '79.5333%', '79.4667%', '79.6667%', '79.4667%', '79.4667%', '79.4667%', '79.4667%', '79.4000%', '79.4667%', '79.3333%']
Computed and normalized credits:  tensor([0.0504, 0.0504, 0.0504, 0.0502, 0.0502, 0.0501, 0.0501, 0.0502, 0.0501,
        0.0500, 0.0497, 0.0498, 0.0496, 0.0498, 0.0498, 0.0498, 0.0498, 0.0499,
        0.0498, 0.0499])
Federated model performance: Loss: 0.435087. Accuracy: 79.2727%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['69.433%', '70.930%', '71.594%', '72.727%', '73.176%', '73.861%', '74.524%', '74.096%', '74.888%', '74.631%', '75.187%', '75.551%', '75.701%', '75.701%', '75.508%', '76.299%', '75.807%', '75.765%', '76.642%', '76.342%']
Workers federated accuracies:  ['79.316%', '79.508%', '79.658%', '79.401%', '79.615%', '79.615%', '79.615%', '79.358%', '79.572%', '79.722%', '79.508%', '79.551%', '79.722%', '79.786%', '79.337%', '79.487%', '79.422%', '79.829%', '79.743%', '79.807%']
Workers improved  accuracies:  ['12.406%', '12.257%', '12.000%', '11.251%', '11.358%', '10.909%', '10.460%', '10.096%', '9.561%', '10.053%', '8.877%', '8.535%', '8.898%', '8.428%', '8.706%', '8.021%', '8.000%', '8.342%', '7.722%', '7.936%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 79.3333%
Leave-one-out validation accuracies :  ['79.3333%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.5333%', '79.6000%', '79.7333%', '79.7333%', '79.8000%', '79.9333%', '79.9333%', '80.0000%', '79.8667%', '79.8667%', '79.8000%', '79.6667%', '79.6000%', '79.4667%', '79.4667%']
Computed and normalized credits:  tensor([0.0504, 0.0503, 0.0503, 0.0503, 0.0503, 0.0501, 0.0501, 0.0499, 0.0499,
        0.0498, 0.0497, 0.0497, 0.0496, 0.0497, 0.0497, 0.0498, 0.0500, 0.0500,
        0.0502, 0.0502])
Federated model performance: Loss: 0.436680. Accuracy: 79.0802%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['69.733%', '71.273%', '71.743%', '72.877%', '73.754%', '74.332%', '74.866%', '74.289%', '75.059%', '74.909%', '75.380%', '75.786%', '75.957%', '75.914%', '75.786%', '76.492%', '76.064%', '75.979%', '76.834%', '76.642%']
Workers federated accuracies:  ['79.444%', '79.743%', '79.636%', '79.636%', '79.786%', '79.701%', '79.615%', '79.422%', '79.701%', '79.850%', '79.594%', '79.615%', '79.679%', '79.872%', '79.508%', '79.658%', '79.487%', '79.872%', '79.786%', '79.850%']
Workers improved  accuracies:  ['12.535%', '12.492%', '11.979%', '11.487%', '11.529%', '10.995%', '10.460%', '10.160%', '9.690%', '10.182%', '8.963%', '8.599%', '8.856%', '8.513%', '8.877%', '8.193%', '8.064%', '8.385%', '7.765%', '7.979%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 79.4667%
Leave-one-out validation accuracies :  ['79.4667%', '79.5333%', '79.5333%', '79.5333%', '79.3333%', '79.5333%', '79.6667%', '79.4000%', '79.4000%', '79.3333%', '79.2000%', '79.1333%', '79.2000%', '79.1333%', '79.3333%', '79.2667%', '79.1333%', '79.2000%', '78.9333%', '78.8667%']
Computed and normalized credits:  tensor([0.0499, 0.0498, 0.0498, 0.0498, 0.0500, 0.0498, 0.0496, 0.0499, 0.0499,
        0.0500, 0.0501, 0.0502, 0.0501, 0.0502, 0.0499, 0.0500, 0.0502, 0.0501,
        0.0504, 0.0505])
Federated model performance: Loss: 0.439349. Accuracy: 79.1016%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['70.118%', '71.380%', '72.086%', '73.626%', '74.032%', '74.610%', '75.209%', '74.567%', '75.273%', '75.144%', '75.508%', '76.193%', '76.299%', '76.128%', '76.043%', '76.706%', '76.278%', '76.043%', '76.941%', '76.770%']
Workers federated accuracies:  ['79.594%', '79.829%', '79.850%', '79.722%', '79.829%', '79.743%', '79.765%', '79.401%', '79.743%', '79.936%', '79.722%', '79.658%', '79.979%', '79.936%', '79.679%', '79.765%', '79.679%', '80.064%', '79.872%', '79.914%']
Workers improved  accuracies:  ['12.684%', '12.578%', '12.193%', '11.572%', '11.572%', '11.037%', '10.610%', '10.139%', '9.733%', '10.267%', '9.091%', '8.642%', '9.155%', '8.578%', '9.048%', '8.299%', '8.257%', '8.578%', '7.850%', '8.043%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.2667%', '79.3333%', '79.3333%', '79.4667%', '79.4667%', '79.5333%', '79.6667%', '79.5333%', '79.6000%', '79.4667%', '79.2667%', '79.0667%', '78.9333%', '78.8000%', '78.7333%', '78.9333%', '78.8667%', '78.7333%', '78.6667%']
Computed and normalized credits:  tensor([0.0498, 0.0499, 0.0498, 0.0498, 0.0497, 0.0497, 0.0496, 0.0495, 0.0496,
        0.0496, 0.0497, 0.0499, 0.0502, 0.0503, 0.0504, 0.0505, 0.0503, 0.0504,
        0.0505, 0.0506])
Federated model performance: Loss: 0.443988. Accuracy: 78.9305%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['70.396%', '71.615%', '72.428%', '73.904%', '74.417%', '74.802%', '75.465%', '74.695%', '75.337%', '75.422%', '75.508%', '76.471%', '76.471%', '76.406%', '76.257%', '76.770%', '76.642%', '76.235%', '76.984%', '76.813%']
Workers federated accuracies:  ['79.679%', '79.786%', '79.914%', '79.850%', '79.872%', '79.807%', '79.658%', '79.529%', '79.743%', '80.000%', '79.872%', '79.807%', '80.043%', '79.979%', '79.636%', '79.957%', '79.765%', '80.128%', '79.893%', '79.893%']
Workers improved  accuracies:  ['12.770%', '12.535%', '12.257%', '11.701%', '11.615%', '11.102%', '10.503%', '10.267%', '9.733%', '10.332%', '9.241%', '8.791%', '9.219%', '8.620%', '9.005%', '8.492%', '8.342%', '8.642%', '7.872%', '8.021%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.443988. Accuracy: 78.9305%.
Workers before    accuracies:  ['66.909%', '67.251%', '67.658%', '68.150%', '68.257%', '68.706%', '69.155%', '69.262%', '70.011%', '69.668%', '70.631%', '71.016%', '70.824%', '71.358%', '70.631%', '71.465%', '71.422%', '71.487%', '72.021%', '71.872%']
Workers standlone accuracies:  ['70.396%', '71.615%', '72.428%', '73.904%', '74.417%', '74.802%', '75.465%', '74.695%', '75.337%', '75.422%', '75.508%', '76.471%', '76.471%', '76.406%', '76.257%', '76.770%', '76.642%', '76.235%', '76.984%', '76.813%']
Workers federated accuracies:  ['79.679%', '79.786%', '79.914%', '79.850%', '79.872%', '79.807%', '79.658%', '79.529%', '79.743%', '80.000%', '79.872%', '79.807%', '80.043%', '79.979%', '79.636%', '79.957%', '79.765%', '80.128%', '79.893%', '79.893%']
Workers improved  accuracies:  ['12.770%', '12.535%', '12.257%', '11.701%', '11.615%', '11.102%', '10.503%', '10.267%', '9.733%', '10.332%', '9.241%', '8.791%', '9.219%', '8.620%', '9.005%', '8.492%', '8.342%', '8.642%', '7.872%', '8.021%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.2885450564559431, 0.21728689533096412)
Correlation between stand alone test acc & collaborative final model acc:  (0.3115217718222538, 0.18121618645506468)
Correlation between test_acc & sharing contributions:  (0.3610690904404398, 0.11779808805269436)
Correlation between test_acc improvements & sharing_contributions:  (-0.9723896522885964, 8.012596989487086e-13)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.665543. Accuracy: 63.9144%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 77.0667%
Leave-one-out validation accuracies :  ['77.2000%', '77.1333%', '77.7333%', '77.5333%', '77.4000%', '77.2667%', '77.3333%', '77.1333%', '77.2667%', '77.2000%', '77.0000%', '76.8667%', '76.9333%', '76.8000%', '76.7333%', '76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0493, 0.0495, 0.0496, 0.0498, 0.0497, 0.0499, 0.0498,
        0.0499, 0.0501, 0.0502, 0.0502, 0.0503, 0.0504, 0.0503, 0.0503, 0.0503,
        0.0503, 0.0503])
Federated model performance: Loss: 0.495611. Accuracy: 76.4492%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['58.374%', '59.914%', '60.214%', '62.781%', '62.930%', '63.701%', '64.684%', '65.305%', '66.310%', '66.717%', '68.043%', '68.449%', '68.193%', '69.048%', '69.027%', '70.225%', '70.246%', '70.332%', '71.786%', '71.037%']
Workers federated accuracies:  ['76.064%', '76.299%', '76.428%', '76.535%', '76.428%', '76.449%', '76.513%', '76.449%', '76.299%', '76.257%', '76.385%', '76.321%', '76.620%', '76.749%', '76.578%', '76.684%', '76.727%', '76.706%', '77.027%', '76.834%']
Workers improved  accuracies:  ['18.845%', '17.882%', '17.561%', '15.872%', '15.765%', '15.144%', '14.096%', '13.733%', '12.877%', '12.620%', '11.658%', '11.016%', '11.594%', '10.524%', '10.610%', '9.305%', '8.877%', '8.984%', '8.128%', '8.449%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 2:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.0667%', '78.0667%', '78.2667%', '78.4000%', '78.3333%', '78.4000%', '78.4667%', '78.3333%', '78.0667%', '78.2000%', '78.0667%', '77.9333%', '77.8000%', '78.0667%', '78.4000%', '78.5333%', '78.7333%', '78.8000%', '79.0000%', '79.0667%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0500, 0.0499, 0.0500, 0.0499, 0.0498, 0.0500, 0.0503,
        0.0502, 0.0503, 0.0505, 0.0506, 0.0503, 0.0500, 0.0498, 0.0496, 0.0495,
        0.0493, 0.0492])
Federated model performance: Loss: 0.468692. Accuracy: 78.0535%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['59.123%', '61.176%', '61.711%', '64.385%', '64.834%', '65.711%', '67.337%', '67.722%', '68.471%', '68.963%', '69.925%', '70.267%', '70.353%', '71.251%', '71.358%', '72.428%', '72.599%', '72.684%', '73.733%', '73.241%']
Workers federated accuracies:  ['77.497%', '77.583%', '77.754%', '77.711%', '77.861%', '77.989%', '77.968%', '77.711%', '77.797%', '77.904%', '77.840%', '77.797%', '78.032%', '78.182%', '78.203%', '78.374%', '78.246%', '78.203%', '78.460%', '78.545%']
Workers improved  accuracies:  ['20.278%', '19.166%', '18.888%', '17.048%', '17.198%', '16.684%', '15.551%', '14.995%', '14.374%', '14.267%', '13.112%', '12.492%', '13.005%', '11.957%', '12.235%', '10.995%', '10.396%', '10.481%', '9.561%', '10.160%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 3:
Federated model validation accuracy : 78.4667%
Leave-one-out validation accuracies :  ['78.4667%', '78.4667%', '78.5333%', '78.6000%', '78.6000%', '78.5333%', '78.5333%', '78.5333%', '78.6000%', '78.6000%', '78.6000%', '79.0000%', '79.0000%', '79.2000%', '79.1333%', '79.0000%', '79.3333%', '79.4667%', '79.4667%', '79.8000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0504, 0.0503, 0.0503, 0.0504, 0.0504, 0.0504, 0.0503,
        0.0503, 0.0503, 0.0499, 0.0499, 0.0497, 0.0497, 0.0498, 0.0495, 0.0493,
        0.0493, 0.0489])
Federated model performance: Loss: 0.454941. Accuracy: 78.6738%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['59.979%', '62.267%', '62.738%', '66.353%', '66.374%', '67.487%', '68.834%', '69.155%', '69.711%', '70.310%', '71.508%', '72.107%', '71.615%', '72.963%', '73.134%', '74.310%', '73.904%', '73.775%', '75.123%', '74.824%']
Workers federated accuracies:  ['77.775%', '77.989%', '78.139%', '78.396%', '78.267%', '78.310%', '78.374%', '78.310%', '78.417%', '78.417%', '78.353%', '78.396%', '78.717%', '78.695%', '78.674%', '78.759%', '78.652%', '78.674%', '78.930%', '78.866%']
Workers improved  accuracies:  ['20.556%', '19.572%', '19.273%', '17.733%', '17.604%', '17.005%', '15.957%', '15.594%', '14.995%', '14.781%', '13.626%', '13.091%', '13.690%', '12.471%', '12.706%', '11.380%', '10.802%', '10.952%', '10.032%', '10.481%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 4:
Federated model validation accuracy : 78.7333%
Leave-one-out validation accuracies :  ['78.8000%', '78.8667%', '78.9333%', '79.0000%', '79.0667%', '79.1333%', '79.3333%', '79.1333%', '79.1333%', '79.0000%', '78.9333%', '78.8000%', '78.9333%', '78.9333%', '79.0667%', '79.0667%', '79.1333%', '79.2667%', '79.5333%', '79.6667%']
Computed and normalized credits:  tensor([0.0504, 0.0503, 0.0502, 0.0501, 0.0500, 0.0500, 0.0498, 0.0500, 0.0500,
        0.0501, 0.0502, 0.0503, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499, 0.0497,
        0.0495, 0.0493])
Federated model performance: Loss: 0.445428. Accuracy: 79.1016%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['61.027%', '63.316%', '63.914%', '67.594%', '67.765%', '69.048%', '70.011%', '70.203%', '70.973%', '71.615%', '73.112%', '73.112%', '72.684%', '74.289%', '74.310%', '75.187%', '74.824%', '74.738%', '76.235%', '75.658%']
Workers federated accuracies:  ['78.053%', '78.225%', '78.332%', '78.631%', '78.738%', '78.610%', '78.503%', '78.631%', '78.695%', '78.888%', '78.930%', '78.738%', '78.973%', '79.016%', '79.037%', '79.273%', '78.930%', '78.909%', '79.230%', '78.995%']
Workers improved  accuracies:  ['20.834%', '19.807%', '19.465%', '17.968%', '18.075%', '17.305%', '16.086%', '15.914%', '15.273%', '15.251%', '14.203%', '13.433%', '13.947%', '12.791%', '13.070%', '11.893%', '11.080%', '11.187%', '10.332%', '10.610%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 5:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2667%', '79.2000%', '79.2667%', '79.3333%', '79.2667%', '79.3333%', '79.2667%', '79.1333%', '79.1333%', '78.9333%', '78.8000%', '78.7333%', '79.0000%', '78.9333%', '79.0000%', '79.0667%', '79.1333%', '79.2000%', '79.3333%', '79.5333%']
Computed and normalized credits:  tensor([0.0499, 0.0500, 0.0499, 0.0498, 0.0499, 0.0498, 0.0498, 0.0500, 0.0500,
        0.0502, 0.0504, 0.0505, 0.0502, 0.0502, 0.0502, 0.0501, 0.0500, 0.0499,
        0.0497, 0.0495])
Federated model performance: Loss: 0.438589. Accuracy: 79.5936%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['61.626%', '64.299%', '65.112%', '68.941%', '68.941%', '70.439%', '71.487%', '71.358%', '72.064%', '72.599%', '74.032%', '74.225%', '73.733%', '74.973%', '75.016%', '75.936%', '75.316%', '75.422%', '76.684%', '76.471%']
Workers federated accuracies:  ['78.246%', '78.332%', '78.567%', '78.695%', '78.909%', '78.631%', '78.695%', '78.802%', '78.952%', '79.080%', '79.080%', '78.866%', '79.080%', '78.973%', '78.973%', '79.358%', '79.166%', '79.016%', '79.080%', '79.059%']
Workers improved  accuracies:  ['21.027%', '19.914%', '19.701%', '18.032%', '18.246%', '17.326%', '16.278%', '16.086%', '15.529%', '15.444%', '14.353%', '13.561%', '14.053%', '12.749%', '13.005%', '11.979%', '11.316%', '11.294%', '10.182%', '10.674%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 6:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.1333%', '79.2667%', '79.2000%', '79.2667%', '79.2667%', '79.2667%', '79.3333%', '79.4667%', '79.6000%', '79.4000%', '79.4000%', '79.4000%', '79.2667%', '79.2667%', '79.3333%', '79.4000%', '79.4000%', '79.6000%', '79.2000%']
Computed and normalized credits:  tensor([0.0501, 0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
        0.0497, 0.0500, 0.0500, 0.0499, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499,
        0.0497, 0.0501])
Federated model performance: Loss: 0.433960. Accuracy: 79.8717%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['62.438%', '65.070%', '66.182%', '69.882%', '69.925%', '71.316%', '72.278%', '72.257%', '72.941%', '73.668%', '74.182%', '75.144%', '74.439%', '75.572%', '75.615%', '76.513%', '75.914%', '75.936%', '77.283%', '76.834%']
Workers federated accuracies:  ['78.374%', '78.460%', '78.545%', '78.738%', '78.909%', '78.631%', '78.781%', '78.802%', '78.909%', '79.187%', '79.187%', '78.930%', '79.080%', '79.016%', '79.144%', '79.251%', '79.080%', '79.037%', '78.973%', '79.230%']
Workers improved  accuracies:  ['21.155%', '20.043%', '19.679%', '18.075%', '18.246%', '17.326%', '16.364%', '16.086%', '15.487%', '15.551%', '14.460%', '13.626%', '14.053%', '12.791%', '13.176%', '11.872%', '11.230%', '11.316%', '10.075%', '10.845%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 7:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.3333%', '79.2667%', '79.2667%', '79.4000%', '79.4000%', '79.4000%', '79.2667%', '79.2000%', '79.1333%', '79.2000%', '79.2667%', '79.2000%', '79.2000%', '79.2000%', '79.0667%', '79.0000%', '78.8000%', '79.0000%', '79.0667%']
Computed and normalized credits:  tensor([0.0500, 0.0499, 0.0499, 0.0499, 0.0498, 0.0498, 0.0498, 0.0499, 0.0500,
        0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0501, 0.0502, 0.0504,
        0.0502, 0.0501])
Federated model performance: Loss: 0.429898. Accuracy: 79.9572%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['63.123%', '65.690%', '67.166%', '70.631%', '70.802%', '72.021%', '72.877%', '72.941%', '73.925%', '74.545%', '74.695%', '75.487%', '75.166%', '76.171%', '76.235%', '76.941%', '76.321%', '76.364%', '77.476%', '77.155%']
Workers federated accuracies:  ['78.524%', '78.610%', '78.374%', '78.759%', '78.802%', '78.824%', '78.909%', '78.995%', '78.973%', '79.166%', '79.166%', '78.930%', '79.016%', '79.187%', '79.422%', '79.166%', '79.230%', '79.209%', '79.209%', '79.401%']
Workers improved  accuracies:  ['21.305%', '20.193%', '19.508%', '18.096%', '18.139%', '17.519%', '16.492%', '16.278%', '15.551%', '15.529%', '14.439%', '13.626%', '13.989%', '12.963%', '13.455%', '11.786%', '11.380%', '11.487%', '10.310%', '11.016%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 8:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['78.9333%', '78.8667%', '78.8667%', '78.7333%', '78.8000%', '79.0000%', '79.1333%', '79.0000%', '78.8000%', '78.8667%', '78.9333%', '78.8000%', '78.8667%', '78.7333%', '79.0000%', '78.8667%', '78.6667%', '78.5333%', '78.4667%', '78.7333%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0500, 0.0501, 0.0500, 0.0498, 0.0497, 0.0498, 0.0500,
        0.0500, 0.0499, 0.0500, 0.0500, 0.0501, 0.0498, 0.0500, 0.0502, 0.0504,
        0.0504, 0.0501])
Federated model performance: Loss: 0.427612. Accuracy: 79.8717%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['63.701%', '66.759%', '67.807%', '71.080%', '71.508%', '72.706%', '73.647%', '73.647%', '74.631%', '74.909%', '75.380%', '75.914%', '75.572%', '76.385%', '76.834%', '77.091%', '76.770%', '76.834%', '77.690%', '77.283%']
Workers federated accuracies:  ['78.610%', '78.545%', '78.588%', '78.866%', '78.888%', '78.930%', '78.952%', '79.187%', '79.102%', '79.230%', '79.209%', '79.230%', '79.316%', '79.380%', '79.444%', '79.422%', '79.380%', '79.487%', '79.273%', '79.743%']
Workers improved  accuracies:  ['21.390%', '20.128%', '19.722%', '18.203%', '18.225%', '17.626%', '16.535%', '16.471%', '15.679%', '15.594%', '14.481%', '13.925%', '14.289%', '13.155%', '13.476%', '12.043%', '11.529%', '11.765%', '10.374%', '11.358%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 9:
Federated model validation accuracy : 78.7333%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8667%', '78.8000%', '78.9333%', '78.9333%', '78.8667%', '78.7333%', '78.7333%', '78.8000%', '78.9333%', '78.8667%', '78.8000%', '78.8000%', '78.8667%', '78.6667%', '78.8000%', '78.8667%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0499, 0.0500,
        0.0501, 0.0501, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502,
        0.0501, 0.0500])
Federated model performance: Loss: 0.426092. Accuracy: 79.8075%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['64.364%', '67.187%', '68.620%', '71.936%', '72.299%', '73.369%', '74.332%', '74.225%', '74.995%', '75.166%', '75.529%', '76.064%', '75.786%', '76.706%', '77.198%', '77.134%', '76.920%', '76.813%', '77.818%', '77.433%']
Workers federated accuracies:  ['78.545%', '78.545%', '78.717%', '78.802%', '78.973%', '78.973%', '78.930%', '79.230%', '79.059%', '79.422%', '79.380%', '79.166%', '79.337%', '79.401%', '79.572%', '79.572%', '79.444%', '79.487%', '79.636%', '79.679%']
Workers improved  accuracies:  ['21.326%', '20.128%', '19.850%', '18.139%', '18.310%', '17.668%', '16.513%', '16.513%', '15.636%', '15.786%', '14.652%', '13.861%', '14.310%', '13.176%', '13.604%', '12.193%', '11.594%', '11.765%', '10.738%', '11.294%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Epoch 10:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0667%', '79.0667%', '79.0667%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '78.9333%', '79.0000%', '78.9333%', '78.9333%', '78.8667%', '78.8667%', '78.9333%', '78.8667%', '79.2000%', '79.2667%', '79.2000%', '79.3333%', '79.5333%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0501,
        0.0501, 0.0501, 0.0502, 0.0502, 0.0501, 0.0502, 0.0498, 0.0498, 0.0499,
        0.0497, 0.0495])
Federated model performance: Loss: 0.425756. Accuracy: 79.9358%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['64.663%', '67.722%', '69.305%', '72.684%', '73.005%', '73.840%', '74.631%', '74.695%', '75.444%', '75.508%', '75.936%', '76.193%', '76.021%', '76.984%', '77.283%', '77.305%', '77.070%', '77.005%', '77.818%', '77.540%']
Workers federated accuracies:  ['78.588%', '78.567%', '78.695%', '78.845%', '79.016%', '79.144%', '78.888%', '79.016%', '79.209%', '79.422%', '79.337%', '79.230%', '79.380%', '79.422%', '79.701%', '79.487%', '79.487%', '79.529%', '79.636%', '79.508%']
Workers improved  accuracies:  ['21.369%', '20.150%', '19.829%', '18.182%', '18.353%', '17.840%', '16.471%', '16.299%', '15.786%', '15.786%', '14.610%', '13.925%', '14.353%', '13.198%', '13.733%', '12.107%', '11.636%', '11.807%', '10.738%', '11.123%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.425756. Accuracy: 79.9358%.
Workers before    accuracies:  ['57.219%', '58.417%', '58.866%', '60.663%', '60.663%', '61.305%', '62.417%', '62.717%', '63.422%', '63.636%', '64.727%', '65.305%', '65.027%', '66.225%', '65.968%', '67.380%', '67.850%', '67.722%', '68.898%', '68.385%']
Workers standlone accuracies:  ['64.663%', '67.722%', '69.305%', '72.684%', '73.005%', '73.840%', '74.631%', '74.695%', '75.444%', '75.508%', '75.936%', '76.193%', '76.021%', '76.984%', '77.283%', '77.305%', '77.070%', '77.005%', '77.818%', '77.540%']
Workers federated accuracies:  ['78.588%', '78.567%', '78.695%', '78.845%', '79.016%', '79.144%', '78.888%', '79.016%', '79.209%', '79.422%', '79.337%', '79.230%', '79.380%', '79.422%', '79.701%', '79.487%', '79.487%', '79.529%', '79.636%', '79.508%']
Workers improved  accuracies:  ['21.369%', '20.150%', '19.829%', '18.182%', '18.353%', '17.840%', '16.471%', '16.299%', '15.786%', '15.786%', '14.610%', '13.925%', '14.353%', '13.198%', '13.733%', '12.107%', '11.636%', '11.807%', '10.738%', '11.123%']
Workers shard sizes:  [128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 832, 896, 960, 1024, 1088, 1152, 1216, 1280]
Workers sharing_contributions :  tensor([ 6.4000,  9.6000, 12.8000, 16.0000, 19.2000, 22.4000, 25.6000, 28.8000,
        32.0000, 35.2000, 38.4000, 41.6000, 41.6000, 44.8000, 48.0000, 51.2000,
        54.4000, 57.6000, 60.8000, 64.0000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.2566748709461768, 0.2746552929730997)
Correlation between stand alone test acc & collaborative final model acc:  (0.9084834680589684, 3.056034813688436e-08)
Correlation between test_acc & sharing contributions:  (0.9285482108346328, 3.5501968552197366e-09)
Correlation between test_acc improvements & sharing_contributions:  (-0.989496342560457, 1.422825794650902e-16)
standalone_vs_final_corr [[0.5474798819840652], [0.850810296469408], [0.8548356316572666], [0.3115217718222538], [0.9084834680589684]]
standalone_vs_final_corr_mean [0.6946262099983923]
standalone_vs_final_corr_std [0.22987670907623467]
sharingcontribution_vs_final_corr [[0.6655034505328259], [0.8978503524879752], [0.7822407160956615], [0.3610690904404398], [0.9285482108346328]]
sharingcontribution_vs_final_corr_mean [0.727042364078307]
sharingcontribution_vs_final_corr_std [0.2052073625114598]
standalone_vs_federated_perturbed_corr [[0.1818608675491088], [-0.008676517643858676], [0.08248511385053445], [-0.2885450564559431], [0.2566748709461768]]
standalone_vs_federated_perturbed_corr_mean [0.044759855649203664]
standalone_vs_federated_perturbed_corr_std [0.18924876047297454]
federated_final_performance [0.796577513217926, 0.7908021211624146, 0.7884491682052612, 0.789304792881012, 0.7993583083152771]
federated_final_performance_mean 0.7928983807563782
federated_final_performance_std 0.004298147279098684
CFFL_best_worker [0.8070588111877441, 0.7991443872451782, 0.7972192764282227, 0.8012834191322327, 0.7970053553581238]
CFFL_best_worker_mean 0.8003422498703003
CFFL_best_worker_std 0.003696503712552435
standalone_best_worker [0.7794652581214905, 0.7805347442626953, 0.774117648601532, 0.7698395848274231, 0.778181791305542]
standalone_best_worker_mean 0.7764278054237366
standalone_best_worker_std 0.003947429724782456
