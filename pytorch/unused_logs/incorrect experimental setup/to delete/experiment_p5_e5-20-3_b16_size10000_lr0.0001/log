Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 20, 'fl_individual_epochs': 3}
Experiment : No.1/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.773427. Accuracy: 42.7380%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 54.8000%
Leave-one-out validation accuracies :  ['55.2000%', '57.5000%', '62.0000%', '66.5000%', '70.8000%']
Computed and normalized credits:  tensor([0.2358, 0.2229, 0.1995, 0.1792, 0.1626])
Federated model performance: Loss: 0.682392. Accuracy: 55.8930%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['38.139%', '41.925%', '47.037%', '51.615%', '55.957%']
Workers federated accuracies:  ['46.160%', '49.005%', '52.043%', '54.995%', '57.561%']
Workers improved  accuracies:  ['8.535%', '8.963%', '9.198%', '8.791%', '8.834%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 2:
Federated model validation accuracy : 65.3000%
Leave-one-out validation accuracies :  ['65.4000%', '66.9000%', '68.0000%', '71.6000%', '72.4000%']
Computed and normalized credits:  tensor([0.2255, 0.2150, 0.2031, 0.1823, 0.1741])
Federated model performance: Loss: 0.626213. Accuracy: 66.6096%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['38.524%', '44.364%', '51.059%', '56.963%', '61.818%']
Workers federated accuracies:  ['51.679%', '55.743%', '59.679%', '62.824%', '66.439%']
Workers improved  accuracies:  ['14.053%', '15.701%', '16.834%', '16.620%', '17.711%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 3:
Federated model validation accuracy : 69.6000%
Leave-one-out validation accuracies :  ['69.7000%', '71.3000%', '72.3000%', '73.1000%', '73.7000%']
Computed and normalized credits:  tensor([0.2167, 0.2072, 0.1998, 0.1905, 0.1858])
Federated model performance: Loss: 0.591409. Accuracy: 71.2727%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['38.888%', '46.481%', '54.267%', '60.877%', '66.824%']
Workers federated accuracies:  ['56.513%', '61.647%', '66.225%', '69.219%', '71.658%']
Workers improved  accuracies:  ['18.888%', '21.604%', '23.380%', '23.016%', '22.930%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 4:
Federated model validation accuracy : 73.1000%
Leave-one-out validation accuracies :  ['73.2000%', '73.1000%', '73.9000%', '73.8000%', '74.2000%']
Computed and normalized credits:  tensor([0.2064, 0.2041, 0.1990, 0.1967, 0.1938])
Federated model performance: Loss: 0.568686. Accuracy: 73.0695%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['39.316%', '48.214%', '58.374%', '64.941%', '70.545%']
Workers federated accuracies:  ['61.283%', '66.738%', '70.225%', '72.428%', '74.225%']
Workers improved  accuracies:  ['23.658%', '26.695%', '27.380%', '26.225%', '25.497%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 5:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['73.9000%', '73.6000%', '73.7000%', '74.4000%', '74.7000%']
Computed and normalized credits:  tensor([0.2024, 0.2028, 0.2010, 0.1978, 0.1959])
Federated model performance: Loss: 0.553411. Accuracy: 74.0963%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['39.786%', '50.888%', '61.305%', '67.936%', '73.048%']
Workers federated accuracies:  ['64.920%', '69.561%', '72.406%', '74.160%', '75.059%']
Workers improved  accuracies:  ['27.294%', '29.519%', '29.561%', '27.957%', '26.332%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 6:
Federated model validation accuracy : 74.3000%
Leave-one-out validation accuracies :  ['74.4000%', '74.6000%', '74.9000%', '75.1000%', '75.2000%']
Computed and normalized credits:  tensor([0.2023, 0.2017, 0.2001, 0.1984, 0.1975])
Federated model performance: Loss: 0.542459. Accuracy: 74.4813%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['40.321%', '52.834%', '64.449%', '70.631%', '74.481%']
Workers federated accuracies:  ['67.679%', '71.508%', '73.797%', '74.824%', '75.316%']
Workers improved  accuracies:  ['30.053%', '31.465%', '30.952%', '28.620%', '26.588%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 7:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.1000%', '75.2000%', '75.1000%', '75.2000%']
Computed and normalized credits:  tensor([0.2011, 0.2006, 0.1997, 0.1996, 0.1990])
Federated model performance: Loss: 0.534775. Accuracy: 74.8021%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['40.749%', '54.866%', '66.802%', '71.829%', '75.102%']
Workers federated accuracies:  ['68.856%', '72.578%', '74.545%', '75.166%', '75.679%']
Workers improved  accuracies:  ['31.230%', '32.535%', '31.701%', '28.963%', '26.952%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 8:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.2000%', '75.2000%', '75.0000%', '75.2000%', '75.2000%']
Computed and normalized credits:  tensor([0.2002, 0.2000, 0.2005, 0.1997, 0.1996])
Federated model performance: Loss: 0.528855. Accuracy: 75.0374%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['41.134%', '56.963%', '68.599%', '73.412%', '75.551%']
Workers federated accuracies:  ['69.968%', '73.390%', '74.738%', '75.273%', '76.021%']
Workers improved  accuracies:  ['32.342%', '33.348%', '31.893%', '29.070%', '27.294%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 9:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.3000%', '75.3000%', '75.2000%', '75.4000%', '75.3000%']
Computed and normalized credits:  tensor([0.2000, 0.2000, 0.2005, 0.1996, 0.1999])
Federated model performance: Loss: 0.524352. Accuracy: 75.2513%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['41.583%', '58.674%', '70.118%', '74.417%', '75.679%']
Workers federated accuracies:  ['70.952%', '73.989%', '75.273%', '75.615%', '76.193%']
Workers improved  accuracies:  ['33.326%', '33.947%', '32.428%', '29.412%', '27.465%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 10:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.5000%', '75.4000%', '75.4000%', '75.4000%', '75.2000%']
Computed and normalized credits:  tensor([0.1996, 0.1999, 0.2001, 0.1998, 0.2006])
Federated model performance: Loss: 0.520779. Accuracy: 75.4439%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['41.989%', '60.299%', '71.251%', '74.952%', '76.000%']
Workers federated accuracies:  ['71.829%', '74.567%', '75.594%', '75.765%', '76.342%']
Workers improved  accuracies:  ['34.203%', '34.524%', '32.749%', '29.561%', '27.615%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 11:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.3000%', '75.4000%', '75.5000%', '75.7000%']
Computed and normalized credits:  tensor([0.2001, 0.2005, 0.2002, 0.1998, 0.1993])
Federated model performance: Loss: 0.517593. Accuracy: 75.8717%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['42.481%', '61.818%', '72.299%', '75.230%', '76.235%']
Workers federated accuracies:  ['72.471%', '74.995%', '75.658%', '76.000%', '76.578%']
Workers improved  accuracies:  ['34.845%', '34.952%', '32.813%', '29.797%', '27.850%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 12:
Federated model validation accuracy : 75.5000%
Leave-one-out validation accuracies :  ['75.5000%', '75.4000%', '75.4000%', '75.5000%', '75.9000%']
Computed and normalized credits:  tensor([0.2002, 0.2007, 0.2006, 0.2001, 0.1985])
Federated model performance: Loss: 0.514737. Accuracy: 76.2353%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['43.230%', '63.936%', '73.476%', '75.422%', '76.599%']
Workers federated accuracies:  ['73.005%', '75.251%', '75.914%', '76.150%', '76.749%']
Workers improved  accuracies:  ['35.380%', '35.209%', '33.070%', '29.947%', '28.021%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 13:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '76.0000%', '76.1000%', '76.0000%']
Computed and normalized credits:  tensor([0.2005, 0.2007, 0.1999, 0.1995, 0.1994])
Federated model performance: Loss: 0.512183. Accuracy: 76.5134%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['43.615%', '65.155%', '74.182%', '75.465%', '76.791%']
Workers federated accuracies:  ['73.540%', '75.551%', '76.235%', '76.342%', '76.834%']
Workers improved  accuracies:  ['35.914%', '35.508%', '33.390%', '30.139%', '28.107%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 14:
Federated model validation accuracy : 76.1000%
Leave-one-out validation accuracies :  ['76.1000%', '76.1000%', '76.0000%', '76.0000%', '76.3000%']
Computed and normalized credits:  tensor([0.2002, 0.2002, 0.2003, 0.2002, 0.1991])
Federated model performance: Loss: 0.509915. Accuracy: 76.5348%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['44.171%', '66.203%', '74.888%', '75.722%', '76.898%']
Workers federated accuracies:  ['74.011%', '76.064%', '76.513%', '76.513%', '77.155%']
Workers improved  accuracies:  ['36.385%', '36.021%', '33.668%', '30.310%', '28.428%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 15:
Federated model validation accuracy : 76.1000%
Leave-one-out validation accuracies :  ['76.1000%', '76.1000%', '76.2000%', '76.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.2003, 0.2003, 0.2000, 0.1999, 0.1996])
Federated model performance: Loss: 0.507917. Accuracy: 76.7059%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['44.770%', '67.743%', '75.401%', '75.979%', '76.898%']
Workers federated accuracies:  ['74.246%', '76.299%', '76.599%', '76.663%', '77.219%']
Workers improved  accuracies:  ['36.620%', '36.257%', '33.754%', '30.460%', '28.492%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 16:
Federated model validation accuracy : 76.1000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.1000%', '76.3000%', '76.2000%']
Computed and normalized credits:  tensor([0.2001, 0.2001, 0.2003, 0.1996, 0.1999])
Federated model performance: Loss: 0.505850. Accuracy: 76.8556%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['45.433%', '69.305%', '75.658%', '76.064%', '76.898%']
Workers federated accuracies:  ['74.481%', '76.513%', '76.813%', '76.856%', '77.390%']
Workers improved  accuracies:  ['36.856%', '36.471%', '33.968%', '30.652%', '28.663%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 17:
Federated model validation accuracy : 76.1000%
Leave-one-out validation accuracies :  ['76.2000%', '76.3000%', '76.2000%', '76.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.2001, 0.1997, 0.2002, 0.2000, 0.2000])
Federated model performance: Loss: 0.504467. Accuracy: 77.1551%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['45.968%', '70.652%', '75.743%', '76.171%', '77.091%']
Workers federated accuracies:  ['74.674%', '76.663%', '76.791%', '77.155%', '77.497%']
Workers improved  accuracies:  ['37.048%', '36.620%', '33.947%', '30.952%', '28.770%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 18:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.2000%', '76.2000%', '76.5000%']
Computed and normalized credits:  tensor([0.2002, 0.2001, 0.2003, 0.2002, 0.1992])
Federated model performance: Loss: 0.503254. Accuracy: 77.3048%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['46.695%', '71.316%', '75.914%', '76.321%', '77.262%']
Workers federated accuracies:  ['74.866%', '76.898%', '76.984%', '77.241%', '77.668%']
Workers improved  accuracies:  ['37.241%', '36.856%', '34.139%', '31.037%', '28.941%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 19:
Federated model validation accuracy : 76.3000%
Leave-one-out validation accuracies :  ['76.4000%', '76.3000%', '76.4000%', '76.5000%', '76.5000%']
Computed and normalized credits:  tensor([0.2001, 0.2005, 0.2001, 0.1998, 0.1995])
Federated model performance: Loss: 0.502072. Accuracy: 77.4118%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['47.273%', '72.064%', '76.064%', '76.428%', '77.262%']
Workers federated accuracies:  ['75.037%', '76.877%', '77.091%', '77.348%', '78.053%']
Workers improved  accuracies:  ['37.412%', '36.834%', '34.246%', '31.144%', '29.326%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 20:
Federated model validation accuracy : 76.5000%
Leave-one-out validation accuracies :  ['76.5000%', '76.5000%', '76.5000%', '76.5000%', '76.4000%']
Computed and normalized credits:  tensor([0.2000, 0.2001, 0.2000, 0.1999, 0.2001])
Federated model performance: Loss: 0.500822. Accuracy: 77.4545%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['47.829%', '72.684%', '76.278%', '76.642%', '77.369%']
Workers federated accuracies:  ['75.123%', '77.070%', '77.283%', '77.561%', '78.139%']
Workers improved  accuracies:  ['37.497%', '37.027%', '34.439%', '31.358%', '29.412%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.500822. Accuracy: 77.4545%.
Workers before    accuracies:  ['37.626%', '40.043%', '42.845%', '46.203%', '48.727%']
Workers standlone accuracies:  ['47.829%', '72.684%', '76.278%', '76.642%', '77.369%']
Workers federated accuracies:  ['75.123%', '77.070%', '77.283%', '77.561%', '78.139%']
Workers improved  accuracies:  ['37.497%', '37.027%', '34.439%', '31.358%', '29.412%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]
Workers sharing_contributions :  tensor([ 44.8000, 201.6000, 361.6000, 521.6000, 678.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.6051061532618085, 0.27956839908527653)
Correlation between stand alone test acc & collaborative final model acc:  (0.9664114800788604, 0.0073522436714681715)
Correlation between test_acc & sharing contributions:  (0.9023005266509055, 0.03611628711303876)
Correlation between test_acc improvements & sharing_contributions:  (-0.9811968962494818, 0.0030863804391087282)
Experiment : No.2/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.768210. Accuracy: 45.3476%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 59.5000%
Leave-one-out validation accuracies :  ['59.7000%', '62.6000%', '66.3000%', '69.5000%', '71.5000%']
Computed and normalized credits:  tensor([0.2290, 0.2145, 0.1972, 0.1836, 0.1757])
Federated model performance: Loss: 0.681261. Accuracy: 60.6845%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['39.080%', '45.112%', '51.037%', '55.230%', '59.487%']
Workers federated accuracies:  ['50.310%', '53.818%', '56.599%', '59.316%', '61.754%']
Workers improved  accuracies:  ['11.615%', '12.171%', '11.037%', '9.947%', '9.048%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 2:
Federated model validation accuracy : 67.7000%
Leave-one-out validation accuracies :  ['67.7000%', '69.1000%', '70.5000%', '71.5000%', '72.2000%']
Computed and normalized credits:  tensor([0.2188, 0.2087, 0.1979, 0.1899, 0.1848])
Federated model performance: Loss: 0.631294. Accuracy: 69.7968%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['39.658%', '48.278%', '55.209%', '60.877%', '65.476%']
Workers federated accuracies:  ['56.834%', '60.856%', '64.770%', '67.529%', '70.118%']
Workers improved  accuracies:  ['18.139%', '19.209%', '19.209%', '18.160%', '17.412%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 3:
Federated model validation accuracy : 71.8000%
Leave-one-out validation accuracies :  ['71.7000%', '71.7000%', '72.0000%', '72.7000%', '72.1000%']
Computed and normalized credits:  tensor([0.2067, 0.2038, 0.1995, 0.1946, 0.1954])
Federated model performance: Loss: 0.603055. Accuracy: 72.7059%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['40.000%', '51.273%', '58.909%', '65.241%', '70.139%']
Workers federated accuracies:  ['61.519%', '66.567%', '69.797%', '72.278%', '74.096%']
Workers improved  accuracies:  ['22.824%', '24.920%', '24.235%', '22.909%', '21.390%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 4:
Federated model validation accuracy : 72.7000%
Leave-one-out validation accuracies :  ['72.8000%', '73.2000%', '72.6000%', '72.7000%', '72.9000%']
Computed and normalized credits:  tensor([0.2021, 0.1998, 0.2008, 0.1990, 0.1985])
Federated model performance: Loss: 0.586807. Accuracy: 74.3743%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['40.342%', '54.118%', '62.717%', '68.984%', '73.305%']
Workers federated accuracies:  ['65.519%', '69.818%', '72.599%', '74.545%', '75.636%']
Workers improved  accuracies:  ['26.824%', '28.171%', '27.037%', '25.176%', '22.930%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 5:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.4000%', '73.2000%', '73.2000%', '73.1000%', '73.4000%']
Computed and normalized credits:  tensor([0.2001, 0.2001, 0.2004, 0.2003, 0.1991])
Federated model performance: Loss: 0.576479. Accuracy: 74.9947%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['40.920%', '56.150%', '65.626%', '71.701%', '75.380%']
Workers federated accuracies:  ['67.807%', '71.786%', '74.417%', '75.807%', '76.727%']
Workers improved  accuracies:  ['29.112%', '30.139%', '28.856%', '26.439%', '24.021%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 6:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.6000%', '73.5000%', '73.4000%', '73.7000%']
Computed and normalized credits:  tensor([0.1999, 0.1999, 0.2003, 0.2007, 0.1992])
Federated model performance: Loss: 0.569978. Accuracy: 75.5508%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['41.369%', '58.460%', '68.749%', '73.711%', '76.471%']
Workers federated accuracies:  ['69.497%', '73.241%', '75.572%', '76.599%', '77.091%']
Workers improved  accuracies:  ['30.802%', '31.594%', '30.011%', '27.230%', '24.385%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 7:
Federated model validation accuracy : 73.9000%
Leave-one-out validation accuracies :  ['73.9000%', '73.8000%', '73.7000%', '73.8000%', '73.9000%']
Computed and normalized credits:  tensor([0.1997, 0.2000, 0.2005, 0.2003, 0.1995])
Federated model performance: Loss: 0.565777. Accuracy: 75.5722%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['42.011%', '60.642%', '70.888%', '75.230%', '77.155%']
Workers federated accuracies:  ['70.802%', '74.225%', '76.214%', '76.984%', '77.412%']
Workers improved  accuracies:  ['32.107%', '32.578%', '30.652%', '27.615%', '24.706%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 8:
Federated model validation accuracy : 74.1000%
Leave-one-out validation accuracies :  ['74.1000%', '74.2000%', '74.2000%', '74.2000%', '74.4000%']
Computed and normalized credits:  tensor([0.2003, 0.2001, 0.2002, 0.2001, 0.1992])
Federated model performance: Loss: 0.561217. Accuracy: 75.9572%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['42.503%', '62.567%', '72.428%', '76.513%', '77.262%']
Workers federated accuracies:  ['71.957%', '74.845%', '76.449%', '77.241%', '77.583%']
Workers improved  accuracies:  ['33.262%', '33.198%', '30.888%', '27.872%', '24.877%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 9:
Federated model validation accuracy : 74.5000%
Leave-one-out validation accuracies :  ['74.5000%', '74.5000%', '74.4000%', '74.4000%', '74.3000%']
Computed and normalized credits:  tensor([0.1998, 0.1997, 0.2001, 0.2001, 0.2002])
Federated model performance: Loss: 0.556442. Accuracy: 76.2781%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['43.037%', '64.385%', '73.733%', '77.005%', '77.561%']
Workers federated accuracies:  ['72.791%', '75.615%', '77.005%', '77.690%', '77.690%']
Workers improved  accuracies:  ['34.096%', '33.968%', '31.444%', '28.321%', '24.984%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 10:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.3000%', '74.3000%', '74.3000%', '74.5000%']
Computed and normalized credits:  tensor([0.2004, 0.2000, 0.2001, 0.2001, 0.1994])
Federated model performance: Loss: 0.552107. Accuracy: 76.5134%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['43.743%', '65.861%', '75.102%', '77.134%', '77.775%']
Workers federated accuracies:  ['73.519%', '75.979%', '77.369%', '77.904%', '77.797%']
Workers improved  accuracies:  ['34.824%', '34.332%', '31.807%', '28.535%', '25.091%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 11:
Federated model validation accuracy : 74.6000%
Leave-one-out validation accuracies :  ['74.6000%', '74.6000%', '74.4000%', '74.5000%', '74.9000%']
Computed and normalized credits:  tensor([0.2001, 0.2000, 0.2008, 0.2004, 0.1988])
Federated model performance: Loss: 0.548410. Accuracy: 76.6845%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['44.492%', '67.872%', '75.893%', '77.647%', '77.882%']
Workers federated accuracies:  ['73.840%', '76.620%', '77.519%', '78.032%', '77.925%']
Workers improved  accuracies:  ['35.144%', '34.973%', '31.957%', '28.663%', '25.219%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 12:
Federated model validation accuracy : 74.8000%
Leave-one-out validation accuracies :  ['74.8000%', '74.5000%', '74.5000%', '74.6000%', '75.3000%']
Computed and normalized credits:  tensor([0.1998, 0.2009, 0.2011, 0.2006, 0.1976])
Federated model performance: Loss: 0.545078. Accuracy: 76.9412%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['45.241%', '69.027%', '76.385%', '77.989%', '78.139%']
Workers federated accuracies:  ['74.332%', '76.984%', '77.690%', '78.118%', '78.011%']
Workers improved  accuracies:  ['35.636%', '35.337%', '32.128%', '28.749%', '25.305%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 13:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.3000%', '75.2000%', '75.3000%', '75.5000%', '75.8000%']
Computed and normalized credits:  tensor([0.2004, 0.2010, 0.2007, 0.1999, 0.1980])
Federated model performance: Loss: 0.541617. Accuracy: 77.1979%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['46.096%', '70.267%', '76.663%', '77.968%', '78.203%']
Workers federated accuracies:  ['74.674%', '77.176%', '77.861%', '78.246%', '78.075%']
Workers improved  accuracies:  ['35.979%', '35.529%', '32.299%', '28.877%', '25.369%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 14:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.5000%', '75.6000%', '76.0000%', '76.0000%']
Computed and normalized credits:  tensor([0.2006, 0.2011, 0.2007, 0.1990, 0.1985])
Federated model performance: Loss: 0.538527. Accuracy: 77.4545%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['46.503%', '71.465%', '77.027%', '78.053%', '78.182%']
Workers federated accuracies:  ['74.973%', '77.348%', '77.968%', '78.353%', '78.267%']
Workers improved  accuracies:  ['36.278%', '35.701%', '32.406%', '28.984%', '25.561%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 15:
Federated model validation accuracy : 75.9000%
Leave-one-out validation accuracies :  ['75.9000%', '75.8000%', '76.0000%', '76.2000%', '76.0000%']
Computed and normalized credits:  tensor([0.2005, 0.2010, 0.2001, 0.1990, 0.1995])
Federated model performance: Loss: 0.535807. Accuracy: 77.7112%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['46.888%', '72.471%', '77.155%', '78.075%', '78.289%']
Workers federated accuracies:  ['75.230%', '77.561%', '78.032%', '78.545%', '78.332%']
Workers improved  accuracies:  ['36.535%', '35.914%', '32.471%', '29.176%', '25.626%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 16:
Federated model validation accuracy : 75.9000%
Leave-one-out validation accuracies :  ['75.9000%', '76.0000%', '76.2000%', '76.1000%', '76.0000%']
Computed and normalized credits:  tensor([0.2006, 0.2004, 0.1995, 0.1995, 0.2000])
Federated model performance: Loss: 0.533558. Accuracy: 77.9251%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['47.380%', '73.262%', '77.455%', '78.139%', '78.225%']
Workers federated accuracies:  ['75.615%', '77.775%', '78.118%', '78.717%', '78.310%']
Workers improved  accuracies:  ['36.920%', '36.128%', '32.556%', '29.348%', '25.604%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 17:
Federated model validation accuracy : 76.1000%
Leave-one-out validation accuracies :  ['76.1000%', '76.1000%', '76.0000%', '75.9000%', '76.4000%']
Computed and normalized credits:  tensor([0.2002, 0.2001, 0.2002, 0.2006, 0.1989])
Federated model performance: Loss: 0.531537. Accuracy: 78.0321%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['48.086%', '74.075%', '77.626%', '78.267%', '78.374%']
Workers federated accuracies:  ['75.765%', '77.861%', '78.160%', '78.738%', '78.353%']
Workers improved  accuracies:  ['37.070%', '36.214%', '32.599%', '29.369%', '25.647%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 18:
Federated model validation accuracy : 76.1000%
Leave-one-out validation accuracies :  ['76.1000%', '76.1000%', '76.2000%', '76.3000%', '76.5000%']
Computed and normalized credits:  tensor([0.2005, 0.2005, 0.2002, 0.1999, 0.1988])
Federated model performance: Loss: 0.529744. Accuracy: 78.1604%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['48.877%', '74.866%', '77.647%', '78.332%', '78.396%']
Workers federated accuracies:  ['76.171%', '77.925%', '78.289%', '78.845%', '78.503%']
Workers improved  accuracies:  ['37.476%', '36.278%', '32.727%', '29.476%', '25.797%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 19:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.5000%', '76.5000%', '76.5000%']
Computed and normalized credits:  tensor([0.1999, 0.1999, 0.2002, 0.2001, 0.1998])
Federated model performance: Loss: 0.527991. Accuracy: 78.1818%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['49.433%', '75.144%', '77.647%', '78.417%', '78.396%']
Workers federated accuracies:  ['76.364%', '77.947%', '78.332%', '78.888%', '78.567%']
Workers improved  accuracies:  ['37.668%', '36.299%', '32.770%', '29.519%', '25.861%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 20:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.5000%', '76.5000%', '76.6000%']
Computed and normalized credits:  tensor([0.1998, 0.1998, 0.2003, 0.2002, 0.1998])
Federated model performance: Loss: 0.526425. Accuracy: 78.3315%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['50.053%', '75.701%', '77.668%', '78.374%', '78.310%']
Workers federated accuracies:  ['76.620%', '78.096%', '78.396%', '78.909%', '78.545%']
Workers improved  accuracies:  ['37.925%', '36.449%', '32.834%', '29.540%', '25.840%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.526425. Accuracy: 78.3315%.
Workers before    accuracies:  ['38.695%', '41.647%', '45.561%', '49.369%', '52.706%']
Workers standlone accuracies:  ['50.053%', '75.701%', '77.668%', '78.374%', '78.310%']
Workers federated accuracies:  ['76.620%', '78.096%', '78.396%', '78.909%', '78.545%']
Workers improved  accuracies:  ['37.925%', '36.449%', '32.834%', '29.540%', '25.840%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]
Workers sharing_contributions :  tensor([ 44.8000, 201.6000, 361.6000, 521.6000, 678.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.28836740073095946, 0.6379932476309162)
Correlation between stand alone test acc & collaborative final model acc:  (0.965342936550019, 0.007704613095598642)
Correlation between test_acc & sharing contributions:  (0.8333944202319866, 0.07956199085143806)
Correlation between test_acc improvements & sharing_contributions:  (-0.9917181369322726, 0.0009036196682215736)
standalone_vs_final_corr [[0.9664114800788604], [0.965342936550019]]
standalone_vs_final_corr_mean [0.9658772083144397]
standalone_vs_final_corr_std [0.0005342717644206685]
sharingcontribution_vs_final_corr [[0.9023005266509055], [0.8333944202319866]]
sharingcontribution_vs_final_corr_mean [0.8678474734414461]
sharingcontribution_vs_final_corr_std [0.03445305320945946]
standalone_vs_federated_perturbed_corr [[0.6051061532618085], [0.28836740073095946]]
standalone_vs_federated_perturbed_corr_mean [0.446736776996384]
standalone_vs_federated_perturbed_corr_std [0.15836937626542452]
federated_final_performance [0.774545431137085, 0.7833154797554016]
federated_final_performance_mean 0.7789304554462433
federated_final_performance_std 0.004385024309158325
CFFL_best_worker [0.781390368938446, 0.7890909314155579]
CFFL_best_worker_mean 0.785240650177002
CFFL_best_worker_std 0.003850281238555908
standalone_best_worker [0.773689866065979, 0.7837433218955994]
standalone_best_worker_mean 0.7787165939807892
standalone_best_worker_std 0.005026727914810181
