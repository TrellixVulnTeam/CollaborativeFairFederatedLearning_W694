Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 5000, 'n_workers': 10, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 20, 'fl_individual_epochs': 5}
Experiment : No.1/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.682907. Accuracy: 58.5027%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 66.0000%
Leave-one-out validation accuracies :  ['66.2000%', '66.4000%', '67.4000%', '68.2000%', '69.2000%', '70.8000%', '72.6000%', '73.0000%', '74.6000%', '75.6000%']
Computed and normalized credits:  tensor([0.1103, 0.1098, 0.1072, 0.1052, 0.1027, 0.0988, 0.0945, 0.0936, 0.0900,
        0.0879])
Federated model performance: Loss: 0.631961. Accuracy: 66.8449%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['57.626%', '57.882%', '58.310%', '59.080%', '60.235%', '60.257%', '60.599%', '61.048%', '61.369%', '62.588%']
Workers federated accuracies:  ['57.626%', '57.882%', '58.310%', '59.080%', '60.235%', '60.257%', '60.599%', '61.048%', '61.369%', '62.588%']
Workers improved  accuracies:  ['0.257%', '0.385%', '0.642%', '1.134%', '1.754%', '1.733%', '1.840%', '1.861%', '2.139%', '2.438%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 2:
Federated model validation accuracy : 72.6000%
Leave-one-out validation accuracies :  ['72.6000%', '73.0000%', '73.0000%', '73.6000%', '74.6000%', '75.0000%', '76.2000%', '76.2000%', '76.8000%', '77.8000%']
Computed and normalized credits:  tensor([0.1068, 0.1058, 0.1054, 0.1037, 0.1010, 0.0995, 0.0961, 0.0960, 0.0941,
        0.0916])
Federated model performance: Loss: 0.591896. Accuracy: 70.7380%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['57.840%', '58.310%', '59.144%', '60.235%', '61.348%', '61.390%', '62.160%', '62.759%', '63.487%', '64.791%']
Workers federated accuracies:  ['57.840%', '58.310%', '59.144%', '60.235%', '61.348%', '61.390%', '62.160%', '62.759%', '63.487%', '64.791%']
Workers improved  accuracies:  ['0.471%', '0.813%', '1.476%', '2.289%', '2.866%', '2.866%', '3.401%', '3.572%', '4.257%', '4.642%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 3:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.2000%', '76.4000%', '76.8000%', '77.0000%', '77.0000%', '77.6000%', '78.0000%', '78.2000%']
Computed and normalized credits:  tensor([0.1027, 0.1026, 0.1025, 0.1018, 0.1005, 0.0998, 0.0993, 0.0980, 0.0969,
        0.0960])
Federated model performance: Loss: 0.561463. Accuracy: 72.6417%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['57.947%', '58.866%', '59.893%', '60.920%', '62.545%', '62.652%', '63.636%', '64.364%', '65.198%', '66.866%']
Workers federated accuracies:  ['57.947%', '58.866%', '59.893%', '60.920%', '62.545%', '62.652%', '63.636%', '64.364%', '65.198%', '66.866%']
Workers improved  accuracies:  ['0.578%', '1.369%', '2.225%', '2.973%', '4.064%', '4.128%', '4.877%', '5.176%', '5.968%', '6.717%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 4:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['77.8000%', '78.0000%', '77.6000%', '77.6000%', '78.2000%', '78.2000%', '78.4000%', '78.6000%', '78.4000%', '78.4000%']
Computed and normalized credits:  tensor([0.1011, 0.1007, 0.1015, 0.1013, 0.0999, 0.0998, 0.0993, 0.0987, 0.0989,
        0.0988])
Federated model performance: Loss: 0.538846. Accuracy: 73.6898%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['58.246%', '59.230%', '60.471%', '61.840%', '63.893%', '63.936%', '64.963%', '66.246%', '66.674%', '68.642%']
Workers federated accuracies:  ['58.246%', '59.230%', '60.471%', '61.840%', '63.893%', '63.936%', '64.963%', '66.246%', '66.674%', '68.642%']
Workers improved  accuracies:  ['0.877%', '1.733%', '2.802%', '3.893%', '5.412%', '5.412%', '6.203%', '7.059%', '7.444%', '8.492%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 5:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.2000%', '78.2000%', '78.4000%', '78.2000%', '78.2000%']
Computed and normalized credits:  tensor([0.1003, 0.1002, 0.1003, 0.1003, 0.0997, 0.1000, 0.1000, 0.0995, 0.0999,
        0.0999])
Federated model performance: Loss: 0.522495. Accuracy: 74.5882%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['58.610%', '59.701%', '61.027%', '62.417%', '65.112%', '65.091%', '66.203%', '67.401%', '67.893%', '69.882%']
Workers federated accuracies:  ['58.610%', '59.701%', '61.027%', '62.417%', '65.112%', '65.091%', '66.203%', '67.401%', '67.893%', '69.882%']
Workers improved  accuracies:  ['1.241%', '2.203%', '3.358%', '4.471%', '6.631%', '6.567%', '7.444%', '8.214%', '8.663%', '9.733%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 6:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.6000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.6000%', '78.4000%', '78.2000%', '78.4000%']
Computed and normalized credits:  tensor([0.0995, 0.1003, 0.1003, 0.1003, 0.1002, 0.1002, 0.0994, 0.0998, 0.1002,
        0.0998])
Federated model performance: Loss: 0.511178. Accuracy: 74.8235%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['58.888%', '60.107%', '61.497%', '63.294%', '66.310%', '66.225%', '67.444%', '68.449%', '69.091%', '70.717%']
Workers federated accuracies:  ['58.888%', '60.107%', '61.497%', '63.294%', '66.310%', '66.225%', '67.444%', '68.449%', '69.091%', '70.717%']
Workers improved  accuracies:  ['1.519%', '2.610%', '3.829%', '5.348%', '7.829%', '7.701%', '8.684%', '9.262%', '9.861%', '10.567%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 7:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.4000%', '78.6000%', '79.0000%', '79.2000%', '79.0000%']
Computed and normalized credits:  tensor([0.1006, 0.1007, 0.1007, 0.1007, 0.1003, 0.1003, 0.0998, 0.0990, 0.0987,
        0.0990])
Federated model performance: Loss: 0.503549. Accuracy: 75.2513%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['59.166%', '60.578%', '61.947%', '63.914%', '67.294%', '67.209%', '68.342%', '69.241%', '69.690%', '71.465%']
Workers federated accuracies:  ['59.166%', '60.578%', '61.947%', '63.914%', '67.294%', '67.209%', '68.342%', '69.241%', '69.690%', '71.465%']
Workers improved  accuracies:  ['1.797%', '3.080%', '4.278%', '5.968%', '8.813%', '8.684%', '9.583%', '10.053%', '10.460%', '11.316%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 8:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.1001, 0.1002, 0.1002, 0.1002, 0.1001, 0.1001, 0.1000, 0.0995, 0.0998,
        0.0999])
Federated model performance: Loss: 0.498667. Accuracy: 75.4011%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['59.401%', '60.963%', '62.481%', '64.663%', '67.957%', '67.893%', '69.091%', '70.182%', '70.695%', '71.893%']
Workers federated accuracies:  ['59.401%', '60.963%', '62.481%', '64.663%', '67.957%', '67.893%', '69.091%', '70.182%', '70.695%', '71.893%']
Workers improved  accuracies:  ['2.032%', '3.465%', '4.813%', '6.717%', '9.476%', '9.369%', '10.332%', '10.995%', '11.465%', '11.743%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 9:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.0000%', '79.0000%', '79.0000%', '79.4000%', '79.2000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.0999, 0.0999, 0.0999, 0.1003, 0.1003, 0.1002, 0.0995,
        0.0999])
Federated model performance: Loss: 0.496284. Accuracy: 75.6364%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['59.743%', '61.155%', '62.995%', '65.497%', '68.898%', '68.813%', '69.925%', '70.909%', '71.444%', '72.492%']
Workers federated accuracies:  ['59.743%', '61.155%', '62.995%', '65.497%', '68.898%', '68.813%', '69.925%', '70.909%', '71.444%', '72.492%']
Workers improved  accuracies:  ['2.374%', '3.658%', '5.326%', '7.551%', '10.417%', '10.289%', '11.166%', '11.722%', '12.214%', '12.342%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 10:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.2000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.0996, 0.0996, 0.1004, 0.1004, 0.1003,
        0.0999])
Federated model performance: Loss: 0.496164. Accuracy: 75.7219%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['60.000%', '61.455%', '63.380%', '66.160%', '69.348%', '69.262%', '70.610%', '71.529%', '71.979%', '73.070%']
Workers federated accuracies:  ['60.000%', '61.455%', '63.380%', '66.160%', '69.348%', '69.262%', '70.610%', '71.529%', '71.979%', '73.070%']
Workers improved  accuracies:  ['2.631%', '3.957%', '5.711%', '8.214%', '10.866%', '10.738%', '11.850%', '12.342%', '12.749%', '12.920%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 11:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.0000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%', '78.6000%', '79.0000%', '79.2000%', '79.4000%']
Computed and normalized credits:  tensor([0.0996, 0.1000, 0.1004, 0.1004, 0.0999, 0.0999, 0.1009, 0.1001, 0.0997,
        0.0992])
Federated model performance: Loss: 0.497801. Accuracy: 75.9572%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['60.257%', '61.947%', '63.615%', '66.909%', '69.989%', '69.626%', '71.251%', '72.021%', '72.492%', '73.412%']
Workers federated accuracies:  ['60.257%', '61.947%', '63.615%', '66.909%', '69.989%', '69.626%', '71.251%', '72.021%', '72.492%', '73.412%']
Workers improved  accuracies:  ['2.888%', '4.449%', '5.947%', '8.963%', '11.508%', '11.102%', '12.492%', '12.834%', '13.262%', '13.262%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 12:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.2000%', '79.2000%', '79.4000%', '79.4000%', '79.4000%']
Computed and normalized credits:  tensor([0.1003, 0.1004, 0.1004, 0.1004, 0.0999, 0.0999, 0.1001, 0.0996, 0.0995,
        0.0994])
Federated model performance: Loss: 0.500940. Accuracy: 76.0856%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['60.364%', '62.310%', '64.235%', '67.465%', '70.374%', '70.096%', '71.722%', '72.620%', '72.856%', '74.075%']
Workers federated accuracies:  ['60.364%', '62.310%', '64.235%', '67.465%', '70.374%', '70.096%', '71.722%', '72.620%', '72.856%', '74.075%']
Workers improved  accuracies:  ['2.995%', '4.813%', '6.567%', '9.519%', '11.893%', '11.572%', '12.963%', '13.433%', '13.626%', '13.925%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 13:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999,
        0.0999])
Federated model performance: Loss: 0.504922. Accuracy: 76.1925%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['60.642%', '62.524%', '64.963%', '68.043%', '70.674%', '70.353%', '72.235%', '73.005%', '73.112%', '74.567%']
Workers federated accuracies:  ['60.642%', '62.524%', '64.963%', '68.043%', '70.674%', '70.353%', '72.235%', '73.005%', '73.112%', '74.567%']
Workers improved  accuracies:  ['3.273%', '5.027%', '7.294%', '10.096%', '12.193%', '11.829%', '13.476%', '13.818%', '13.882%', '14.417%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 14:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.6000%', '79.8000%', '80.0000%', '80.0000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1004, 0.1004, 0.1004, 0.1000, 0.0996, 0.0992,
        0.0992])
Federated model performance: Loss: 0.509942. Accuracy: 76.2353%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['60.941%', '63.037%', '65.561%', '68.342%', '71.187%', '70.888%', '72.342%', '73.497%', '73.476%', '74.759%']
Workers federated accuracies:  ['60.941%', '63.037%', '65.561%', '68.342%', '71.187%', '70.888%', '72.342%', '73.497%', '73.476%', '74.759%']
Workers improved  accuracies:  ['3.572%', '5.540%', '7.893%', '10.396%', '12.706%', '12.364%', '13.583%', '14.310%', '14.246%', '14.610%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 15:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.6000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '80.2000%', '80.4000%', '80.4000%']
Computed and normalized credits:  tensor([0.1010, 0.1010, 0.1006, 0.1002, 0.1002, 0.1002, 0.1001, 0.0993, 0.0988,
        0.0988])
Federated model performance: Loss: 0.515585. Accuracy: 76.2781%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['61.198%', '63.422%', '66.118%', '68.834%', '71.316%', '71.380%', '72.856%', '73.647%', '73.604%', '75.187%']
Workers federated accuracies:  ['61.198%', '63.422%', '66.118%', '68.834%', '71.316%', '71.380%', '72.856%', '73.647%', '73.604%', '75.187%']
Workers improved  accuracies:  ['3.829%', '5.925%', '8.449%', '10.888%', '12.834%', '12.856%', '14.096%', '14.460%', '14.374%', '15.037%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 16:
Federated model validation accuracy : 80.2000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.6000%', '80.6000%', '80.6000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1002, 0.1001, 0.1001, 0.1001, 0.1001, 0.0996, 0.0995,
        0.0995])
Federated model performance: Loss: 0.521351. Accuracy: 76.4064%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['61.412%', '63.722%', '66.674%', '69.283%', '71.636%', '71.658%', '73.112%', '73.882%', '74.032%', '75.380%']
Workers federated accuracies:  ['61.412%', '63.722%', '66.674%', '69.283%', '71.636%', '71.658%', '73.112%', '73.882%', '74.032%', '75.380%']
Workers improved  accuracies:  ['4.043%', '6.225%', '9.005%', '11.337%', '13.155%', '13.134%', '14.353%', '14.695%', '14.802%', '15.230%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 17:
Federated model validation accuracy : 80.6000%
Leave-one-out validation accuracies :  ['80.6000%', '80.6000%', '80.4000%', '80.6000%', '80.6000%', '80.6000%', '80.6000%', '80.6000%', '80.8000%', '80.8000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1005, 0.1001, 0.1001, 0.1001, 0.1001, 0.1000, 0.0996,
        0.0996])
Federated model performance: Loss: 0.527267. Accuracy: 76.4706%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['61.604%', '64.235%', '67.209%', '69.583%', '72.128%', '71.957%', '73.262%', '74.011%', '74.118%', '75.508%']
Workers federated accuracies:  ['61.604%', '64.235%', '67.209%', '69.583%', '72.128%', '71.957%', '73.262%', '74.011%', '74.118%', '75.508%']
Workers improved  accuracies:  ['4.235%', '6.738%', '9.540%', '11.636%', '13.647%', '13.433%', '14.503%', '14.824%', '14.888%', '15.358%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 18:
Federated model validation accuracy : 80.6000%
Leave-one-out validation accuracies :  ['80.6000%', '80.6000%', '80.6000%', '80.6000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1003, 0.1002, 0.0999, 0.0999, 0.0999, 0.0998, 0.0998,
        0.0998])
Federated model performance: Loss: 0.533777. Accuracy: 76.6631%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['61.861%', '64.642%', '67.572%', '69.818%', '72.385%', '72.257%', '73.519%', '74.139%', '74.246%', '75.701%']
Workers federated accuracies:  ['61.861%', '64.642%', '67.572%', '69.818%', '72.385%', '72.257%', '73.519%', '74.139%', '74.246%', '75.701%']
Workers improved  accuracies:  ['4.492%', '7.144%', '9.904%', '11.872%', '13.904%', '13.733%', '14.759%', '14.952%', '15.016%', '15.551%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 19:
Federated model validation accuracy : 80.8000%
Leave-one-out validation accuracies :  ['80.8000%', '80.8000%', '80.8000%', '80.8000%', '81.0000%', '81.0000%', '81.0000%', '81.2000%', '81.2000%', '81.2000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1004, 0.0999, 0.0999, 0.0999, 0.0995, 0.0995,
        0.0995])
Federated model performance: Loss: 0.539937. Accuracy: 76.7914%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['62.053%', '64.834%', '67.957%', '70.289%', '72.749%', '72.342%', '73.840%', '74.353%', '74.417%', '75.722%']
Workers federated accuracies:  ['62.053%', '64.834%', '67.957%', '70.289%', '72.749%', '72.342%', '73.840%', '74.353%', '74.417%', '75.722%']
Workers improved  accuracies:  ['4.684%', '7.337%', '10.289%', '12.342%', '14.267%', '13.818%', '15.080%', '15.166%', '15.187%', '15.572%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 20:
Federated model validation accuracy : 81.0000%
Leave-one-out validation accuracies :  ['81.0000%', '81.0000%', '81.0000%', '81.2000%', '81.2000%', '81.2000%', '81.2000%', '81.4000%', '81.4000%', '81.2000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1000, 0.1000, 0.1000, 0.1000, 0.0995, 0.0995,
        0.0999])
Federated model performance: Loss: 0.546411. Accuracy: 76.8770%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['62.246%', '65.198%', '68.214%', '70.439%', '73.005%', '72.663%', '74.182%', '74.631%', '74.631%', '75.786%']
Workers federated accuracies:  ['62.246%', '65.198%', '68.214%', '70.439%', '73.005%', '72.663%', '74.182%', '74.631%', '74.631%', '75.786%']
Workers improved  accuracies:  ['4.877%', '7.701%', '10.545%', '12.492%', '14.524%', '14.139%', '15.422%', '15.444%', '15.401%', '15.636%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.546411. Accuracy: 76.8770%.
Workers before    accuracies:  ['57.369%', '57.497%', '57.668%', '57.947%', '58.481%', '58.524%', '58.759%', '59.187%', '59.230%', '60.150%']
Workers standlone accuracies:  ['62.246%', '65.198%', '68.214%', '70.439%', '73.005%', '72.663%', '74.182%', '74.631%', '74.631%', '75.786%']
Workers federated accuracies:  ['62.246%', '65.198%', '68.214%', '70.439%', '73.005%', '72.663%', '74.182%', '74.631%', '74.631%', '75.786%']
Workers improved  accuracies:  ['4.877%', '7.701%', '10.545%', '12.492%', '14.524%', '14.139%', '15.422%', '15.444%', '15.401%', '15.636%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]
Workers sharing_contributions :  tensor([ 6.4000, 14.4000, 24.0000, 32.0000, 41.6000, 49.6000, 59.2000, 67.2000,
        76.8000, 84.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.23774497562464264, 0.508344956584619)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9358188419637434, 6.866903469931577e-05)
Correlation between test_acc improvements & sharing_contributions:  (0.8970735772828745, 0.00043292236770412553)
Experiment : No.2/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.613338. Accuracy: 68.1283%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.4000%
Leave-one-out validation accuracies :  ['71.4000%', '71.4000%', '71.8000%', '71.4000%', '72.2000%', '72.8000%', '73.4000%', '73.6000%', '73.2000%', '74.2000%']
Computed and normalized credits:  tensor([0.1025, 0.1025, 0.1016, 0.1025, 0.1007, 0.0994, 0.0981, 0.0977, 0.0985,
        0.0964])
Federated model performance: Loss: 0.580966. Accuracy: 70.5455%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['67.529%', '67.701%', '68.107%', '68.513%', '69.112%', '69.005%', '69.241%', '69.497%', '69.497%', '69.647%']
Workers federated accuracies:  ['67.529%', '67.701%', '68.107%', '68.513%', '69.112%', '69.005%', '69.241%', '69.497%', '69.497%', '69.647%']
Workers improved  accuracies:  ['0.064%', '0.235%', '0.471%', '0.642%', '0.920%', '0.770%', '0.791%', '0.920%', '0.877%', '0.706%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 2:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.4000%', '73.4000%', '73.6000%', '73.6000%', '73.6000%', '72.8000%', '73.4000%', '74.2000%', '75.0000%']
Computed and normalized credits:  tensor([0.1005, 0.1010, 0.1008, 0.1005, 0.1002, 0.1000, 0.1015, 0.1002, 0.0986,
        0.0966])
Federated model performance: Loss: 0.555165. Accuracy: 72.7914%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['67.679%', '67.914%', '68.642%', '68.941%', '69.433%', '69.348%', '69.690%', '70.032%', '70.075%', '70.289%']
Workers federated accuracies:  ['67.679%', '67.914%', '68.642%', '68.941%', '69.433%', '69.348%', '69.690%', '70.032%', '70.075%', '70.289%']
Workers improved  accuracies:  ['0.214%', '0.449%', '1.005%', '1.070%', '1.241%', '1.112%', '1.241%', '1.455%', '1.455%', '1.348%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 3:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['73.8000%', '73.8000%', '73.8000%', '73.8000%', '74.2000%', '74.8000%', '75.4000%', '76.4000%', '76.4000%', '76.6000%']
Computed and normalized credits:  tensor([0.1024, 0.1025, 0.1025, 0.1024, 0.1015, 0.1002, 0.0992, 0.0969, 0.0966,
        0.0958])
Federated model performance: Loss: 0.534138. Accuracy: 74.0535%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['67.786%', '68.128%', '69.048%', '69.369%', '69.668%', '69.626%', '70.417%', '70.396%', '70.781%', '70.503%']
Workers federated accuracies:  ['67.786%', '68.128%', '69.048%', '69.369%', '69.668%', '69.626%', '70.417%', '70.396%', '70.781%', '70.503%']
Workers improved  accuracies:  ['0.321%', '0.663%', '1.412%', '1.497%', '1.476%', '1.390%', '1.968%', '1.818%', '2.160%', '1.561%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 4:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.4000%', '76.6000%', '76.6000%', '76.4000%', '76.4000%', '77.0000%', '77.2000%', '77.0000%']
Computed and normalized credits:  tensor([0.1012, 0.1012, 0.1008, 0.1004, 0.1003, 0.1004, 0.1003, 0.0987, 0.0982,
        0.0985])
Federated model performance: Loss: 0.517486. Accuracy: 75.1016%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['67.979%', '68.364%', '69.155%', '69.561%', '70.096%', '70.032%', '70.524%', '70.588%', '70.973%', '71.316%']
Workers federated accuracies:  ['67.979%', '68.364%', '69.155%', '69.561%', '70.096%', '70.032%', '70.524%', '70.588%', '70.973%', '71.316%']
Workers improved  accuracies:  ['0.513%', '0.898%', '1.519%', '1.690%', '1.904%', '1.797%', '2.075%', '2.011%', '2.353%', '2.374%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 5:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.8000%', '77.0000%', '77.0000%', '77.4000%', '77.2000%', '77.4000%', '77.4000%', '77.4000%']
Computed and normalized credits:  tensor([0.1009, 0.1009, 0.1008, 0.1003, 0.1003, 0.0995, 0.0999, 0.0992, 0.0991,
        0.0992])
Federated model performance: Loss: 0.504707. Accuracy: 75.0802%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.171%', '68.449%', '69.412%', '69.690%', '70.417%', '70.374%', '70.610%', '70.674%', '71.037%', '72.321%']
Workers federated accuracies:  ['68.171%', '68.449%', '69.412%', '69.690%', '70.417%', '70.374%', '70.610%', '70.674%', '71.037%', '72.321%']
Workers improved  accuracies:  ['0.706%', '0.984%', '1.775%', '1.818%', '2.225%', '2.139%', '2.160%', '2.096%', '2.417%', '3.380%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 6:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['76.8000%', '77.0000%', '77.0000%', '77.4000%', '77.4000%', '77.4000%', '77.2000%', '77.6000%', '78.0000%', '78.4000%']
Computed and normalized credits:  tensor([0.1014, 0.1010, 0.1010, 0.1001, 0.1001, 0.1000, 0.1004, 0.0995, 0.0987,
        0.0979])
Federated model performance: Loss: 0.494789. Accuracy: 75.3583%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.299%', '68.684%', '69.604%', '69.840%', '70.524%', '70.631%', '70.973%', '71.016%', '71.358%', '72.920%']
Workers federated accuracies:  ['68.299%', '68.684%', '69.604%', '69.840%', '70.524%', '70.631%', '70.973%', '71.016%', '71.358%', '72.920%']
Workers improved  accuracies:  ['0.834%', '1.219%', '1.968%', '1.968%', '2.332%', '2.396%', '2.524%', '2.439%', '2.738%', '3.979%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 7:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.6000%', '78.0000%', '78.2000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.1018, 0.1017, 0.1017, 0.1011, 0.1003, 0.0999, 0.0988, 0.0986, 0.0981,
        0.0979])
Federated model performance: Loss: 0.487266. Accuracy: 75.8289%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.406%', '68.663%', '69.690%', '70.011%', '70.631%', '70.930%', '71.080%', '71.273%', '71.807%', '73.241%']
Workers federated accuracies:  ['68.406%', '68.663%', '69.690%', '70.011%', '70.631%', '70.930%', '71.080%', '71.273%', '71.807%', '73.241%']
Workers improved  accuracies:  ['0.941%', '1.198%', '2.053%', '2.139%', '2.439%', '2.695%', '2.631%', '2.695%', '3.187%', '4.299%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 8:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.6000%', '78.8000%', '78.8000%', '78.6000%', '78.8000%', '79.0000%', '78.8000%', '78.8000%', '79.0000%']
Computed and normalized credits:  tensor([0.1010, 0.1006, 0.1002, 0.1001, 0.1004, 0.0999, 0.0993, 0.0997, 0.0996,
        0.0992])
Federated model performance: Loss: 0.481839. Accuracy: 76.2353%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.556%', '68.813%', '69.861%', '69.968%', '70.524%', '71.594%', '71.572%', '72.000%', '72.578%', '73.561%']
Workers federated accuracies:  ['68.556%', '68.813%', '69.861%', '69.968%', '70.524%', '71.594%', '71.572%', '72.000%', '72.578%', '73.561%']
Workers improved  accuracies:  ['1.091%', '1.348%', '2.225%', '2.096%', '2.332%', '3.358%', '3.123%', '3.422%', '3.957%', '4.620%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 9:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '79.0000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.2000%', '79.4000%', '79.2000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1000, 0.1004, 0.1004, 0.1003, 0.0998, 0.0995, 0.0991,
        0.0994])
Federated model performance: Loss: 0.478010. Accuracy: 76.3636%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.620%', '69.048%', '69.904%', '70.160%', '70.845%', '71.914%', '72.214%', '72.727%', '73.583%', '73.647%']
Workers federated accuracies:  ['68.620%', '69.048%', '69.904%', '70.160%', '70.845%', '71.914%', '72.214%', '72.727%', '73.583%', '73.647%']
Workers improved  accuracies:  ['1.155%', '1.583%', '2.267%', '2.289%', '2.652%', '3.679%', '3.765%', '4.150%', '4.963%', '4.706%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 10:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%', '79.0000%', '79.4000%', '79.2000%', '79.2000%', '79.2000%']
Computed and normalized credits:  tensor([0.1006, 0.1006, 0.1005, 0.1001, 0.1001, 0.1001, 0.0993, 0.0996, 0.0995,
        0.0996])
Federated model performance: Loss: 0.475522. Accuracy: 76.3209%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.706%', '69.027%', '69.968%', '70.545%', '71.294%', '72.342%', '72.920%', '73.326%', '74.246%', '74.032%']
Workers federated accuracies:  ['68.706%', '69.027%', '69.968%', '70.545%', '71.294%', '72.342%', '72.920%', '73.326%', '74.246%', '74.032%']
Workers improved  accuracies:  ['1.241%', '1.561%', '2.332%', '2.674%', '3.102%', '4.107%', '4.471%', '4.749%', '5.626%', '5.091%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 11:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.0000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.0998, 0.0999, 0.0999,
        0.1003])
Federated model performance: Loss: 0.474267. Accuracy: 76.4920%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.877%', '69.112%', '70.203%', '70.888%', '71.979%', '72.684%', '73.540%', '73.840%', '74.631%', '74.332%']
Workers federated accuracies:  ['68.877%', '69.112%', '70.203%', '70.888%', '71.979%', '72.684%', '73.540%', '73.840%', '74.631%', '74.332%']
Workers improved  accuracies:  ['1.412%', '1.647%', '2.567%', '3.016%', '3.786%', '4.449%', '5.091%', '5.262%', '6.011%', '5.390%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 12:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '78.8000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.0998, 0.0998, 0.0998, 0.0998, 0.0998, 0.0998, 0.0997, 0.1005, 0.1005,
        0.1006])
Federated model performance: Loss: 0.473839. Accuracy: 76.5989%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.898%', '69.198%', '70.332%', '71.187%', '72.471%', '72.749%', '73.947%', '74.332%', '74.866%', '74.545%']
Workers federated accuracies:  ['68.898%', '69.198%', '70.332%', '71.187%', '72.471%', '72.749%', '73.947%', '74.332%', '74.866%', '74.545%']
Workers improved  accuracies:  ['1.433%', '1.733%', '2.695%', '3.316%', '4.278%', '4.513%', '5.497%', '5.754%', '6.246%', '5.604%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 13:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '79.0000%', '78.8000%', '78.8000%', '78.8000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.0995, 0.0995, 0.0995, 0.0999, 0.0999, 0.0999, 0.1003, 0.1004, 0.1004,
        0.1005])
Federated model performance: Loss: 0.474304. Accuracy: 76.6203%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['68.941%', '69.305%', '70.460%', '71.508%', '72.856%', '72.898%', '74.075%', '74.674%', '75.123%', '74.802%']
Workers federated accuracies:  ['68.941%', '69.305%', '70.460%', '71.508%', '72.856%', '72.898%', '74.075%', '74.674%', '75.123%', '74.802%']
Workers improved  accuracies:  ['1.476%', '1.840%', '2.824%', '3.636%', '4.663%', '4.663%', '5.626%', '6.096%', '6.503%', '5.861%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 14:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%', '78.6000%', '79.0000%']
Computed and normalized credits:  tensor([0.0997, 0.1001, 0.1001, 0.1002, 0.1002, 0.1002, 0.0999, 0.0999, 0.1003,
        0.0995])
Federated model performance: Loss: 0.475494. Accuracy: 76.6203%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['69.027%', '69.390%', '70.524%', '71.807%', '73.155%', '72.963%', '74.374%', '74.802%', '75.273%', '75.059%']
Workers federated accuracies:  ['69.027%', '69.390%', '70.524%', '71.807%', '73.155%', '72.963%', '74.374%', '74.802%', '75.273%', '75.059%']
Workers improved  accuracies:  ['1.561%', '1.925%', '2.888%', '3.936%', '4.963%', '4.727%', '5.925%', '6.225%', '6.652%', '6.118%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 15:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.2000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.0998,
        0.0992])
Federated model performance: Loss: 0.477276. Accuracy: 76.6203%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['69.048%', '69.519%', '70.545%', '72.235%', '73.369%', '73.091%', '74.524%', '75.144%', '75.422%', '75.230%']
Workers federated accuracies:  ['69.048%', '69.519%', '70.545%', '72.235%', '73.369%', '73.091%', '74.524%', '75.144%', '75.422%', '75.230%']
Workers improved  accuracies:  ['1.583%', '2.053%', '2.909%', '4.364%', '5.176%', '4.856%', '6.075%', '6.567%', '6.802%', '6.289%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 16:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '79.0000%', '78.8000%', '78.8000%', '79.2000%', '79.2000%', '79.0000%', '79.4000%', '79.6000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1006, 0.1006, 0.0998, 0.0998, 0.1002, 0.0994,
        0.0989])
Federated model performance: Loss: 0.479354. Accuracy: 76.8128%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['69.219%', '69.519%', '70.717%', '72.599%', '73.647%', '73.326%', '74.695%', '75.166%', '75.701%', '75.358%']
Workers federated accuracies:  ['69.219%', '69.519%', '70.717%', '72.599%', '73.647%', '73.326%', '74.695%', '75.166%', '75.701%', '75.358%']
Workers improved  accuracies:  ['1.754%', '2.053%', '3.080%', '4.727%', '5.455%', '5.091%', '6.246%', '6.588%', '7.080%', '6.417%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 17:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%', '79.8000%', '80.0000%', '79.8000%', '80.0000%']
Computed and normalized credits:  tensor([0.1003, 0.1004, 0.1004, 0.1004, 0.1000, 0.0999, 0.0999, 0.0996, 0.0998,
        0.0993])
Federated model performance: Loss: 0.481681. Accuracy: 76.8984%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['69.369%', '69.668%', '70.824%', '72.770%', '73.882%', '73.626%', '74.824%', '75.358%', '75.722%', '75.529%']
Workers federated accuracies:  ['69.369%', '69.668%', '70.824%', '72.770%', '73.882%', '73.626%', '74.824%', '75.358%', '75.722%', '75.529%']
Workers improved  accuracies:  ['1.904%', '2.203%', '3.187%', '4.898%', '5.690%', '5.390%', '6.374%', '6.781%', '7.102%', '6.588%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 18:
Federated model validation accuracy : 79.8000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.2000%', '80.2000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1000, 0.0997,
        0.0996])
Federated model performance: Loss: 0.484404. Accuracy: 76.9626%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['69.433%', '69.711%', '70.952%', '72.834%', '74.160%', '73.647%', '74.930%', '75.572%', '75.765%', '75.572%']
Workers federated accuracies:  ['69.433%', '69.711%', '70.952%', '72.834%', '74.160%', '73.647%', '74.930%', '75.572%', '75.765%', '75.572%']
Workers improved  accuracies:  ['1.968%', '2.246%', '3.316%', '4.963%', '5.968%', '5.412%', '6.481%', '6.995%', '7.144%', '6.631%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 19:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.0998, 0.0998, 0.0998, 0.0997,
        0.0997])
Federated model performance: Loss: 0.487274. Accuracy: 77.0053%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['69.561%', '69.797%', '71.144%', '72.963%', '74.246%', '73.840%', '75.059%', '75.594%', '75.829%', '75.615%']
Workers federated accuracies:  ['69.561%', '69.797%', '71.144%', '72.963%', '74.246%', '73.840%', '75.059%', '75.594%', '75.829%', '75.615%']
Workers improved  accuracies:  ['2.096%', '2.332%', '3.508%', '5.091%', '6.053%', '5.604%', '6.610%', '7.016%', '7.209%', '6.674%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 20:
Federated model validation accuracy : 80.2000%
Leave-one-out validation accuracies :  ['80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 0.490553. Accuracy: 77.0053%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['69.604%', '69.840%', '71.166%', '73.048%', '74.332%', '73.968%', '75.273%', '75.765%', '75.850%', '75.722%']
Workers federated accuracies:  ['69.604%', '69.840%', '71.166%', '73.048%', '74.332%', '73.968%', '75.273%', '75.765%', '75.850%', '75.722%']
Workers improved  accuracies:  ['2.139%', '2.374%', '3.529%', '5.176%', '6.139%', '5.733%', '6.824%', '7.187%', '7.230%', '6.781%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.490553. Accuracy: 77.0053%.
Workers before    accuracies:  ['67.465%', '67.465%', '67.636%', '67.872%', '68.193%', '68.235%', '68.449%', '68.578%', '68.620%', '68.941%']
Workers standlone accuracies:  ['69.604%', '69.840%', '71.166%', '73.048%', '74.332%', '73.968%', '75.273%', '75.765%', '75.850%', '75.722%']
Workers federated accuracies:  ['69.604%', '69.840%', '71.166%', '73.048%', '74.332%', '73.968%', '75.273%', '75.765%', '75.850%', '75.722%']
Workers improved  accuracies:  ['2.139%', '2.374%', '3.529%', '5.176%', '6.139%', '5.733%', '6.824%', '7.187%', '7.230%', '6.781%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]
Workers sharing_contributions :  tensor([ 6.4000, 14.4000, 24.0000, 32.0000, 41.6000, 49.6000, 59.2000, 67.2000,
        76.8000, 84.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.638190005429736, 0.04707491021577657)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999999, 6.646897422031858e-64)
Correlation between test_acc & sharing contributions:  (0.949521422013224, 2.672103602455374e-05)
Correlation between test_acc improvements & sharing_contributions:  (0.9266856722004364, 0.00011561220689265466)
standalone_vs_final_corr [[1.0], [0.9999999999999999]]
standalone_vs_final_corr_mean [1.0]
standalone_vs_final_corr_std [7.850462293418876e-17]
sharingcontribution_vs_final_corr [[0.9358188419637434], [0.949521422013224]]
sharingcontribution_vs_final_corr_mean [0.9426701319884837]
sharingcontribution_vs_final_corr_std [0.006851290024740275]
standalone_vs_federated_perturbed_corr [[0.23774497562464264], [-0.638190005429736]]
standalone_vs_federated_perturbed_corr_mean [-0.2002225149025467]
standalone_vs_federated_perturbed_corr_std [0.4379674905271893]
federated_final_performance [0.7687700390815735, 0.7700534462928772]
federated_final_performance_mean 0.7694117426872253
federated_final_performance_std 0.0006417036056518555
CFFL_best_worker [0.7578609585762024, 0.7585026621818542]
CFFL_best_worker_mean 0.7581818103790283
CFFL_best_worker_std 0.00032085180282592773
standalone_best_worker [0.7578609585762024, 0.7585026621818542]
standalone_best_worker_mean 0.7581818103790283
standalone_best_worker_std 0.00032085180282592773
