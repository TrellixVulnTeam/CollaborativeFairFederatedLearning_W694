Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 20, 'fl_individual_epochs': 5}
Experiment : No.1/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.758526. Accuracy: 48.9412%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 69.0000%
Leave-one-out validation accuracies :  ['68.9000%', '70.0000%', '70.9000%', '72.1000%', '72.6000%']
Computed and normalized credits:  tensor([0.2079, 0.2035, 0.1999, 0.1953, 0.1934])
Federated model performance: Loss: 0.635389. Accuracy: 70.3315%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['44.556%', '50.139%', '56.193%', '61.968%', '65.904%']
Workers federated accuracies:  ['58.053%', '62.417%', '66.460%', '68.171%', '69.925%']
Workers improved  accuracies:  ['14.182%', '15.594%', '17.134%', '16.171%', '15.572%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 2:
Federated model validation accuracy : 71.3000%
Leave-one-out validation accuracies :  ['71.4000%', '71.8000%', '72.6000%', '72.1000%', '72.9000%']
Computed and normalized credits:  tensor([0.2052, 0.2024, 0.1983, 0.1989, 0.1953])
Federated model performance: Loss: 0.583197. Accuracy: 74.3316%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['45.476%', '53.904%', '63.251%', '68.599%', '71.251%']
Workers federated accuracies:  ['66.909%', '70.353%', '71.872%', '73.070%', '74.096%']
Workers improved  accuracies:  ['23.037%', '23.529%', '22.545%', '21.070%', '19.743%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 3:
Federated model validation accuracy : 72.7000%
Leave-one-out validation accuracies :  ['72.6000%', '72.6000%', '72.8000%', '73.1000%', '73.7000%']
Computed and normalized credits:  tensor([0.2028, 0.2020, 0.2001, 0.1992, 0.1959])
Federated model performance: Loss: 0.557702. Accuracy: 75.5936%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['46.011%', '57.989%', '67.893%', '71.957%', '74.396%']
Workers federated accuracies:  ['70.567%', '72.877%', '73.840%', '74.781%', '75.936%']
Workers improved  accuracies:  ['26.695%', '26.053%', '24.513%', '22.781%', '21.583%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 4:
Federated model validation accuracy : 72.7000%
Leave-one-out validation accuracies :  ['72.8000%', '73.1000%', '73.3000%', '73.6000%', '74.0000%']
Computed and normalized credits:  tensor([0.2029, 0.2015, 0.2002, 0.1989, 0.1965])
Federated model performance: Loss: 0.544793. Accuracy: 76.1497%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['46.674%', '62.032%', '70.845%', '73.989%', '75.701%']
Workers federated accuracies:  ['72.257%', '73.754%', '75.380%', '75.936%', '76.791%']
Workers improved  accuracies:  ['28.385%', '26.930%', '26.053%', '23.936%', '22.439%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 5:
Federated model validation accuracy : 73.3000%
Leave-one-out validation accuracies :  ['73.3000%', '73.5000%', '73.8000%', '74.1000%', '74.4000%']
Computed and normalized credits:  tensor([0.2027, 0.2016, 0.2001, 0.1986, 0.1969])
Federated model performance: Loss: 0.536019. Accuracy: 76.8342%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['47.251%', '65.198%', '72.535%', '74.909%', '76.492%']
Workers federated accuracies:  ['73.134%', '74.674%', '76.021%', '76.663%', '77.241%']
Workers improved  accuracies:  ['29.262%', '27.850%', '26.695%', '24.663%', '22.888%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 6:
Federated model validation accuracy : 73.9000%
Leave-one-out validation accuracies :  ['73.9000%', '74.2000%', '74.4000%', '74.4000%', '74.7000%']
Computed and normalized credits:  tensor([0.2023, 0.2009, 0.1997, 0.1993, 0.1977])
Federated model performance: Loss: 0.528421. Accuracy: 77.0695%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['47.850%', '67.765%', '73.690%', '75.658%', '77.241%']
Workers federated accuracies:  ['73.711%', '75.251%', '76.834%', '77.027%', '77.733%']
Workers improved  accuracies:  ['29.840%', '28.428%', '27.508%', '25.027%', '23.380%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 7:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.4000%', '74.5000%', '74.5000%', '74.6000%', '75.0000%']
Computed and normalized credits:  tensor([0.2014, 0.2006, 0.2003, 0.1998, 0.1979])
Federated model performance: Loss: 0.522993. Accuracy: 77.3690%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['48.599%', '69.412%', '74.631%', '76.321%', '77.690%']
Workers federated accuracies:  ['73.968%', '75.658%', '77.134%', '77.348%', '78.032%']
Workers improved  accuracies:  ['30.096%', '28.834%', '27.807%', '25.348%', '23.679%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 8:
Federated model validation accuracy : 74.7000%
Leave-one-out validation accuracies :  ['74.7000%', '74.8000%', '75.1000%', '75.2000%', '75.2000%']
Computed and normalized credits:  tensor([0.2015, 0.2009, 0.1997, 0.1992, 0.1987])
Federated model performance: Loss: 0.517780. Accuracy: 77.5829%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['49.348%', '70.695%', '75.380%', '76.684%', '77.882%']
Workers federated accuracies:  ['74.503%', '76.000%', '77.476%', '77.668%', '78.353%']
Workers improved  accuracies:  ['30.631%', '29.176%', '28.150%', '25.668%', '24.000%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 9:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.2000%', '75.3000%', '75.6000%']
Computed and normalized credits:  tensor([0.2012, 0.2010, 0.2000, 0.1995, 0.1983])
Federated model performance: Loss: 0.513451. Accuracy: 77.6257%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['50.053%', '71.936%', '75.957%', '77.112%', '78.160%']
Workers federated accuracies:  ['74.909%', '76.321%', '77.690%', '78.139%', '78.481%']
Workers improved  accuracies:  ['31.037%', '29.497%', '28.364%', '26.139%', '24.128%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 10:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.3000%', '75.4000%', '75.6000%', '75.7000%', '75.6000%']
Computed and normalized credits:  tensor([0.2011, 0.2007, 0.1997, 0.1992, 0.1992])
Federated model performance: Loss: 0.510313. Accuracy: 77.7540%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['50.909%', '72.791%', '76.492%', '77.433%', '78.353%']
Workers federated accuracies:  ['75.166%', '76.684%', '77.797%', '78.246%', '78.824%']
Workers improved  accuracies:  ['31.294%', '29.861%', '28.471%', '26.246%', '24.471%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 11:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.5000%', '75.6000%', '75.6000%', '75.6000%', '75.7000%']
Computed and normalized credits:  tensor([0.2007, 0.2002, 0.1999, 0.1998, 0.1994])
Federated model performance: Loss: 0.506830. Accuracy: 77.9465%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['51.679%', '73.369%', '76.834%', '77.711%', '78.545%']
Workers federated accuracies:  ['75.294%', '77.048%', '78.075%', '78.439%', '78.845%']
Workers improved  accuracies:  ['31.422%', '30.225%', '28.749%', '26.439%', '24.492%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 12:
Federated model validation accuracy : 75.7000%
Leave-one-out validation accuracies :  ['75.7000%', '75.7000%', '75.9000%', '75.8000%', '75.9000%']
Computed and normalized credits:  tensor([0.2005, 0.2004, 0.1996, 0.1999, 0.1995])
Federated model performance: Loss: 0.503774. Accuracy: 77.9893%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['52.150%', '74.053%', '76.984%', '77.968%', '78.524%']
Workers federated accuracies:  ['75.572%', '77.219%', '78.182%', '78.396%', '78.845%']
Workers improved  accuracies:  ['31.701%', '30.396%', '28.856%', '26.396%', '24.492%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 13:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.9000%', '75.9000%', '76.0000%', '76.0000%']
Computed and normalized credits:  tensor([0.2006, 0.2002, 0.2000, 0.1997, 0.1996])
Federated model performance: Loss: 0.500509. Accuracy: 78.3315%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['52.877%', '74.439%', '77.262%', '78.075%', '78.567%']
Workers federated accuracies:  ['75.786%', '77.390%', '78.289%', '78.567%', '78.759%']
Workers improved  accuracies:  ['31.914%', '30.567%', '28.963%', '26.567%', '24.406%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 14:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '75.9000%', '76.0000%', '76.0000%', '75.9000%']
Computed and normalized credits:  tensor([0.2000, 0.2003, 0.1998, 0.1998, 0.2001])
Federated model performance: Loss: 0.497690. Accuracy: 78.4385%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['53.797%', '74.717%', '77.390%', '78.139%', '78.674%']
Workers federated accuracies:  ['75.936%', '77.561%', '78.310%', '78.567%', '78.973%']
Workers improved  accuracies:  ['32.064%', '30.738%', '28.984%', '26.567%', '24.620%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 15:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '76.0000%', '76.2000%', '76.0000%']
Computed and normalized credits:  tensor([0.2001, 0.2002, 0.2001, 0.1994, 0.2002])
Federated model performance: Loss: 0.495088. Accuracy: 78.4599%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['54.481%', '74.888%', '77.519%', '78.310%', '78.845%']
Workers federated accuracies:  ['76.214%', '77.668%', '78.545%', '78.610%', '78.973%']
Workers improved  accuracies:  ['32.342%', '30.845%', '29.219%', '26.610%', '24.620%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 16:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.1000%', '76.1000%', '76.2000%', '76.1000%', '76.2000%']
Computed and normalized credits:  tensor([0.2002, 0.2002, 0.1998, 0.2000, 0.1998])
Federated model performance: Loss: 0.492433. Accuracy: 78.4385%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['55.316%', '75.144%', '77.604%', '78.439%', '78.909%']
Workers federated accuracies:  ['76.342%', '77.861%', '78.781%', '78.759%', '79.037%']
Workers improved  accuracies:  ['32.471%', '31.037%', '29.455%', '26.759%', '24.684%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 17:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.1000%', '76.3000%', '76.3000%']
Computed and normalized credits:  tensor([0.2001, 0.2001, 0.2004, 0.1997, 0.1997])
Federated model performance: Loss: 0.490174. Accuracy: 78.4599%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['56.428%', '75.444%', '77.583%', '78.652%', '78.930%']
Workers federated accuracies:  ['76.578%', '77.968%', '78.866%', '78.909%', '79.166%']
Workers improved  accuracies:  ['32.706%', '31.144%', '29.540%', '26.909%', '24.813%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 18:
Federated model validation accuracy : 76.3000%
Leave-one-out validation accuracies :  ['76.3000%', '76.3000%', '76.3000%', '76.3000%', '76.4000%']
Computed and normalized credits:  tensor([0.2001, 0.2001, 0.2002, 0.2000, 0.1996])
Federated model performance: Loss: 0.487999. Accuracy: 78.5241%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['57.134%', '75.658%', '77.818%', '78.738%', '79.102%']
Workers federated accuracies:  ['76.770%', '78.096%', '78.888%', '79.016%', '79.380%']
Workers improved  accuracies:  ['32.898%', '31.273%', '29.561%', '27.016%', '25.027%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 19:
Federated model validation accuracy : 76.3000%
Leave-one-out validation accuracies :  ['76.3000%', '76.4000%', '76.4000%', '76.4000%', '76.4000%']
Computed and normalized credits:  tensor([0.2003, 0.2000, 0.2000, 0.1999, 0.1998])
Federated model performance: Loss: 0.486154. Accuracy: 78.6952%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['57.733%', '75.957%', '77.882%', '78.781%', '79.102%']
Workers federated accuracies:  ['76.920%', '78.160%', '78.824%', '79.166%', '79.422%']
Workers improved  accuracies:  ['33.048%', '31.337%', '29.497%', '27.166%', '25.070%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 20:
Federated model validation accuracy : 76.5000%
Leave-one-out validation accuracies :  ['76.5000%', '76.5000%', '76.4000%', '76.4000%', '76.5000%']
Computed and normalized credits:  tensor([0.1999, 0.1998, 0.2002, 0.2002, 0.1998])
Federated model performance: Loss: 0.484373. Accuracy: 78.7594%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['58.524%', '76.000%', '77.904%', '78.845%', '79.102%']
Workers federated accuracies:  ['77.091%', '78.353%', '78.824%', '79.294%', '79.594%']
Workers improved  accuracies:  ['33.219%', '31.529%', '29.497%', '27.294%', '25.241%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.484373. Accuracy: 78.7594%.
Workers before    accuracies:  ['43.872%', '46.824%', '49.326%', '52.000%', '54.353%']
Workers standlone accuracies:  ['58.524%', '76.000%', '77.904%', '78.845%', '79.102%']
Workers federated accuracies:  ['77.091%', '78.353%', '78.824%', '79.294%', '79.594%']
Workers improved  accuracies:  ['33.219%', '31.529%', '29.497%', '27.294%', '25.241%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]
Workers sharing_contributions :  tensor([ 44.8000, 201.6000, 361.6000, 521.6000, 678.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.2732271513915283, 0.6564946273635945)
Correlation between stand alone test acc & collaborative final model acc:  (0.9330906315589365, 0.020566331174503148)
Correlation between test_acc & sharing contributions:  (0.957640263792493, 0.010398838720042068)
Correlation between test_acc improvements & sharing_contributions:  (-0.9990838198077563, 3.328476628407709e-05)
Experiment : No.2/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.689422. Accuracy: 58.8663%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 70.5000%
Leave-one-out validation accuracies :  ['71.0000%', '71.8000%', '72.9000%', '72.7000%', '72.0000%']
Computed and normalized credits:  tensor([0.2041, 0.2011, 0.1969, 0.1976, 0.2003])
Federated model performance: Loss: 0.600710. Accuracy: 69.8610%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['54.460%', '60.257%', '63.893%', '66.053%', '67.572%']
Workers federated accuracies:  ['63.872%', '65.647%', '67.230%', '68.214%', '69.219%']
Workers improved  accuracies:  ['10.118%', '8.663%', '8.021%', '6.824%', '6.353%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 2:
Federated model validation accuracy : 73.1000%
Leave-one-out validation accuracies :  ['73.1000%', '73.2000%', '73.1000%', '72.3000%', '72.3000%']
Computed and normalized credits:  tensor([0.2001, 0.1988, 0.1980, 0.2012, 0.2019])
Federated model performance: Loss: 0.565750. Accuracy: 73.1551%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['55.166%', '62.909%', '67.123%', '69.198%', '70.824%']
Workers federated accuracies:  ['67.701%', '69.882%', '71.572%', '73.155%', '74.032%']
Workers improved  accuracies:  ['13.947%', '12.898%', '12.364%', '11.765%', '11.166%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 3:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.7000%', '73.5000%', '72.9000%', '73.4000%', '73.6000%']
Computed and normalized credits:  tensor([0.1990, 0.1994, 0.2013, 0.2004, 0.1999])
Federated model performance: Loss: 0.547907. Accuracy: 74.2032%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['55.872%', '64.535%', '68.492%', '71.765%', '73.754%']
Workers federated accuracies:  ['69.840%', '72.257%', '73.968%', '74.460%', '74.824%']
Workers improved  accuracies:  ['16.086%', '15.273%', '14.759%', '13.070%', '11.957%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 4:
Federated model validation accuracy : 73.7000%
Leave-one-out validation accuracies :  ['73.6000%', '73.5000%', '73.8000%', '74.2000%', '74.5000%']
Computed and normalized credits:  tensor([0.2009, 0.2014, 0.2008, 0.1991, 0.1979])
Federated model performance: Loss: 0.536878. Accuracy: 74.8449%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['56.877%', '66.118%', '70.353%', '73.583%', '74.717%']
Workers federated accuracies:  ['71.487%', '73.882%', '74.802%', '74.995%', '75.358%']
Workers improved  accuracies:  ['17.733%', '16.898%', '15.594%', '13.604%', '12.492%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 5:
Federated model validation accuracy : 74.3000%
Leave-one-out validation accuracies :  ['74.3000%', '74.3000%', '74.7000%', '74.8000%', '74.8000%']
Computed and normalized credits:  tensor([0.2013, 0.2014, 0.1998, 0.1989, 0.1986])
Federated model performance: Loss: 0.528320. Accuracy: 75.4866%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['57.647%', '67.872%', '72.257%', '74.824%', '75.230%']
Workers federated accuracies:  ['72.727%', '74.759%', '75.187%', '75.615%', '76.128%']
Workers improved  accuracies:  ['18.973%', '17.775%', '15.979%', '14.225%', '13.262%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 6:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.2000%', '75.4000%', '75.2000%', '75.0000%', '75.2000%']
Computed and normalized credits:  tensor([0.2004, 0.1997, 0.1999, 0.2004, 0.1996])
Federated model performance: Loss: 0.521773. Accuracy: 75.8289%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['58.289%', '68.791%', '73.241%', '75.422%', '75.701%']
Workers federated accuracies:  ['73.497%', '75.166%', '75.722%', '76.214%', '76.513%']
Workers improved  accuracies:  ['19.743%', '18.182%', '16.513%', '14.824%', '13.647%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 7:
Federated model validation accuracy : 75.1000%
Leave-one-out validation accuracies :  ['75.0000%', '75.1000%', '75.1000%', '75.2000%', '75.2000%']
Computed and normalized credits:  tensor([0.2005, 0.2000, 0.2001, 0.1998, 0.1996])
Federated model performance: Loss: 0.516229. Accuracy: 76.2139%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['58.909%', '69.968%', '74.203%', '75.551%', '76.086%']
Workers federated accuracies:  ['73.775%', '75.487%', '76.021%', '76.535%', '76.877%']
Workers improved  accuracies:  ['20.021%', '18.503%', '16.813%', '15.144%', '14.011%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 8:
Federated model validation accuracy : 75.1000%
Leave-one-out validation accuracies :  ['75.1000%', '75.1000%', '75.3000%', '75.3000%', '75.5000%']
Computed and normalized credits:  tensor([0.2007, 0.2006, 0.1999, 0.1998, 0.1990])
Federated model performance: Loss: 0.511997. Accuracy: 76.6203%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['59.658%', '71.059%', '74.652%', '75.936%', '76.406%']
Workers federated accuracies:  ['74.332%', '75.807%', '76.471%', '76.684%', '77.176%']
Workers improved  accuracies:  ['20.578%', '18.824%', '17.262%', '15.294%', '14.310%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 9:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.3000%', '75.3000%', '75.3000%', '75.4000%', '75.5000%']
Computed and normalized credits:  tensor([0.2004, 0.2004, 0.2002, 0.1998, 0.1992])
Federated model performance: Loss: 0.508093. Accuracy: 76.7701%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['60.321%', '72.193%', '75.080%', '76.086%', '76.684%']
Workers federated accuracies:  ['74.631%', '76.235%', '76.599%', '76.856%', '77.326%']
Workers improved  accuracies:  ['20.877%', '19.251%', '17.390%', '15.465%', '14.460%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 10:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.6000%', '75.4000%', '75.9000%']
Computed and normalized credits:  tensor([0.2002, 0.2002, 0.2001, 0.2007, 0.1988])
Federated model performance: Loss: 0.504503. Accuracy: 77.0267%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['60.813%', '72.791%', '75.316%', '76.278%', '77.070%']
Workers federated accuracies:  ['75.059%', '76.406%', '76.984%', '77.198%', '77.497%']
Workers improved  accuracies:  ['21.305%', '19.422%', '17.775%', '15.807%', '14.631%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 11:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.7000%', '75.6000%', '75.8000%', '76.1000%']
Computed and normalized credits:  tensor([0.2012, 0.2001, 0.2005, 0.1999, 0.1983])
Federated model performance: Loss: 0.501438. Accuracy: 77.3904%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['61.241%', '73.626%', '75.572%', '76.364%', '77.198%']
Workers federated accuracies:  ['75.401%', '76.663%', '77.155%', '77.455%', '77.561%']
Workers improved  accuracies:  ['21.647%', '19.679%', '17.947%', '16.064%', '14.695%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 12:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.1000%', '76.0000%', '76.0000%', '76.3000%', '76.2000%']
Computed and normalized credits:  tensor([0.2004, 0.2005, 0.2006, 0.1993, 0.1992])
Federated model performance: Loss: 0.498806. Accuracy: 77.4973%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['61.626%', '74.246%', '76.021%', '76.706%', '77.283%']
Workers federated accuracies:  ['75.594%', '76.920%', '77.326%', '77.647%', '77.626%']
Workers improved  accuracies:  ['21.840%', '19.936%', '18.118%', '16.257%', '14.759%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 13:
Federated model validation accuracy : 76.3000%
Leave-one-out validation accuracies :  ['76.3000%', '76.3000%', '76.4000%', '76.5000%', '76.7000%']
Computed and normalized credits:  tensor([0.2006, 0.2006, 0.2003, 0.1996, 0.1989])
Federated model performance: Loss: 0.496349. Accuracy: 77.6471%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['62.332%', '74.610%', '76.193%', '76.749%', '77.390%']
Workers federated accuracies:  ['75.679%', '77.112%', '77.583%', '77.861%', '77.882%']
Workers improved  accuracies:  ['21.925%', '20.128%', '18.374%', '16.471%', '15.016%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 14:
Federated model validation accuracy : 76.7000%
Leave-one-out validation accuracies :  ['76.7000%', '76.7000%', '76.8000%', '76.8000%', '77.0000%']
Computed and normalized credits:  tensor([0.2005, 0.2005, 0.2001, 0.1999, 0.1990])
Federated model performance: Loss: 0.493920. Accuracy: 77.8824%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['62.824%', '74.866%', '76.428%', '76.941%', '77.626%']
Workers federated accuracies:  ['75.936%', '77.198%', '77.711%', '77.968%', '77.947%']
Workers improved  accuracies:  ['22.182%', '20.214%', '18.503%', '16.578%', '15.080%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 15:
Federated model validation accuracy : 76.9000%
Leave-one-out validation accuracies :  ['76.9000%', '76.8000%', '76.8000%', '77.1000%', '77.1000%']
Computed and normalized credits:  tensor([0.2003, 0.2006, 0.2005, 0.1994, 0.1992])
Federated model performance: Loss: 0.491594. Accuracy: 77.8824%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['63.294%', '75.187%', '76.556%', '77.091%', '77.733%']
Workers federated accuracies:  ['76.214%', '77.412%', '77.797%', '78.096%', '78.096%']
Workers improved  accuracies:  ['22.460%', '20.428%', '18.588%', '16.706%', '15.230%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 16:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['77.0000%', '77.1000%', '77.1000%', '77.2000%', '77.3000%']
Computed and normalized credits:  tensor([0.2006, 0.2003, 0.2003, 0.1996, 0.1992])
Federated model performance: Loss: 0.489620. Accuracy: 78.0749%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['63.722%', '75.209%', '76.727%', '77.390%', '77.882%']
Workers federated accuracies:  ['76.321%', '77.668%', '77.989%', '78.289%', '78.203%']
Workers improved  accuracies:  ['22.567%', '20.684%', '18.781%', '16.898%', '15.337%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 17:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.1000%', '77.2000%', '77.2000%', '77.2000%', '77.3000%']
Computed and normalized credits:  tensor([0.2005, 0.2001, 0.2001, 0.1999, 0.1994])
Federated model performance: Loss: 0.487859. Accuracy: 78.2032%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['64.064%', '75.294%', '76.791%', '77.476%', '77.818%']
Workers federated accuracies:  ['76.556%', '77.754%', '78.246%', '78.332%', '78.374%']
Workers improved  accuracies:  ['22.802%', '20.770%', '19.037%', '16.941%', '15.508%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 18:
Federated model validation accuracy : 77.3000%
Leave-one-out validation accuracies :  ['77.3000%', '77.5000%', '77.3000%', '77.4000%', '77.3000%']
Computed and normalized credits:  tensor([0.2004, 0.1995, 0.2002, 0.1998, 0.2000])
Federated model performance: Loss: 0.486269. Accuracy: 78.2246%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['64.364%', '75.444%', '76.920%', '77.561%', '78.011%']
Workers federated accuracies:  ['76.663%', '77.968%', '78.353%', '78.460%', '78.588%']
Workers improved  accuracies:  ['22.909%', '20.984%', '19.144%', '17.070%', '15.722%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 19:
Federated model validation accuracy : 77.3000%
Leave-one-out validation accuracies :  ['77.3000%', '77.5000%', '77.5000%', '77.5000%', '77.7000%']
Computed and normalized credits:  tensor([0.2008, 0.1999, 0.2001, 0.2000, 0.1993])
Federated model performance: Loss: 0.484723. Accuracy: 78.2032%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['64.770%', '75.551%', '76.856%', '77.733%', '78.182%']
Workers federated accuracies:  ['76.856%', '78.096%', '78.439%', '78.610%', '78.717%']
Workers improved  accuracies:  ['23.102%', '21.112%', '19.230%', '17.219%', '15.850%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 20:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['77.8000%', '77.8000%', '77.7000%', '77.7000%', '77.6000%']
Computed and normalized credits:  tensor([0.2000, 0.1997, 0.2001, 0.2001, 0.2002])
Federated model performance: Loss: 0.483193. Accuracy: 78.4171%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['65.262%', '75.807%', '76.813%', '77.733%', '78.310%']
Workers federated accuracies:  ['76.898%', '78.160%', '78.332%', '78.610%', '78.866%']
Workers improved  accuracies:  ['23.144%', '21.176%', '19.123%', '17.219%', '16.000%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.483193. Accuracy: 78.4171%.
Workers before    accuracies:  ['53.754%', '56.984%', '59.209%', '61.390%', '62.866%']
Workers standlone accuracies:  ['65.262%', '75.807%', '76.813%', '77.733%', '78.310%']
Workers federated accuracies:  ['76.898%', '78.160%', '78.332%', '78.610%', '78.866%']
Workers improved  accuracies:  ['23.144%', '21.176%', '19.123%', '17.219%', '16.000%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]
Workers sharing_contributions :  tensor([ 44.8000, 201.6000, 361.6000, 521.6000, 678.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.24801382993374094, 0.6874868571906982)
Correlation between stand alone test acc & collaborative final model acc:  (0.98183733113543, 0.0029303305818821988)
Correlation between test_acc & sharing contributions:  (0.9092471269545281, 0.032368483727698065)
Correlation between test_acc improvements & sharing_contributions:  (-0.996363152440403, 0.00026313852922743304)
standalone_vs_final_corr [[0.9330906315589365], [0.98183733113543]]
standalone_vs_final_corr_mean [0.9574639813471832]
standalone_vs_final_corr_std [0.02437334978824679]
sharingcontribution_vs_final_corr [[0.957640263792493], [0.9092471269545281]]
sharingcontribution_vs_final_corr_mean [0.9334436953735106]
sharingcontribution_vs_final_corr_std [0.024196568418982434]
standalone_vs_federated_perturbed_corr [[-0.2732271513915283], [0.24801382993374094]]
standalone_vs_federated_perturbed_corr_mean [-0.012606660728893687]
standalone_vs_federated_perturbed_corr_std [0.2606204906626346]
federated_final_performance [0.7875936031341553, 0.7841711044311523]
federated_final_performance_mean 0.7858823537826538
federated_final_performance_std 0.0017112493515014648
CFFL_best_worker [0.7959358096122742, 0.7886630892753601]
CFFL_best_worker_mean 0.7922994494438171
CFFL_best_worker_std 0.0036363601684570312
standalone_best_worker [0.7910160422325134, 0.7831016182899475]
standalone_best_worker_mean 0.7870588302612305
standalone_best_worker_std 0.003957211971282959
