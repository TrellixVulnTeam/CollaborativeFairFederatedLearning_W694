Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.701965. Accuracy: 58.0107%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 69.3000%
Leave-one-out validation accuracies :  ['69.8000%', '70.4000%', '72.7000%', '73.5000%', '75.1000%']
Computed and normalized credits:  tensor([0.2098, 0.2074, 0.1983, 0.1952, 0.1892])
Federated model performance: Loss: 0.604593. Accuracy: 69.5401%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['54.053%', '58.652%', '62.888%', '64.663%', '67.679%']
Workers federated accuracies:  ['62.160%', '64.492%', '66.396%', '68.513%', '69.882%']
Workers improved  accuracies:  ['8.578%', '8.663%', '8.128%', '8.684%', '8.021%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 2:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.9000%', '74.2000%', '74.5000%', '75.6000%', '76.6000%']
Computed and normalized credits:  tensor([0.2067, 0.2049, 0.2012, 0.1963, 0.1909])
Federated model performance: Loss: 0.549305. Accuracy: 72.9412%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['54.524%', '61.348%', '65.583%', '69.455%', '71.508%']
Workers federated accuracies:  ['67.102%', '69.840%', '71.786%', '72.749%', '73.134%']
Workers improved  accuracies:  ['13.519%', '14.011%', '13.519%', '12.920%', '11.273%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 3:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.4000%', '75.7000%', '75.8000%', '76.8000%', '77.7000%']
Computed and normalized credits:  tensor([0.2051, 0.2035, 0.2020, 0.1970, 0.1923])
Federated model performance: Loss: 0.517098. Accuracy: 74.4813%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['55.123%', '63.102%', '69.305%', '72.064%', '73.476%']
Workers federated accuracies:  ['70.225%', '72.406%', '73.219%', '73.840%', '74.353%']
Workers improved  accuracies:  ['16.642%', '16.578%', '14.952%', '14.011%', '12.492%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 4:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.3000%', '76.8000%', '77.4000%', '78.1000%', '78.2000%']
Computed and normalized credits:  tensor([0.2052, 0.2030, 0.2004, 0.1965, 0.1948])
Federated model performance: Loss: 0.496416. Accuracy: 75.2513%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['55.872%', '64.556%', '71.187%', '73.241%', '74.353%']
Workers federated accuracies:  ['71.979%', '73.540%', '74.524%', '74.781%', '75.465%']
Workers improved  accuracies:  ['18.396%', '17.711%', '16.257%', '14.952%', '13.604%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 5:
Federated model validation accuracy : 77.9000%
Leave-one-out validation accuracies :  ['77.9000%', '77.9000%', '78.0000%', '78.7000%', '78.7000%']
Computed and normalized credits:  tensor([0.2027, 0.2020, 0.2010, 0.1974, 0.1969])
Federated model performance: Loss: 0.481930. Accuracy: 75.7861%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['56.556%', '66.524%', '72.492%', '73.904%', '75.337%']
Workers federated accuracies:  ['72.877%', '74.332%', '75.016%', '75.358%', '75.850%']
Workers improved  accuracies:  ['19.294%', '18.503%', '16.749%', '15.529%', '13.989%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 6:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.7000%', '78.7000%', '78.8000%', '78.9000%', '79.0000%']
Computed and normalized credits:  tensor([0.2012, 0.2010, 0.2003, 0.1990, 0.1985])
Federated model performance: Loss: 0.470945. Accuracy: 76.4278%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['57.005%', '68.299%', '73.369%', '74.610%', '75.786%']
Workers federated accuracies:  ['73.840%', '75.016%', '75.786%', '75.722%', '76.321%']
Workers improved  accuracies:  ['20.257%', '19.187%', '17.519%', '15.893%', '14.460%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 7:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.7000%', '78.7000%', '79.0000%', '78.8000%', '78.9000%']
Computed and normalized credits:  tensor([0.2007, 0.2007, 0.1995, 0.1998, 0.1993])
Federated model performance: Loss: 0.461794. Accuracy: 76.7487%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['57.604%', '70.203%', '74.203%', '75.166%', '76.107%']
Workers federated accuracies:  ['74.460%', '75.401%', '76.107%', '76.128%', '76.535%']
Workers improved  accuracies:  ['20.877%', '19.572%', '17.840%', '16.299%', '14.674%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 8:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.1000%', '79.0000%', '79.2000%']
Computed and normalized credits:  tensor([0.2000, 0.2000, 0.2000, 0.2004, 0.1996])
Federated model performance: Loss: 0.454497. Accuracy: 77.2406%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['58.053%', '71.187%', '74.717%', '75.679%', '76.749%']
Workers federated accuracies:  ['74.888%', '76.000%', '76.492%', '76.257%', '76.898%']
Workers improved  accuracies:  ['21.305%', '20.171%', '18.225%', '16.428%', '15.037%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 9:
Federated model validation accuracy : 79.1000%
Leave-one-out validation accuracies :  ['79.2000%', '79.1000%', '78.9000%', '79.3000%', '79.8000%']
Computed and normalized credits:  tensor([0.2002, 0.2005, 0.2012, 0.2000, 0.1981])
Federated model performance: Loss: 0.448505. Accuracy: 77.4973%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['58.524%', '72.150%', '75.209%', '75.979%', '76.898%']
Workers federated accuracies:  ['75.380%', '76.428%', '76.770%', '76.684%', '77.412%']
Workers improved  accuracies:  ['21.797%', '20.599%', '18.503%', '16.856%', '15.551%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 10:
Federated model validation accuracy : 79.3000%
Leave-one-out validation accuracies :  ['79.3000%', '79.5000%', '79.7000%', '79.8000%', '79.6000%']
Computed and normalized credits:  tensor([0.2010, 0.2004, 0.1999, 0.1993, 0.1994])
Federated model performance: Loss: 0.443352. Accuracy: 77.6684%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['59.016%', '72.513%', '75.401%', '76.235%', '77.027%']
Workers federated accuracies:  ['75.551%', '76.749%', '76.856%', '77.027%', '77.797%']
Workers improved  accuracies:  ['21.968%', '20.920%', '18.588%', '17.198%', '15.936%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.443352. Accuracy: 77.6684%.
Workers before    accuracies:  ['53.583%', '55.829%', '58.267%', '59.829%', '61.861%']
Workers standlone accuracies:  ['59.016%', '72.513%', '75.401%', '76.235%', '77.027%']
Workers federated accuracies:  ['75.551%', '76.749%', '76.856%', '77.027%', '77.797%']
Workers improved  accuracies:  ['21.968%', '20.920%', '18.588%', '17.198%', '15.936%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]
Workers sharing_contributions :  tensor([ 44.8000, 201.6000, 361.6000, 521.6000, 678.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.5635291682476898, 0.32252133715921755)
Correlation between stand alone test acc & collaborative final model acc:  (0.9251111079119391, 0.02432317701065491)
Correlation between test_acc & sharing contributions:  (0.9321462733261054, 0.021000231013846606)
Correlation between test_acc improvements & sharing_contributions:  (-0.9934019863302328, 0.0006427223245535938)
Experiment : No.2/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.727052. Accuracy: 56.4706%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 70.7000%
Leave-one-out validation accuracies :  ['70.8000%', '71.5000%', '73.3000%', '73.4000%', '73.7000%']
Computed and normalized credits:  tensor([0.2067, 0.2040, 0.1971, 0.1967, 0.1956])
Federated model performance: Loss: 0.643099. Accuracy: 70.5241%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['52.770%', '57.412%', '62.973%', '66.909%', '69.262%']
Workers federated accuracies:  ['62.717%', '65.968%', '68.257%', '69.733%', '71.016%']
Workers improved  accuracies:  ['10.738%', '11.722%', '11.615%', '10.439%', '9.326%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 2:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.8000%', '73.9000%', '73.8000%', '73.7000%', '74.0000%']
Computed and normalized credits:  tensor([0.2021, 0.2009, 0.1993, 0.1996, 0.1982])
Federated model performance: Loss: 0.595992. Accuracy: 73.8396%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['53.326%', '61.048%', '67.529%', '70.588%', '72.492%']
Workers federated accuracies:  ['68.321%', '70.631%', '72.235%', '73.390%', '73.925%']
Workers improved  accuracies:  ['16.342%', '16.385%', '15.594%', '14.096%', '12.235%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 3:
Federated model validation accuracy : 73.7000%
Leave-one-out validation accuracies :  ['73.7000%', '73.8000%', '74.0000%', '74.4000%', '74.8000%']
Computed and normalized credits:  tensor([0.2022, 0.2015, 0.2003, 0.1989, 0.1971])
Federated model performance: Loss: 0.567406. Accuracy: 74.7594%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['53.733%', '64.214%', '70.417%', '72.770%', '74.053%']
Workers federated accuracies:  ['71.037%', '72.984%', '74.053%', '74.481%', '74.738%']
Workers improved  accuracies:  ['19.059%', '18.738%', '17.412%', '15.187%', '13.048%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 4:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.4000%', '74.6000%', '75.0000%', '75.1000%']
Computed and normalized credits:  tensor([0.2023, 0.2014, 0.2003, 0.1985, 0.1976])
Federated model performance: Loss: 0.548274. Accuracy: 75.5722%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['54.567%', '66.545%', '72.021%', '73.840%', '74.802%']
Workers federated accuracies:  ['72.556%', '73.989%', '74.610%', '75.080%', '75.358%']
Workers improved  accuracies:  ['20.578%', '19.743%', '17.968%', '15.786%', '13.668%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 5:
Federated model validation accuracy : 74.9000%
Leave-one-out validation accuracies :  ['74.8000%', '75.0000%', '75.4000%', '75.0000%', '76.0000%']
Computed and normalized credits:  tensor([0.2022, 0.2013, 0.1995, 0.2004, 0.1966])
Federated model performance: Loss: 0.533285. Accuracy: 76.2139%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['54.952%', '68.364%', '73.134%', '74.481%', '75.294%']
Workers federated accuracies:  ['73.390%', '74.588%', '74.973%', '75.594%', '76.107%']
Workers improved  accuracies:  ['21.412%', '20.342%', '18.332%', '16.299%', '14.417%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 6:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.3000%', '75.4000%', '75.8000%', '76.0000%', '76.2000%']
Computed and normalized credits:  tensor([0.2022, 0.2016, 0.1996, 0.1992, 0.1974])
Federated model performance: Loss: 0.521248. Accuracy: 76.5989%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['55.658%', '69.733%', '73.861%', '74.930%', '75.529%']
Workers federated accuracies:  ['74.032%', '74.909%', '75.636%', '76.278%', '76.556%']
Workers improved  accuracies:  ['22.053%', '20.663%', '18.995%', '16.984%', '14.866%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 7:
Federated model validation accuracy : 75.9000%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '76.0000%', '76.2000%', '76.1000%']
Computed and normalized credits:  tensor([0.2008, 0.2007, 0.2001, 0.1993, 0.1991])
Federated model performance: Loss: 0.511796. Accuracy: 76.8984%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['56.406%', '70.888%', '74.310%', '75.294%', '75.914%']
Workers federated accuracies:  ['74.439%', '75.294%', '76.021%', '76.684%', '76.984%']
Workers improved  accuracies:  ['22.460%', '21.048%', '19.380%', '17.390%', '15.294%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 8:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.2000%', '76.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.2002, 0.2002, 0.2000, 0.1998, 0.1997])
Federated model performance: Loss: 0.503484. Accuracy: 77.2406%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['56.856%', '71.615%', '74.652%', '75.594%', '76.128%']
Workers federated accuracies:  ['74.802%', '75.636%', '76.428%', '76.920%', '77.219%']
Workers improved  accuracies:  ['22.824%', '21.390%', '19.786%', '17.626%', '15.529%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 9:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '76.2000%', '76.2000%', '76.4000%', '77.0000%']
Computed and normalized credits:  tensor([0.2013, 0.2006, 0.2006, 0.1998, 0.1977])
Federated model performance: Loss: 0.496463. Accuracy: 77.5401%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['57.497%', '72.428%', '74.952%', '75.893%', '76.278%']
Workers federated accuracies:  ['75.187%', '76.064%', '76.770%', '77.348%', '77.583%']
Workers improved  accuracies:  ['23.209%', '21.818%', '20.128%', '18.053%', '15.893%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 10:
Federated model validation accuracy : 76.5000%
Leave-one-out validation accuracies :  ['76.5000%', '76.5000%', '76.7000%', '76.9000%', '77.1000%']
Computed and normalized credits:  tensor([0.2012, 0.2010, 0.2003, 0.1994, 0.1981])
Federated model performance: Loss: 0.490755. Accuracy: 77.5615%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['58.246%', '72.941%', '75.230%', '76.193%', '76.513%']
Workers federated accuracies:  ['75.422%', '76.428%', '77.027%', '77.647%', '77.882%']
Workers improved  accuracies:  ['23.444%', '22.182%', '20.385%', '18.353%', '16.193%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.490755. Accuracy: 77.5615%.
Workers before    accuracies:  ['51.979%', '54.246%', '56.642%', '59.294%', '61.690%']
Workers standlone accuracies:  ['58.246%', '72.941%', '75.230%', '76.193%', '76.513%']
Workers federated accuracies:  ['75.422%', '76.428%', '77.027%', '77.647%', '77.882%']
Workers improved  accuracies:  ['23.444%', '22.182%', '20.385%', '18.353%', '16.193%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]
Workers sharing_contributions :  tensor([ 44.8000, 201.6000, 361.6000, 521.6000, 678.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.5192312860950742, 0.3699349746133296)
Correlation between stand alone test acc & collaborative final model acc:  (0.9080769427881978, 0.03299057442106445)
Correlation between test_acc & sharing contributions:  (0.9775725247345584, 0.00401825974140105)
Correlation between test_acc improvements & sharing_contributions:  (-0.9954707013862742, 0.00036566636265651496)
standalone_vs_final_corr [[0.9251111079119391], [0.9080769427881978]]
standalone_vs_final_corr_mean [0.9165940253500684]
standalone_vs_final_corr_std [0.008517082561870615]
sharingcontribution_vs_final_corr [[0.9321462733261054], [0.9775725247345584]]
sharingcontribution_vs_final_corr_mean [0.9548593990303319]
sharingcontribution_vs_final_corr_std [0.022713125704226456]
standalone_vs_federated_perturbed_corr [[-0.5635291682476898], [-0.5192312860950742]]
standalone_vs_federated_perturbed_corr_mean [-0.541380227171382]
standalone_vs_federated_perturbed_corr_std [0.022148941076307826]
federated_final_performance [0.7766844630241394, 0.7756149768829346]
federated_final_performance_mean 0.776149719953537
federated_final_performance_std 0.000534743070602417
CFFL_best_worker [0.7779679298400879, 0.7788235545158386]
CFFL_best_worker_mean 0.7783957421779633
CFFL_best_worker_std 0.0004278123378753662
standalone_best_worker [0.7702673673629761, 0.7651336789131165]
standalone_best_worker_mean 0.7677005231380463
standalone_best_worker_std 0.0025668442249298096
