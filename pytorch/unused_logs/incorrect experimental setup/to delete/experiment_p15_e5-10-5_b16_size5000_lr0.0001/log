Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 5000, 'n_workers': 15, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.810345. Accuracy: 40.7914%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 61.0000%
Leave-one-out validation accuracies :  ['61.0000%', '61.0000%', '61.4000%', '61.6000%', '62.6000%', '64.0000%', '65.6000%', '66.8000%', '67.4000%', '68.4000%', '69.0000%', '69.4000%', '69.6000%', '69.8000%', '70.4000%']
Computed and normalized credits:  tensor([0.0760, 0.0760, 0.0752, 0.0747, 0.0727, 0.0700, 0.0669, 0.0647, 0.0636,
        0.0618, 0.0608, 0.0601, 0.0598, 0.0594, 0.0584])
Federated model performance: Loss: 0.717350. Accuracy: 58.0963%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['39.679%', '39.957%', '40.128%', '40.813%', '40.770%', '41.369%', '42.417%', '42.267%', '42.995%', '43.358%', '43.380%', '43.508%', '44.727%', '44.642%', '45.455%']
Workers federated accuracies:  ['39.679%', '39.957%', '40.128%', '40.813%', '40.770%', '41.369%', '42.417%', '42.267%', '42.995%', '43.358%', '43.380%', '43.508%', '44.727%', '44.642%', '45.455%']
Workers improved  accuracies:  ['0.171%', '0.321%', '0.513%', '0.834%', '0.856%', '0.920%', '1.626%', '1.583%', '1.989%', '2.225%', '2.139%', '2.396%', '2.909%', '2.952%', '3.209%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 2:
Federated model validation accuracy : 69.0000%
Leave-one-out validation accuracies :  ['69.0000%', '69.0000%', '69.0000%', '69.2000%', '69.4000%', '69.8000%', '69.6000%', '69.8000%', '70.4000%', '70.2000%', '70.2000%', '70.4000%', '71.0000%', '71.2000%', '72.0000%']
Computed and normalized credits:  tensor([0.0694, 0.0694, 0.0693, 0.0690, 0.0684, 0.0674, 0.0674, 0.0668, 0.0657,
        0.0658, 0.0656, 0.0652, 0.0642, 0.0639, 0.0625])
Federated model performance: Loss: 0.645306. Accuracy: 66.9305%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['39.872%', '40.642%', '40.684%', '41.733%', '41.476%', '42.995%', '44.128%', '44.000%', '45.048%', '45.348%', '45.775%', '45.882%', '47.358%', '47.123%', '48.749%']
Workers federated accuracies:  ['39.872%', '40.642%', '40.684%', '41.733%', '41.476%', '42.995%', '44.128%', '44.000%', '45.048%', '45.348%', '45.775%', '45.882%', '47.358%', '47.123%', '48.749%']
Workers improved  accuracies:  ['0.364%', '1.005%', '1.070%', '1.754%', '1.561%', '2.545%', '3.337%', '3.316%', '4.043%', '4.214%', '4.535%', '4.770%', '5.540%', '5.433%', '6.503%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 3:
Federated model validation accuracy : 70.2000%
Leave-one-out validation accuracies :  ['70.2000%', '70.2000%', '70.4000%', '70.4000%', '70.4000%', '70.8000%', '71.0000%', '70.8000%', '70.8000%', '71.2000%', '71.4000%', '71.8000%', '72.4000%', '72.2000%', '72.6000%']
Computed and normalized credits:  tensor([0.0684, 0.0684, 0.0681, 0.0681, 0.0680, 0.0672, 0.0669, 0.0672, 0.0670,
        0.0664, 0.0661, 0.0654, 0.0643, 0.0646, 0.0638])
Federated model performance: Loss: 0.593338. Accuracy: 70.4385%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['40.086%', '40.984%', '41.048%', '42.481%', '42.481%', '44.257%', '45.861%', '45.412%', '46.802%', '47.358%', '47.850%', '48.086%', '49.519%', '49.668%', '51.743%']
Workers federated accuracies:  ['40.086%', '40.984%', '41.048%', '42.481%', '42.481%', '44.257%', '45.861%', '45.412%', '46.802%', '47.358%', '47.850%', '48.086%', '49.519%', '49.668%', '51.743%']
Workers improved  accuracies:  ['0.578%', '1.348%', '1.433%', '2.503%', '2.567%', '3.807%', '5.070%', '4.727%', '5.797%', '6.225%', '6.610%', '6.973%', '7.701%', '7.979%', '9.497%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 4:
Federated model validation accuracy : 71.6000%
Leave-one-out validation accuracies :  ['71.4000%', '71.6000%', '71.6000%', '72.0000%', '71.8000%', '72.0000%', '72.2000%', '72.2000%', '71.8000%', '72.2000%', '72.6000%', '73.0000%', '73.0000%', '73.0000%', '73.2000%']
Computed and normalized credits:  tensor([0.0682, 0.0679, 0.0678, 0.0672, 0.0675, 0.0671, 0.0668, 0.0668, 0.0674,
        0.0667, 0.0660, 0.0653, 0.0652, 0.0652, 0.0648])
Federated model performance: Loss: 0.558143. Accuracy: 72.2567%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['40.385%', '41.455%', '41.797%', '43.444%', '43.508%', '45.711%', '47.615%', '46.952%', '48.749%', '49.241%', '50.353%', '50.759%', '51.872%', '52.385%', '54.524%']
Workers federated accuracies:  ['40.385%', '41.455%', '41.797%', '43.444%', '43.508%', '45.711%', '47.615%', '46.952%', '48.749%', '49.241%', '50.353%', '50.759%', '51.872%', '52.385%', '54.524%']
Workers improved  accuracies:  ['0.877%', '1.818%', '2.182%', '3.465%', '3.594%', '5.262%', '6.824%', '6.267%', '7.743%', '8.107%', '9.112%', '9.647%', '10.053%', '10.695%', '12.278%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 5:
Federated model validation accuracy : 72.4000%
Leave-one-out validation accuracies :  ['72.4000%', '72.6000%', '72.6000%', '73.0000%', '73.0000%', '73.0000%', '73.2000%', '73.2000%', '73.2000%', '73.4000%', '73.8000%', '74.0000%', '73.8000%', '74.0000%', '74.0000%']
Computed and normalized credits:  tensor([0.0682, 0.0679, 0.0679, 0.0672, 0.0672, 0.0671, 0.0668, 0.0668, 0.0669,
        0.0665, 0.0658, 0.0654, 0.0657, 0.0654, 0.0653])
Federated model performance: Loss: 0.536247. Accuracy: 73.1765%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['40.492%', '42.032%', '42.417%', '44.385%', '44.278%', '47.209%', '48.984%', '48.257%', '50.588%', '50.952%', '52.727%', '53.198%', '54.417%', '54.738%', '56.963%']
Workers federated accuracies:  ['40.492%', '42.032%', '42.417%', '44.385%', '44.278%', '47.209%', '48.984%', '48.257%', '50.588%', '50.952%', '52.727%', '53.198%', '54.417%', '54.738%', '56.963%']
Workers improved  accuracies:  ['0.984%', '2.396%', '2.802%', '4.406%', '4.364%', '6.759%', '8.193%', '7.572%', '9.583%', '9.818%', '11.487%', '12.086%', '12.599%', '13.048%', '14.717%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 6:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.4000%', '73.6000%', '73.4000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '74.0000%', '73.8000%', '74.2000%', '74.0000%', '74.0000%', '74.6000%', '74.6000%', '74.6000%']
Computed and normalized credits:  tensor([0.0677, 0.0674, 0.0677, 0.0670, 0.0670, 0.0670, 0.0669, 0.0666, 0.0669,
        0.0663, 0.0665, 0.0665, 0.0656, 0.0656, 0.0655])
Federated model performance: Loss: 0.524280. Accuracy: 74.1818%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['40.599%', '42.717%', '42.995%', '45.198%', '45.155%', '48.278%', '50.824%', '49.583%', '52.342%', '53.262%', '54.631%', '55.401%', '56.449%', '56.920%', '59.636%']
Workers federated accuracies:  ['40.599%', '42.717%', '42.995%', '45.198%', '45.155%', '48.278%', '50.824%', '49.583%', '52.342%', '53.262%', '54.631%', '55.401%', '56.449%', '56.920%', '59.636%']
Workers improved  accuracies:  ['1.091%', '3.080%', '3.380%', '5.219%', '5.241%', '7.829%', '10.032%', '8.898%', '11.337%', '12.128%', '13.390%', '14.289%', '14.631%', '15.230%', '17.390%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 7:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.8000%', '73.8000%', '74.2000%', '74.0000%', '74.0000%', '74.0000%', '74.2000%', '74.6000%', '74.6000%', '74.6000%', '74.8000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%']
Computed and normalized credits:  tensor([0.0678, 0.0677, 0.0671, 0.0674, 0.0674, 0.0674, 0.0671, 0.0664, 0.0665,
        0.0664, 0.0661, 0.0658, 0.0657, 0.0657, 0.0657])
Federated model performance: Loss: 0.520240. Accuracy: 74.4599%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['40.963%', '43.273%', '43.594%', '46.160%', '45.904%', '49.283%', '52.150%', '51.123%', '54.182%', '54.717%', '56.834%', '57.134%', '58.310%', '58.759%', '61.604%']
Workers federated accuracies:  ['40.963%', '43.273%', '43.594%', '46.160%', '45.904%', '49.283%', '52.150%', '51.123%', '54.182%', '54.717%', '56.834%', '57.134%', '58.310%', '58.759%', '61.604%']
Workers improved  accuracies:  ['1.455%', '3.636%', '3.979%', '6.182%', '5.989%', '8.834%', '11.358%', '10.439%', '13.176%', '13.583%', '15.594%', '16.021%', '16.492%', '17.070%', '19.358%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 8:
Federated model validation accuracy : 74.6000%
Leave-one-out validation accuracies :  ['74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.2000%', '75.2000%', '75.4000%', '75.6000%', '75.6000%']
Computed and normalized credits:  tensor([0.0674, 0.0674, 0.0673, 0.0673, 0.0673, 0.0667, 0.0667, 0.0666, 0.0666,
        0.0666, 0.0663, 0.0663, 0.0660, 0.0657, 0.0657])
Federated model performance: Loss: 0.521469. Accuracy: 74.8877%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['41.112%', '43.829%', '44.214%', '46.973%', '46.845%', '50.588%', '53.882%', '52.278%', '55.829%', '56.086%', '58.374%', '58.631%', '60.193%', '60.385%', '62.845%']
Workers federated accuracies:  ['41.112%', '43.829%', '44.214%', '46.973%', '46.845%', '50.588%', '53.882%', '52.278%', '55.829%', '56.086%', '58.374%', '58.631%', '60.193%', '60.385%', '62.845%']
Workers improved  accuracies:  ['1.604%', '4.193%', '4.599%', '6.995%', '6.930%', '10.139%', '13.091%', '11.594%', '14.824%', '14.952%', '17.134%', '17.519%', '18.374%', '18.695%', '20.599%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 9:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '76.0000%']
Computed and normalized credits:  tensor([0.0674, 0.0674, 0.0671, 0.0671, 0.0671, 0.0670, 0.0664, 0.0664, 0.0664,
        0.0664, 0.0664, 0.0664, 0.0663, 0.0663, 0.0657])
Federated model performance: Loss: 0.527674. Accuracy: 75.2941%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['41.390%', '44.342%', '44.791%', '47.679%', '47.444%', '52.086%', '55.487%', '53.626%', '57.305%', '57.476%', '60.150%', '60.321%', '61.390%', '62.160%', '64.150%']
Workers federated accuracies:  ['41.390%', '44.342%', '44.791%', '47.679%', '47.444%', '52.086%', '55.487%', '53.626%', '57.305%', '57.476%', '60.150%', '60.321%', '61.390%', '62.160%', '64.150%']
Workers improved  accuracies:  ['1.882%', '4.706%', '5.176%', '7.701%', '7.529%', '11.636%', '14.695%', '12.941%', '16.299%', '16.342%', '18.909%', '19.209%', '19.572%', '20.471%', '21.904%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 10:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.8000%', '75.8000%', '76.2000%', '76.2000%', '76.4000%', '76.4000%', '76.4000%', '76.4000%', '76.4000%']
Computed and normalized credits:  tensor([0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0669, 0.0669, 0.0663,
        0.0663, 0.0660, 0.0660, 0.0660, 0.0660, 0.0659])
Federated model performance: Loss: 0.536665. Accuracy: 75.5080%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['41.754%', '44.813%', '45.497%', '48.428%', '48.235%', '53.005%', '56.856%', '54.930%', '58.588%', '58.888%', '61.326%', '62.011%', '62.824%', '63.337%', '65.283%']
Workers federated accuracies:  ['41.754%', '44.813%', '45.497%', '48.428%', '48.235%', '53.005%', '56.856%', '54.930%', '58.588%', '58.888%', '61.326%', '62.011%', '62.824%', '63.337%', '65.283%']
Workers improved  accuracies:  ['2.246%', '5.176%', '5.882%', '8.449%', '8.321%', '12.556%', '16.064%', '14.246%', '17.583%', '17.754%', '20.086%', '20.898%', '21.005%', '21.647%', '23.037%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.536665. Accuracy: 75.5080%.
Workers before    accuracies:  ['39.508%', '39.636%', '39.615%', '39.979%', '39.914%', '40.449%', '40.791%', '40.684%', '41.005%', '41.134%', '41.241%', '41.112%', '41.818%', '41.690%', '42.246%']
Workers standlone accuracies:  ['41.754%', '44.813%', '45.497%', '48.428%', '48.235%', '53.005%', '56.856%', '54.930%', '58.588%', '58.888%', '61.326%', '62.011%', '62.824%', '63.337%', '65.283%']
Workers federated accuracies:  ['41.754%', '44.813%', '45.497%', '48.428%', '48.235%', '53.005%', '56.856%', '54.930%', '58.588%', '58.888%', '61.326%', '62.011%', '62.824%', '63.337%', '65.283%']
Workers improved  accuracies:  ['2.246%', '5.176%', '5.882%', '8.449%', '8.321%', '12.556%', '16.064%', '14.246%', '17.583%', '17.754%', '20.086%', '20.898%', '21.005%', '21.647%', '23.037%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]
Workers sharing_contributions :  tensor([ 3.2000,  5.3333,  7.4667, 10.6667, 12.8000, 16.0000, 18.1333, 20.2667,
        23.4667, 25.6000, 27.7333, 30.9333, 33.0667, 35.2000, 37.3333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.09923938814331756, 0.7249292509431317)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9832113677425707, 5.476254253899655e-11)
Correlation between test_acc improvements & sharing_contributions:  (0.9802951175792035, 1.5401870846912962e-10)
Experiment : No.2/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.819245. Accuracy: 39.9144%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 56.0000%
Leave-one-out validation accuracies :  ['56.0000%', '56.4000%', '56.8000%', '57.6000%', '58.4000%', '59.2000%', '61.0000%', '63.4000%', '66.6000%', '68.6000%', '69.4000%', '71.8000%', '73.6000%', '74.4000%', '74.6000%']
Computed and normalized credits:  tensor([0.0845, 0.0835, 0.0826, 0.0806, 0.0787, 0.0768, 0.0727, 0.0675, 0.0612,
        0.0575, 0.0562, 0.0522, 0.0495, 0.0484, 0.0481])
Federated model performance: Loss: 0.724995. Accuracy: 55.8075%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['39.059%', '39.273%', '39.701%', '40.064%', '40.150%', '40.556%', '41.390%', '41.326%', '41.305%', '41.583%', '41.390%', '42.267%', '42.203%', '42.652%', '43.957%']
Workers federated accuracies:  ['39.059%', '39.273%', '39.701%', '40.064%', '40.150%', '40.556%', '41.390%', '41.326%', '41.305%', '41.583%', '41.390%', '42.267%', '42.203%', '42.652%', '43.957%']
Workers improved  accuracies:  ['0.193%', '0.235%', '0.620%', '0.727%', '0.791%', '1.027%', '1.219%', '1.348%', '1.112%', '1.198%', '1.176%', '1.797%', '1.647%', '1.882%', '2.759%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 2:
Federated model validation accuracy : 68.8000%
Leave-one-out validation accuracies :  ['69.0000%', '69.0000%', '70.4000%', '70.8000%', '71.4000%', '72.4000%', '73.4000%', '74.2000%', '74.6000%', '74.4000%', '75.0000%', '74.8000%', '74.8000%', '75.2000%', '75.6000%']
Computed and normalized credits:  tensor([0.0758, 0.0756, 0.0731, 0.0721, 0.0708, 0.0689, 0.0667, 0.0647, 0.0633,
        0.0631, 0.0620, 0.0618, 0.0614, 0.0607, 0.0600])
Federated model performance: Loss: 0.654010. Accuracy: 67.2941%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['39.422%', '39.572%', '40.214%', '40.684%', '40.963%', '41.519%', '42.952%', '42.888%', '42.674%', '43.337%', '43.166%', '44.578%', '44.321%', '45.283%', '46.888%']
Workers federated accuracies:  ['39.422%', '39.572%', '40.214%', '40.684%', '40.963%', '41.519%', '42.952%', '42.888%', '42.674%', '43.337%', '43.166%', '44.578%', '44.321%', '45.283%', '46.888%']
Workers improved  accuracies:  ['0.556%', '0.535%', '1.134%', '1.348%', '1.604%', '1.989%', '2.781%', '2.909%', '2.481%', '2.952%', '2.952%', '4.107%', '3.765%', '4.513%', '5.690%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 3:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.2000%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '75.0000%', '75.0000%', '75.0000%', '75.2000%', '75.0000%', '74.8000%', '75.4000%', '76.0000%', '76.0000%', '76.4000%']
Computed and normalized credits:  tensor([0.0692, 0.0683, 0.0680, 0.0678, 0.0677, 0.0672, 0.0669, 0.0667, 0.0662,
        0.0665, 0.0666, 0.0657, 0.0648, 0.0647, 0.0640])
Federated model performance: Loss: 0.603242. Accuracy: 71.7219%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['39.679%', '40.021%', '40.492%', '41.305%', '41.711%', '42.524%', '44.813%', '44.385%', '44.385%', '45.027%', '45.070%', '46.930%', '47.037%', '47.508%', '50.203%']
Workers federated accuracies:  ['39.679%', '40.021%', '40.492%', '41.305%', '41.711%', '42.524%', '44.813%', '44.385%', '44.385%', '45.027%', '45.070%', '46.930%', '47.037%', '47.508%', '50.203%']
Workers improved  accuracies:  ['0.813%', '0.984%', '1.412%', '1.968%', '2.353%', '2.995%', '4.642%', '4.406%', '4.193%', '4.642%', '4.856%', '6.460%', '6.481%', '6.738%', '9.005%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 4:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.2000%', '75.2000%', '75.2000%', '75.4000%', '75.8000%', '76.2000%', '76.4000%', '76.4000%', '76.8000%', '76.8000%', '76.8000%', '76.6000%', '76.6000%']
Computed and normalized credits:  tensor([0.0676, 0.0675, 0.0681, 0.0680, 0.0680, 0.0677, 0.0670, 0.0664, 0.0661,
        0.0661, 0.0656, 0.0654, 0.0653, 0.0656, 0.0655])
Federated model performance: Loss: 0.568046. Accuracy: 72.9412%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['39.979%', '40.385%', '40.877%', '41.797%', '42.374%', '43.636%', '46.310%', '46.139%', '46.310%', '46.909%', '46.524%', '49.305%', '48.813%', '50.310%', '52.791%']
Workers federated accuracies:  ['39.979%', '40.385%', '40.877%', '41.797%', '42.374%', '43.636%', '46.310%', '46.139%', '46.310%', '46.909%', '46.524%', '49.305%', '48.813%', '50.310%', '52.791%']
Workers improved  accuracies:  ['1.112%', '1.348%', '1.797%', '2.460%', '3.016%', '4.107%', '6.139%', '6.160%', '6.118%', '6.524%', '6.310%', '8.834%', '8.257%', '9.540%', '11.594%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 5:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.4000%', '76.8000%', '76.8000%', '76.8000%', '77.0000%', '76.6000%', '76.8000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.4000%', '76.6000%', '76.4000%']
Computed and normalized credits:  tensor([0.0674, 0.0671, 0.0666, 0.0666, 0.0666, 0.0662, 0.0667, 0.0664, 0.0666,
        0.0666, 0.0666, 0.0665, 0.0668, 0.0666, 0.0668])
Federated model performance: Loss: 0.546009. Accuracy: 73.9251%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['40.128%', '40.578%', '41.241%', '42.695%', '43.209%', '44.877%', '47.636%', '47.487%', '47.679%', '48.749%', '47.979%', '51.551%', '51.615%', '52.299%', '55.037%']
Workers federated accuracies:  ['40.128%', '40.578%', '41.241%', '42.695%', '43.209%', '44.877%', '47.636%', '47.487%', '47.679%', '48.749%', '47.979%', '51.551%', '51.615%', '52.299%', '55.037%']
Workers improved  accuracies:  ['1.262%', '1.540%', '2.160%', '3.358%', '3.850%', '5.348%', '7.465%', '7.508%', '7.487%', '8.364%', '7.765%', '11.080%', '11.059%', '11.529%', '13.840%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 6:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.8000%', '76.6000%', '76.6000%', '76.4000%', '76.6000%', '76.6000%', '76.6000%', '77.0000%', '77.2000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0667, 0.0667, 0.0667, 0.0667, 0.0665, 0.0667, 0.0668,
        0.0670, 0.0667, 0.0667, 0.0668, 0.0662, 0.0659])
Federated model performance: Loss: 0.533903. Accuracy: 74.5455%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['40.321%', '40.791%', '41.733%', '43.380%', '44.000%', '45.775%', '49.283%', '49.027%', '49.112%', '50.353%', '49.861%', '53.561%', '53.861%', '54.353%', '57.241%']
Workers federated accuracies:  ['40.321%', '40.791%', '41.733%', '43.380%', '44.000%', '45.775%', '49.283%', '49.027%', '49.112%', '50.353%', '49.861%', '53.561%', '53.861%', '54.353%', '57.241%']
Workers improved  accuracies:  ['1.455%', '1.754%', '2.652%', '4.043%', '4.642%', '6.246%', '9.112%', '9.048%', '8.920%', '9.968%', '9.647%', '13.091%', '13.305%', '13.583%', '16.043%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 7:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.8000%', '77.0000%', '77.0000%', '77.4000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.4000%']
Computed and normalized credits:  tensor([0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0673, 0.0670, 0.0667, 0.0667,
        0.0662, 0.0659, 0.0659, 0.0659, 0.0658, 0.0661])
Federated model performance: Loss: 0.529050. Accuracy: 74.9305%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['40.535%', '41.048%', '42.075%', '44.342%', '45.091%', '46.909%', '51.037%', '50.545%', '50.888%', '51.893%', '51.786%', '55.209%', '55.316%', '55.957%', '59.316%']
Workers federated accuracies:  ['40.535%', '41.048%', '42.075%', '44.342%', '45.091%', '46.909%', '51.037%', '50.545%', '50.888%', '51.893%', '51.786%', '55.209%', '55.316%', '55.957%', '59.316%']
Workers improved  accuracies:  ['1.668%', '2.011%', '2.995%', '5.005%', '5.733%', '7.380%', '10.866%', '10.567%', '10.695%', '11.508%', '11.572%', '14.738%', '14.759%', '15.187%', '18.118%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 8:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['77.2000%', '77.2000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.4000%', '77.6000%', '77.6000%']
Computed and normalized credits:  tensor([0.0672, 0.0672, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666,
        0.0665, 0.0665, 0.0665, 0.0668, 0.0665, 0.0665])
Federated model performance: Loss: 0.529737. Accuracy: 75.0160%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['40.834%', '41.262%', '42.631%', '45.219%', '45.818%', '48.385%', '52.706%', '52.385%', '52.535%', '53.348%', '53.326%', '56.898%', '57.005%', '57.840%', '61.112%']
Workers federated accuracies:  ['40.834%', '41.262%', '42.631%', '45.219%', '45.818%', '48.385%', '52.706%', '52.385%', '52.535%', '53.348%', '53.326%', '56.898%', '57.005%', '57.840%', '61.112%']
Workers improved  accuracies:  ['1.968%', '2.225%', '3.551%', '5.882%', '6.460%', '8.856%', '12.535%', '12.406%', '12.342%', '12.963%', '13.112%', '16.428%', '16.449%', '17.070%', '19.914%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 9:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.6000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.8000%', '77.8000%', '77.8000%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0666, 0.0666, 0.0666, 0.0668, 0.0668, 0.0668, 0.0668,
        0.0668, 0.0668, 0.0668, 0.0663, 0.0662, 0.0662])
Federated model performance: Loss: 0.535077. Accuracy: 75.1872%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['41.005%', '41.497%', '43.102%', '46.139%', '46.567%', '49.604%', '54.139%', '53.818%', '53.733%', '54.717%', '54.631%', '58.610%', '58.610%', '59.337%', '62.781%']
Workers federated accuracies:  ['41.005%', '41.497%', '43.102%', '46.139%', '46.567%', '49.604%', '54.139%', '53.818%', '53.733%', '54.717%', '54.631%', '58.610%', '58.610%', '59.337%', '62.781%']
Workers improved  accuracies:  ['2.139%', '2.460%', '4.021%', '6.802%', '7.209%', '10.075%', '13.968%', '13.840%', '13.540%', '14.332%', '14.417%', '18.139%', '18.053%', '18.567%', '21.583%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Epoch 10:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.2000%', '77.2000%', '77.4000%', '77.6000%', '77.6000%', '77.8000%', '77.6000%', '77.8000%', '77.6000%', '77.6000%', '77.8000%', '77.8000%', '77.8000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0672, 0.0672, 0.0669, 0.0667, 0.0667, 0.0664, 0.0667,
        0.0664, 0.0667, 0.0667, 0.0663, 0.0663, 0.0663])
Federated model performance: Loss: 0.543870. Accuracy: 75.3155%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['41.155%', '41.733%', '43.615%', '46.759%', '47.722%', '50.524%', '55.487%', '55.059%', '55.251%', '56.107%', '55.765%', '59.807%', '60.086%', '60.813%', '64.535%']
Workers federated accuracies:  ['41.155%', '41.733%', '43.615%', '46.759%', '47.722%', '50.524%', '55.487%', '55.059%', '55.251%', '56.107%', '55.765%', '59.807%', '60.086%', '60.813%', '64.535%']
Workers improved  accuracies:  ['2.289%', '2.695%', '4.535%', '7.422%', '8.364%', '10.995%', '15.316%', '15.080%', '15.059%', '15.722%', '15.551%', '19.337%', '19.529%', '20.043%', '23.337%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.543870. Accuracy: 75.3155%.
Workers before    accuracies:  ['38.866%', '39.037%', '39.080%', '39.337%', '39.358%', '39.529%', '40.171%', '39.979%', '40.193%', '40.385%', '40.214%', '40.471%', '40.556%', '40.770%', '41.198%']
Workers standlone accuracies:  ['41.155%', '41.733%', '43.615%', '46.759%', '47.722%', '50.524%', '55.487%', '55.059%', '55.251%', '56.107%', '55.765%', '59.807%', '60.086%', '60.813%', '64.535%']
Workers federated accuracies:  ['41.155%', '41.733%', '43.615%', '46.759%', '47.722%', '50.524%', '55.487%', '55.059%', '55.251%', '56.107%', '55.765%', '59.807%', '60.086%', '60.813%', '64.535%']
Workers improved  accuracies:  ['2.289%', '2.695%', '4.535%', '7.422%', '8.364%', '10.995%', '15.316%', '15.080%', '15.059%', '15.722%', '15.551%', '19.337%', '19.529%', '20.043%', '23.337%']
Workers shard sizes:  [48, 80, 112, 160, 192, 240, 272, 304, 352, 384, 416, 464, 496, 528, 560]
Workers sharing_contributions :  tensor([ 3.2000,  5.3333,  7.4667, 10.6667, 12.8000, 16.0000, 18.1333, 20.2667,
        23.4667, 25.6000, 27.7333, 30.9333, 33.0667, 35.2000, 37.3333])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.04889370266724591, 0.862621239249728)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999999, 3.876914407497237e-103)
Correlation between test_acc & sharing contributions:  (0.977839046435925, 3.2855252818245074e-10)
Correlation between test_acc improvements & sharing_contributions:  (0.9765907767762645, 4.677260873564578e-10)
standalone_vs_final_corr [[1.0], [0.9999999999999999]]
standalone_vs_final_corr_mean [1.0]
standalone_vs_final_corr_std [7.850462293418876e-17]
sharingcontribution_vs_final_corr [[0.9832113677425707], [0.977839046435925]]
sharingcontribution_vs_final_corr_mean [0.9805252070892478]
sharingcontribution_vs_final_corr_std [0.0026861606533228333]
standalone_vs_federated_perturbed_corr [[-0.09923938814331756], [-0.04889370266724591]]
standalone_vs_federated_perturbed_corr_mean [-0.07406654540528174]
standalone_vs_federated_perturbed_corr_std [0.025172842738035828]
federated_final_performance [0.7550802230834961, 0.7531550526618958]
federated_final_performance_mean 0.7541176378726959
federated_final_performance_std 0.0009625852108001709
CFFL_best_worker [0.6528342366218567, 0.6453475952148438]
CFFL_best_worker_mean 0.6490909159183502
CFFL_best_worker_std 0.0037433207035064697
standalone_best_worker [0.6528342366218567, 0.6453475952148438]
standalone_best_worker_mean 0.6490909159183502
standalone_best_worker_std 0.0037433207035064697
