Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 5000, 'n_workers': 20, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.776579. Accuracy: 56.9412%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 61.6000%
Leave-one-out validation accuracies :  ['61.6000%', '61.8000%', '62.0000%', '62.6000%', '62.6000%', '63.4000%', '63.6000%', '65.0000%', '64.8000%', '66.4000%', '66.6000%', '67.4000%', '68.2000%', '69.4000%', '70.0000%', '70.4000%', '70.8000%', '70.4000%', '70.8000%', '71.4000%']
Computed and normalized credits:  tensor([0.0571, 0.0568, 0.0565, 0.0556, 0.0556, 0.0543, 0.0540, 0.0519, 0.0522,
        0.0499, 0.0496, 0.0485, 0.0474, 0.0457, 0.0449, 0.0444, 0.0439, 0.0444,
        0.0439, 0.0431])
Federated model performance: Loss: 0.715855. Accuracy: 62.2032%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['56.535%', '56.578%', '56.727%', '56.706%', '56.834%', '57.155%', '57.134%', '56.941%', '57.390%', '57.155%', '57.283%', '57.455%', '57.412%', '57.583%', '57.668%', '57.668%', '57.840%', '57.882%', '58.011%', '57.647%']
Workers federated accuracies:  ['56.535%', '56.578%', '56.727%', '56.706%', '56.834%', '57.155%', '57.134%', '56.941%', '57.390%', '57.155%', '57.283%', '57.455%', '57.412%', '57.583%', '57.668%', '57.668%', '57.840%', '57.882%', '58.011%', '57.647%']
Workers improved  accuracies:  ['0.043%', '0.064%', '0.171%', '0.214%', '0.171%', '0.364%', '0.321%', '0.235%', '0.406%', '0.321%', '0.471%', '0.449%', '0.492%', '0.535%', '0.663%', '0.706%', '0.727%', '0.663%', '0.791%', '0.578%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 2:
Federated model validation accuracy : 69.4000%
Leave-one-out validation accuracies :  ['69.6000%', '69.8000%', '69.8000%', '69.8000%', '70.0000%', '70.4000%', '71.0000%', '71.0000%', '71.2000%', '71.0000%', '71.0000%', '70.8000%', '71.0000%', '71.6000%', '72.4000%', '72.8000%', '73.2000%', '73.2000%', '73.6000%', '73.8000%']
Computed and normalized credits:  tensor([0.0529, 0.0526, 0.0526, 0.0525, 0.0522, 0.0516, 0.0508, 0.0506, 0.0504,
        0.0504, 0.0504, 0.0505, 0.0502, 0.0493, 0.0482, 0.0477, 0.0471, 0.0472,
        0.0466, 0.0463])
Federated model performance: Loss: 0.668492. Accuracy: 67.9572%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['56.663%', '56.663%', '56.877%', '56.813%', '57.027%', '57.305%', '57.305%', '57.305%', '57.797%', '57.604%', '57.626%', '57.925%', '57.925%', '58.032%', '58.032%', '58.032%', '58.182%', '58.267%', '58.503%', '58.182%']
Workers federated accuracies:  ['56.663%', '56.663%', '56.877%', '56.813%', '57.027%', '57.305%', '57.305%', '57.305%', '57.797%', '57.604%', '57.626%', '57.925%', '57.925%', '58.032%', '58.032%', '58.032%', '58.182%', '58.267%', '58.503%', '58.182%']
Workers improved  accuracies:  ['0.171%', '0.150%', '0.321%', '0.321%', '0.364%', '0.513%', '0.492%', '0.599%', '0.813%', '0.770%', '0.813%', '0.920%', '1.005%', '0.984%', '1.027%', '1.070%', '1.070%', '1.048%', '1.283%', '1.112%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 3:
Federated model validation accuracy : 71.4000%
Leave-one-out validation accuracies :  ['71.4000%', '71.4000%', '71.6000%', '72.0000%', '72.4000%', '72.6000%', '72.6000%', '72.8000%', '73.2000%', '73.2000%', '73.4000%', '73.8000%', '74.0000%', '73.8000%', '74.2000%', '74.0000%', '74.0000%', '74.0000%', '73.8000%', '74.0000%']
Computed and normalized credits:  tensor([0.0524, 0.0523, 0.0521, 0.0516, 0.0511, 0.0508, 0.0507, 0.0504, 0.0499,
        0.0499, 0.0497, 0.0492, 0.0489, 0.0491, 0.0485, 0.0487, 0.0486, 0.0487,
        0.0488, 0.0486])
Federated model performance: Loss: 0.633261. Accuracy: 72.2139%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['56.706%', '56.770%', '56.920%', '56.941%', '57.112%', '57.561%', '57.668%', '57.711%', '58.182%', '57.840%', '58.011%', '58.160%', '58.182%', '58.545%', '58.310%', '58.439%', '58.717%', '59.059%', '59.080%', '58.631%']
Workers federated accuracies:  ['56.706%', '56.770%', '56.920%', '56.941%', '57.112%', '57.561%', '57.668%', '57.711%', '58.182%', '57.840%', '58.011%', '58.160%', '58.182%', '58.545%', '58.310%', '58.439%', '58.717%', '59.059%', '59.080%', '58.631%']
Workers improved  accuracies:  ['0.214%', '0.257%', '0.364%', '0.449%', '0.449%', '0.770%', '0.856%', '1.005%', '1.198%', '1.005%', '1.198%', '1.155%', '1.262%', '1.497%', '1.305%', '1.476%', '1.604%', '1.840%', '1.861%', '1.561%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 4:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.6000%', '73.8000%', '74.0000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.0000%', '74.0000%', '74.2000%', '74.0000%', '74.4000%', '74.2000%', '74.4000%', '74.2000%', '74.4000%', '74.2000%', '74.6000%', '74.6000%']
Computed and normalized credits:  tensor([0.0509, 0.0509, 0.0506, 0.0503, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502,
        0.0502, 0.0499, 0.0501, 0.0496, 0.0499, 0.0496, 0.0498, 0.0496, 0.0498,
        0.0494, 0.0493])
Federated model performance: Loss: 0.608254. Accuracy: 73.9465%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['56.727%', '56.963%', '57.070%', '57.005%', '57.219%', '57.947%', '57.904%', '57.904%', '58.439%', '58.203%', '58.267%', '58.588%', '58.524%', '59.187%', '58.909%', '58.845%', '59.273%', '59.487%', '59.701%', '58.845%']
Workers federated accuracies:  ['56.727%', '56.963%', '57.070%', '57.005%', '57.219%', '57.947%', '57.904%', '57.904%', '58.439%', '58.203%', '58.267%', '58.588%', '58.524%', '59.187%', '58.909%', '58.845%', '59.273%', '59.487%', '59.701%', '58.845%']
Workers improved  accuracies:  ['0.235%', '0.449%', '0.513%', '0.513%', '0.556%', '1.155%', '1.091%', '1.198%', '1.455%', '1.369%', '1.455%', '1.583%', '1.604%', '2.139%', '1.904%', '1.882%', '2.160%', '2.267%', '2.481%', '1.775%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 5:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2000%', '74.2000%', '74.4000%', '74.6000%', '74.4000%', '74.4000%', '74.2000%', '74.2000%', '74.2000%', '74.4000%', '74.4000%', '74.4000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.4000%', '74.6000%', '74.8000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0501, 0.0498, 0.0500, 0.0500, 0.0503, 0.0503,
        0.0503, 0.0500, 0.0500, 0.0500, 0.0498, 0.0498, 0.0498, 0.0498, 0.0500,
        0.0497, 0.0495])
Federated model performance: Loss: 0.592808. Accuracy: 75.2513%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['56.813%', '56.984%', '57.219%', '57.091%', '57.455%', '58.096%', '58.267%', '58.118%', '58.738%', '58.417%', '58.610%', '59.166%', '58.973%', '59.594%', '59.529%', '59.401%', '59.936%', '60.257%', '60.492%', '59.551%']
Workers federated accuracies:  ['56.813%', '56.984%', '57.219%', '57.091%', '57.455%', '58.096%', '58.267%', '58.118%', '58.738%', '58.417%', '58.610%', '59.166%', '58.973%', '59.594%', '59.529%', '59.401%', '59.936%', '60.257%', '60.492%', '59.551%']
Workers improved  accuracies:  ['0.321%', '0.471%', '0.663%', '0.599%', '0.791%', '1.305%', '1.455%', '1.412%', '1.754%', '1.583%', '1.797%', '2.160%', '2.053%', '2.545%', '2.524%', '2.439%', '2.824%', '3.037%', '3.273%', '2.481%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 6:
Federated model validation accuracy : 74.6000%
Leave-one-out validation accuracies :  ['74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.8000%', '74.8000%', '75.0000%', '75.0000%', '75.0000%', '75.6000%', '75.8000%', '75.8000%', '76.0000%', '76.2000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0505, 0.0505, 0.0504, 0.0505, 0.0505, 0.0505, 0.0505,
        0.0505, 0.0502, 0.0502, 0.0500, 0.0500, 0.0500, 0.0493, 0.0491, 0.0491,
        0.0488, 0.0486])
Federated model performance: Loss: 0.584390. Accuracy: 75.7647%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['56.834%', '57.027%', '57.305%', '57.134%', '57.668%', '58.246%', '58.332%', '58.310%', '59.123%', '58.588%', '58.909%', '59.551%', '59.401%', '60.128%', '59.743%', '59.807%', '60.257%', '60.727%', '61.048%', '59.957%']
Workers federated accuracies:  ['56.834%', '57.027%', '57.305%', '57.134%', '57.668%', '58.246%', '58.332%', '58.310%', '59.123%', '58.588%', '58.909%', '59.551%', '59.401%', '60.128%', '59.743%', '59.807%', '60.257%', '60.727%', '61.048%', '59.957%']
Workers improved  accuracies:  ['0.342%', '0.513%', '0.749%', '0.642%', '1.005%', '1.455%', '1.519%', '1.604%', '2.139%', '1.754%', '2.096%', '2.545%', '2.481%', '3.080%', '2.738%', '2.845%', '3.144%', '3.508%', '3.829%', '2.888%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 7:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.2000%', '75.4000%', '75.6000%', '75.8000%', '76.0000%', '76.2000%', '76.2000%', '76.0000%', '76.0000%', '75.8000%', '75.8000%', '75.8000%', '76.2000%', '76.4000%', '76.4000%']
Computed and normalized credits:  tensor([0.0508, 0.0508, 0.0508, 0.0508, 0.0508, 0.0506, 0.0504, 0.0501, 0.0499,
        0.0497, 0.0494, 0.0494, 0.0496, 0.0496, 0.0499, 0.0498, 0.0498, 0.0493,
        0.0491, 0.0491])
Federated model performance: Loss: 0.582261. Accuracy: 76.1070%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['56.898%', '57.070%', '57.519%', '57.326%', '57.882%', '58.481%', '58.524%', '58.503%', '59.508%', '58.695%', '59.337%', '59.936%', '59.701%', '60.578%', '60.214%', '60.299%', '60.898%', '61.369%', '61.797%', '60.235%']
Workers federated accuracies:  ['56.898%', '57.070%', '57.519%', '57.326%', '57.882%', '58.481%', '58.524%', '58.503%', '59.508%', '58.695%', '59.337%', '59.936%', '59.701%', '60.578%', '60.214%', '60.299%', '60.898%', '61.369%', '61.797%', '60.235%']
Workers improved  accuracies:  ['0.406%', '0.556%', '0.963%', '0.834%', '1.219%', '1.690%', '1.711%', '1.797%', '2.524%', '1.861%', '2.524%', '2.930%', '2.781%', '3.529%', '3.209%', '3.337%', '3.786%', '4.150%', '4.578%', '3.166%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 8:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.2000%', '76.2000%', '76.0000%', '76.0000%', '76.0000%', '75.8000%', '75.8000%', '76.2000%', '76.2000%', '76.4000%', '76.2000%', '76.2000%', '76.2000%', '76.0000%', '76.0000%', '76.2000%', '76.0000%', '75.8000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0502, 0.0501, 0.0503, 0.0503,
        0.0498, 0.0498, 0.0496, 0.0498, 0.0498, 0.0499, 0.0501, 0.0501, 0.0498,
        0.0500, 0.0502])
Federated model performance: Loss: 0.585136. Accuracy: 76.3209%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['57.005%', '57.176%', '57.647%', '57.540%', '58.032%', '58.631%', '58.995%', '58.802%', '59.872%', '59.123%', '59.872%', '60.321%', '60.043%', '61.219%', '60.620%', '60.791%', '61.668%', '62.160%', '62.631%', '61.048%']
Workers federated accuracies:  ['57.005%', '57.176%', '57.647%', '57.540%', '58.032%', '58.631%', '58.995%', '58.802%', '59.872%', '59.123%', '59.872%', '60.321%', '60.043%', '61.219%', '60.620%', '60.791%', '61.668%', '62.160%', '62.631%', '61.048%']
Workers improved  accuracies:  ['0.513%', '0.663%', '1.091%', '1.048%', '1.369%', '1.840%', '2.182%', '2.096%', '2.888%', '2.289%', '3.059%', '3.316%', '3.123%', '4.171%', '3.615%', '3.829%', '4.556%', '4.941%', '5.412%', '3.979%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 9:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.4000%', '76.4000%', '76.4000%', '76.4000%', '76.4000%', '76.4000%', '76.2000%', '76.2000%', '76.2000%', '76.2000%', '75.8000%', '75.8000%', '75.8000%', '76.0000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '76.0000%']
Computed and normalized credits:  tensor([0.0496, 0.0496, 0.0496, 0.0496, 0.0497, 0.0497, 0.0499, 0.0499, 0.0499,
        0.0499, 0.0503, 0.0503, 0.0503, 0.0501, 0.0503, 0.0503, 0.0503, 0.0503,
        0.0503, 0.0501])
Federated model performance: Loss: 0.591439. Accuracy: 76.6417%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['57.048%', '57.305%', '57.668%', '57.604%', '58.032%', '58.845%', '59.380%', '58.930%', '60.193%', '59.401%', '60.043%', '60.877%', '60.385%', '61.668%', '61.070%', '61.262%', '62.353%', '62.802%', '63.508%', '61.711%']
Workers federated accuracies:  ['57.048%', '57.305%', '57.668%', '57.604%', '58.032%', '58.845%', '59.380%', '58.930%', '60.193%', '59.401%', '60.043%', '60.877%', '60.385%', '61.668%', '61.070%', '61.262%', '62.353%', '62.802%', '63.508%', '61.711%']
Workers improved  accuracies:  ['0.556%', '0.791%', '1.112%', '1.112%', '1.369%', '2.053%', '2.567%', '2.225%', '3.209%', '2.567%', '3.230%', '3.872%', '3.465%', '4.620%', '4.064%', '4.299%', '5.241%', '5.583%', '6.289%', '4.642%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 10:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '75.8000%', '75.8000%', '75.8000%', '76.2000%', '76.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.0501, 0.0499, 0.0499, 0.0499, 0.0499, 0.0501, 0.0502, 0.0502, 0.0502,
        0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0502, 0.0502, 0.0497,
        0.0497, 0.0497])
Federated model performance: Loss: 0.600650. Accuracy: 76.8128%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['57.112%', '57.348%', '57.733%', '57.690%', '58.118%', '59.037%', '59.444%', '59.144%', '60.406%', '59.636%', '60.406%', '61.198%', '60.898%', '62.438%', '61.561%', '61.818%', '63.037%', '63.487%', '64.235%', '62.481%']
Workers federated accuracies:  ['57.112%', '57.348%', '57.733%', '57.690%', '58.118%', '59.037%', '59.444%', '59.144%', '60.406%', '59.636%', '60.406%', '61.198%', '60.898%', '62.438%', '61.561%', '61.818%', '63.037%', '63.487%', '64.235%', '62.481%']
Workers improved  accuracies:  ['0.620%', '0.834%', '1.176%', '1.198%', '1.455%', '2.246%', '2.631%', '2.439%', '3.422%', '2.802%', '3.594%', '4.193%', '3.979%', '5.390%', '4.556%', '4.856%', '5.925%', '6.267%', '7.016%', '5.412%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.600650. Accuracy: 76.8128%.
Workers before    accuracies:  ['56.492%', '56.513%', '56.556%', '56.492%', '56.663%', '56.791%', '56.813%', '56.706%', '56.984%', '56.834%', '56.813%', '57.005%', '56.920%', '57.048%', '57.005%', '56.963%', '57.112%', '57.219%', '57.219%', '57.070%']
Workers standlone accuracies:  ['57.112%', '57.348%', '57.733%', '57.690%', '58.118%', '59.037%', '59.444%', '59.144%', '60.406%', '59.636%', '60.406%', '61.198%', '60.898%', '62.438%', '61.561%', '61.818%', '63.037%', '63.487%', '64.235%', '62.481%']
Workers federated accuracies:  ['57.112%', '57.348%', '57.733%', '57.690%', '58.118%', '59.037%', '59.444%', '59.144%', '60.406%', '59.636%', '60.406%', '61.198%', '60.898%', '62.438%', '61.561%', '61.818%', '63.037%', '63.487%', '64.235%', '62.481%']
Workers improved  accuracies:  ['0.620%', '0.834%', '1.176%', '1.198%', '1.455%', '2.246%', '2.631%', '2.439%', '3.422%', '2.802%', '3.594%', '4.193%', '3.979%', '5.390%', '4.556%', '4.856%', '5.925%', '6.267%', '7.016%', '5.412%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]
Workers sharing_contributions :  tensor([ 1.6000,  2.4000,  4.0000,  4.8000,  5.6000,  7.2000,  8.0000,  8.8000,
        10.4000, 11.2000, 12.0000, 13.6000, 14.4000, 15.2000, 16.0000, 17.6000,
        18.4000, 19.2000, 20.8000, 20.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.4203374585675923, 0.06499067675327522)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9753821216378725, 2.8847766952348215e-13)
Correlation between test_acc improvements & sharing_contributions:  (0.975948099094409, 2.3447428990820707e-13)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.761785. Accuracy: 54.7166%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 63.8000%
Leave-one-out validation accuracies :  ['63.8000%', '63.8000%', '64.2000%', '64.8000%', '65.6000%', '66.2000%', '66.2000%', '66.6000%', '67.2000%', '67.2000%', '67.4000%', '68.2000%', '68.6000%', '69.8000%', '70.6000%', '71.0000%', '71.4000%', '71.6000%', '71.8000%', '72.4000%']
Computed and normalized credits:  tensor([0.0558, 0.0558, 0.0552, 0.0543, 0.0532, 0.0523, 0.0523, 0.0517, 0.0509,
        0.0509, 0.0506, 0.0495, 0.0490, 0.0473, 0.0463, 0.0458, 0.0453, 0.0450,
        0.0448, 0.0440])
Federated model performance: Loss: 0.687001. Accuracy: 63.3155%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['54.353%', '54.353%', '54.353%', '54.674%', '54.588%', '54.674%', '54.973%', '55.123%', '55.444%', '55.529%', '55.615%', '55.487%', '55.765%', '55.294%', '55.979%', '56.021%', '55.979%', '55.936%', '56.642%', '56.684%']
Workers federated accuracies:  ['54.353%', '54.353%', '54.353%', '54.674%', '54.588%', '54.674%', '54.973%', '55.123%', '55.444%', '55.529%', '55.615%', '55.487%', '55.765%', '55.294%', '55.979%', '56.021%', '55.979%', '55.936%', '56.642%', '56.684%']
Workers improved  accuracies:  ['0.064%', '0.086%', '-0.021%', '0.299%', '0.214%', '0.214%', '0.471%', '0.578%', '0.727%', '0.727%', '0.727%', '0.684%', '0.834%', '0.599%', '0.984%', '0.898%', '1.048%', '0.963%', '1.283%', '1.241%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 2:
Federated model validation accuracy : 69.4000%
Leave-one-out validation accuracies :  ['69.8000%', '70.0000%', '70.2000%', '70.4000%', '71.0000%', '71.2000%', '71.2000%', '71.4000%', '71.4000%', '71.4000%', '71.6000%', '71.8000%', '72.2000%', '72.6000%', '73.0000%', '73.0000%', '73.0000%', '73.2000%', '73.4000%', '73.8000%']
Computed and normalized credits:  tensor([0.0531, 0.0528, 0.0525, 0.0522, 0.0513, 0.0509, 0.0509, 0.0506, 0.0505,
        0.0505, 0.0503, 0.0499, 0.0494, 0.0487, 0.0481, 0.0481, 0.0480, 0.0477,
        0.0475, 0.0469])
Federated model performance: Loss: 0.627283. Accuracy: 67.7005%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['54.353%', '54.417%', '54.738%', '55.059%', '54.909%', '55.273%', '55.465%', '55.786%', '56.150%', '56.021%', '56.278%', '56.086%', '56.471%', '56.000%', '56.834%', '57.176%', '56.941%', '56.834%', '57.647%', '58.118%']
Workers federated accuracies:  ['54.353%', '54.417%', '54.738%', '55.059%', '54.909%', '55.273%', '55.465%', '55.786%', '56.150%', '56.021%', '56.278%', '56.086%', '56.471%', '56.000%', '56.834%', '57.176%', '56.941%', '56.834%', '57.647%', '58.118%']
Workers improved  accuracies:  ['0.064%', '0.150%', '0.364%', '0.684%', '0.535%', '0.813%', '0.963%', '1.241%', '1.433%', '1.219%', '1.390%', '1.283%', '1.540%', '1.305%', '1.840%', '2.053%', '2.011%', '1.861%', '2.289%', '2.674%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 3:
Federated model validation accuracy : 72.2000%
Leave-one-out validation accuracies :  ['72.2000%', '72.4000%', '72.6000%', '72.6000%', '72.8000%', '72.8000%', '72.8000%', '73.0000%', '73.0000%', '73.2000%', '73.0000%', '73.6000%', '73.6000%', '73.6000%', '73.4000%', '73.8000%', '73.6000%', '73.6000%', '74.2000%', '74.8000%']
Computed and normalized credits:  tensor([0.0515, 0.0513, 0.0510, 0.0510, 0.0506, 0.0506, 0.0506, 0.0503, 0.0503,
        0.0501, 0.0503, 0.0495, 0.0495, 0.0494, 0.0496, 0.0491, 0.0494, 0.0493,
        0.0486, 0.0479])
Federated model performance: Loss: 0.581555. Accuracy: 70.3315%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['54.417%', '54.439%', '54.952%', '55.337%', '55.209%', '55.508%', '55.743%', '56.086%', '56.684%', '56.791%', '56.963%', '56.663%', '57.155%', '56.620%', '57.904%', '58.267%', '57.968%', '57.861%', '58.824%', '59.144%']
Workers federated accuracies:  ['54.417%', '54.439%', '54.952%', '55.337%', '55.209%', '55.508%', '55.743%', '56.086%', '56.684%', '56.791%', '56.963%', '56.663%', '57.155%', '56.620%', '57.904%', '58.267%', '57.968%', '57.861%', '58.824%', '59.144%']
Workers improved  accuracies:  ['0.128%', '0.171%', '0.578%', '0.963%', '0.834%', '1.048%', '1.241%', '1.540%', '1.968%', '1.989%', '2.075%', '1.861%', '2.225%', '1.925%', '2.909%', '3.144%', '3.037%', '2.888%', '3.465%', '3.701%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 4:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.6000%', '73.6000%', '73.4000%', '73.4000%', '73.4000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.8000%', '74.4000%', '74.8000%', '75.2000%', '76.0000%', '76.0000%', '76.6000%', '76.8000%', '76.6000%']
Computed and normalized credits:  tensor([0.0511, 0.0511, 0.0511, 0.0513, 0.0513, 0.0513, 0.0511, 0.0510, 0.0510,
        0.0510, 0.0510, 0.0507, 0.0500, 0.0495, 0.0491, 0.0481, 0.0482, 0.0475,
        0.0472, 0.0473])
Federated model performance: Loss: 0.548343. Accuracy: 71.4866%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['54.588%', '54.610%', '55.123%', '55.636%', '55.465%', '55.786%', '55.914%', '56.663%', '57.540%', '57.540%', '57.840%', '57.433%', '58.011%', '57.070%', '58.674%', '59.187%', '58.802%', '58.652%', '60.193%', '60.428%']
Workers federated accuracies:  ['54.588%', '54.610%', '55.123%', '55.636%', '55.465%', '55.786%', '55.914%', '56.663%', '57.540%', '57.540%', '57.840%', '57.433%', '58.011%', '57.070%', '58.674%', '59.187%', '58.802%', '58.652%', '60.193%', '60.428%']
Workers improved  accuracies:  ['0.299%', '0.342%', '0.749%', '1.262%', '1.091%', '1.326%', '1.412%', '2.118%', '2.824%', '2.738%', '2.952%', '2.631%', '3.080%', '2.374%', '3.679%', '4.064%', '3.872%', '3.679%', '4.834%', '4.984%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 5:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.4000%', '75.4000%', '75.8000%', '76.2000%', '76.4000%', '76.4000%', '76.4000%', '76.6000%', '76.6000%', '77.0000%', '77.4000%', '77.8000%', '77.8000%', '78.2000%', '78.8000%']
Computed and normalized credits:  tensor([0.0515, 0.0515, 0.0515, 0.0515, 0.0515, 0.0513, 0.0513, 0.0508, 0.0503,
        0.0501, 0.0501, 0.0501, 0.0498, 0.0497, 0.0492, 0.0487, 0.0482, 0.0482,
        0.0477, 0.0471])
Federated model performance: Loss: 0.525836. Accuracy: 72.9840%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['54.738%', '54.802%', '55.401%', '55.850%', '55.701%', '56.000%', '56.428%', '57.283%', '57.947%', '58.417%', '58.481%', '58.396%', '58.631%', '57.797%', '59.701%', '60.107%', '59.636%', '59.358%', '60.898%', '61.305%']
Workers federated accuracies:  ['54.738%', '54.802%', '55.401%', '55.850%', '55.701%', '56.000%', '56.428%', '57.283%', '57.947%', '58.417%', '58.481%', '58.396%', '58.631%', '57.797%', '59.701%', '60.107%', '59.636%', '59.358%', '60.898%', '61.305%']
Workers improved  accuracies:  ['0.449%', '0.535%', '1.027%', '1.476%', '1.326%', '1.540%', '1.925%', '2.738%', '3.230%', '3.615%', '3.594%', '3.594%', '3.701%', '3.102%', '4.706%', '4.984%', '4.706%', '4.385%', '5.540%', '5.861%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 6:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.8000%', '77.0000%', '77.0000%', '77.2000%', '77.4000%', '77.8000%', '77.8000%', '77.6000%', '78.0000%', '78.4000%', '78.2000%', '78.4000%', '79.2000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%']
Computed and normalized credits:  tensor([0.0518, 0.0518, 0.0516, 0.0514, 0.0514, 0.0511, 0.0509, 0.0504, 0.0504,
        0.0506, 0.0501, 0.0497, 0.0499, 0.0496, 0.0487, 0.0482, 0.0482, 0.0481,
        0.0481, 0.0480])
Federated model performance: Loss: 0.512339. Accuracy: 74.0749%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['54.802%', '54.909%', '55.487%', '56.107%', '55.936%', '56.449%', '56.620%', '57.840%', '58.973%', '58.888%', '59.230%', '59.059%', '59.594%', '58.439%', '60.321%', '60.813%', '60.214%', '60.257%', '62.032%', '62.567%']
Workers federated accuracies:  ['54.802%', '54.909%', '55.487%', '56.107%', '55.936%', '56.449%', '56.620%', '57.840%', '58.973%', '58.888%', '59.230%', '59.059%', '59.594%', '58.439%', '60.321%', '60.813%', '60.214%', '60.257%', '62.032%', '62.567%']
Workers improved  accuracies:  ['0.513%', '0.642%', '1.112%', '1.733%', '1.561%', '1.989%', '2.118%', '3.294%', '4.257%', '4.086%', '4.342%', '4.257%', '4.663%', '3.743%', '5.326%', '5.690%', '5.283%', '5.283%', '6.674%', '7.123%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 7:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.4000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%', '79.6000%', '80.2000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%']
Computed and normalized credits:  tensor([0.0511, 0.0511, 0.0511, 0.0511, 0.0504, 0.0502, 0.0502, 0.0501, 0.0499,
        0.0501, 0.0501, 0.0498, 0.0499, 0.0501, 0.0493, 0.0491, 0.0491, 0.0491,
        0.0491, 0.0490])
Federated model performance: Loss: 0.506178. Accuracy: 74.9733%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['54.930%', '55.016%', '55.807%', '56.342%', '56.257%', '56.642%', '57.176%', '58.289%', '59.487%', '59.508%', '59.786%', '59.636%', '60.086%', '59.144%', '61.155%', '61.326%', '61.219%', '60.791%', '62.588%', '63.102%']
Workers federated accuracies:  ['54.930%', '55.016%', '55.807%', '56.342%', '56.257%', '56.642%', '57.176%', '58.289%', '59.487%', '59.508%', '59.786%', '59.636%', '60.086%', '59.144%', '61.155%', '61.326%', '61.219%', '60.791%', '62.588%', '63.102%']
Workers improved  accuracies:  ['0.642%', '0.749%', '1.433%', '1.968%', '1.882%', '2.182%', '2.674%', '3.743%', '4.770%', '4.706%', '4.898%', '4.834%', '5.155%', '4.449%', '6.160%', '6.203%', '6.289%', '5.818%', '7.230%', '7.658%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 8:
Federated model validation accuracy : 79.8000%
Leave-one-out validation accuracies :  ['79.8000%', '79.8000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '80.2000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.6000%', '80.6000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0507, 0.0507, 0.0507, 0.0504, 0.0500, 0.0498, 0.0498,
        0.0498, 0.0498, 0.0498, 0.0498, 0.0498, 0.0495, 0.0495, 0.0497, 0.0497,
        0.0497, 0.0497])
Federated model performance: Loss: 0.506255. Accuracy: 75.3797%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['54.995%', '55.251%', '56.128%', '56.535%', '56.513%', '56.963%', '57.626%', '58.781%', '60.043%', '60.214%', '60.513%', '60.193%', '60.578%', '59.529%', '61.861%', '62.032%', '61.668%', '61.497%', '63.551%', '64.000%']
Workers federated accuracies:  ['54.995%', '55.251%', '56.128%', '56.535%', '56.513%', '56.963%', '57.626%', '58.781%', '60.043%', '60.214%', '60.513%', '60.193%', '60.578%', '59.529%', '61.861%', '62.032%', '61.668%', '61.497%', '63.551%', '64.000%']
Workers improved  accuracies:  ['0.706%', '0.984%', '1.754%', '2.160%', '2.139%', '2.503%', '3.123%', '4.235%', '5.326%', '5.412%', '5.626%', '5.390%', '5.647%', '4.834%', '6.866%', '6.909%', '6.738%', '6.524%', '8.193%', '8.556%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 9:
Federated model validation accuracy : 80.4000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.4000%', '80.6000%', '80.6000%', '80.6000%', '80.6000%', '80.6000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.6000%', '80.6000%', '80.2000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '79.8000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0498, 0.0498, 0.0498, 0.0497, 0.0497, 0.0499,
        0.0499, 0.0499, 0.0499, 0.0497, 0.0497, 0.0501, 0.0503, 0.0503, 0.0503,
        0.0503, 0.0506])
Federated model performance: Loss: 0.512082. Accuracy: 75.5080%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['55.209%', '55.380%', '56.342%', '56.791%', '56.791%', '57.519%', '58.096%', '59.294%', '60.706%', '60.770%', '60.941%', '60.770%', '61.134%', '60.021%', '62.481%', '62.503%', '62.417%', '62.096%', '64.406%', '64.963%']
Workers federated accuracies:  ['55.209%', '55.380%', '56.342%', '56.791%', '56.791%', '57.519%', '58.096%', '59.294%', '60.706%', '60.770%', '60.941%', '60.770%', '61.134%', '60.021%', '62.481%', '62.503%', '62.417%', '62.096%', '64.406%', '64.963%']
Workers improved  accuracies:  ['0.920%', '1.112%', '1.968%', '2.417%', '2.417%', '3.059%', '3.594%', '4.749%', '5.989%', '5.968%', '6.053%', '5.968%', '6.203%', '5.326%', '7.487%', '7.380%', '7.487%', '7.123%', '9.048%', '9.519%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 10:
Federated model validation accuracy : 80.6000%
Leave-one-out validation accuracies :  ['80.6000%', '80.6000%', '80.6000%', '80.4000%', '80.4000%', '80.4000%', '80.2000%', '80.2000%', '80.2000%', '80.0000%', '80.0000%', '80.0000%', '79.8000%', '79.8000%', '79.8000%', '79.8000%', '79.6000%', '79.4000%', '79.4000%', '79.4000%']
Computed and normalized credits:  tensor([0.0494, 0.0494, 0.0494, 0.0496, 0.0496, 0.0496, 0.0498, 0.0498, 0.0498,
        0.0500, 0.0500, 0.0500, 0.0502, 0.0502, 0.0503, 0.0503, 0.0505, 0.0507,
        0.0507, 0.0507])
Federated model performance: Loss: 0.521345. Accuracy: 75.6791%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['55.294%', '55.508%', '56.321%', '57.027%', '57.048%', '57.818%', '58.717%', '59.658%', '61.283%', '61.155%', '61.476%', '61.262%', '61.583%', '60.684%', '63.059%', '63.037%', '63.080%', '62.674%', '65.027%', '65.455%']
Workers federated accuracies:  ['55.294%', '55.508%', '56.321%', '57.027%', '57.048%', '57.818%', '58.717%', '59.658%', '61.283%', '61.155%', '61.476%', '61.262%', '61.583%', '60.684%', '63.059%', '63.037%', '63.080%', '62.674%', '65.027%', '65.455%']
Workers improved  accuracies:  ['1.005%', '1.241%', '1.947%', '2.652%', '2.674%', '3.358%', '4.214%', '5.112%', '6.567%', '6.353%', '6.588%', '6.460%', '6.652%', '5.989%', '8.064%', '7.914%', '8.150%', '7.701%', '9.668%', '10.011%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.521345. Accuracy: 75.6791%.
Workers before    accuracies:  ['54.289%', '54.267%', '54.374%', '54.374%', '54.374%', '54.460%', '54.503%', '54.545%', '54.717%', '54.802%', '54.888%', '54.802%', '54.930%', '54.695%', '54.995%', '55.123%', '54.930%', '54.973%', '55.358%', '55.444%']
Workers standlone accuracies:  ['55.294%', '55.508%', '56.321%', '57.027%', '57.048%', '57.818%', '58.717%', '59.658%', '61.283%', '61.155%', '61.476%', '61.262%', '61.583%', '60.684%', '63.059%', '63.037%', '63.080%', '62.674%', '65.027%', '65.455%']
Workers federated accuracies:  ['55.294%', '55.508%', '56.321%', '57.027%', '57.048%', '57.818%', '58.717%', '59.658%', '61.283%', '61.155%', '61.476%', '61.262%', '61.583%', '60.684%', '63.059%', '63.037%', '63.080%', '62.674%', '65.027%', '65.455%']
Workers improved  accuracies:  ['1.005%', '1.241%', '1.947%', '2.652%', '2.674%', '3.358%', '4.214%', '5.112%', '6.567%', '6.353%', '6.588%', '6.460%', '6.652%', '5.989%', '8.064%', '7.914%', '8.150%', '7.701%', '9.668%', '10.011%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]
Workers sharing_contributions :  tensor([ 1.6000,  2.4000,  4.0000,  4.8000,  5.6000,  7.2000,  8.0000,  8.8000,
        10.4000, 11.2000, 12.0000, 13.6000, 14.4000, 15.2000, 16.0000, 17.6000,
        18.4000, 19.2000, 20.8000, 20.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.02602847949396464, 0.9132614536161662)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9706547863169714, 1.3778973571924846e-12)
Correlation between test_acc improvements & sharing_contributions:  (0.9697661293366697, 1.7964629322032995e-12)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.814455. Accuracy: 46.0963%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 62.6000%
Leave-one-out validation accuracies :  ['62.6000%', '63.0000%', '63.6000%', '64.2000%', '64.2000%', '64.4000%', '65.0000%', '65.8000%', '67.4000%', '67.6000%', '68.8000%', '70.0000%', '71.2000%', '72.4000%', '73.2000%', '74.2000%', '74.8000%', '75.6000%', '76.0000%', '76.4000%']
Computed and normalized credits:  tensor([0.0594, 0.0587, 0.0578, 0.0568, 0.0568, 0.0565, 0.0556, 0.0543, 0.0519,
        0.0517, 0.0499, 0.0482, 0.0466, 0.0450, 0.0440, 0.0428, 0.0420, 0.0411,
        0.0406, 0.0402])
Federated model performance: Loss: 0.723108. Accuracy: 56.7701%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['45.668%', '45.754%', '45.947%', '45.925%', '46.053%', '45.989%', '46.246%', '46.652%', '46.909%', '47.080%', '46.866%', '46.930%', '47.144%', '46.973%', '47.529%', '47.444%', '47.358%', '47.444%', '48.150%', '48.235%']
Workers federated accuracies:  ['45.668%', '45.754%', '45.947%', '45.925%', '46.053%', '45.989%', '46.246%', '46.652%', '46.909%', '47.080%', '46.866%', '46.930%', '47.144%', '46.973%', '47.529%', '47.444%', '47.358%', '47.444%', '48.150%', '48.235%']
Workers improved  accuracies:  ['0.128%', '0.171%', '0.321%', '0.278%', '0.214%', '0.214%', '0.299%', '0.642%', '0.620%', '0.791%', '0.620%', '0.770%', '0.856%', '0.813%', '1.027%', '0.877%', '0.834%', '0.898%', '1.455%', '1.390%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 2:
Federated model validation accuracy : 72.4000%
Leave-one-out validation accuracies :  ['72.4000%', '72.4000%', '72.6000%', '73.0000%', '73.4000%', '73.6000%', '74.2000%', '74.2000%', '74.8000%', '75.2000%', '75.4000%', '76.0000%', '76.2000%', '76.4000%', '76.4000%', '76.4000%', '76.8000%', '77.0000%', '77.0000%', '77.4000%']
Computed and normalized credits:  tensor([0.0541, 0.0541, 0.0537, 0.0531, 0.0526, 0.0524, 0.0515, 0.0514, 0.0505,
        0.0499, 0.0495, 0.0487, 0.0483, 0.0479, 0.0478, 0.0477, 0.0471, 0.0468,
        0.0467, 0.0462])
Federated model performance: Loss: 0.651641. Accuracy: 66.6738%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['45.797%', '45.861%', '46.139%', '46.182%', '46.417%', '46.374%', '46.610%', '47.166%', '47.829%', '47.572%', '47.529%', '47.658%', '47.893%', '47.743%', '48.428%', '48.556%', '48.535%', '48.471%', '49.711%', '49.775%']
Workers federated accuracies:  ['45.797%', '45.861%', '46.139%', '46.182%', '46.417%', '46.374%', '46.610%', '47.166%', '47.829%', '47.572%', '47.529%', '47.658%', '47.893%', '47.743%', '48.428%', '48.556%', '48.535%', '48.471%', '49.711%', '49.775%']
Workers improved  accuracies:  ['0.257%', '0.278%', '0.513%', '0.535%', '0.578%', '0.599%', '0.663%', '1.155%', '1.540%', '1.283%', '1.283%', '1.497%', '1.604%', '1.583%', '1.925%', '1.989%', '2.011%', '1.925%', '3.016%', '2.930%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 3:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.4000%', '76.4000%', '76.6000%', '76.8000%', '76.8000%', '77.0000%', '77.0000%', '77.2000%', '77.4000%', '78.0000%', '77.6000%', '77.6000%', '77.2000%', '77.4000%', '77.2000%', '77.6000%', '77.6000%']
Computed and normalized credits:  tensor([0.0509, 0.0509, 0.0509, 0.0510, 0.0510, 0.0508, 0.0505, 0.0504, 0.0501,
        0.0501, 0.0498, 0.0495, 0.0488, 0.0492, 0.0492, 0.0496, 0.0494, 0.0496,
        0.0491, 0.0491])
Federated model performance: Loss: 0.598251. Accuracy: 71.2299%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['45.882%', '46.182%', '46.460%', '46.545%', '46.781%', '46.695%', '46.888%', '47.701%', '48.385%', '48.257%', '48.364%', '48.428%', '48.620%', '48.471%', '49.476%', '49.519%', '49.433%', '49.305%', '51.123%', '51.358%']
Workers federated accuracies:  ['45.882%', '46.182%', '46.460%', '46.545%', '46.781%', '46.695%', '46.888%', '47.701%', '48.385%', '48.257%', '48.364%', '48.428%', '48.620%', '48.471%', '49.476%', '49.519%', '49.433%', '49.305%', '51.123%', '51.358%']
Workers improved  accuracies:  ['0.342%', '0.599%', '0.834%', '0.898%', '0.941%', '0.920%', '0.941%', '1.690%', '2.096%', '1.968%', '2.118%', '2.267%', '2.332%', '2.310%', '2.973%', '2.952%', '2.909%', '2.759%', '4.428%', '4.513%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 4:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.4000%', '77.8000%', '77.8000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '78.0000%', '78.2000%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0502, 0.0502, 0.0504, 0.0499, 0.0499, 0.0501,
        0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0495, 0.0493])
Federated model performance: Loss: 0.560464. Accuracy: 73.3048%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['46.032%', '46.417%', '46.567%', '46.824%', '47.059%', '46.909%', '47.422%', '48.214%', '49.433%', '49.283%', '49.134%', '49.305%', '49.262%', '49.112%', '50.652%', '50.695%', '50.524%', '50.588%', '52.663%', '52.813%']
Workers federated accuracies:  ['46.032%', '46.417%', '46.567%', '46.824%', '47.059%', '46.909%', '47.422%', '48.214%', '49.433%', '49.283%', '49.134%', '49.305%', '49.262%', '49.112%', '50.652%', '50.695%', '50.524%', '50.588%', '52.663%', '52.813%']
Workers improved  accuracies:  ['0.492%', '0.834%', '0.941%', '1.176%', '1.219%', '1.134%', '1.476%', '2.203%', '3.144%', '2.995%', '2.888%', '3.144%', '2.973%', '2.952%', '4.150%', '4.128%', '4.000%', '4.043%', '5.968%', '5.968%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 5:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.4000%', '77.6000%', '77.8000%', '77.6000%', '77.6000%', '77.8000%', '78.0000%', '78.0000%', '78.2000%', '78.2000%', '78.0000%', '77.8000%', '77.8000%', '77.8000%', '78.0000%', '77.8000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0502, 0.0504, 0.0502, 0.0500, 0.0502, 0.0502,
        0.0500, 0.0498, 0.0498, 0.0495, 0.0495, 0.0498, 0.0500, 0.0500, 0.0500,
        0.0497, 0.0499])
Federated model performance: Loss: 0.536237. Accuracy: 74.1176%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['46.053%', '46.545%', '46.652%', '46.995%', '47.444%', '47.316%', '47.765%', '48.663%', '50.267%', '50.118%', '50.267%', '50.203%', '50.353%', '50.053%', '51.658%', '51.658%', '51.594%', '51.508%', '53.861%', '54.053%']
Workers federated accuracies:  ['46.053%', '46.545%', '46.652%', '46.995%', '47.444%', '47.316%', '47.765%', '48.663%', '50.267%', '50.118%', '50.267%', '50.203%', '50.353%', '50.053%', '51.658%', '51.658%', '51.594%', '51.508%', '53.861%', '54.053%']
Workers improved  accuracies:  ['0.513%', '0.963%', '1.027%', '1.348%', '1.604%', '1.540%', '1.818%', '2.652%', '3.979%', '3.829%', '4.021%', '4.043%', '4.064%', '3.893%', '5.155%', '5.091%', '5.070%', '4.963%', '7.166%', '7.209%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 6:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.2000%', '78.2000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '78.0000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%']
Computed and normalized credits:  tensor([0.0498, 0.0498, 0.0498, 0.0498, 0.0503, 0.0503, 0.0502, 0.0502, 0.0502,
        0.0502, 0.0502, 0.0502, 0.0502, 0.0500, 0.0498, 0.0498, 0.0498, 0.0498,
        0.0498, 0.0498])
Federated model performance: Loss: 0.522259. Accuracy: 74.5882%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['46.203%', '46.802%', '46.845%', '47.230%', '47.636%', '47.572%', '48.193%', '49.476%', '51.144%', '51.016%', '50.888%', '51.080%', '51.230%', '50.995%', '52.920%', '52.599%', '52.770%', '52.684%', '54.952%', '55.422%']
Workers federated accuracies:  ['46.203%', '46.802%', '46.845%', '47.230%', '47.636%', '47.572%', '48.193%', '49.476%', '51.144%', '51.016%', '50.888%', '51.080%', '51.230%', '50.995%', '52.920%', '52.599%', '52.770%', '52.684%', '54.952%', '55.422%']
Workers improved  accuracies:  ['0.663%', '1.219%', '1.219%', '1.583%', '1.797%', '1.797%', '2.246%', '3.465%', '4.856%', '4.727%', '4.642%', '4.920%', '4.941%', '4.834%', '6.417%', '6.032%', '6.246%', '6.139%', '8.257%', '8.578%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 7:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.6000%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0495,
        0.0495, 0.0495])
Federated model performance: Loss: 0.516549. Accuracy: 74.9305%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['46.246%', '46.866%', '47.059%', '47.594%', '47.893%', '47.658%', '48.620%', '50.203%', '52.021%', '51.765%', '51.422%', '51.807%', '51.829%', '51.893%', '53.840%', '53.882%', '53.668%', '53.604%', '56.171%', '56.898%']
Workers federated accuracies:  ['46.246%', '46.866%', '47.059%', '47.594%', '47.893%', '47.658%', '48.620%', '50.203%', '52.021%', '51.765%', '51.422%', '51.807%', '51.829%', '51.893%', '53.840%', '53.882%', '53.668%', '53.604%', '56.171%', '56.898%']
Workers improved  accuracies:  ['0.706%', '1.283%', '1.433%', '1.947%', '2.053%', '1.882%', '2.674%', '4.193%', '5.733%', '5.476%', '5.176%', '5.647%', '5.540%', '5.733%', '7.337%', '7.316%', '7.144%', '7.059%', '9.476%', '10.053%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 8:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.8000%', '78.8000%', '78.6000%', '78.4000%', '78.6000%', '78.8000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0496, 0.0496, 0.0498, 0.0500, 0.0498, 0.0496,
        0.0496, 0.0496])
Federated model performance: Loss: 0.516494. Accuracy: 75.1658%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['46.332%', '46.995%', '47.251%', '47.829%', '48.193%', '47.914%', '49.005%', '50.738%', '52.791%', '52.321%', '52.171%', '52.620%', '52.620%', '52.684%', '54.717%', '54.802%', '54.781%', '54.567%', '57.348%', '57.947%']
Workers federated accuracies:  ['46.332%', '46.995%', '47.251%', '47.829%', '48.193%', '47.914%', '49.005%', '50.738%', '52.791%', '52.321%', '52.171%', '52.620%', '52.620%', '52.684%', '54.717%', '54.802%', '54.781%', '54.567%', '57.348%', '57.947%']
Workers improved  accuracies:  ['0.791%', '1.412%', '1.626%', '2.182%', '2.353%', '2.139%', '3.059%', '4.727%', '6.503%', '6.032%', '5.925%', '6.460%', '6.332%', '6.524%', '8.214%', '8.235%', '8.257%', '8.021%', '10.652%', '11.102%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 9:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.6000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0502, 0.0502, 0.0502, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499,
        0.0497, 0.0497])
Federated model performance: Loss: 0.521419. Accuracy: 75.4652%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['46.460%', '47.187%', '47.572%', '48.150%', '48.556%', '48.193%', '49.540%', '51.337%', '53.882%', '53.241%', '52.642%', '53.604%', '53.326%', '53.326%', '55.807%', '55.701%', '55.786%', '55.422%', '58.503%', '58.845%']
Workers federated accuracies:  ['46.460%', '47.187%', '47.572%', '48.150%', '48.556%', '48.193%', '49.540%', '51.337%', '53.882%', '53.241%', '52.642%', '53.604%', '53.326%', '53.326%', '55.807%', '55.701%', '55.786%', '55.422%', '58.503%', '58.845%']
Workers improved  accuracies:  ['0.920%', '1.604%', '1.947%', '2.503%', '2.717%', '2.417%', '3.594%', '5.326%', '7.594%', '6.952%', '6.396%', '7.444%', '7.037%', '7.166%', '9.305%', '9.134%', '9.262%', '8.877%', '11.807%', '12.000%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 10:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.4000%', '79.4000%', '79.4000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502,
        0.0502, 0.0502, 0.0502, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0495,
        0.0495, 0.0495])
Federated model performance: Loss: 0.529060. Accuracy: 75.5294%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['46.524%', '47.358%', '47.701%', '48.342%', '48.898%', '48.535%', '50.032%', '51.979%', '54.374%', '54.160%', '53.155%', '54.353%', '54.118%', '54.225%', '56.535%', '56.342%', '56.556%', '56.364%', '59.465%', '59.936%']
Workers federated accuracies:  ['46.524%', '47.358%', '47.701%', '48.342%', '48.898%', '48.535%', '50.032%', '51.979%', '54.374%', '54.160%', '53.155%', '54.353%', '54.118%', '54.225%', '56.535%', '56.342%', '56.556%', '56.364%', '59.465%', '59.936%']
Workers improved  accuracies:  ['0.984%', '1.775%', '2.075%', '2.695%', '3.059%', '2.759%', '4.086%', '5.968%', '8.086%', '7.872%', '6.909%', '8.193%', '7.829%', '8.064%', '10.032%', '9.775%', '10.032%', '9.818%', '12.770%', '13.091%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.529060. Accuracy: 75.5294%.
Workers before    accuracies:  ['45.540%', '45.583%', '45.626%', '45.647%', '45.840%', '45.775%', '45.947%', '46.011%', '46.289%', '46.289%', '46.246%', '46.160%', '46.289%', '46.160%', '46.503%', '46.567%', '46.524%', '46.545%', '46.695%', '46.845%']
Workers standlone accuracies:  ['46.524%', '47.358%', '47.701%', '48.342%', '48.898%', '48.535%', '50.032%', '51.979%', '54.374%', '54.160%', '53.155%', '54.353%', '54.118%', '54.225%', '56.535%', '56.342%', '56.556%', '56.364%', '59.465%', '59.936%']
Workers federated accuracies:  ['46.524%', '47.358%', '47.701%', '48.342%', '48.898%', '48.535%', '50.032%', '51.979%', '54.374%', '54.160%', '53.155%', '54.353%', '54.118%', '54.225%', '56.535%', '56.342%', '56.556%', '56.364%', '59.465%', '59.936%']
Workers improved  accuracies:  ['0.984%', '1.775%', '2.075%', '2.695%', '3.059%', '2.759%', '4.086%', '5.968%', '8.086%', '7.872%', '6.909%', '8.193%', '7.829%', '8.064%', '10.032%', '9.775%', '10.032%', '9.818%', '12.770%', '13.091%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]
Workers sharing_contributions :  tensor([ 1.6000,  2.4000,  4.0000,  4.8000,  5.6000,  7.2000,  8.0000,  8.8000,
        10.4000, 11.2000, 12.0000, 13.6000, 14.4000, 15.2000, 16.0000, 17.6000,
        18.4000, 19.2000, 20.8000, 20.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.018643147135664853, 0.9378180484094853)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9719977197854344, 9.083370342413914e-13)
Correlation between test_acc improvements & sharing_contributions:  (0.971061259425175, 1.21714228907378e-12)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.768223. Accuracy: 50.6096%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 65.2000%
Leave-one-out validation accuracies :  ['65.2000%', '65.4000%', '66.2000%', '67.0000%', '67.6000%', '68.2000%', '68.6000%', '69.6000%', '69.8000%', '71.0000%', '71.6000%', '72.0000%', '72.6000%', '73.0000%', '73.8000%', '74.8000%', '75.0000%', '75.2000%', '75.8000%', '76.6000%']
Computed and normalized credits:  tensor([0.0581, 0.0578, 0.0566, 0.0554, 0.0545, 0.0537, 0.0531, 0.0517, 0.0514,
        0.0497, 0.0489, 0.0484, 0.0476, 0.0471, 0.0461, 0.0448, 0.0446, 0.0443,
        0.0436, 0.0426])
Federated model performance: Loss: 0.690464. Accuracy: 61.8610%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.267%', '50.289%', '50.481%', '50.695%', '50.695%', '50.610%', '50.738%', '51.059%', '51.508%', '51.358%', '51.337%', '51.422%', '51.829%', '51.422%', '51.893%', '52.150%', '52.086%', '52.150%', '53.091%', '52.898%']
Workers federated accuracies:  ['50.267%', '50.289%', '50.481%', '50.695%', '50.695%', '50.610%', '50.738%', '51.059%', '51.508%', '51.358%', '51.337%', '51.422%', '51.829%', '51.422%', '51.893%', '52.150%', '52.086%', '52.150%', '53.091%', '52.898%']
Workers improved  accuracies:  ['0.150%', '0.128%', '0.150%', '0.342%', '0.321%', '0.299%', '0.299%', '0.513%', '0.898%', '0.642%', '0.706%', '0.856%', '1.048%', '0.856%', '1.283%', '1.241%', '1.305%', '1.390%', '1.647%', '1.583%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 2:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2000%', '74.2000%', '74.4000%', '74.4000%', '74.4000%', '74.8000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.6000%', '76.2000%', '77.0000%', '77.0000%', '77.0000%', '76.6000%', '77.0000%', '77.4000%', '77.4000%']
Computed and normalized credits:  tensor([0.0524, 0.0524, 0.0523, 0.0519, 0.0519, 0.0518, 0.0512, 0.0506, 0.0506,
        0.0505, 0.0504, 0.0499, 0.0491, 0.0481, 0.0480, 0.0479, 0.0484, 0.0479,
        0.0474, 0.0473])
Federated model performance: Loss: 0.630571. Accuracy: 69.2192%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.332%', '50.417%', '50.524%', '50.995%', '50.909%', '50.824%', '51.251%', '51.636%', '52.406%', '52.342%', '52.364%', '52.406%', '52.749%', '52.492%', '53.005%', '53.369%', '53.005%', '53.176%', '54.759%', '54.396%']
Workers federated accuracies:  ['50.332%', '50.417%', '50.524%', '50.995%', '50.909%', '50.824%', '51.251%', '51.636%', '52.406%', '52.342%', '52.364%', '52.406%', '52.749%', '52.492%', '53.005%', '53.369%', '53.005%', '53.176%', '54.759%', '54.396%']
Workers improved  accuracies:  ['0.214%', '0.257%', '0.193%', '0.642%', '0.535%', '0.513%', '0.813%', '1.091%', '1.797%', '1.626%', '1.733%', '1.840%', '1.968%', '1.925%', '2.396%', '2.460%', '2.225%', '2.417%', '3.316%', '3.080%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 3:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.4000%', '76.6000%', '77.0000%', '77.2000%', '77.0000%', '77.0000%', '77.0000%', '77.0000%', '76.8000%', '76.8000%', '76.8000%', '77.0000%', '77.2000%', '77.4000%', '77.4000%', '77.6000%', '77.8000%', '77.4000%', '77.4000%', '77.8000%']
Computed and normalized credits:  tensor([0.0510, 0.0508, 0.0504, 0.0501, 0.0503, 0.0503, 0.0503, 0.0502, 0.0504,
        0.0504, 0.0504, 0.0501, 0.0498, 0.0495, 0.0495, 0.0493, 0.0491, 0.0495,
        0.0495, 0.0490])
Federated model performance: Loss: 0.585283. Accuracy: 72.4706%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.460%', '50.567%', '50.738%', '51.166%', '51.144%', '51.529%', '51.786%', '52.428%', '53.305%', '53.348%', '53.048%', '53.155%', '53.604%', '53.176%', '53.882%', '54.674%', '54.225%', '54.417%', '56.428%', '55.979%']
Workers federated accuracies:  ['50.460%', '50.567%', '50.738%', '51.166%', '51.144%', '51.529%', '51.786%', '52.428%', '53.305%', '53.348%', '53.048%', '53.155%', '53.604%', '53.176%', '53.882%', '54.674%', '54.225%', '54.417%', '56.428%', '55.979%']
Workers improved  accuracies:  ['0.342%', '0.406%', '0.406%', '0.813%', '0.770%', '1.219%', '1.348%', '1.882%', '2.695%', '2.631%', '2.417%', '2.588%', '2.824%', '2.610%', '3.273%', '3.765%', '3.444%', '3.658%', '4.984%', '4.663%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 4:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.4000%', '77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.6000%', '77.8000%', '78.0000%', '78.2000%', '78.0000%', '77.8000%', '78.0000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0500, 0.0500, 0.0503,
        0.0503, 0.0503, 0.0500, 0.0500, 0.0500, 0.0498, 0.0495, 0.0493, 0.0495,
        0.0498, 0.0495])
Federated model performance: Loss: 0.552976. Accuracy: 73.8824%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.503%', '50.652%', '50.845%', '51.572%', '51.594%', '51.957%', '52.406%', '52.791%', '53.968%', '54.118%', '53.711%', '54.011%', '54.695%', '54.118%', '55.166%', '55.765%', '55.251%', '55.572%', '58.139%', '57.476%']
Workers federated accuracies:  ['50.503%', '50.652%', '50.845%', '51.572%', '51.594%', '51.957%', '52.406%', '52.791%', '53.968%', '54.118%', '53.711%', '54.011%', '54.695%', '54.118%', '55.166%', '55.765%', '55.251%', '55.572%', '58.139%', '57.476%']
Workers improved  accuracies:  ['0.385%', '0.492%', '0.513%', '1.219%', '1.219%', '1.647%', '1.968%', '2.246%', '3.358%', '3.401%', '3.080%', '3.444%', '3.914%', '3.551%', '4.556%', '4.856%', '4.471%', '4.813%', '6.695%', '6.160%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 5:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.8000%', '77.8000%', '77.8000%', '77.6000%', '77.6000%', '78.2000%', '78.2000%', '78.2000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%']
Computed and normalized credits:  tensor([0.0504, 0.0504, 0.0502, 0.0502, 0.0502, 0.0504, 0.0504, 0.0497, 0.0497,
        0.0497, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0498, 0.0499,
        0.0499, 0.0499])
Federated model performance: Loss: 0.531248. Accuracy: 74.6310%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.567%', '50.759%', '51.144%', '51.893%', '52.150%', '52.406%', '52.684%', '53.626%', '55.166%', '55.187%', '54.695%', '54.824%', '55.273%', '54.930%', '56.299%', '56.727%', '56.513%', '56.578%', '59.936%', '59.016%']
Workers federated accuracies:  ['50.567%', '50.759%', '51.144%', '51.893%', '52.150%', '52.406%', '52.684%', '53.626%', '55.166%', '55.187%', '54.695%', '54.824%', '55.273%', '54.930%', '56.299%', '56.727%', '56.513%', '56.578%', '59.936%', '59.016%']
Workers improved  accuracies:  ['0.449%', '0.599%', '0.813%', '1.540%', '1.775%', '2.096%', '2.246%', '3.080%', '4.556%', '4.471%', '4.064%', '4.257%', '4.492%', '4.364%', '5.690%', '5.818%', '5.733%', '5.818%', '8.492%', '7.701%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 6:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.2000%', '78.2000%', '78.4000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0502, 0.0502,
        0.0502, 0.0502, 0.0502, 0.0500, 0.0500, 0.0498, 0.0496, 0.0496, 0.0494,
        0.0494, 0.0494])
Federated model performance: Loss: 0.518257. Accuracy: 74.9091%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.567%', '50.888%', '51.380%', '52.128%', '52.406%', '52.877%', '53.198%', '54.267%', '55.957%', '56.086%', '55.615%', '55.893%', '56.342%', '55.957%', '57.262%', '57.947%', '57.369%', '57.861%', '61.455%', '60.535%']
Workers federated accuracies:  ['50.567%', '50.888%', '51.380%', '52.128%', '52.406%', '52.877%', '53.198%', '54.267%', '55.957%', '56.086%', '55.615%', '55.893%', '56.342%', '55.957%', '57.262%', '57.947%', '57.369%', '57.861%', '61.455%', '60.535%']
Workers improved  accuracies:  ['0.449%', '0.727%', '1.048%', '1.775%', '2.032%', '2.567%', '2.759%', '3.722%', '5.348%', '5.369%', '4.984%', '5.326%', '5.561%', '5.390%', '6.652%', '7.037%', '6.588%', '7.102%', '10.011%', '9.219%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 7:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0505, 0.0505, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0498, 0.0498, 0.0498, 0.0497, 0.0497, 0.0497,
        0.0497, 0.0497])
Federated model performance: Loss: 0.512063. Accuracy: 75.4011%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.631%', '51.037%', '51.529%', '52.406%', '52.749%', '53.198%', '53.690%', '54.802%', '57.005%', '56.898%', '56.214%', '56.535%', '57.262%', '57.112%', '58.781%', '59.529%', '58.631%', '58.845%', '62.802%', '61.947%']
Workers federated accuracies:  ['50.631%', '51.037%', '51.529%', '52.406%', '52.749%', '53.198%', '53.690%', '54.802%', '57.005%', '56.898%', '56.214%', '56.535%', '57.262%', '57.112%', '58.781%', '59.529%', '58.631%', '58.845%', '62.802%', '61.947%']
Workers improved  accuracies:  ['0.513%', '0.877%', '1.198%', '2.053%', '2.374%', '2.888%', '3.251%', '4.257%', '6.396%', '6.182%', '5.583%', '5.968%', '6.481%', '6.545%', '8.171%', '8.620%', '7.850%', '8.086%', '11.358%', '10.631%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 8:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498,
        0.0498, 0.0498])
Federated model performance: Loss: 0.511324. Accuracy: 75.5508%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.567%', '51.209%', '51.872%', '52.877%', '53.219%', '53.626%', '54.118%', '55.572%', '57.925%', '57.733%', '56.984%', '57.198%', '58.139%', '57.947%', '59.829%', '60.342%', '59.487%', '59.872%', '64.064%', '62.845%']
Workers federated accuracies:  ['50.567%', '51.209%', '51.872%', '52.877%', '53.219%', '53.626%', '54.118%', '55.572%', '57.925%', '57.733%', '56.984%', '57.198%', '58.139%', '57.947%', '59.829%', '60.342%', '59.487%', '59.872%', '64.064%', '62.845%']
Workers improved  accuracies:  ['0.449%', '1.048%', '1.540%', '2.524%', '2.845%', '3.316%', '3.679%', '5.027%', '7.316%', '7.016%', '6.353%', '6.631%', '7.358%', '7.380%', '9.219%', '9.433%', '8.706%', '9.112%', '12.620%', '11.529%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 9:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.2000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.6000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0501, 0.0501,
        0.0501, 0.0501, 0.0501, 0.0501, 0.0498, 0.0498, 0.0496, 0.0496, 0.0496,
        0.0496, 0.0494])
Federated model performance: Loss: 0.514849. Accuracy: 75.4866%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.759%', '51.444%', '52.150%', '53.305%', '53.668%', '54.374%', '54.738%', '56.214%', '58.802%', '58.759%', '57.840%', '57.968%', '58.738%', '58.695%', '60.620%', '61.497%', '60.471%', '60.834%', '65.134%', '63.807%']
Workers federated accuracies:  ['50.759%', '51.444%', '52.150%', '53.305%', '53.668%', '54.374%', '54.738%', '56.214%', '58.802%', '58.759%', '57.840%', '57.968%', '58.738%', '58.695%', '60.620%', '61.497%', '60.471%', '60.834%', '65.134%', '63.807%']
Workers improved  accuracies:  ['0.642%', '1.283%', '1.818%', '2.952%', '3.294%', '4.064%', '4.299%', '5.668%', '8.193%', '8.043%', '7.209%', '7.401%', '7.957%', '8.128%', '10.011%', '10.588%', '9.690%', '10.075%', '13.690%', '12.492%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 10:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.4000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0503, 0.0503, 0.0503, 0.0500, 0.0498, 0.0498, 0.0498,
        0.0498, 0.0498, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500])
Federated model performance: Loss: 0.522163. Accuracy: 75.5080%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.824%', '51.636%', '52.321%', '53.775%', '54.182%', '54.717%', '55.273%', '56.813%', '59.807%', '59.679%', '58.524%', '58.973%', '59.829%', '59.444%', '61.690%', '62.182%', '61.540%', '61.775%', '66.118%', '65.091%']
Workers federated accuracies:  ['50.824%', '51.636%', '52.321%', '53.775%', '54.182%', '54.717%', '55.273%', '56.813%', '59.807%', '59.679%', '58.524%', '58.973%', '59.829%', '59.444%', '61.690%', '62.182%', '61.540%', '61.775%', '66.118%', '65.091%']
Workers improved  accuracies:  ['0.706%', '1.476%', '1.989%', '3.422%', '3.807%', '4.406%', '4.834%', '6.267%', '9.198%', '8.963%', '7.893%', '8.406%', '9.048%', '8.877%', '11.080%', '11.273%', '10.759%', '11.016%', '14.674%', '13.775%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.522163. Accuracy: 75.5080%.
Workers before    accuracies:  ['50.118%', '50.160%', '50.332%', '50.353%', '50.374%', '50.310%', '50.439%', '50.545%', '50.610%', '50.717%', '50.631%', '50.567%', '50.781%', '50.567%', '50.610%', '50.909%', '50.781%', '50.759%', '51.444%', '51.316%']
Workers standlone accuracies:  ['50.824%', '51.636%', '52.321%', '53.775%', '54.182%', '54.717%', '55.273%', '56.813%', '59.807%', '59.679%', '58.524%', '58.973%', '59.829%', '59.444%', '61.690%', '62.182%', '61.540%', '61.775%', '66.118%', '65.091%']
Workers federated accuracies:  ['50.824%', '51.636%', '52.321%', '53.775%', '54.182%', '54.717%', '55.273%', '56.813%', '59.807%', '59.679%', '58.524%', '58.973%', '59.829%', '59.444%', '61.690%', '62.182%', '61.540%', '61.775%', '66.118%', '65.091%']
Workers improved  accuracies:  ['0.706%', '1.476%', '1.989%', '3.422%', '3.807%', '4.406%', '4.834%', '6.267%', '9.198%', '8.963%', '7.893%', '8.406%', '9.048%', '8.877%', '11.080%', '11.273%', '10.759%', '11.016%', '14.674%', '13.775%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]
Workers sharing_contributions :  tensor([ 1.6000,  2.4000,  4.0000,  4.8000,  5.6000,  7.2000,  8.0000,  8.8000,
        10.4000, 11.2000, 12.0000, 13.6000, 14.4000, 15.2000, 16.0000, 17.6000,
        18.4000, 19.2000, 20.8000, 20.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.1568032819100949, 0.5091281861087831)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999998, 1.2459683851238692e-139)
Correlation between test_acc & sharing contributions:  (0.9719039991895451, 9.357476440170903e-13)
Correlation between test_acc improvements & sharing_contributions:  (0.9731429792815793, 6.263805568950426e-13)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.833343. Accuracy: 40.4492%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 51.6000%
Leave-one-out validation accuracies :  ['52.0000%', '51.8000%', '52.2000%', '53.0000%', '53.8000%', '54.6000%', '54.8000%', '55.4000%', '56.0000%', '57.2000%', '58.8000%', '60.6000%', '61.4000%', '62.6000%', '65.4000%', '65.8000%', '66.6000%', '67.0000%', '67.4000%', '68.8000%']
Computed and normalized credits:  tensor([0.0629, 0.0633, 0.0625, 0.0608, 0.0592, 0.0576, 0.0572, 0.0561, 0.0549,
        0.0527, 0.0498, 0.0468, 0.0455, 0.0437, 0.0397, 0.0391, 0.0381, 0.0376,
        0.0371, 0.0354])
Federated model performance: Loss: 0.745019. Accuracy: 52.8128%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['39.807%', '40.043%', '40.128%', '40.406%', '40.471%', '40.556%', '40.642%', '41.005%', '41.690%', '41.690%', '41.583%', '41.904%', '41.882%', '41.561%', '42.096%', '42.267%', '42.203%', '42.332%', '43.487%', '43.294%']
Workers federated accuracies:  ['39.807%', '40.043%', '40.128%', '40.406%', '40.471%', '40.556%', '40.642%', '41.005%', '41.690%', '41.690%', '41.583%', '41.904%', '41.882%', '41.561%', '42.096%', '42.267%', '42.203%', '42.332%', '43.487%', '43.294%']
Workers improved  accuracies:  ['0.128%', '0.235%', '0.278%', '0.471%', '0.513%', '0.535%', '0.492%', '0.684%', '1.176%', '1.134%', '1.134%', '1.305%', '1.283%', '1.027%', '1.283%', '1.476%', '1.369%', '1.455%', '1.840%', '1.775%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 2:
Federated model validation accuracy : 63.4000%
Leave-one-out validation accuracies :  ['63.4000%', '63.6000%', '64.0000%', '65.2000%', '65.8000%', '65.8000%', '65.8000%', '66.0000%', '66.6000%', '65.8000%', '66.2000%', '66.6000%', '67.0000%', '68.2000%', '68.4000%', '69.4000%', '70.6000%', '70.6000%', '72.0000%', '72.4000%']
Computed and normalized credits:  tensor([0.0566, 0.0564, 0.0557, 0.0538, 0.0528, 0.0526, 0.0526, 0.0522, 0.0512,
        0.0521, 0.0512, 0.0504, 0.0497, 0.0479, 0.0472, 0.0458, 0.0441, 0.0441,
        0.0423, 0.0416])
Federated model performance: Loss: 0.673691. Accuracy: 63.2941%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['39.979%', '40.214%', '40.342%', '40.749%', '40.941%', '41.091%', '41.198%', '41.797%', '42.503%', '42.781%', '42.332%', '42.845%', '42.781%', '42.524%', '43.422%', '43.701%', '43.529%', '43.529%', '45.604%', '45.390%']
Workers federated accuracies:  ['39.979%', '40.214%', '40.342%', '40.749%', '40.941%', '41.091%', '41.198%', '41.797%', '42.503%', '42.781%', '42.332%', '42.845%', '42.781%', '42.524%', '43.422%', '43.701%', '43.529%', '43.529%', '45.604%', '45.390%']
Workers improved  accuracies:  ['0.299%', '0.406%', '0.492%', '0.813%', '0.984%', '1.070%', '1.048%', '1.476%', '1.989%', '2.225%', '1.882%', '2.246%', '2.182%', '1.989%', '2.610%', '2.909%', '2.695%', '2.652%', '3.957%', '3.872%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 3:
Federated model validation accuracy : 68.2000%
Leave-one-out validation accuracies :  ['68.2000%', '68.2000%', '68.2000%', '68.2000%', '68.2000%', '68.4000%', '69.0000%', '70.0000%', '70.4000%', '71.2000%', '71.6000%', '72.0000%', '72.6000%', '72.6000%', '72.8000%', '73.2000%', '73.2000%', '73.4000%', '73.8000%', '74.4000%']
Computed and normalized credits:  tensor([0.0542, 0.0542, 0.0541, 0.0540, 0.0539, 0.0536, 0.0528, 0.0514, 0.0508,
        0.0499, 0.0493, 0.0487, 0.0479, 0.0477, 0.0474, 0.0468, 0.0466, 0.0463,
        0.0457, 0.0449])
Federated model performance: Loss: 0.617937. Accuracy: 67.6791%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.064%', '40.406%', '40.813%', '41.091%', '41.561%', '41.840%', '41.904%', '42.674%', '43.529%', '43.743%', '43.465%', '43.594%', '43.957%', '43.358%', '44.984%', '45.455%', '45.283%', '44.898%', '47.487%', '47.316%']
Workers federated accuracies:  ['40.064%', '40.406%', '40.813%', '41.091%', '41.561%', '41.840%', '41.904%', '42.674%', '43.529%', '43.743%', '43.465%', '43.594%', '43.957%', '43.358%', '44.984%', '45.455%', '45.283%', '44.898%', '47.487%', '47.316%']
Workers improved  accuracies:  ['0.385%', '0.599%', '0.963%', '1.155%', '1.604%', '1.818%', '1.754%', '2.353%', '3.016%', '3.187%', '3.016%', '2.995%', '3.358%', '2.824%', '4.171%', '4.663%', '4.449%', '4.021%', '5.840%', '5.797%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 4:
Federated model validation accuracy : 72.2000%
Leave-one-out validation accuracies :  ['72.2000%', '72.2000%', '72.0000%', '72.4000%', '72.8000%', '73.0000%', '73.0000%', '73.2000%', '73.2000%', '73.4000%', '73.4000%', '73.4000%', '74.0000%', '74.2000%', '74.6000%', '74.6000%', '74.6000%', '74.8000%', '75.0000%', '75.4000%']
Computed and normalized credits:  tensor([0.0520, 0.0520, 0.0523, 0.0518, 0.0513, 0.0510, 0.0509, 0.0506, 0.0505,
        0.0502, 0.0501, 0.0501, 0.0493, 0.0490, 0.0485, 0.0485, 0.0484, 0.0482,
        0.0479, 0.0474])
Federated model performance: Loss: 0.577011. Accuracy: 70.7807%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.107%', '40.556%', '40.877%', '41.604%', '41.861%', '42.053%', '42.503%', '43.572%', '44.920%', '44.941%', '44.321%', '44.920%', '45.198%', '44.492%', '46.460%', '47.059%', '46.781%', '46.481%', '49.326%', '49.005%']
Workers federated accuracies:  ['40.107%', '40.556%', '40.877%', '41.604%', '41.861%', '42.053%', '42.503%', '43.572%', '44.920%', '44.941%', '44.321%', '44.920%', '45.198%', '44.492%', '46.460%', '47.059%', '46.781%', '46.481%', '49.326%', '49.005%']
Workers improved  accuracies:  ['0.428%', '0.749%', '1.027%', '1.668%', '1.904%', '2.032%', '2.353%', '3.251%', '4.406%', '4.385%', '3.872%', '4.321%', '4.599%', '3.957%', '5.647%', '6.267%', '5.947%', '5.604%', '7.679%', '7.487%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 5:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.4000%', '74.4000%', '74.4000%', '74.4000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.8000%', '75.0000%', '75.2000%', '75.4000%', '75.6000%', '75.8000%', '76.0000%', '76.0000%', '76.2000%', '76.4000%', '76.6000%']
Computed and normalized credits:  tensor([0.0511, 0.0511, 0.0511, 0.0511, 0.0508, 0.0508, 0.0508, 0.0507, 0.0507,
        0.0505, 0.0502, 0.0500, 0.0497, 0.0494, 0.0491, 0.0489, 0.0489, 0.0487,
        0.0484, 0.0481])
Federated model performance: Loss: 0.548073. Accuracy: 72.4706%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.171%', '40.813%', '41.262%', '42.011%', '42.225%', '42.631%', '43.080%', '44.385%', '45.989%', '45.840%', '45.519%', '45.947%', '46.417%', '45.989%', '47.594%', '48.235%', '47.979%', '47.786%', '50.674%', '50.289%']
Workers federated accuracies:  ['40.171%', '40.813%', '41.262%', '42.011%', '42.225%', '42.631%', '43.080%', '44.385%', '45.989%', '45.840%', '45.519%', '45.947%', '46.417%', '45.989%', '47.594%', '48.235%', '47.979%', '47.786%', '50.674%', '50.289%']
Workers improved  accuracies:  ['0.492%', '1.005%', '1.412%', '2.075%', '2.267%', '2.610%', '2.930%', '4.064%', '5.476%', '5.283%', '5.070%', '5.348%', '5.818%', '5.455%', '6.781%', '7.444%', '7.144%', '6.909%', '9.027%', '8.770%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 6:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.2000%', '75.2000%', '75.2000%', '75.4000%', '75.8000%', '75.8000%', '76.0000%', '76.0000%', '76.0000%', '76.2000%', '76.2000%', '76.4000%', '76.8000%', '76.8000%', '77.0000%', '77.2000%', '77.2000%', '77.8000%', '77.8000%', '77.8000%']
Computed and normalized credits:  tensor([0.0515, 0.0515, 0.0515, 0.0512, 0.0507, 0.0507, 0.0505, 0.0505, 0.0505,
        0.0503, 0.0502, 0.0500, 0.0495, 0.0495, 0.0492, 0.0490, 0.0490, 0.0483,
        0.0482, 0.0482])
Federated model performance: Loss: 0.527901. Accuracy: 73.6685%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.278%', '41.027%', '41.497%', '42.289%', '42.738%', '43.123%', '43.722%', '45.198%', '46.738%', '46.973%', '46.503%', '46.973%', '47.658%', '46.824%', '48.856%', '49.262%', '49.369%', '48.898%', '52.150%', '51.743%']
Workers federated accuracies:  ['40.278%', '41.027%', '41.497%', '42.289%', '42.738%', '43.123%', '43.722%', '45.198%', '46.738%', '46.973%', '46.503%', '46.973%', '47.658%', '46.824%', '48.856%', '49.262%', '49.369%', '48.898%', '52.150%', '51.743%']
Workers improved  accuracies:  ['0.599%', '1.219%', '1.647%', '2.353%', '2.781%', '3.102%', '3.572%', '4.877%', '6.225%', '6.417%', '6.053%', '6.374%', '7.059%', '6.289%', '8.043%', '8.471%', '8.535%', '8.021%', '10.503%', '10.225%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 7:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.8000%', '77.0000%', '77.2000%', '77.6000%', '77.6000%', '77.6000%', '77.8000%', '77.8000%', '78.0000%', '78.0000%', '78.4000%', '78.6000%', '78.6000%', '78.8000%']
Computed and normalized credits:  tensor([0.0511, 0.0511, 0.0511, 0.0511, 0.0510, 0.0510, 0.0508, 0.0506, 0.0503,
        0.0499, 0.0499, 0.0498, 0.0496, 0.0496, 0.0493, 0.0493, 0.0489, 0.0486,
        0.0486, 0.0484])
Federated model performance: Loss: 0.515520. Accuracy: 74.4171%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.471%', '41.283%', '41.840%', '42.824%', '43.187%', '43.658%', '44.064%', '46.096%', '47.850%', '47.957%', '46.973%', '47.850%', '48.578%', '47.551%', '49.497%', '50.460%', '50.439%', '50.160%', '53.861%', '53.583%']
Workers federated accuracies:  ['40.471%', '41.283%', '41.840%', '42.824%', '43.187%', '43.658%', '44.064%', '46.096%', '47.850%', '47.957%', '46.973%', '47.850%', '48.578%', '47.551%', '49.497%', '50.460%', '50.439%', '50.160%', '53.861%', '53.583%']
Workers improved  accuracies:  ['0.791%', '1.476%', '1.989%', '2.888%', '3.230%', '3.636%', '3.914%', '5.775%', '7.337%', '7.401%', '6.524%', '7.251%', '7.979%', '7.016%', '8.684%', '9.668%', '9.604%', '9.283%', '12.214%', '12.064%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 8:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['77.8000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.2000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.6000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.2000%', '79.6000%', '79.6000%']
Computed and normalized credits:  tensor([0.0509, 0.0507, 0.0507, 0.0507, 0.0507, 0.0507, 0.0504, 0.0502, 0.0502,
        0.0501, 0.0501, 0.0501, 0.0499, 0.0496, 0.0496, 0.0496, 0.0496, 0.0491,
        0.0487, 0.0487])
Federated model performance: Loss: 0.508853. Accuracy: 74.6738%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.620%', '41.476%', '42.267%', '43.080%', '43.658%', '44.086%', '44.663%', '46.695%', '48.834%', '48.877%', '48.064%', '48.941%', '49.241%', '48.492%', '50.567%', '51.551%', '51.551%', '51.059%', '55.615%', '55.080%']
Workers federated accuracies:  ['40.620%', '41.476%', '42.267%', '43.080%', '43.658%', '44.086%', '44.663%', '46.695%', '48.834%', '48.877%', '48.064%', '48.941%', '49.241%', '48.492%', '50.567%', '51.551%', '51.551%', '51.059%', '55.615%', '55.080%']
Workers improved  accuracies:  ['0.941%', '1.668%', '2.417%', '3.144%', '3.701%', '4.064%', '4.513%', '6.374%', '8.321%', '8.321%', '7.615%', '8.342%', '8.642%', '7.957%', '9.754%', '10.759%', '10.717%', '10.182%', '13.968%', '13.561%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 9:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%', '79.2000%', '79.2000%', '79.2000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.6000%', '79.8000%', '80.0000%']
Computed and normalized credits:  tensor([0.0504, 0.0504, 0.0504, 0.0504, 0.0504, 0.0504, 0.0503, 0.0503, 0.0501,
        0.0501, 0.0499, 0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0498, 0.0494,
        0.0491, 0.0489])
Federated model performance: Loss: 0.506651. Accuracy: 75.1444%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.813%', '41.797%', '42.396%', '43.487%', '44.128%', '44.578%', '45.326%', '47.358%', '49.775%', '49.797%', '48.963%', '49.775%', '49.947%', '49.497%', '51.358%', '52.556%', '52.749%', '52.064%', '57.219%', '56.706%']
Workers federated accuracies:  ['40.813%', '41.797%', '42.396%', '43.487%', '44.128%', '44.578%', '45.326%', '47.358%', '49.775%', '49.797%', '48.963%', '49.775%', '49.947%', '49.497%', '51.358%', '52.556%', '52.749%', '52.064%', '57.219%', '56.706%']
Workers improved  accuracies:  ['1.134%', '1.989%', '2.545%', '3.551%', '4.171%', '4.556%', '5.176%', '7.037%', '9.262%', '9.241%', '8.513%', '9.176%', '9.348%', '8.963%', '10.545%', '11.765%', '11.914%', '11.187%', '15.572%', '15.187%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Epoch 10:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.2000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.2000%', '79.2000%', '79.4000%', '79.4000%', '79.6000%', '79.6000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.2000%', '80.4000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0504, 0.0506, 0.0506, 0.0506, 0.0504, 0.0504, 0.0504,
        0.0502, 0.0502, 0.0499, 0.0499, 0.0495, 0.0495, 0.0495, 0.0495, 0.0495,
        0.0492, 0.0490])
Federated model performance: Loss: 0.508471. Accuracy: 75.2513%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.920%', '42.096%', '42.717%', '43.936%', '44.535%', '45.241%', '46.011%', '47.979%', '50.631%', '50.717%', '49.711%', '50.545%', '50.824%', '50.075%', '52.492%', '53.861%', '53.861%', '53.348%', '58.866%', '58.481%']
Workers federated accuracies:  ['40.920%', '42.096%', '42.717%', '43.936%', '44.535%', '45.241%', '46.011%', '47.979%', '50.631%', '50.717%', '49.711%', '50.545%', '50.824%', '50.075%', '52.492%', '53.861%', '53.861%', '53.348%', '58.866%', '58.481%']
Workers improved  accuracies:  ['1.241%', '2.289%', '2.866%', '4.000%', '4.578%', '5.219%', '5.861%', '7.658%', '10.118%', '10.160%', '9.262%', '9.947%', '10.225%', '9.540%', '11.679%', '13.070%', '13.027%', '12.471%', '17.219%', '16.963%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.508471. Accuracy: 75.2513%.
Workers before    accuracies:  ['39.679%', '39.807%', '39.850%', '39.936%', '39.957%', '40.021%', '40.150%', '40.321%', '40.513%', '40.556%', '40.449%', '40.599%', '40.599%', '40.535%', '40.813%', '40.791%', '40.834%', '40.877%', '41.647%', '41.519%']
Workers standlone accuracies:  ['40.920%', '42.096%', '42.717%', '43.936%', '44.535%', '45.241%', '46.011%', '47.979%', '50.631%', '50.717%', '49.711%', '50.545%', '50.824%', '50.075%', '52.492%', '53.861%', '53.861%', '53.348%', '58.866%', '58.481%']
Workers federated accuracies:  ['40.920%', '42.096%', '42.717%', '43.936%', '44.535%', '45.241%', '46.011%', '47.979%', '50.631%', '50.717%', '49.711%', '50.545%', '50.824%', '50.075%', '52.492%', '53.861%', '53.861%', '53.348%', '58.866%', '58.481%']
Workers improved  accuracies:  ['1.241%', '2.289%', '2.866%', '4.000%', '4.578%', '5.219%', '5.861%', '7.658%', '10.118%', '10.160%', '9.262%', '9.947%', '10.225%', '9.540%', '11.679%', '13.070%', '13.027%', '12.471%', '17.219%', '16.963%']
Workers shard sizes:  [32, 48, 80, 96, 112, 144, 160, 176, 208, 224, 240, 272, 288, 304, 320, 352, 368, 384, 416, 416]
Workers sharing_contributions :  tensor([ 1.6000,  2.4000,  4.0000,  4.8000,  5.6000,  7.2000,  8.0000,  8.8000,
        10.4000, 11.2000, 12.0000, 13.6000, 14.4000, 15.2000, 16.0000, 17.6000,
        18.4000, 19.2000, 20.8000, 20.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.4891991431295706, 0.02859293825939108)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9712479619767803, 1.149047231683129e-12)
Correlation between test_acc improvements & sharing_contributions:  (0.9721435636352608, 8.670959759256241e-13)
standalone_vs_final_corr [[1.0], [1.0], [1.0], [0.9999999999999998], [1.0]]
standalone_vs_final_corr_mean [1.0]
standalone_vs_final_corr_std [9.930136612989092e-17]
sharingcontribution_vs_final_corr [[0.9753821216378725], [0.9706547863169714], [0.9719977197854344], [0.9719039991895451], [0.9712479619767803]]
sharingcontribution_vs_final_corr_mean [0.9722373177813207]
sharingcontribution_vs_final_corr_std [0.0016456931988115173]
standalone_vs_federated_perturbed_corr [[0.4203374585675923], [0.02602847949396464], [0.018643147135664853], [0.1568032819100949], [-0.4891991431295706]]
standalone_vs_federated_perturbed_corr_mean [0.02652264479554922]
standalone_vs_federated_perturbed_corr_std [0.2960048800870285]
federated_final_performance [0.7681283354759216, 0.7567914724349976, 0.755294144153595, 0.7550802230834961, 0.7525133490562439]
federated_final_performance_mean 0.7575615048408508
federated_final_performance_std 0.005459531482599769
CFFL_best_worker [0.6423529386520386, 0.6545454263687134, 0.5993582606315613, 0.6611764430999756, 0.5886631011962891]
CFFL_best_worker_mean 0.6292192339897156
CFFL_best_worker_std 0.029569075297501145
standalone_best_worker [0.6423529386520386, 0.6545454263687134, 0.5993582606315613, 0.6611764430999756, 0.5886631011962891]
standalone_best_worker_mean 0.6292192339897156
standalone_best_worker_std 0.029569075297501145
