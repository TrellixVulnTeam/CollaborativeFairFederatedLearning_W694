Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 20, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.687680. Accuracy: 61.5615%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.6000%
Leave-one-out validation accuracies :  ['71.7000%', '71.7000%', '71.8000%', '71.8000%', '71.8000%', '72.3000%', '72.2000%', '72.3000%', '72.8000%', '72.7000%', '73.4000%', '73.6000%', '74.3000%', '74.7000%', '74.8000%', '75.2000%', '75.7000%', '76.3000%', '76.4000%', '76.8000%']
Computed and normalized credits:  tensor([0.0523, 0.0523, 0.0522, 0.0522, 0.0522, 0.0516, 0.0517, 0.0516, 0.0510,
        0.0511, 0.0502, 0.0500, 0.0491, 0.0487, 0.0485, 0.0481, 0.0475, 0.0468,
        0.0467, 0.0462])
Federated model performance: Loss: 0.593748. Accuracy: 71.5722%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['60.428%', '60.620%', '60.834%', '61.433%', '61.497%', '61.861%', '61.818%', '62.353%', '62.246%', '62.545%', '63.166%', '62.952%', '63.316%', '63.251%', '63.636%', '63.872%', '64.321%', '63.487%', '64.449%', '64.920%']
Workers federated accuracies:  ['60.428%', '60.620%', '60.834%', '61.433%', '61.497%', '61.861%', '61.818%', '62.353%', '62.246%', '62.545%', '63.166%', '62.952%', '63.316%', '63.251%', '63.636%', '63.872%', '64.321%', '63.487%', '64.449%', '64.920%']
Workers improved  accuracies:  ['0.193%', '0.214%', '0.406%', '0.813%', '0.727%', '0.791%', '0.749%', '1.091%', '0.941%', '1.048%', '1.433%', '1.348%', '1.583%', '1.348%', '1.690%', '1.733%', '2.075%', '1.476%', '2.053%', '2.310%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 2:
Federated model validation accuracy : 74.8000%
Leave-one-out validation accuracies :  ['74.8000%', '74.9000%', '74.9000%', '74.9000%', '75.0000%', '75.2000%', '75.3000%', '75.6000%', '75.8000%', '76.0000%', '76.2000%', '76.5000%', '76.7000%', '76.7000%', '76.9000%', '76.9000%', '77.2000%', '77.2000%', '77.2000%', '77.2000%']
Computed and normalized credits:  tensor([0.0517, 0.0516, 0.0515, 0.0515, 0.0514, 0.0511, 0.0510, 0.0507, 0.0504,
        0.0502, 0.0498, 0.0495, 0.0492, 0.0491, 0.0489, 0.0488, 0.0485, 0.0484,
        0.0484, 0.0483])
Federated model performance: Loss: 0.536062. Accuracy: 74.2888%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['60.513%', '61.027%', '61.027%', '62.032%', '61.882%', '62.738%', '62.545%', '63.422%', '63.059%', '63.872%', '64.449%', '64.128%', '64.684%', '64.941%', '65.112%', '65.561%', '65.882%', '65.348%', '66.396%', '66.845%']
Workers federated accuracies:  ['60.513%', '61.027%', '61.027%', '62.032%', '61.882%', '62.738%', '62.545%', '63.422%', '63.059%', '63.872%', '64.449%', '64.128%', '64.684%', '64.941%', '65.112%', '65.561%', '65.882%', '65.348%', '66.396%', '66.845%']
Workers improved  accuracies:  ['0.278%', '0.620%', '0.599%', '1.412%', '1.112%', '1.668%', '1.476%', '2.160%', '1.754%', '2.374%', '2.717%', '2.524%', '2.952%', '3.037%', '3.166%', '3.422%', '3.636%', '3.337%', '4.000%', '4.235%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 3:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['77.0000%', '77.0000%', '77.0000%', '77.1000%', '77.2000%', '77.1000%', '77.0000%', '77.1000%', '77.2000%', '77.2000%', '77.1000%', '77.1000%', '77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.5000%', '77.3000%', '77.4000%', '77.6000%']
Computed and normalized credits:  tensor([0.0504, 0.0503, 0.0503, 0.0502, 0.0501, 0.0502, 0.0503, 0.0502, 0.0500,
        0.0500, 0.0501, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0495, 0.0497,
        0.0496, 0.0494])
Federated model performance: Loss: 0.503640. Accuracy: 75.3369%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['60.727%', '61.155%', '61.433%', '62.631%', '62.524%', '63.594%', '63.273%', '64.299%', '64.171%', '64.941%', '65.626%', '65.048%', '66.053%', '66.182%', '66.631%', '67.037%', '67.551%', '66.652%', '68.278%', '68.535%']
Workers federated accuracies:  ['60.727%', '61.155%', '61.433%', '62.631%', '62.524%', '63.594%', '63.273%', '64.299%', '64.171%', '64.941%', '65.626%', '65.048%', '66.053%', '66.182%', '66.631%', '67.037%', '67.551%', '66.652%', '68.278%', '68.535%']
Workers improved  accuracies:  ['0.492%', '0.749%', '1.005%', '2.011%', '1.754%', '2.524%', '2.203%', '3.037%', '2.866%', '3.444%', '3.893%', '3.444%', '4.321%', '4.278%', '4.684%', '4.898%', '5.305%', '4.642%', '5.882%', '5.925%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 4:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.2000%', '77.3000%', '77.2000%', '77.2000%', '77.2000%', '77.4000%', '77.3000%', '77.2000%', '77.2000%', '77.3000%', '77.5000%', '77.5000%', '77.5000%', '77.4000%', '77.2000%', '77.2000%', '77.5000%', '77.6000%', '77.6000%', '77.9000%']
Computed and normalized credits:  tensor([0.0502, 0.0501, 0.0502, 0.0502, 0.0502, 0.0500, 0.0501, 0.0502, 0.0502,
        0.0501, 0.0499, 0.0499, 0.0498, 0.0500, 0.0502, 0.0502, 0.0498, 0.0497,
        0.0497, 0.0494])
Federated model performance: Loss: 0.489590. Accuracy: 76.0000%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['60.877%', '61.390%', '61.733%', '63.187%', '62.973%', '64.385%', '64.000%', '65.176%', '65.262%', '65.968%', '66.845%', '66.203%', '67.422%', '67.615%', '68.021%', '68.257%', '68.898%', '68.107%', '69.647%', '69.861%']
Workers federated accuracies:  ['60.877%', '61.390%', '61.733%', '63.187%', '62.973%', '64.385%', '64.000%', '65.176%', '65.262%', '65.968%', '66.845%', '66.203%', '67.422%', '67.615%', '68.021%', '68.257%', '68.898%', '68.107%', '69.647%', '69.861%']
Workers improved  accuracies:  ['0.642%', '0.984%', '1.305%', '2.567%', '2.203%', '3.316%', '2.930%', '3.914%', '3.957%', '4.471%', '5.112%', '4.599%', '5.690%', '5.711%', '6.075%', '6.118%', '6.652%', '6.096%', '7.251%', '7.251%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 5:
Federated model validation accuracy : 77.7000%
Leave-one-out validation accuracies :  ['77.7000%', '77.6000%', '77.7000%', '77.7000%', '77.7000%', '77.4000%', '77.4000%', '77.5000%', '77.7000%', '77.6000%', '77.7000%', '77.8000%', '78.0000%', '78.0000%', '78.2000%', '78.2000%', '78.2000%', '78.1000%', '78.1000%', '78.3000%']
Computed and normalized credits:  tensor([0.0502, 0.0503, 0.0502, 0.0502, 0.0502, 0.0505, 0.0505, 0.0504, 0.0502,
        0.0503, 0.0501, 0.0500, 0.0498, 0.0498, 0.0496, 0.0496, 0.0496, 0.0497,
        0.0497, 0.0494])
Federated model performance: Loss: 0.486537. Accuracy: 76.2567%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['61.091%', '61.818%', '61.925%', '63.572%', '63.316%', '65.112%', '64.813%', '66.246%', '65.989%', '67.037%', '67.936%', '67.187%', '68.385%', '68.706%', '69.262%', '69.775%', '70.225%', '69.198%', '70.845%', '70.909%']
Workers federated accuracies:  ['61.091%', '61.818%', '61.925%', '63.572%', '63.316%', '65.112%', '64.813%', '66.246%', '65.989%', '67.037%', '67.936%', '67.187%', '68.385%', '68.706%', '69.262%', '69.775%', '70.225%', '69.198%', '70.845%', '70.909%']
Workers improved  accuracies:  ['0.856%', '1.412%', '1.497%', '2.952%', '2.545%', '4.043%', '3.743%', '4.984%', '4.684%', '5.540%', '6.203%', '5.583%', '6.652%', '6.802%', '7.316%', '7.636%', '7.979%', '7.187%', '8.449%', '8.299%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 6:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.2000%', '78.2000%', '78.2000%', '78.1000%', '78.1000%', '78.1000%', '78.1000%', '78.1000%', '78.1000%', '78.1000%', '78.2000%', '78.2000%', '78.4000%', '78.4000%', '78.5000%', '78.4000%', '78.4000%', '78.4000%']
Computed and normalized credits:  tensor([0.0502, 0.0503, 0.0500, 0.0500, 0.0500, 0.0502, 0.0502, 0.0502, 0.0501,
        0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0498, 0.0498, 0.0496, 0.0498,
        0.0498, 0.0497])
Federated model performance: Loss: 0.491489. Accuracy: 76.3850%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['61.134%', '62.053%', '62.182%', '64.021%', '63.850%', '65.968%', '65.390%', '67.037%', '66.652%', '67.872%', '68.920%', '68.278%', '69.369%', '69.861%', '70.118%', '70.631%', '71.187%', '70.118%', '71.380%', '71.551%']
Workers federated accuracies:  ['61.134%', '62.053%', '62.182%', '64.021%', '63.850%', '65.968%', '65.390%', '67.037%', '66.652%', '67.872%', '68.920%', '68.278%', '69.369%', '69.861%', '70.118%', '70.631%', '71.187%', '70.118%', '71.380%', '71.551%']
Workers improved  accuracies:  ['0.898%', '1.647%', '1.754%', '3.401%', '3.080%', '4.898%', '4.321%', '5.775%', '5.348%', '6.374%', '7.187%', '6.674%', '7.636%', '7.957%', '8.171%', '8.492%', '8.941%', '8.107%', '8.984%', '8.941%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 7:
Federated model validation accuracy : 78.3000%
Leave-one-out validation accuracies :  ['78.3000%', '78.4000%', '78.4000%', '78.6000%', '78.5000%', '78.5000%', '78.5000%', '78.5000%', '78.4000%', '78.5000%', '78.6000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.5000%', '78.6000%', '78.5000%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.0502, 0.0501, 0.0501, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
        0.0500, 0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0498, 0.0500,
        0.0498, 0.0498])
Federated model performance: Loss: 0.501831. Accuracy: 76.6417%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['61.283%', '62.267%', '62.503%', '64.663%', '64.492%', '66.631%', '66.246%', '67.893%', '67.508%', '68.684%', '69.861%', '69.091%', '69.925%', '70.631%', '70.973%', '71.358%', '71.786%', '70.802%', '71.872%', '72.107%']
Workers federated accuracies:  ['61.283%', '62.267%', '62.503%', '64.663%', '64.492%', '66.631%', '66.246%', '67.893%', '67.508%', '68.684%', '69.861%', '69.091%', '69.925%', '70.631%', '70.973%', '71.358%', '71.786%', '70.802%', '71.872%', '72.107%']
Workers improved  accuracies:  ['1.048%', '1.861%', '2.075%', '4.043%', '3.722%', '5.561%', '5.176%', '6.631%', '6.203%', '7.187%', '8.128%', '7.487%', '8.193%', '8.727%', '9.027%', '9.219%', '9.540%', '8.791%', '9.476%', '9.497%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 8:
Federated model validation accuracy : 78.5000%
Leave-one-out validation accuracies :  ['78.5000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.7000%', '78.7000%', '78.8000%', '78.8000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.7000%', '78.8000%', '78.9000%', '78.9000%']
Computed and normalized credits:  tensor([0.0502, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0499,
        0.0499, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499,
        0.0497, 0.0497])
Federated model performance: Loss: 0.515513. Accuracy: 76.6417%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['61.390%', '62.524%', '62.759%', '65.091%', '65.005%', '67.209%', '66.952%', '68.449%', '68.257%', '69.540%', '70.695%', '69.754%', '70.631%', '71.123%', '71.636%', '71.914%', '72.214%', '71.615%', '72.492%', '72.535%']
Workers federated accuracies:  ['61.390%', '62.524%', '62.759%', '65.091%', '65.005%', '67.209%', '66.952%', '68.449%', '68.257%', '69.540%', '70.695%', '69.754%', '70.631%', '71.123%', '71.636%', '71.914%', '72.214%', '71.615%', '72.492%', '72.535%']
Workers improved  accuracies:  ['1.155%', '2.118%', '2.332%', '4.471%', '4.235%', '6.139%', '5.882%', '7.187%', '6.952%', '8.043%', '8.963%', '8.150%', '8.898%', '9.219%', '9.690%', '9.775%', '9.968%', '9.604%', '10.096%', '9.925%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 9:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.6000%', '78.7000%', '78.7000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.7000%', '78.7000%', '78.7000%', '78.7000%', '78.7000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499,
        0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499,
        0.0499, 0.0499])
Federated model performance: Loss: 0.531625. Accuracy: 76.7059%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['61.455%', '62.674%', '63.080%', '65.369%', '65.348%', '67.850%', '67.529%', '69.048%', '68.963%', '70.182%', '70.995%', '70.503%', '71.294%', '71.722%', '72.064%', '72.214%', '72.620%', '72.107%', '72.856%', '73.070%']
Workers federated accuracies:  ['61.455%', '62.674%', '63.080%', '65.369%', '65.348%', '67.850%', '67.529%', '69.048%', '68.963%', '70.182%', '70.995%', '70.503%', '71.294%', '71.722%', '72.064%', '72.214%', '72.620%', '72.107%', '72.856%', '73.070%']
Workers improved  accuracies:  ['1.219%', '2.267%', '2.652%', '4.749%', '4.578%', '6.781%', '6.460%', '7.786%', '7.658%', '8.684%', '9.262%', '8.898%', '9.561%', '9.818%', '10.118%', '10.075%', '10.374%', '10.096%', '10.460%', '10.460%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 10:
Federated model validation accuracy : 78.7000%
Leave-one-out validation accuracies :  ['78.7000%', '78.7000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.7000%', '78.8000%', '78.8000%', '78.9000%', '79.0000%', '79.1000%', '79.1000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0500, 0.0500, 0.0499, 0.0498,
        0.0497, 0.0497])
Federated model performance: Loss: 0.548557. Accuracy: 76.7487%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['61.604%', '62.888%', '63.594%', '65.818%', '65.733%', '68.385%', '68.128%', '69.561%', '69.668%', '70.759%', '71.529%', '71.102%', '71.893%', '72.278%', '72.428%', '72.706%', '73.176%', '72.449%', '73.219%', '73.412%']
Workers federated accuracies:  ['61.604%', '62.888%', '63.594%', '65.818%', '65.733%', '68.385%', '68.128%', '69.561%', '69.668%', '70.759%', '71.529%', '71.102%', '71.893%', '72.278%', '72.428%', '72.706%', '73.176%', '72.449%', '73.219%', '73.412%']
Workers improved  accuracies:  ['1.369%', '2.481%', '3.166%', '5.198%', '4.963%', '7.316%', '7.059%', '8.299%', '8.364%', '9.262%', '9.797%', '9.497%', '10.160%', '10.374%', '10.481%', '10.567%', '10.930%', '10.439%', '10.824%', '10.802%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.548557. Accuracy: 76.7487%.
Workers before    accuracies:  ['60.235%', '60.406%', '60.428%', '60.620%', '60.770%', '61.070%', '61.070%', '61.262%', '61.305%', '61.497%', '61.733%', '61.604%', '61.733%', '61.904%', '61.947%', '62.139%', '62.246%', '62.011%', '62.396%', '62.610%']
Workers standlone accuracies:  ['61.604%', '62.888%', '63.594%', '65.818%', '65.733%', '68.385%', '68.128%', '69.561%', '69.668%', '70.759%', '71.529%', '71.102%', '71.893%', '72.278%', '72.428%', '72.706%', '73.176%', '72.449%', '73.219%', '73.412%']
Workers federated accuracies:  ['61.604%', '62.888%', '63.594%', '65.818%', '65.733%', '68.385%', '68.128%', '69.561%', '69.668%', '70.759%', '71.529%', '71.102%', '71.893%', '72.278%', '72.428%', '72.706%', '73.176%', '72.449%', '73.219%', '73.412%']
Workers improved  accuracies:  ['1.369%', '2.481%', '3.166%', '5.198%', '4.963%', '7.316%', '7.059%', '8.299%', '8.364%', '9.262%', '9.797%', '9.497%', '10.160%', '10.374%', '10.481%', '10.567%', '10.930%', '10.439%', '10.824%', '10.802%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]
Workers sharing_contributions :  tensor([ 3.2000,  4.8000,  7.2000,  9.6000, 11.2000, 13.6000, 15.2000, 17.6000,
        20.0000, 21.6000, 24.0000, 26.4000, 28.0000, 30.4000, 32.0000, 34.4000,
        36.8000, 38.4000, 40.8000, 42.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.5480275809760834, 0.012363291702282383)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999998, 1.2459683851238692e-139)
Correlation between test_acc & sharing contributions:  (0.9408534809461744, 6.780694069020567e-10)
Correlation between test_acc improvements & sharing_contributions:  (0.9214884974651284, 8.074965658762357e-09)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.749395. Accuracy: 54.3529%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 67.9000%
Leave-one-out validation accuracies :  ['67.9000%', '67.9000%', '68.6000%', '68.6000%', '68.8000%', '69.2000%', '69.5000%', '69.5000%', '70.0000%', '70.0000%', '70.0000%', '70.1000%', '70.6000%', '70.7000%', '71.1000%', '71.2000%', '71.5000%', '71.7000%', '71.7000%', '71.8000%']
Computed and normalized credits:  tensor([0.0527, 0.0527, 0.0518, 0.0518, 0.0516, 0.0510, 0.0507, 0.0507, 0.0500,
        0.0500, 0.0500, 0.0499, 0.0492, 0.0491, 0.0486, 0.0485, 0.0481, 0.0479,
        0.0479, 0.0477])
Federated model performance: Loss: 0.650579. Accuracy: 69.4759%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['53.262%', '53.604%', '53.775%', '54.182%', '54.695%', '54.866%', '55.337%', '55.722%', '55.979%', '56.578%', '56.813%', '56.834%', '56.706%', '57.540%', '57.540%', '57.647%', '57.989%', '58.182%', '58.460%', '58.267%']
Workers federated accuracies:  ['53.262%', '53.604%', '53.775%', '54.182%', '54.695%', '54.866%', '55.337%', '55.722%', '55.979%', '56.578%', '56.813%', '56.834%', '56.706%', '57.540%', '57.540%', '57.647%', '57.989%', '58.182%', '58.460%', '58.267%']
Workers improved  accuracies:  ['0.107%', '0.321%', '0.428%', '0.642%', '1.070%', '1.091%', '1.390%', '1.604%', '1.904%', '2.053%', '2.075%', '1.947%', '1.968%', '2.139%', '2.246%', '2.053%', '2.096%', '2.246%', '2.353%', '2.225%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 2:
Federated model validation accuracy : 71.1000%
Leave-one-out validation accuracies :  ['71.1000%', '71.3000%', '71.3000%', '71.3000%', '71.4000%', '71.4000%', '71.4000%', '71.6000%', '71.8000%', '71.8000%', '71.9000%', '71.7000%', '71.9000%', '71.8000%', '71.8000%', '72.0000%', '72.0000%', '72.5000%', '72.3000%', '72.6000%']
Computed and normalized credits:  tensor([0.0510, 0.0508, 0.0507, 0.0507, 0.0506, 0.0505, 0.0505, 0.0502, 0.0499,
        0.0499, 0.0498, 0.0500, 0.0497, 0.0499, 0.0498, 0.0496, 0.0495, 0.0489,
        0.0491, 0.0488])
Federated model performance: Loss: 0.601865. Accuracy: 73.7112%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['53.348%', '53.968%', '54.225%', '55.102%', '55.786%', '56.107%', '56.364%', '56.834%', '57.070%', '57.989%', '58.011%', '58.267%', '58.053%', '59.316%', '59.273%', '59.487%', '60.214%', '60.513%', '60.963%', '60.727%']
Workers federated accuracies:  ['53.348%', '53.968%', '54.225%', '55.102%', '55.786%', '56.107%', '56.364%', '56.834%', '57.070%', '57.989%', '58.011%', '58.267%', '58.053%', '59.316%', '59.273%', '59.487%', '60.214%', '60.513%', '60.963%', '60.727%']
Workers improved  accuracies:  ['0.193%', '0.684%', '0.877%', '1.561%', '2.160%', '2.332%', '2.417%', '2.717%', '2.995%', '3.465%', '3.273%', '3.380%', '3.316%', '3.914%', '3.979%', '3.893%', '4.321%', '4.578%', '4.856%', '4.684%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 3:
Federated model validation accuracy : 72.0000%
Leave-one-out validation accuracies :  ['72.0000%', '72.1000%', '72.0000%', '71.9000%', '72.0000%', '71.9000%', '71.9000%', '71.8000%', '72.1000%', '72.3000%', '72.4000%', '72.2000%', '72.3000%', '72.4000%', '72.6000%', '72.7000%', '72.7000%', '72.8000%', '72.8000%', '73.0000%']
Computed and normalized credits:  tensor([0.0504, 0.0503, 0.0504, 0.0505, 0.0504, 0.0505, 0.0505, 0.0506, 0.0502,
        0.0500, 0.0499, 0.0501, 0.0500, 0.0499, 0.0496, 0.0495, 0.0495, 0.0493,
        0.0493, 0.0491])
Federated model performance: Loss: 0.587993. Accuracy: 74.7380%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['53.476%', '54.374%', '54.930%', '56.021%', '56.706%', '56.813%', '57.326%', '57.968%', '57.989%', '59.209%', '59.701%', '59.829%', '59.487%', '61.433%', '61.176%', '61.412%', '62.289%', '62.610%', '62.909%', '62.674%']
Workers federated accuracies:  ['53.476%', '54.374%', '54.930%', '56.021%', '56.706%', '56.813%', '57.326%', '57.968%', '57.989%', '59.209%', '59.701%', '59.829%', '59.487%', '61.433%', '61.176%', '61.412%', '62.289%', '62.610%', '62.909%', '62.674%']
Workers improved  accuracies:  ['0.321%', '1.091%', '1.583%', '2.481%', '3.080%', '3.037%', '3.380%', '3.850%', '3.914%', '4.684%', '4.963%', '4.941%', '4.749%', '6.032%', '5.882%', '5.818%', '6.396%', '6.674%', '6.802%', '6.631%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 4:
Federated model validation accuracy : 72.5000%
Leave-one-out validation accuracies :  ['72.5000%', '72.6000%', '72.7000%', '72.6000%', '72.6000%', '72.8000%', '72.7000%', '72.8000%', '72.9000%', '72.9000%', '72.9000%', '72.9000%', '72.9000%', '72.9000%', '73.0000%', '73.1000%', '73.1000%', '73.2000%', '73.3000%', '73.2000%']
Computed and normalized credits:  tensor([0.0505, 0.0504, 0.0503, 0.0504, 0.0504, 0.0501, 0.0503, 0.0501, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498, 0.0497, 0.0497, 0.0496,
        0.0494, 0.0495])
Federated model performance: Loss: 0.598026. Accuracy: 74.9091%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['53.583%', '54.695%', '55.572%', '56.578%', '57.241%', '57.690%', '57.947%', '59.209%', '59.102%', '60.856%', '61.348%', '61.433%', '61.027%', '62.674%', '62.717%', '62.759%', '63.936%', '64.278%', '64.727%', '64.235%']
Workers federated accuracies:  ['53.583%', '54.695%', '55.572%', '56.578%', '57.241%', '57.690%', '57.947%', '59.209%', '59.102%', '60.856%', '61.348%', '61.433%', '61.027%', '62.674%', '62.717%', '62.759%', '63.936%', '64.278%', '64.727%', '64.235%']
Workers improved  accuracies:  ['0.428%', '1.412%', '2.225%', '3.037%', '3.615%', '3.914%', '4.000%', '5.091%', '5.027%', '6.332%', '6.610%', '6.545%', '6.289%', '7.273%', '7.422%', '7.166%', '8.043%', '8.342%', '8.620%', '8.193%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 5:
Federated model validation accuracy : 72.9000%
Leave-one-out validation accuracies :  ['72.9000%', '72.9000%', '72.9000%', '73.0000%', '73.0000%', '73.0000%', '73.1000%', '73.2000%', '73.3000%', '73.3000%', '73.2000%', '73.3000%', '73.5000%', '73.5000%', '73.5000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.5000%']
Computed and normalized credits:  tensor([0.0505, 0.0505, 0.0505, 0.0504, 0.0504, 0.0503, 0.0502, 0.0501, 0.0500,
        0.0500, 0.0501, 0.0500, 0.0497, 0.0497, 0.0497, 0.0496, 0.0496, 0.0496,
        0.0496, 0.0497])
Federated model performance: Loss: 0.624009. Accuracy: 75.1658%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['53.775%', '55.080%', '55.979%', '57.048%', '57.882%', '58.567%', '58.909%', '60.342%', '60.257%', '62.032%', '62.396%', '62.567%', '62.438%', '63.957%', '64.086%', '64.342%', '65.925%', '66.160%', '66.695%', '66.203%']
Workers federated accuracies:  ['53.775%', '55.080%', '55.979%', '57.048%', '57.882%', '58.567%', '58.909%', '60.342%', '60.257%', '62.032%', '62.396%', '62.567%', '62.438%', '63.957%', '64.086%', '64.342%', '65.925%', '66.160%', '66.695%', '66.203%']
Workers improved  accuracies:  ['0.620%', '1.797%', '2.631%', '3.508%', '4.257%', '4.791%', '4.963%', '6.225%', '6.182%', '7.508%', '7.658%', '7.679%', '7.701%', '8.556%', '8.791%', '8.749%', '10.032%', '10.225%', '10.588%', '10.160%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 6:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.4000%', '73.6000%', '73.6000%', '73.6000%', '73.8000%', '73.7000%', '73.7000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.7000%', '73.6000%', '73.4000%', '73.6000%', '73.4000%', '73.6000%', '73.6000%', '73.6000%']
Computed and normalized credits:  tensor([0.0503, 0.0500, 0.0500, 0.0500, 0.0498, 0.0499, 0.0499, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0502, 0.0500, 0.0502, 0.0500,
        0.0500, 0.0500])
Federated model performance: Loss: 0.658825. Accuracy: 75.2299%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['53.904%', '55.444%', '56.513%', '57.519%', '58.588%', '59.380%', '59.872%', '61.348%', '61.369%', '63.316%', '63.273%', '63.572%', '63.380%', '65.283%', '65.262%', '65.690%', '67.251%', '67.872%', '68.813%', '67.957%']
Workers federated accuracies:  ['53.904%', '55.444%', '56.513%', '57.519%', '58.588%', '59.380%', '59.872%', '61.348%', '61.369%', '63.316%', '63.273%', '63.572%', '63.380%', '65.283%', '65.262%', '65.690%', '67.251%', '67.872%', '68.813%', '67.957%']
Workers improved  accuracies:  ['0.749%', '2.160%', '3.166%', '3.979%', '4.963%', '5.604%', '5.925%', '7.230%', '7.294%', '8.791%', '8.535%', '8.684%', '8.642%', '9.882%', '9.968%', '10.096%', '11.358%', '11.936%', '12.706%', '11.914%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 7:
Federated model validation accuracy : 73.5000%
Leave-one-out validation accuracies :  ['73.5000%', '73.5000%', '73.5000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.5000%', '73.5000%', '73.3000%', '73.4000%', '73.5000%', '73.5000%', '73.5000%', '73.5000%', '73.5000%', '73.6000%', '73.7000%', '73.7000%']
Computed and normalized credits:  tensor([0.0501, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0500,
        0.0500, 0.0503, 0.0502, 0.0500, 0.0500, 0.0501, 0.0500, 0.0501, 0.0499,
        0.0498, 0.0498])
Federated model performance: Loss: 0.697163. Accuracy: 75.1016%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['54.032%', '55.850%', '56.920%', '58.139%', '59.187%', '60.107%', '60.642%', '62.353%', '62.267%', '64.278%', '64.471%', '64.941%', '64.492%', '66.759%', '66.824%', '67.187%', '68.963%', '69.561%', '69.947%', '69.497%']
Workers federated accuracies:  ['54.032%', '55.850%', '56.920%', '58.139%', '59.187%', '60.107%', '60.642%', '62.353%', '62.267%', '64.278%', '64.471%', '64.941%', '64.492%', '66.759%', '66.824%', '67.187%', '68.963%', '69.561%', '69.947%', '69.497%']
Workers improved  accuracies:  ['0.877%', '2.567%', '3.572%', '4.599%', '5.562%', '6.332%', '6.695%', '8.235%', '8.193%', '9.754%', '9.733%', '10.053%', '9.754%', '11.358%', '11.529%', '11.594%', '13.070%', '13.626%', '13.840%', '13.455%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 8:
Federated model validation accuracy : 73.7000%
Leave-one-out validation accuracies :  ['73.7000%', '73.7000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.5000%', '73.5000%', '73.4000%', '73.4000%', '73.5000%', '73.6000%', '73.5000%', '73.5000%', '73.5000%', '73.6000%', '73.6000%', '73.7000%', '73.7000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
        0.0502, 0.0502, 0.0501, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500,
        0.0498, 0.0498])
Federated model performance: Loss: 0.736144. Accuracy: 75.2299%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['54.118%', '56.043%', '57.262%', '58.717%', '59.936%', '60.963%', '61.626%', '63.037%', '63.380%', '65.283%', '65.348%', '65.925%', '65.497%', '68.107%', '68.150%', '69.070%', '70.075%', '70.781%', '71.123%', '70.674%']
Workers federated accuracies:  ['54.118%', '56.043%', '57.262%', '58.717%', '59.936%', '60.963%', '61.626%', '63.037%', '63.380%', '65.283%', '65.348%', '65.925%', '65.497%', '68.107%', '68.150%', '69.070%', '70.075%', '70.781%', '71.123%', '70.674%']
Workers improved  accuracies:  ['0.963%', '2.759%', '3.914%', '5.176%', '6.310%', '7.187%', '7.679%', '8.920%', '9.305%', '10.759%', '10.610%', '11.037%', '10.759%', '12.706%', '12.856%', '13.476%', '14.182%', '14.845%', '15.016%', '14.631%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 9:
Federated model validation accuracy : 73.7000%
Leave-one-out validation accuracies :  ['73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.6000%', '73.6000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.8000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501,
        0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0499])
Federated model performance: Loss: 0.777534. Accuracy: 75.3797%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['54.203%', '56.471%', '57.626%', '59.144%', '60.513%', '61.733%', '62.310%', '63.765%', '64.021%', '66.267%', '66.417%', '67.037%', '66.888%', '69.219%', '69.433%', '70.310%', '71.294%', '71.850%', '71.786%', '71.337%']
Workers federated accuracies:  ['54.203%', '56.471%', '57.626%', '59.144%', '60.513%', '61.733%', '62.310%', '63.765%', '64.021%', '66.267%', '66.417%', '67.037%', '66.888%', '69.219%', '69.433%', '70.310%', '71.294%', '71.850%', '71.786%', '71.337%']
Workers improved  accuracies:  ['1.048%', '3.187%', '4.278%', '5.604%', '6.888%', '7.957%', '8.364%', '9.647%', '9.947%', '11.743%', '11.679%', '12.150%', '12.150%', '13.818%', '14.139%', '14.717%', '15.401%', '15.914%', '15.679%', '15.294%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 10:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.8000%', '73.7000%', '73.7000%', '73.7000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.6000%', '73.7000%', '73.7000%', '73.7000%', '73.7000%', '73.8000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500,
        0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0499])
Federated model performance: Loss: 0.818949. Accuracy: 75.4652%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['54.524%', '56.727%', '57.840%', '59.743%', '61.369%', '62.353%', '62.995%', '64.492%', '64.791%', '67.294%', '67.337%', '68.428%', '68.064%', '70.460%', '70.674%', '71.123%', '71.914%', '72.492%', '72.513%', '72.064%']
Workers federated accuracies:  ['54.524%', '56.727%', '57.840%', '59.743%', '61.369%', '62.353%', '62.995%', '64.492%', '64.791%', '67.294%', '67.337%', '68.428%', '68.064%', '70.460%', '70.674%', '71.123%', '71.914%', '72.492%', '72.513%', '72.064%']
Workers improved  accuracies:  ['1.369%', '3.444%', '4.492%', '6.203%', '7.743%', '8.578%', '9.048%', '10.374%', '10.717%', '12.770%', '12.599%', '13.540%', '13.326%', '15.059%', '15.380%', '15.529%', '16.021%', '16.556%', '16.406%', '16.021%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.818949. Accuracy: 75.4652%.
Workers before    accuracies:  ['53.155%', '53.283%', '53.348%', '53.540%', '53.626%', '53.775%', '53.947%', '54.118%', '54.075%', '54.524%', '54.738%', '54.888%', '54.738%', '55.401%', '55.294%', '55.594%', '55.893%', '55.936%', '56.107%', '56.043%']
Workers standlone accuracies:  ['54.524%', '56.727%', '57.840%', '59.743%', '61.369%', '62.353%', '62.995%', '64.492%', '64.791%', '67.294%', '67.337%', '68.428%', '68.064%', '70.460%', '70.674%', '71.123%', '71.914%', '72.492%', '72.513%', '72.064%']
Workers federated accuracies:  ['54.524%', '56.727%', '57.840%', '59.743%', '61.369%', '62.353%', '62.995%', '64.492%', '64.791%', '67.294%', '67.337%', '68.428%', '68.064%', '70.460%', '70.674%', '71.123%', '71.914%', '72.492%', '72.513%', '72.064%']
Workers improved  accuracies:  ['1.369%', '3.444%', '4.492%', '6.203%', '7.743%', '8.578%', '9.048%', '10.374%', '10.717%', '12.770%', '12.599%', '13.540%', '13.326%', '15.059%', '15.380%', '15.529%', '16.021%', '16.556%', '16.406%', '16.021%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]
Workers sharing_contributions :  tensor([ 3.2000,  4.8000,  7.2000,  9.6000, 11.2000, 13.6000, 15.2000, 17.6000,
        20.0000, 21.6000, 24.0000, 26.4000, 28.0000, 30.4000, 32.0000, 34.4000,
        36.8000, 38.4000, 40.8000, 42.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.01865145588005155, 0.9377903869802116)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999999, 2.4335320021950577e-142)
Correlation between test_acc & sharing contributions:  (0.977318980779798, 1.3895626062391444e-13)
Correlation between test_acc improvements & sharing_contributions:  (0.9660022291164025, 5.094057088029223e-12)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.691156. Accuracy: 54.2246%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.8000%
Leave-one-out validation accuracies :  ['71.8000%', '72.0000%', '72.6000%', '72.9000%', '73.5000%', '73.8000%', '73.7000%', '73.5000%', '73.7000%', '74.3000%', '74.3000%', '74.1000%', '74.1000%', '74.0000%', '73.7000%', '73.5000%', '73.1000%', '73.2000%', '72.9000%', '72.8000%']
Computed and normalized credits:  tensor([0.0519, 0.0517, 0.0509, 0.0506, 0.0498, 0.0495, 0.0496, 0.0498, 0.0496,
        0.0489, 0.0489, 0.0491, 0.0491, 0.0492, 0.0496, 0.0498, 0.0503, 0.0502,
        0.0506, 0.0507])
Federated model performance: Loss: 0.591923. Accuracy: 70.5241%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['52.898%', '53.433%', '53.626%', '53.968%', '54.332%', '54.631%', '54.652%', '55.080%', '55.251%', '56.107%', '56.064%', '56.171%', '56.043%', '56.877%', '57.283%', '57.455%', '57.626%', '58.246%', '57.968%', '57.925%']
Workers federated accuracies:  ['52.898%', '53.433%', '53.626%', '53.968%', '54.332%', '54.631%', '54.652%', '55.080%', '55.251%', '56.107%', '56.064%', '56.171%', '56.043%', '56.877%', '57.283%', '57.455%', '57.626%', '58.246%', '57.968%', '57.925%']
Workers improved  accuracies:  ['0.385%', '0.620%', '0.535%', '0.620%', '0.770%', '1.027%', '0.898%', '1.219%', '1.305%', '1.668%', '1.433%', '1.668%', '1.455%', '2.053%', '2.374%', '2.289%', '2.396%', '2.738%', '2.588%', '2.588%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 2:
Federated model validation accuracy : 74.5000%
Leave-one-out validation accuracies :  ['74.5000%', '74.5000%', '74.2000%', '74.3000%', '74.1000%', '73.9000%', '74.0000%', '73.6000%', '73.3000%', '73.3000%', '73.1000%', '72.9000%', '72.8000%', '72.7000%', '73.0000%', '72.9000%', '72.8000%', '72.4000%', '72.4000%', '72.3000%']
Computed and normalized credits:  tensor([0.0489, 0.0489, 0.0491, 0.0490, 0.0491, 0.0493, 0.0492, 0.0497, 0.0500,
        0.0500, 0.0502, 0.0504, 0.0505, 0.0507, 0.0504, 0.0505, 0.0506, 0.0511,
        0.0511, 0.0513])
Federated model performance: Loss: 0.554710. Accuracy: 73.7754%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['53.219%', '53.647%', '54.182%', '54.824%', '55.380%', '55.380%', '56.000%', '56.257%', '56.513%', '57.668%', '57.861%', '58.096%', '57.989%', '59.251%', '59.679%', '59.722%', '60.278%', '60.663%', '60.578%', '60.449%']
Workers federated accuracies:  ['53.219%', '53.647%', '54.182%', '54.824%', '55.380%', '55.380%', '56.000%', '56.257%', '56.513%', '57.668%', '57.861%', '58.096%', '57.989%', '59.251%', '59.679%', '59.722%', '60.278%', '60.663%', '60.578%', '60.449%']
Workers improved  accuracies:  ['0.706%', '0.834%', '1.091%', '1.476%', '1.818%', '1.775%', '2.246%', '2.396%', '2.567%', '3.230%', '3.230%', '3.594%', '3.401%', '4.428%', '4.770%', '4.556%', '5.048%', '5.155%', '5.198%', '5.112%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 3:
Federated model validation accuracy : 72.8000%
Leave-one-out validation accuracies :  ['72.9000%', '73.0000%', '73.1000%', '73.0000%', '73.0000%', '73.1000%', '73.0000%', '73.0000%', '72.8000%', '72.4000%', '72.3000%', '72.3000%', '72.3000%', '72.3000%', '72.4000%', '72.5000%', '72.4000%', '72.6000%', '72.8000%', '72.7000%']
Computed and normalized credits:  tensor([0.0497, 0.0495, 0.0494, 0.0496, 0.0496, 0.0495, 0.0496, 0.0496, 0.0499,
        0.0503, 0.0505, 0.0505, 0.0505, 0.0505, 0.0504, 0.0503, 0.0504, 0.0502,
        0.0500, 0.0501])
Federated model performance: Loss: 0.560593. Accuracy: 73.9037%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['53.476%', '54.032%', '54.674%', '55.636%', '56.021%', '56.214%', '56.834%', '57.497%', '58.032%', '59.337%', '59.444%', '59.786%', '59.722%', '61.134%', '62.118%', '62.203%', '62.930%', '63.572%', '63.807%', '63.337%']
Workers federated accuracies:  ['53.476%', '54.032%', '54.674%', '55.636%', '56.021%', '56.214%', '56.834%', '57.497%', '58.032%', '59.337%', '59.444%', '59.786%', '59.722%', '61.134%', '62.118%', '62.203%', '62.930%', '63.572%', '63.807%', '63.337%']
Workers improved  accuracies:  ['0.963%', '1.219%', '1.583%', '2.289%', '2.460%', '2.610%', '3.080%', '3.636%', '4.086%', '4.898%', '4.813%', '5.283%', '5.134%', '6.310%', '7.209%', '7.037%', '7.701%', '8.064%', '8.428%', '8.000%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 4:
Federated model validation accuracy : 72.3000%
Leave-one-out validation accuracies :  ['72.3000%', '72.5000%', '72.2000%', '72.2000%', '72.2000%', '72.3000%', '72.2000%', '72.4000%', '72.5000%', '72.6000%', '72.7000%', '72.8000%', '72.6000%', '72.5000%', '72.4000%', '72.3000%', '72.2000%', '72.5000%', '72.4000%', '72.4000%']
Computed and normalized credits:  tensor([0.0501, 0.0499, 0.0502, 0.0502, 0.0502, 0.0501, 0.0502, 0.0500, 0.0499,
        0.0498, 0.0497, 0.0496, 0.0498, 0.0499, 0.0500, 0.0502, 0.0503, 0.0499,
        0.0500, 0.0500])
Federated model performance: Loss: 0.593896. Accuracy: 73.8824%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['53.711%', '54.246%', '55.037%', '56.043%', '56.813%', '57.070%', '57.882%', '58.567%', '58.973%', '60.984%', '61.283%', '61.840%', '61.561%', '63.080%', '64.086%', '64.235%', '65.048%', '65.690%', '65.775%', '65.219%']
Workers federated accuracies:  ['53.711%', '54.246%', '55.037%', '56.043%', '56.813%', '57.070%', '57.882%', '58.567%', '58.973%', '60.984%', '61.283%', '61.840%', '61.561%', '63.080%', '64.086%', '64.235%', '65.048%', '65.690%', '65.775%', '65.219%']
Workers improved  accuracies:  ['1.198%', '1.433%', '1.947%', '2.695%', '3.251%', '3.465%', '4.128%', '4.706%', '5.027%', '6.545%', '6.652%', '7.337%', '6.973%', '8.257%', '9.176%', '9.070%', '9.818%', '10.182%', '10.396%', '9.882%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 5:
Federated model validation accuracy : 72.7000%
Leave-one-out validation accuracies :  ['72.7000%', '72.6000%', '72.6000%', '72.6000%', '72.5000%', '72.4000%', '72.4000%', '72.5000%', '72.4000%', '72.3000%', '72.3000%', '72.3000%', '72.3000%', '72.3000%', '72.4000%', '72.4000%', '72.2000%', '72.2000%', '72.1000%', '72.2000%']
Computed and normalized credits:  tensor([0.0496, 0.0497, 0.0498, 0.0498, 0.0499, 0.0500, 0.0500, 0.0499, 0.0500,
        0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500, 0.0500, 0.0502, 0.0502,
        0.0503, 0.0502])
Federated model performance: Loss: 0.643867. Accuracy: 73.6471%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['53.968%', '54.695%', '55.508%', '56.877%', '57.904%', '57.947%', '59.102%', '59.979%', '60.193%', '62.781%', '63.251%', '63.551%', '63.337%', '64.791%', '65.733%', '65.840%', '66.824%', '67.144%', '66.973%', '66.695%']
Workers federated accuracies:  ['53.968%', '54.695%', '55.508%', '56.877%', '57.904%', '57.947%', '59.102%', '59.979%', '60.193%', '62.781%', '63.251%', '63.551%', '63.337%', '64.791%', '65.733%', '65.840%', '66.824%', '67.144%', '66.973%', '66.695%']
Workers improved  accuracies:  ['1.455%', '1.882%', '2.417%', '3.529%', '4.342%', '4.342%', '5.348%', '6.118%', '6.246%', '8.342%', '8.620%', '9.048%', '8.749%', '9.968%', '10.824%', '10.674%', '11.594%', '11.636%', '11.594%', '11.358%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 6:
Federated model validation accuracy : 72.5000%
Leave-one-out validation accuracies :  ['72.5000%', '72.5000%', '72.5000%', '72.5000%', '72.4000%', '72.3000%', '72.4000%', '72.4000%', '72.4000%', '72.4000%', '72.3000%', '72.3000%', '72.2000%', '72.2000%', '72.3000%', '72.3000%', '72.3000%', '72.2000%', '72.3000%', '72.2000%']
Computed and normalized credits:  tensor([0.0498, 0.0498, 0.0498, 0.0498, 0.0499, 0.0501, 0.0499, 0.0499, 0.0499,
        0.0499, 0.0501, 0.0501, 0.0502, 0.0502, 0.0501, 0.0501, 0.0501, 0.0502,
        0.0501, 0.0502])
Federated model performance: Loss: 0.701828. Accuracy: 73.6043%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['54.203%', '55.037%', '55.914%', '57.390%', '58.460%', '58.759%', '59.957%', '60.920%', '61.433%', '64.278%', '64.513%', '64.727%', '64.791%', '66.332%', '67.016%', '66.973%', '67.850%', '68.535%', '68.492%', '67.722%']
Workers federated accuracies:  ['54.203%', '55.037%', '55.914%', '57.390%', '58.460%', '58.759%', '59.957%', '60.920%', '61.433%', '64.278%', '64.513%', '64.727%', '64.791%', '66.332%', '67.016%', '66.973%', '67.850%', '68.535%', '68.492%', '67.722%']
Workers improved  accuracies:  ['1.690%', '2.225%', '2.824%', '4.043%', '4.898%', '5.155%', '6.203%', '7.059%', '7.487%', '9.840%', '9.882%', '10.225%', '10.203%', '11.508%', '12.107%', '11.807%', '12.620%', '13.027%', '13.112%', '12.385%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 7:
Federated model validation accuracy : 72.3000%
Leave-one-out validation accuracies :  ['72.3000%', '72.3000%', '72.3000%', '72.3000%', '72.2000%', '72.2000%', '72.2000%', '72.3000%', '72.3000%', '72.2000%', '72.2000%', '72.2000%', '72.1000%', '72.1000%', '72.1000%', '72.2000%', '72.1000%', '72.2000%', '72.2000%', '72.2000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499,
        0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0500, 0.0501, 0.0500,
        0.0500, 0.0500])
Federated model performance: Loss: 0.765292. Accuracy: 73.4973%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['54.267%', '55.401%', '56.364%', '58.075%', '59.251%', '59.594%', '60.877%', '62.353%', '62.759%', '65.561%', '65.561%', '65.989%', '65.989%', '67.615%', '68.107%', '68.043%', '68.984%', '69.754%', '69.733%', '68.834%']
Workers federated accuracies:  ['54.267%', '55.401%', '56.364%', '58.075%', '59.251%', '59.594%', '60.877%', '62.353%', '62.759%', '65.561%', '65.561%', '65.989%', '65.989%', '67.615%', '68.107%', '68.043%', '68.984%', '69.754%', '69.733%', '68.834%']
Workers improved  accuracies:  ['1.754%', '2.588%', '3.273%', '4.727%', '5.690%', '5.989%', '7.123%', '8.492%', '8.813%', '11.123%', '10.930%', '11.487%', '11.401%', '12.791%', '13.198%', '12.877%', '13.754%', '14.246%', '14.353%', '13.497%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 8:
Federated model validation accuracy : 72.4000%
Leave-one-out validation accuracies :  ['72.4000%', '72.4000%', '72.4000%', '72.3000%', '72.3000%', '72.2000%', '72.2000%', '72.3000%', '72.3000%', '72.2000%', '72.1000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '72.1000%']
Computed and normalized credits:  tensor([0.0497, 0.0497, 0.0497, 0.0498, 0.0498, 0.0500, 0.0500, 0.0498, 0.0498,
        0.0500, 0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502,
        0.0502, 0.0501])
Federated model performance: Loss: 0.827609. Accuracy: 73.3904%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['54.481%', '55.636%', '56.727%', '58.802%', '60.000%', '60.492%', '62.160%', '63.529%', '63.850%', '66.417%', '66.545%', '67.144%', '66.909%', '68.449%', '69.134%', '68.877%', '70.118%', '70.631%', '71.037%', '70.160%']
Workers federated accuracies:  ['54.481%', '55.636%', '56.727%', '58.802%', '60.000%', '60.492%', '62.160%', '63.529%', '63.850%', '66.417%', '66.545%', '67.144%', '66.909%', '68.449%', '69.134%', '68.877%', '70.118%', '70.631%', '71.037%', '70.160%']
Workers improved  accuracies:  ['1.968%', '2.824%', '3.636%', '5.455%', '6.439%', '6.888%', '8.406%', '9.668%', '9.904%', '11.979%', '11.914%', '12.642%', '12.321%', '13.626%', '14.225%', '13.711%', '14.888%', '15.123%', '15.658%', '14.824%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 9:
Federated model validation accuracy : 72.5000%
Leave-one-out validation accuracies :  ['72.5000%', '72.5000%', '72.4000%', '72.4000%', '72.4000%', '72.3000%', '72.2000%', '72.1000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '72.0000%', '71.9000%', '71.9000%', '71.9000%', '72.0000%', '72.0000%']
Computed and normalized credits:  tensor([0.0495, 0.0495, 0.0497, 0.0497, 0.0497, 0.0498, 0.0499, 0.0500, 0.0501,
        0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0503, 0.0503, 0.0503,
        0.0502, 0.0502])
Federated model performance: Loss: 0.891035. Accuracy: 73.3904%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['54.802%', '55.872%', '57.070%', '59.465%', '60.941%', '61.412%', '62.930%', '64.556%', '64.813%', '67.380%', '67.658%', '67.807%', '68.342%', '69.390%', '69.754%', '70.182%', '70.909%', '72.107%', '71.722%', '71.102%']
Workers federated accuracies:  ['54.802%', '55.872%', '57.070%', '59.465%', '60.941%', '61.412%', '62.930%', '64.556%', '64.813%', '67.380%', '67.658%', '67.807%', '68.342%', '69.390%', '69.754%', '70.182%', '70.909%', '72.107%', '71.722%', '71.102%']
Workers improved  accuracies:  ['2.289%', '3.059%', '3.979%', '6.118%', '7.380%', '7.807%', '9.176%', '10.695%', '10.866%', '12.941%', '13.027%', '13.305%', '13.754%', '14.567%', '14.845%', '15.016%', '15.679%', '16.599%', '16.342%', '15.765%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 10:
Federated model validation accuracy : 72.2000%
Leave-one-out validation accuracies :  ['72.2000%', '72.2000%', '72.1000%', '72.1000%', '72.1000%', '72.1000%', '72.1000%', '72.0000%', '72.0000%', '72.0000%', '71.9000%', '72.0000%', '72.0000%', '72.1000%', '72.1000%', '72.1000%', '72.1000%', '72.1000%', '72.1000%', '72.1000%']
Computed and normalized credits:  tensor([0.0498, 0.0498, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501,
        0.0501, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500])
Federated model performance: Loss: 0.952369. Accuracy: 73.4973%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['54.952%', '56.128%', '57.412%', '60.086%', '61.989%', '62.225%', '63.786%', '65.390%', '65.262%', '68.364%', '68.214%', '69.027%', '69.155%', '70.118%', '70.674%', '71.166%', '71.701%', '72.834%', '72.770%', '71.893%']
Workers federated accuracies:  ['54.952%', '56.128%', '57.412%', '60.086%', '61.989%', '62.225%', '63.786%', '65.390%', '65.262%', '68.364%', '68.214%', '69.027%', '69.155%', '70.118%', '70.674%', '71.166%', '71.701%', '72.834%', '72.770%', '71.893%']
Workers improved  accuracies:  ['2.439%', '3.316%', '4.321%', '6.738%', '8.428%', '8.620%', '10.032%', '11.529%', '11.316%', '13.925%', '13.583%', '14.524%', '14.567%', '15.294%', '15.765%', '16.000%', '16.471%', '17.326%', '17.390%', '16.556%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.952369. Accuracy: 73.4973%.
Workers before    accuracies:  ['52.513%', '52.813%', '53.091%', '53.348%', '53.561%', '53.604%', '53.754%', '53.861%', '53.947%', '54.439%', '54.631%', '54.503%', '54.588%', '54.824%', '54.909%', '55.166%', '55.230%', '55.508%', '55.380%', '55.337%']
Workers standlone accuracies:  ['54.952%', '56.128%', '57.412%', '60.086%', '61.989%', '62.225%', '63.786%', '65.390%', '65.262%', '68.364%', '68.214%', '69.027%', '69.155%', '70.118%', '70.674%', '71.166%', '71.701%', '72.834%', '72.770%', '71.893%']
Workers federated accuracies:  ['54.952%', '56.128%', '57.412%', '60.086%', '61.989%', '62.225%', '63.786%', '65.390%', '65.262%', '68.364%', '68.214%', '69.027%', '69.155%', '70.118%', '70.674%', '71.166%', '71.701%', '72.834%', '72.770%', '71.893%']
Workers improved  accuracies:  ['2.439%', '3.316%', '4.321%', '6.738%', '8.428%', '8.620%', '10.032%', '11.529%', '11.316%', '13.925%', '13.583%', '14.524%', '14.567%', '15.294%', '15.765%', '16.000%', '16.471%', '17.326%', '17.390%', '16.556%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]
Workers sharing_contributions :  tensor([ 3.2000,  4.8000,  7.2000,  9.6000, 11.2000, 13.6000, 15.2000, 17.6000,
        20.0000, 21.6000, 24.0000, 26.4000, 28.0000, 30.4000, 32.0000, 34.4000,
        36.8000, 38.4000, 40.8000, 42.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.18418783517045556, 0.4369458053595698)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9655393482177754, 5.743637507265955e-12)
Correlation between test_acc improvements & sharing_contributions:  (0.959307425157863, 2.5061875734006515e-11)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.732439. Accuracy: 60.1497%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 69.3000%
Leave-one-out validation accuracies :  ['69.2000%', '69.0000%', '69.0000%', '69.4000%', '69.3000%', '69.6000%', '69.5000%', '69.4000%', '70.0000%', '70.3000%', '70.6000%', '71.0000%', '71.2000%', '71.5000%', '72.1000%', '72.2000%', '72.7000%', '72.8000%', '73.0000%', '72.9000%']
Computed and normalized credits:  tensor([0.0519, 0.0522, 0.0522, 0.0517, 0.0518, 0.0514, 0.0515, 0.0517, 0.0509,
        0.0505, 0.0501, 0.0496, 0.0494, 0.0490, 0.0483, 0.0482, 0.0476, 0.0475,
        0.0472, 0.0473])
Federated model performance: Loss: 0.648634. Accuracy: 69.8182%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['59.465%', '59.765%', '59.807%', '59.936%', '60.235%', '60.299%', '60.428%', '60.535%', '60.556%', '60.770%', '60.856%', '60.856%', '60.898%', '61.027%', '61.305%', '61.326%', '61.369%', '61.497%', '61.497%', '61.348%']
Workers federated accuracies:  ['59.465%', '59.765%', '59.807%', '59.936%', '60.235%', '60.299%', '60.428%', '60.535%', '60.556%', '60.770%', '60.856%', '60.856%', '60.898%', '61.027%', '61.305%', '61.326%', '61.369%', '61.497%', '61.497%', '61.348%']
Workers improved  accuracies:  ['0.086%', '0.257%', '0.278%', '0.235%', '0.364%', '0.449%', '0.535%', '0.556%', '0.620%', '0.684%', '0.663%', '0.620%', '0.706%', '0.749%', '0.834%', '0.898%', '0.791%', '0.834%', '0.856%', '0.706%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 2:
Federated model validation accuracy : 71.5000%
Leave-one-out validation accuracies :  ['71.6000%', '71.9000%', '72.2000%', '72.2000%', '72.1000%', '72.1000%', '72.1000%', '72.3000%', '72.4000%', '72.4000%', '72.8000%', '72.9000%', '73.0000%', '73.1000%', '73.1000%', '73.5000%', '73.7000%', '73.8000%', '73.8000%', '73.7000%']
Computed and normalized credits:  tensor([0.0516, 0.0512, 0.0508, 0.0508, 0.0509, 0.0509, 0.0509, 0.0507, 0.0505,
        0.0504, 0.0499, 0.0498, 0.0496, 0.0495, 0.0494, 0.0489, 0.0486, 0.0485,
        0.0485, 0.0486])
Federated model performance: Loss: 0.606648. Accuracy: 73.3262%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['59.529%', '59.914%', '59.957%', '60.299%', '60.578%', '60.856%', '60.920%', '61.027%', '60.984%', '61.134%', '61.262%', '61.348%', '61.497%', '61.840%', '62.203%', '62.267%', '62.674%', '62.695%', '62.781%', '62.353%']
Workers federated accuracies:  ['59.529%', '59.914%', '59.957%', '60.299%', '60.578%', '60.856%', '60.920%', '61.027%', '60.984%', '61.134%', '61.262%', '61.348%', '61.497%', '61.840%', '62.203%', '62.267%', '62.674%', '62.695%', '62.781%', '62.353%']
Workers improved  accuracies:  ['0.150%', '0.406%', '0.428%', '0.599%', '0.706%', '1.005%', '1.027%', '1.048%', '1.048%', '1.048%', '1.070%', '1.112%', '1.305%', '1.561%', '1.733%', '1.840%', '2.096%', '2.032%', '2.139%', '1.711%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 3:
Federated model validation accuracy : 72.7000%
Leave-one-out validation accuracies :  ['72.7000%', '72.7000%', '72.7000%', '72.9000%', '73.0000%', '73.1000%', '73.5000%', '73.4000%', '73.5000%', '73.4000%', '73.4000%', '73.5000%', '73.5000%', '73.6000%', '73.7000%', '74.0000%', '73.9000%', '74.1000%', '74.1000%', '74.1000%']
Computed and normalized credits:  tensor([0.0510, 0.0510, 0.0510, 0.0507, 0.0506, 0.0505, 0.0500, 0.0501, 0.0500,
        0.0501, 0.0500, 0.0499, 0.0499, 0.0498, 0.0496, 0.0492, 0.0493, 0.0491,
        0.0491, 0.0491])
Federated model performance: Loss: 0.595026. Accuracy: 74.4385%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['59.679%', '60.021%', '60.278%', '60.428%', '60.749%', '61.091%', '61.326%', '61.219%', '61.262%', '61.925%', '61.968%', '62.182%', '62.396%', '62.588%', '63.016%', '63.102%', '63.508%', '63.807%', '63.893%', '63.316%']
Workers federated accuracies:  ['59.679%', '60.021%', '60.278%', '60.428%', '60.749%', '61.091%', '61.326%', '61.219%', '61.262%', '61.925%', '61.968%', '62.182%', '62.396%', '62.588%', '63.016%', '63.102%', '63.508%', '63.807%', '63.893%', '63.316%']
Workers improved  accuracies:  ['0.299%', '0.513%', '0.749%', '0.727%', '0.877%', '1.241%', '1.433%', '1.241%', '1.326%', '1.840%', '1.775%', '1.947%', '2.203%', '2.310%', '2.545%', '2.674%', '2.930%', '3.144%', '3.251%', '2.674%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 4:
Federated model validation accuracy : 73.7000%
Leave-one-out validation accuracies :  ['73.7000%', '73.7000%', '73.8000%', '73.8000%', '73.9000%', '73.9000%', '73.9000%', '74.0000%', '74.0000%', '73.8000%', '73.8000%', '73.8000%', '73.9000%', '74.1000%', '74.1000%', '74.2000%', '74.0000%', '74.0000%', '74.1000%', '74.0000%']
Computed and normalized credits:  tensor([0.0504, 0.0504, 0.0502, 0.0502, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499,
        0.0502, 0.0501, 0.0501, 0.0500, 0.0498, 0.0498, 0.0496, 0.0499, 0.0498,
        0.0497, 0.0498])
Federated model performance: Loss: 0.603688. Accuracy: 74.8663%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['59.786%', '60.321%', '60.321%', '60.749%', '61.091%', '61.455%', '61.733%', '61.818%', '61.947%', '62.631%', '62.674%', '62.845%', '62.909%', '63.422%', '63.765%', '64.021%', '64.556%', '65.134%', '65.369%', '64.642%']
Workers federated accuracies:  ['59.786%', '60.321%', '60.321%', '60.749%', '61.091%', '61.455%', '61.733%', '61.818%', '61.947%', '62.631%', '62.674%', '62.845%', '62.909%', '63.422%', '63.765%', '64.021%', '64.556%', '65.134%', '65.369%', '64.642%']
Workers improved  accuracies:  ['0.406%', '0.813%', '0.791%', '1.048%', '1.219%', '1.604%', '1.840%', '1.840%', '2.011%', '2.545%', '2.481%', '2.610%', '2.717%', '3.144%', '3.294%', '3.594%', '3.979%', '4.471%', '4.727%', '4.000%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 5:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.1000%', '74.2000%', '74.2000%', '74.1000%', '73.9000%', '73.8000%', '74.0000%', '74.0000%', '74.0000%', '74.1000%', '74.2000%', '74.2000%', '74.3000%', '74.3000%', '74.0000%', '73.9000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0499, 0.0499, 0.0500, 0.0502,
        0.0504, 0.0501, 0.0501, 0.0501, 0.0500, 0.0499, 0.0499, 0.0498, 0.0498,
        0.0501, 0.0502])
Federated model performance: Loss: 0.627081. Accuracy: 75.1872%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['59.807%', '60.535%', '60.492%', '60.920%', '61.412%', '61.861%', '62.118%', '62.225%', '62.332%', '63.337%', '63.316%', '63.807%', '63.743%', '64.513%', '64.749%', '65.027%', '65.476%', '66.310%', '66.203%', '65.561%']
Workers federated accuracies:  ['59.807%', '60.535%', '60.492%', '60.920%', '61.412%', '61.861%', '62.118%', '62.225%', '62.332%', '63.337%', '63.316%', '63.807%', '63.743%', '64.513%', '64.749%', '65.027%', '65.476%', '66.310%', '66.203%', '65.561%']
Workers improved  accuracies:  ['0.428%', '1.027%', '0.963%', '1.219%', '1.540%', '2.011%', '2.225%', '2.246%', '2.396%', '3.251%', '3.123%', '3.572%', '3.551%', '4.235%', '4.278%', '4.599%', '4.898%', '5.647%', '5.561%', '4.920%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 6:
Federated model validation accuracy : 73.9000%
Leave-one-out validation accuracies :  ['73.9000%', '73.9000%', '74.0000%', '74.0000%', '74.1000%', '74.1000%', '74.1000%', '74.2000%', '74.3000%', '74.3000%', '74.3000%', '74.3000%', '74.1000%', '74.1000%', '74.1000%', '74.1000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0498,
        0.0498, 0.0498, 0.0498, 0.0500, 0.0500, 0.0500, 0.0500, 0.0501, 0.0501,
        0.0501, 0.0501])
Federated model performance: Loss: 0.659887. Accuracy: 75.3797%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['59.872%', '60.684%', '60.684%', '61.070%', '61.690%', '62.246%', '62.588%', '62.759%', '63.016%', '63.979%', '63.807%', '64.834%', '64.620%', '65.540%', '65.497%', '65.968%', '66.888%', '67.551%', '67.102%', '66.781%']
Workers federated accuracies:  ['59.872%', '60.684%', '60.684%', '61.070%', '61.690%', '62.246%', '62.588%', '62.759%', '63.016%', '63.979%', '63.807%', '64.834%', '64.620%', '65.540%', '65.497%', '65.968%', '66.888%', '67.551%', '67.102%', '66.781%']
Workers improved  accuracies:  ['0.492%', '1.176%', '1.155%', '1.369%', '1.818%', '2.396%', '2.695%', '2.781%', '3.080%', '3.893%', '3.615%', '4.599%', '4.428%', '5.262%', '5.027%', '5.540%', '6.310%', '6.888%', '6.460%', '6.139%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 7:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.0000%', '74.0000%', '74.0000%', '73.9000%', '73.9000%', '73.9000%', '73.9000%', '73.9000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.2000%', '74.3000%', '74.4000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0498,
        0.0497, 0.0496])
Federated model performance: Loss: 0.695836. Accuracy: 75.5936%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['59.936%', '60.706%', '60.920%', '61.305%', '62.182%', '62.610%', '63.102%', '63.102%', '63.487%', '64.663%', '64.578%', '65.540%', '65.262%', '66.289%', '66.652%', '67.037%', '68.086%', '68.791%', '68.321%', '67.679%']
Workers federated accuracies:  ['59.936%', '60.706%', '60.920%', '61.305%', '62.182%', '62.610%', '63.102%', '63.102%', '63.487%', '64.663%', '64.578%', '65.540%', '65.262%', '66.289%', '66.652%', '67.037%', '68.086%', '68.791%', '68.321%', '67.679%']
Workers improved  accuracies:  ['0.556%', '1.198%', '1.390%', '1.604%', '2.310%', '2.759%', '3.209%', '3.123%', '3.551%', '4.578%', '4.385%', '5.305%', '5.070%', '6.011%', '6.182%', '6.610%', '7.508%', '8.128%', '7.679%', '7.037%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 8:
Federated model validation accuracy : 73.9000%
Leave-one-out validation accuracies :  ['73.9000%', '74.0000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.2000%', '74.3000%', '74.4000%', '74.5000%', '74.5000%', '74.5000%', '74.6000%', '74.5000%', '74.5000%', '74.5000%']
Computed and normalized credits:  tensor([0.0505, 0.0504, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501, 0.0501,
        0.0501, 0.0501, 0.0500, 0.0499, 0.0498, 0.0498, 0.0498, 0.0497, 0.0498,
        0.0497, 0.0497])
Federated model performance: Loss: 0.736584. Accuracy: 75.7861%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['60.021%', '60.834%', '61.027%', '61.540%', '62.481%', '63.037%', '63.401%', '63.679%', '64.128%', '65.155%', '65.070%', '66.332%', '65.668%', '67.102%', '67.551%', '68.000%', '68.941%', '69.797%', '69.604%', '68.535%']
Workers federated accuracies:  ['60.021%', '60.834%', '61.027%', '61.540%', '62.481%', '63.037%', '63.401%', '63.679%', '64.128%', '65.155%', '65.070%', '66.332%', '65.668%', '67.102%', '67.551%', '68.000%', '68.941%', '69.797%', '69.604%', '68.535%']
Workers improved  accuracies:  ['0.642%', '1.326%', '1.497%', '1.840%', '2.610%', '3.187%', '3.508%', '3.701%', '4.193%', '5.070%', '4.877%', '6.096%', '5.476%', '6.824%', '7.080%', '7.572%', '8.364%', '9.134%', '8.963%', '7.893%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 9:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.6000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.6000%', '74.7000%', '74.6000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0499, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0498, 0.0499, 0.0500, 0.0500,
        0.0500, 0.0500])
Federated model performance: Loss: 0.778426. Accuracy: 75.7005%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['60.107%', '61.027%', '61.134%', '61.882%', '62.717%', '63.316%', '63.765%', '64.107%', '64.749%', '65.861%', '65.840%', '67.080%', '66.717%', '68.000%', '68.342%', '68.706%', '69.690%', '70.824%', '70.310%', '69.519%']
Workers federated accuracies:  ['60.107%', '61.027%', '61.134%', '61.882%', '62.717%', '63.316%', '63.765%', '64.107%', '64.749%', '65.861%', '65.840%', '67.080%', '66.717%', '68.000%', '68.342%', '68.706%', '69.690%', '70.824%', '70.310%', '69.519%']
Workers improved  accuracies:  ['0.727%', '1.519%', '1.604%', '2.182%', '2.845%', '3.465%', '3.872%', '4.128%', '4.813%', '5.775%', '5.647%', '6.845%', '6.524%', '7.722%', '7.872%', '8.278%', '9.112%', '10.160%', '9.668%', '8.877%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 10:
Federated model validation accuracy : 74.5000%
Leave-one-out validation accuracies :  ['74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.6000%', '74.6000%', '74.6000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.5000%', '74.4000%', '74.4000%']
Computed and normalized credits:  tensor([0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0500,
        0.0501, 0.0501])
Federated model performance: Loss: 0.820947. Accuracy: 75.7433%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['60.171%', '61.091%', '61.348%', '62.182%', '63.251%', '63.529%', '64.449%', '64.578%', '65.433%', '66.652%', '66.567%', '67.936%', '67.594%', '68.727%', '69.112%', '69.540%', '70.310%', '71.936%', '71.166%', '70.203%']
Workers federated accuracies:  ['60.171%', '61.091%', '61.348%', '62.182%', '63.251%', '63.529%', '64.449%', '64.578%', '65.433%', '66.652%', '66.567%', '67.936%', '67.594%', '68.727%', '69.112%', '69.540%', '70.310%', '71.936%', '71.166%', '70.203%']
Workers improved  accuracies:  ['0.791%', '1.583%', '1.818%', '2.481%', '3.380%', '3.679%', '4.556%', '4.599%', '5.497%', '6.567%', '6.374%', '7.701%', '7.401%', '8.449%', '8.642%', '9.112%', '9.733%', '11.273%', '10.524%', '9.561%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.820947. Accuracy: 75.7433%.
Workers before    accuracies:  ['59.380%', '59.508%', '59.529%', '59.701%', '59.872%', '59.850%', '59.893%', '59.979%', '59.936%', '60.086%', '60.193%', '60.235%', '60.193%', '60.278%', '60.471%', '60.428%', '60.578%', '60.663%', '60.642%', '60.642%']
Workers standlone accuracies:  ['60.171%', '61.091%', '61.348%', '62.182%', '63.251%', '63.529%', '64.449%', '64.578%', '65.433%', '66.652%', '66.567%', '67.936%', '67.594%', '68.727%', '69.112%', '69.540%', '70.310%', '71.936%', '71.166%', '70.203%']
Workers federated accuracies:  ['60.171%', '61.091%', '61.348%', '62.182%', '63.251%', '63.529%', '64.449%', '64.578%', '65.433%', '66.652%', '66.567%', '67.936%', '67.594%', '68.727%', '69.112%', '69.540%', '70.310%', '71.936%', '71.166%', '70.203%']
Workers improved  accuracies:  ['0.791%', '1.583%', '1.818%', '2.481%', '3.380%', '3.679%', '4.556%', '4.599%', '5.497%', '6.567%', '6.374%', '7.701%', '7.401%', '8.449%', '8.642%', '9.112%', '9.733%', '11.273%', '10.524%', '9.561%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]
Workers sharing_contributions :  tensor([ 3.2000,  4.8000,  7.2000,  9.6000, 11.2000, 13.6000, 15.2000, 17.6000,
        20.0000, 21.6000, 24.0000, 26.4000, 28.0000, 30.4000, 32.0000, 34.4000,
        36.8000, 38.4000, 40.8000, 42.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.08630088319898081, 0.7175206848196186)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9872744122213304, 7.937735055496888e-16)
Correlation between test_acc improvements & sharing_contributions:  (0.9857462400640725, 2.190574962893667e-15)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.707942. Accuracy: 60.4278%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 72.1000%
Leave-one-out validation accuracies :  ['72.2000%', '72.2000%', '72.3000%', '72.1000%', '72.1000%', '72.1000%', '72.2000%', '72.7000%', '72.9000%', '73.3000%', '73.4000%', '73.6000%', '73.4000%', '74.0000%', '74.3000%', '74.7000%', '74.4000%', '74.6000%', '74.5000%', '74.4000%']
Computed and normalized credits:  tensor([0.0513, 0.0513, 0.0512, 0.0514, 0.0514, 0.0514, 0.0513, 0.0507, 0.0504,
        0.0500, 0.0498, 0.0496, 0.0498, 0.0491, 0.0488, 0.0483, 0.0487, 0.0484,
        0.0485, 0.0487])
Federated model performance: Loss: 0.626915. Accuracy: 70.8021%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['59.936%', '60.021%', '60.150%', '60.449%', '60.663%', '60.727%', '61.219%', '61.262%', '61.348%', '62.032%', '62.139%', '62.032%', '62.289%', '62.802%', '63.487%', '63.059%', '63.658%', '63.936%', '64.107%', '63.914%']
Workers federated accuracies:  ['59.936%', '60.021%', '60.150%', '60.449%', '60.663%', '60.727%', '61.219%', '61.262%', '61.348%', '62.032%', '62.139%', '62.032%', '62.289%', '62.802%', '63.487%', '63.059%', '63.658%', '63.936%', '64.107%', '63.914%']
Workers improved  accuracies:  ['0.171%', '0.150%', '0.235%', '0.428%', '0.471%', '0.620%', '0.920%', '1.048%', '0.898%', '1.412%', '1.583%', '1.348%', '1.561%', '1.818%', '2.267%', '2.096%', '2.481%', '2.652%', '2.631%', '2.481%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 2:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.0000%', '73.9000%', '73.9000%', '74.0000%', '74.3000%', '74.1000%', '74.4000%', '74.3000%', '74.4000%', '74.3000%', '74.2000%', '74.2000%', '74.4000%', '74.5000%', '74.5000%', '74.6000%', '74.5000%', '74.5000%', '74.6000%', '74.4000%']
Computed and normalized credits:  tensor([0.0505, 0.0506, 0.0506, 0.0505, 0.0501, 0.0504, 0.0500, 0.0501, 0.0499,
        0.0500, 0.0501, 0.0501, 0.0499, 0.0497, 0.0497, 0.0495, 0.0496, 0.0496,
        0.0495, 0.0498])
Federated model performance: Loss: 0.579456. Accuracy: 73.9679%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['59.979%', '60.257%', '60.406%', '61.070%', '61.198%', '61.604%', '62.053%', '62.310%', '62.396%', '63.850%', '63.893%', '63.893%', '64.021%', '64.877%', '65.668%', '64.813%', '65.754%', '65.733%', '65.925%', '65.840%']
Workers federated accuracies:  ['59.979%', '60.257%', '60.406%', '61.070%', '61.198%', '61.604%', '62.053%', '62.310%', '62.396%', '63.850%', '63.893%', '63.893%', '64.021%', '64.877%', '65.668%', '64.813%', '65.754%', '65.733%', '65.925%', '65.840%']
Workers improved  accuracies:  ['0.214%', '0.385%', '0.492%', '1.048%', '1.005%', '1.497%', '1.754%', '2.096%', '1.947%', '3.230%', '3.337%', '3.209%', '3.294%', '3.893%', '4.449%', '3.850%', '4.578%', '4.449%', '4.449%', '4.406%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 3:
Federated model validation accuracy : 74.6000%
Leave-one-out validation accuracies :  ['74.6000%', '74.6000%', '74.5000%', '74.6000%', '74.6000%', '74.4000%', '74.4000%', '74.5000%', '74.5000%', '74.4000%', '74.4000%', '74.4000%', '74.3000%', '74.3000%', '74.3000%', '74.6000%', '74.7000%', '74.6000%', '74.7000%', '74.8000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0501, 0.0499, 0.0499, 0.0502, 0.0501, 0.0500, 0.0500,
        0.0501, 0.0501, 0.0501, 0.0502, 0.0502, 0.0502, 0.0499, 0.0498, 0.0499,
        0.0497, 0.0496])
Federated model performance: Loss: 0.555975. Accuracy: 75.1016%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.214%', '60.449%', '60.727%', '61.476%', '62.053%', '62.460%', '63.316%', '63.594%', '63.572%', '65.219%', '65.134%', '65.198%', '65.497%', '66.267%', '67.016%', '66.139%', '66.781%', '67.294%', '67.487%', '67.251%']
Workers federated accuracies:  ['60.214%', '60.449%', '60.727%', '61.476%', '62.053%', '62.460%', '63.316%', '63.594%', '63.572%', '65.219%', '65.134%', '65.198%', '65.497%', '66.267%', '67.016%', '66.139%', '66.781%', '67.294%', '67.487%', '67.251%']
Workers improved  accuracies:  ['0.449%', '0.578%', '0.813%', '1.455%', '1.861%', '2.353%', '3.016%', '3.380%', '3.123%', '4.599%', '4.578%', '4.513%', '4.770%', '5.283%', '5.797%', '5.176%', '5.604%', '6.011%', '6.011%', '5.818%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 4:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.4000%', '74.4000%', '74.3000%', '74.3000%', '74.4000%', '74.5000%', '74.4000%', '74.5000%', '74.5000%', '74.5000%', '74.4000%', '74.7000%', '74.7000%', '74.7000%', '74.8000%', '74.9000%', '75.0000%', '75.2000%', '75.3000%', '75.4000%']
Computed and normalized credits:  tensor([0.0503, 0.0503, 0.0504, 0.0504, 0.0503, 0.0502, 0.0503, 0.0502, 0.0502,
        0.0502, 0.0503, 0.0500, 0.0500, 0.0500, 0.0499, 0.0497, 0.0496, 0.0494,
        0.0492, 0.0491])
Federated model performance: Loss: 0.548750. Accuracy: 75.8289%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.321%', '60.684%', '60.963%', '62.225%', '62.781%', '63.594%', '64.406%', '64.727%', '64.791%', '66.225%', '66.139%', '66.075%', '66.524%', '67.294%', '68.021%', '67.273%', '67.722%', '68.535%', '68.513%', '68.321%']
Workers federated accuracies:  ['60.321%', '60.684%', '60.963%', '62.225%', '62.781%', '63.594%', '64.406%', '64.727%', '64.791%', '66.225%', '66.139%', '66.075%', '66.524%', '67.294%', '68.021%', '67.273%', '67.722%', '68.535%', '68.513%', '68.321%']
Workers improved  accuracies:  ['0.556%', '0.813%', '1.048%', '2.203%', '2.588%', '3.487%', '4.107%', '4.513%', '4.342%', '5.604%', '5.583%', '5.390%', '5.797%', '6.310%', '6.802%', '6.310%', '6.545%', '7.251%', '7.037%', '6.888%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 5:
Federated model validation accuracy : 74.9000%
Leave-one-out validation accuracies :  ['74.9000%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '75.0000%', '75.1000%', '75.1000%', '75.2000%', '75.2000%', '75.2000%', '75.4000%', '75.4000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%']
Computed and normalized credits:  tensor([0.0502, 0.0504, 0.0504, 0.0504, 0.0504, 0.0503, 0.0501, 0.0500, 0.0500,
        0.0499, 0.0499, 0.0499, 0.0496, 0.0496, 0.0499, 0.0498, 0.0498, 0.0498,
        0.0498, 0.0498])
Federated model performance: Loss: 0.552068. Accuracy: 76.3636%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.428%', '60.834%', '61.519%', '62.888%', '63.444%', '64.471%', '65.305%', '65.604%', '65.561%', '67.037%', '67.080%', '66.930%', '67.551%', '68.000%', '68.877%', '68.342%', '68.856%', '69.647%', '69.433%', '69.348%']
Workers federated accuracies:  ['60.428%', '60.834%', '61.519%', '62.888%', '63.444%', '64.471%', '65.305%', '65.604%', '65.561%', '67.037%', '67.080%', '66.930%', '67.551%', '68.000%', '68.877%', '68.342%', '68.856%', '69.647%', '69.433%', '69.348%']
Workers improved  accuracies:  ['0.663%', '0.963%', '1.604%', '2.866%', '3.251%', '4.364%', '5.005%', '5.390%', '5.112%', '6.417%', '6.524%', '6.246%', '6.824%', '7.016%', '7.658%', '7.380%', '7.679%', '8.364%', '7.957%', '7.914%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 6:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.3000%', '75.3000%', '75.3000%', '75.2000%', '75.2000%', '75.1000%', '75.2000%', '75.3000%', '75.3000%', '75.4000%', '75.4000%', '75.3000%', '75.3000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500,
        0.0500, 0.0501, 0.0501, 0.0502, 0.0501, 0.0500, 0.0500, 0.0499, 0.0499,
        0.0500, 0.0500])
Federated model performance: Loss: 0.562491. Accuracy: 76.5562%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.385%', '61.219%', '61.840%', '63.551%', '64.428%', '65.241%', '66.032%', '66.396%', '66.160%', '67.701%', '67.829%', '67.679%', '68.364%', '68.620%', '69.690%', '69.176%', '69.647%', '70.310%', '70.439%', '69.989%']
Workers federated accuracies:  ['60.385%', '61.219%', '61.840%', '63.551%', '64.428%', '65.241%', '66.032%', '66.396%', '66.160%', '67.701%', '67.829%', '67.679%', '68.364%', '68.620%', '69.690%', '69.176%', '69.647%', '70.310%', '70.439%', '69.989%']
Workers improved  accuracies:  ['0.620%', '1.348%', '1.925%', '3.529%', '4.235%', '5.134%', '5.733%', '6.182%', '5.711%', '7.080%', '7.273%', '6.995%', '7.636%', '7.636%', '8.471%', '8.214%', '8.471%', '9.027%', '8.963%', '8.556%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 7:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.4000%', '75.3000%', '75.3000%', '75.3000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.3000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.6000%', '75.5000%', '75.5000%', '75.5000%', '75.5000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0501, 0.0501, 0.0501, 0.0499, 0.0499, 0.0500, 0.0500,
        0.0501, 0.0502, 0.0502, 0.0502, 0.0502, 0.0502, 0.0497, 0.0498, 0.0498,
        0.0498, 0.0498])
Federated model performance: Loss: 0.577722. Accuracy: 76.8556%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.642%', '61.390%', '62.118%', '64.021%', '65.134%', '65.882%', '66.717%', '67.102%', '66.973%', '68.513%', '68.556%', '68.299%', '69.326%', '69.412%', '70.267%', '69.840%', '70.053%', '71.123%', '70.888%', '70.738%']
Workers federated accuracies:  ['60.642%', '61.390%', '62.118%', '64.021%', '65.134%', '65.882%', '66.717%', '67.102%', '66.973%', '68.513%', '68.556%', '68.299%', '69.326%', '69.412%', '70.267%', '69.840%', '70.053%', '71.123%', '70.888%', '70.738%']
Workers improved  accuracies:  ['0.877%', '1.519%', '2.203%', '4.000%', '4.941%', '5.775%', '6.417%', '6.888%', '6.524%', '7.893%', '8.000%', '7.615%', '8.599%', '8.428%', '9.048%', '8.877%', '8.877%', '9.840%', '9.412%', '9.305%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 8:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.5000%', '75.5000%', '75.4000%', '75.4000%', '75.4000%', '75.0000%', '75.0000%', '75.1000%', '75.2000%', '75.5000%', '75.6000%', '75.8000%', '75.9000%', '75.8000%', '75.8000%', '75.9000%']
Computed and normalized credits:  tensor([0.0499, 0.0499, 0.0499, 0.0499, 0.0500, 0.0500, 0.0501, 0.0501, 0.0501,
        0.0506, 0.0506, 0.0505, 0.0504, 0.0500, 0.0499, 0.0496, 0.0495, 0.0497,
        0.0497, 0.0495])
Federated model performance: Loss: 0.596446. Accuracy: 77.0053%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.727%', '61.690%', '62.588%', '64.877%', '65.775%', '66.332%', '67.209%', '67.465%', '67.487%', '69.305%', '69.455%', '68.877%', '69.775%', '70.160%', '70.930%', '70.396%', '70.738%', '71.572%', '71.487%', '71.273%']
Workers federated accuracies:  ['60.727%', '61.690%', '62.588%', '64.877%', '65.775%', '66.332%', '67.209%', '67.465%', '67.487%', '69.305%', '69.455%', '68.877%', '69.775%', '70.160%', '70.930%', '70.396%', '70.738%', '71.572%', '71.487%', '71.273%']
Workers improved  accuracies:  ['0.963%', '1.818%', '2.674%', '4.856%', '5.583%', '6.225%', '6.909%', '7.251%', '7.037%', '8.684%', '8.898%', '8.193%', '9.048%', '9.176%', '9.711%', '9.433%', '9.561%', '10.289%', '10.011%', '9.840%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 9:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.6000%', '75.5000%', '75.5000%', '75.4000%', '75.6000%', '75.7000%', '75.7000%', '75.7000%', '75.9000%', '75.8000%', '75.9000%', '75.9000%', '75.8000%', '75.9000%', '75.9000%', '76.0000%', '76.0000%', '76.0000%']
Computed and normalized credits:  tensor([0.0502, 0.0502, 0.0502, 0.0503, 0.0503, 0.0504, 0.0502, 0.0501, 0.0501,
        0.0501, 0.0499, 0.0500, 0.0499, 0.0498, 0.0499, 0.0498, 0.0498, 0.0497,
        0.0497, 0.0497])
Federated model performance: Loss: 0.617446. Accuracy: 77.1551%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.791%', '62.053%', '62.995%', '65.283%', '66.160%', '66.717%', '67.807%', '68.021%', '67.979%', '70.032%', '69.968%', '69.262%', '70.503%', '70.695%', '71.572%', '71.016%', '71.059%', '72.171%', '71.936%', '71.786%']
Workers federated accuracies:  ['60.791%', '62.053%', '62.995%', '65.283%', '66.160%', '66.717%', '67.807%', '68.021%', '67.979%', '70.032%', '69.968%', '69.262%', '70.503%', '70.695%', '71.572%', '71.016%', '71.059%', '72.171%', '71.936%', '71.786%']
Workers improved  accuracies:  ['1.027%', '2.182%', '3.080%', '5.262%', '5.968%', '6.610%', '7.508%', '7.807%', '7.529%', '9.412%', '9.412%', '8.578%', '9.775%', '9.711%', '10.353%', '10.053%', '9.882%', '10.888%', '10.460%', '10.353%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Epoch 10:
Federated model validation accuracy : 75.9000%
Leave-one-out validation accuracies :  ['75.9000%', '75.9000%', '76.0000%', '76.0000%', '76.0000%', '75.9000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.1000%', '76.1000%', '76.1000%', '76.0000%', '76.0000%', '76.1000%']
Computed and normalized credits:  tensor([0.0501, 0.0501, 0.0500, 0.0500, 0.0500, 0.0502, 0.0500, 0.0500, 0.0500,
        0.0500, 0.0500, 0.0500, 0.0500, 0.0500, 0.0499, 0.0499, 0.0499, 0.0500,
        0.0500, 0.0499])
Federated model performance: Loss: 0.639484. Accuracy: 77.1337%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.856%', '62.310%', '63.401%', '65.754%', '66.545%', '67.080%', '68.235%', '68.406%', '68.257%', '70.289%', '70.545%', '69.690%', '71.080%', '71.123%', '72.128%', '71.444%', '71.701%', '72.556%', '72.471%', '72.321%']
Workers federated accuracies:  ['60.856%', '62.310%', '63.401%', '65.754%', '66.545%', '67.080%', '68.235%', '68.406%', '68.257%', '70.289%', '70.545%', '69.690%', '71.080%', '71.123%', '72.128%', '71.444%', '71.701%', '72.556%', '72.471%', '72.321%']
Workers improved  accuracies:  ['1.091%', '2.439%', '3.487%', '5.733%', '6.353%', '6.973%', '7.936%', '8.193%', '7.807%', '9.668%', '9.989%', '9.005%', '10.353%', '10.139%', '10.909%', '10.481%', '10.524%', '11.273%', '10.995%', '10.888%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.639484. Accuracy: 77.1337%.
Workers before    accuracies:  ['59.765%', '59.872%', '59.914%', '60.021%', '60.193%', '60.107%', '60.299%', '60.214%', '60.449%', '60.620%', '60.556%', '60.684%', '60.727%', '60.984%', '61.219%', '60.963%', '61.176%', '61.283%', '61.476%', '61.433%']
Workers standlone accuracies:  ['60.856%', '62.310%', '63.401%', '65.754%', '66.545%', '67.080%', '68.235%', '68.406%', '68.257%', '70.289%', '70.545%', '69.690%', '71.080%', '71.123%', '72.128%', '71.444%', '71.701%', '72.556%', '72.471%', '72.321%']
Workers federated accuracies:  ['60.856%', '62.310%', '63.401%', '65.754%', '66.545%', '67.080%', '68.235%', '68.406%', '68.257%', '70.289%', '70.545%', '69.690%', '71.080%', '71.123%', '72.128%', '71.444%', '71.701%', '72.556%', '72.471%', '72.321%']
Workers improved  accuracies:  ['1.091%', '2.439%', '3.487%', '5.733%', '6.353%', '6.973%', '7.936%', '8.193%', '7.807%', '9.668%', '9.989%', '9.005%', '10.353%', '10.139%', '10.909%', '10.481%', '10.524%', '11.273%', '10.995%', '10.888%']
Workers shard sizes:  [64, 96, 144, 192, 224, 272, 304, 352, 400, 432, 480, 528, 560, 608, 640, 688, 736, 768, 816, 848]
Workers sharing_contributions :  tensor([ 3.2000,  4.8000,  7.2000,  9.6000, 11.2000, 13.6000, 15.2000, 17.6000,
        20.0000, 21.6000, 24.0000, 26.4000, 28.0000, 30.4000, 32.0000, 34.4000,
        36.8000, 38.4000, 40.8000, 42.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.4410626699759651, 0.05157853033604385)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.937313145783369, 1.1293286611961351e-09)
Correlation between test_acc improvements & sharing_contributions:  (0.9129330350973347, 1.9841209723948504e-08)
standalone_vs_final_corr [[0.9999999999999998], [0.9999999999999999], [1.0], [1.0], [1.0]]
standalone_vs_final_corr_mean [1.0]
standalone_vs_final_corr_std [1.1102230246251565e-16]
sharingcontribution_vs_final_corr [[0.9408534809461744], [0.977318980779798], [0.9655393482177754], [0.9872744122213304], [0.937313145783369]]
sharingcontribution_vs_final_corr_mean [0.9616598735896893]
sharingcontribution_vs_final_corr_std [0.01970802719910987]
standalone_vs_federated_perturbed_corr [[0.5480275809760834], [-0.01865145588005155], [0.18418783517045556], [0.08630088319898081], [-0.4410626699759651]]
standalone_vs_federated_perturbed_corr_mean [0.07176043469790061]
standalone_vs_federated_perturbed_corr_std [0.31963841642981994]
federated_final_performance [0.7674866318702698, 0.7546523809432983, 0.7349732518196106, 0.7574331760406494, 0.7713369131088257]
federated_final_performance_mean 0.7571764707565307
federated_final_performance_std 0.012698325936538975
CFFL_best_worker [0.7341176271438599, 0.7251337170600891, 0.7283422350883484, 0.7193582653999329, 0.7255614995956421]
CFFL_best_worker_mean 0.7265026688575744
CFFL_best_worker_std 0.004799456698174835
standalone_best_worker [0.7341176271438599, 0.7251337170600891, 0.7283422350883484, 0.7193582653999329, 0.7255614995956421]
standalone_best_worker_mean 0.7265026688575744
standalone_best_worker_std 0.004799456698174835
