Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 10, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 20, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.737094. Accuracy: 60.0642%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 68.1000%
Leave-one-out validation accuracies :  ['68.1000%', '68.4000%', '68.6000%', '69.3000%', '69.5000%', '69.6000%', '71.2000%', '71.6000%', '71.8000%', '71.7000%']
Computed and normalized credits:  tensor([0.1044, 0.1037, 0.1032, 0.1016, 0.1011, 0.1008, 0.0972, 0.0962, 0.0958,
        0.0960])
Federated model performance: Loss: 0.648919. Accuracy: 70.1604%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['55.144%', '57.882%', '60.813%', '62.289%', '63.465%', '64.770%', '65.989%', '66.481%', '67.209%', '67.273%']
Workers federated accuracies:  ['55.144%', '57.882%', '60.813%', '62.289%', '63.465%', '64.770%', '65.989%', '66.481%', '67.209%', '67.273%']
Workers improved  accuracies:  ['0.406%', '2.160%', '3.080%', '3.658%', '3.679%', '4.021%', '4.578%', '4.064%', '4.171%', '3.829%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 2:
Federated model validation accuracy : 71.0000%
Leave-one-out validation accuracies :  ['71.1000%', '71.3000%', '71.5000%', '71.4000%', '71.6000%', '71.6000%', '71.8000%', '72.3000%', '72.4000%', '72.6000%']
Computed and normalized credits:  tensor([0.1022, 0.1016, 0.1011, 0.1011, 0.1005, 0.1005, 0.0994, 0.0982, 0.0979,
        0.0975])
Federated model performance: Loss: 0.600844. Accuracy: 72.9198%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['55.872%', '59.422%', '63.144%', '64.599%', '66.246%', '66.973%', '67.615%', '68.107%', '68.663%', '68.749%']
Workers federated accuracies:  ['55.872%', '59.422%', '63.144%', '64.599%', '66.246%', '66.973%', '67.615%', '68.107%', '68.663%', '68.749%']
Workers improved  accuracies:  ['1.134%', '3.701%', '5.412%', '5.968%', '6.460%', '6.225%', '6.203%', '5.690%', '5.626%', '5.305%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 3:
Federated model validation accuracy : 71.6000%
Leave-one-out validation accuracies :  ['71.6000%', '71.7000%', '71.7000%', '72.3000%', '72.5000%', '72.5000%', '72.7000%', '72.5000%', '72.7000%', '72.9000%']
Computed and normalized credits:  tensor([0.1019, 0.1016, 0.1015, 0.1002, 0.0997, 0.0997, 0.0990, 0.0993, 0.0988,
        0.0983])
Federated model performance: Loss: 0.579626. Accuracy: 73.9465%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['56.663%', '60.963%', '64.684%', '66.524%', '67.380%', '67.914%', '68.642%', '69.369%', '69.754%', '69.711%']
Workers federated accuracies:  ['56.663%', '60.963%', '64.684%', '66.524%', '67.380%', '67.914%', '68.642%', '69.369%', '69.754%', '69.711%']
Workers improved  accuracies:  ['1.925%', '5.241%', '6.952%', '7.893%', '7.594%', '7.166%', '7.230%', '6.952%', '6.717%', '6.267%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 4:
Federated model validation accuracy : 72.9000%
Leave-one-out validation accuracies :  ['72.9000%', '72.8000%', '72.7000%', '72.5000%', '72.8000%', '72.6000%', '72.9000%', '73.2000%', '73.4000%', '73.6000%']
Computed and normalized credits:  tensor([0.1004, 0.1006, 0.1008, 0.1010, 0.1002, 0.1007, 0.0999, 0.0993, 0.0988,
        0.0983])
Federated model performance: Loss: 0.574980. Accuracy: 74.5668%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['57.305%', '62.246%', '65.840%', '67.380%', '68.278%', '68.727%', '69.476%', '70.139%', '70.332%', '70.545%']
Workers federated accuracies:  ['57.305%', '62.246%', '65.840%', '67.380%', '68.278%', '68.727%', '69.476%', '70.139%', '70.332%', '70.545%']
Workers improved  accuracies:  ['2.567%', '6.524%', '8.107%', '8.749%', '8.492%', '7.979%', '8.064%', '7.722%', '7.294%', '7.102%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 5:
Federated model validation accuracy : 73.1000%
Leave-one-out validation accuracies :  ['73.1000%', '73.1000%', '73.0000%', '73.3000%', '73.3000%', '73.5000%', '73.5000%', '73.7000%', '73.7000%', '74.0000%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1010, 0.1004, 0.1003, 0.0999, 0.0998, 0.0993, 0.0992,
        0.0985])
Federated model performance: Loss: 0.580281. Accuracy: 75.3369%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['57.925%', '63.166%', '66.631%', '68.406%', '69.027%', '69.283%', '70.053%', '70.567%', '71.273%', '71.422%']
Workers federated accuracies:  ['57.925%', '63.166%', '66.631%', '68.406%', '69.027%', '69.283%', '70.053%', '70.567%', '71.273%', '71.422%']
Workers improved  accuracies:  ['3.187%', '7.444%', '8.898%', '9.775%', '9.241%', '8.535%', '8.642%', '8.150%', '8.235%', '7.979%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 6:
Federated model validation accuracy : 73.7000%
Leave-one-out validation accuracies :  ['73.7000%', '73.7000%', '73.7000%', '73.5000%', '73.9000%', '73.9000%', '74.3000%', '74.1000%', '74.1000%', '74.2000%']
Computed and normalized credits:  tensor([0.1006, 0.1006, 0.1006, 0.1009, 0.1001, 0.1000, 0.0991, 0.0995, 0.0995,
        0.0991])
Federated model performance: Loss: 0.591851. Accuracy: 75.6578%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['58.652%', '64.150%', '67.144%', '69.005%', '69.561%', '69.754%', '70.674%', '71.187%', '72.150%', '72.321%']
Workers federated accuracies:  ['58.652%', '64.150%', '67.144%', '69.005%', '69.561%', '69.754%', '70.674%', '71.187%', '72.150%', '72.321%']
Workers improved  accuracies:  ['3.914%', '8.428%', '9.412%', '10.374%', '9.775%', '9.005%', '9.262%', '8.770%', '9.112%', '8.877%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 7:
Federated model validation accuracy : 73.9000%
Leave-one-out validation accuracies :  ['73.9000%', '74.0000%', '74.1000%', '74.0000%', '74.2000%', '74.1000%', '74.3000%', '74.3000%', '74.8000%', '74.7000%']
Computed and normalized credits:  tensor([0.1008, 0.1006, 0.1004, 0.1007, 0.1001, 0.1003, 0.0997, 0.0998, 0.0987,
        0.0989])
Federated model performance: Loss: 0.606753. Accuracy: 76.0000%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['59.337%', '64.856%', '67.722%', '69.283%', '69.947%', '70.182%', '71.230%', '72.278%', '73.048%', '72.984%']
Workers federated accuracies:  ['59.337%', '64.856%', '67.722%', '69.283%', '69.947%', '70.182%', '71.230%', '72.278%', '73.048%', '72.984%']
Workers improved  accuracies:  ['4.599%', '9.134%', '9.989%', '10.652%', '10.160%', '9.433%', '9.818%', '9.861%', '10.011%', '9.540%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 8:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.3000%', '74.4000%', '74.4000%', '74.5000%', '74.8000%', '74.8000%', '74.7000%', '74.8000%', '74.8000%', '75.0000%']
Computed and normalized credits:  tensor([0.1009, 0.1006, 0.1006, 0.1004, 0.0997, 0.0997, 0.0998, 0.0996, 0.0995,
        0.0991])
Federated model performance: Loss: 0.623550. Accuracy: 76.2995%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['59.914%', '65.390%', '68.299%', '69.711%', '70.225%', '70.674%', '71.850%', '73.005%', '73.882%', '73.947%']
Workers federated accuracies:  ['59.914%', '65.390%', '68.299%', '69.711%', '70.225%', '70.674%', '71.850%', '73.005%', '73.882%', '73.947%']
Workers improved  accuracies:  ['5.176%', '9.668%', '10.567%', '11.080%', '10.439%', '9.925%', '10.439%', '10.588%', '10.845%', '10.503%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 9:
Federated model validation accuracy : 74.7000%
Leave-one-out validation accuracies :  ['74.7000%', '74.9000%', '74.9000%', '74.8000%', '74.9000%', '74.8000%', '74.7000%', '75.2000%', '75.3000%', '75.4000%']
Computed and normalized credits:  tensor([0.1007, 0.1002, 0.1002, 0.1004, 0.1001, 0.1003, 0.1005, 0.0994, 0.0992,
        0.0989])
Federated model performance: Loss: 0.641240. Accuracy: 76.4920%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['60.299%', '66.011%', '68.706%', '70.439%', '70.374%', '70.973%', '72.535%', '73.497%', '74.503%', '74.545%']
Workers federated accuracies:  ['60.299%', '66.011%', '68.706%', '70.439%', '70.374%', '70.973%', '72.535%', '73.497%', '74.503%', '74.545%']
Workers improved  accuracies:  ['5.562%', '10.289%', '10.973%', '11.807%', '10.588%', '10.225%', '11.123%', '11.080%', '11.465%', '11.102%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 10:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '74.8000%', '74.8000%', '75.0000%', '75.2000%', '75.2000%', '75.3000%', '75.4000%', '75.4000%', '75.4000%']
Computed and normalized credits:  tensor([0.1004, 0.1008, 0.1008, 0.1004, 0.0999, 0.0999, 0.0998, 0.0994, 0.0993,
        0.0993])
Federated model performance: Loss: 0.659626. Accuracy: 76.7273%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['60.877%', '66.417%', '68.941%', '70.802%', '70.738%', '71.422%', '73.134%', '73.989%', '74.845%', '74.845%']
Workers federated accuracies:  ['60.877%', '66.417%', '68.941%', '70.802%', '70.738%', '71.422%', '73.134%', '73.989%', '74.845%', '74.845%']
Workers improved  accuracies:  ['6.139%', '10.695%', '11.209%', '12.171%', '10.952%', '10.674%', '11.722%', '11.572%', '11.807%', '11.401%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 11:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1001, 0.1000, 0.1000,
        0.0998])
Federated model performance: Loss: 0.676935. Accuracy: 77.0481%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['61.305%', '66.759%', '69.091%', '71.401%', '71.465%', '71.807%', '73.733%', '74.396%', '75.209%', '75.401%']
Workers federated accuracies:  ['75.401%', '75.380%', '75.594%', '76.086%', '75.722%', '75.914%', '76.278%', '76.278%', '76.406%', '76.471%']
Workers improved  accuracies:  ['20.663%', '19.658%', '17.861%', '17.455%', '15.936%', '15.166%', '14.866%', '13.861%', '13.369%', '13.027%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 12:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.5000%', '75.6000%', '75.7000%', '75.7000%', '75.7000%', '75.8000%', '76.0000%', '76.1000%', '76.4000%', '76.8000%']
Computed and normalized credits:  tensor([0.1009, 0.1007, 0.1005, 0.1005, 0.1005, 0.1003, 0.0999, 0.0996, 0.0990,
        0.0982])
Federated model performance: Loss: 0.656809. Accuracy: 77.2193%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['61.668%', '67.059%', '69.412%', '71.979%', '71.850%', '72.107%', '74.032%', '74.824%', '75.337%', '75.722%']
Workers federated accuracies:  ['75.594%', '75.444%', '75.701%', '76.257%', '75.936%', '76.064%', '76.406%', '76.578%', '76.535%', '76.770%']
Workers improved  accuracies:  ['20.856%', '19.722%', '17.968%', '17.626%', '16.150%', '15.316%', '14.995%', '14.160%', '13.497%', '13.326%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 13:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '76.0000%', '76.2000%', '76.2000%', '76.6000%', '76.9000%', '76.8000%', '76.8000%', '76.9000%']
Computed and normalized credits:  tensor([0.1011, 0.1010, 0.1010, 0.1006, 0.1006, 0.0997, 0.0990, 0.0992, 0.0991,
        0.0987])
Federated model performance: Loss: 0.638591. Accuracy: 77.4118%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['61.968%', '67.273%', '69.711%', '72.278%', '72.535%', '72.513%', '74.610%', '75.037%', '75.529%', '75.807%']
Workers federated accuracies:  ['75.872%', '75.701%', '75.979%', '76.449%', '76.193%', '76.299%', '76.727%', '76.706%', '76.642%', '77.027%']
Workers improved  accuracies:  ['21.134%', '19.979%', '18.246%', '17.818%', '16.406%', '15.551%', '15.316%', '14.289%', '13.604%', '13.583%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 14:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.8000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1001, 0.1001, 0.1000, 0.0998, 0.0999, 0.0998,
        0.0998])
Federated model performance: Loss: 0.622362. Accuracy: 77.5615%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['62.374%', '67.465%', '70.032%', '72.791%', '72.984%', '72.941%', '74.695%', '75.401%', '75.572%', '76.107%']
Workers federated accuracies:  ['76.021%', '75.872%', '76.150%', '76.578%', '76.406%', '76.535%', '76.834%', '76.791%', '76.813%', '77.112%']
Workers improved  accuracies:  ['21.283%', '20.150%', '18.417%', '17.947%', '16.620%', '15.786%', '15.422%', '14.374%', '13.775%', '13.668%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 15:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.7000%', '76.6000%', '76.8000%', '76.8000%', '76.8000%', '77.2000%', '77.2000%', '77.1000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1004, 0.1006, 0.1002, 0.1002, 0.1001, 0.0993, 0.0993,
        0.0995])
Federated model performance: Loss: 0.607798. Accuracy: 77.6471%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['62.610%', '67.765%', '70.225%', '73.091%', '73.390%', '73.433%', '74.866%', '75.401%', '75.572%', '76.278%']
Workers federated accuracies:  ['76.086%', '76.128%', '76.364%', '76.620%', '76.535%', '76.684%', '76.920%', '76.856%', '77.005%', '77.283%']
Workers improved  accuracies:  ['21.348%', '20.406%', '18.631%', '17.989%', '16.749%', '15.936%', '15.508%', '14.439%', '13.968%', '13.840%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 16:
Federated model validation accuracy : 76.7000%
Leave-one-out validation accuracies :  ['76.8000%', '77.0000%', '77.0000%', '77.1000%', '77.3000%', '77.2000%', '77.2000%', '77.2000%', '77.3000%', '77.2000%']
Computed and normalized credits:  tensor([0.1007, 0.1003, 0.1003, 0.1002, 0.0997, 0.0999, 0.0999, 0.0997, 0.0995,
        0.0998])
Federated model performance: Loss: 0.594823. Accuracy: 77.9465%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['62.888%', '68.086%', '70.631%', '73.283%', '73.412%', '73.733%', '75.187%', '75.508%', '75.615%', '76.471%']
Workers federated accuracies:  ['76.278%', '76.214%', '76.513%', '76.706%', '76.663%', '76.834%', '76.984%', '77.070%', '77.176%', '77.305%']
Workers improved  accuracies:  ['21.540%', '20.492%', '18.781%', '18.075%', '16.877%', '16.086%', '15.572%', '14.652%', '14.139%', '13.861%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 17:
Federated model validation accuracy : 77.1000%
Leave-one-out validation accuracies :  ['77.1000%', '77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.4000%', '77.2000%', '77.2000%', '77.2000%', '77.6000%']
Computed and normalized credits:  tensor([0.1004, 0.1002, 0.1002, 0.1001, 0.1000, 0.0997, 0.1001, 0.1001, 0.1000,
        0.0993])
Federated model performance: Loss: 0.583128. Accuracy: 78.0321%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['63.273%', '68.342%', '70.759%', '73.626%', '73.626%', '74.118%', '75.187%', '75.401%', '75.658%', '76.428%']
Workers federated accuracies:  ['76.364%', '76.406%', '76.684%', '76.727%', '76.749%', '76.898%', '77.048%', '77.112%', '77.369%', '77.476%']
Workers improved  accuracies:  ['21.626%', '20.684%', '18.952%', '18.096%', '16.963%', '16.150%', '15.636%', '14.695%', '14.332%', '14.032%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 18:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.3000%', '77.3000%', '77.3000%', '77.3000%', '77.3000%', '77.3000%', '77.5000%', '77.6000%', '77.5000%', '77.7000%']
Computed and normalized credits:  tensor([0.1003, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.0998, 0.0996, 0.0998,
        0.0993])
Federated model performance: Loss: 0.572630. Accuracy: 78.2460%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['63.722%', '68.385%', '70.845%', '74.118%', '73.818%', '74.374%', '75.487%', '75.529%', '75.658%', '76.599%']
Workers federated accuracies:  ['76.492%', '76.428%', '76.791%', '76.727%', '76.770%', '77.112%', '77.219%', '77.134%', '77.497%', '77.797%']
Workers improved  accuracies:  ['21.754%', '20.706%', '19.059%', '18.096%', '16.984%', '16.364%', '15.807%', '14.717%', '14.460%', '14.353%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 19:
Federated model validation accuracy : 77.5000%
Leave-one-out validation accuracies :  ['77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.7000%', '77.6000%', '77.7000%', '77.9000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.0997, 0.0999, 0.0997,
        0.0993])
Federated model performance: Loss: 0.563159. Accuracy: 78.3315%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['64.064%', '68.556%', '70.888%', '74.182%', '73.968%', '74.503%', '75.722%', '75.722%', '75.765%', '76.642%']
Workers federated accuracies:  ['76.599%', '76.513%', '76.813%', '76.813%', '76.834%', '77.262%', '77.134%', '77.348%', '77.540%', '78.011%']
Workers improved  accuracies:  ['21.861%', '20.791%', '19.080%', '18.182%', '17.048%', '16.513%', '15.722%', '14.930%', '14.503%', '14.567%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 20:
Federated model validation accuracy : 77.5000%
Leave-one-out validation accuracies :  ['77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.7000%', '77.7000%', '77.8000%', '77.7000%', '77.8000%', '77.8000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1003, 0.0999, 0.0999, 0.0997, 0.0999, 0.0997,
        0.0996])
Federated model performance: Loss: 0.554489. Accuracy: 78.4813%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['64.235%', '68.898%', '71.102%', '74.374%', '74.075%', '74.631%', '75.829%', '75.872%', '75.914%', '76.663%']
Workers federated accuracies:  ['76.642%', '76.578%', '76.877%', '76.984%', '76.834%', '77.305%', '77.369%', '77.455%', '77.754%', '78.075%']
Workers improved  accuracies:  ['21.904%', '20.856%', '19.144%', '18.353%', '17.048%', '16.556%', '15.957%', '15.037%', '14.717%', '14.631%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.554489. Accuracy: 78.4813%.
Workers before    accuracies:  ['54.738%', '55.722%', '57.733%', '58.631%', '59.786%', '60.749%', '61.412%', '62.417%', '63.037%', '63.444%']
Workers standlone accuracies:  ['64.235%', '68.898%', '71.102%', '74.374%', '74.075%', '74.631%', '75.829%', '75.872%', '75.914%', '76.663%']
Workers federated accuracies:  ['76.642%', '76.578%', '76.877%', '76.984%', '76.834%', '77.305%', '77.369%', '77.455%', '77.754%', '78.075%']
Workers improved  accuracies:  ['21.904%', '20.856%', '19.144%', '18.353%', '17.048%', '16.556%', '15.957%', '15.037%', '14.717%', '14.631%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]
Workers sharing_contributions :  tensor([ 11.2000,  28.8000,  46.4000,  64.0000,  81.6000,  99.2000, 116.8000,
        134.4000, 152.0000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.20784271552195993, 0.5644807281418149)
Correlation between stand alone test acc & collaborative final model acc:  (0.779258696982579, 0.007881079417986665)
Correlation between test_acc & sharing contributions:  (0.9608605947653236, 9.792412567250827e-06)
Correlation between test_acc improvements & sharing_contributions:  (-0.9748218486726421, 1.7056536051655096e-06)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.677349. Accuracy: 62.6738%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 72.3000%
Leave-one-out validation accuracies :  ['72.2000%', '72.2000%', '72.5000%', '72.7000%', '73.2000%', '73.6000%', '73.8000%', '73.8000%', '74.4000%', '74.2000%']
Computed and normalized credits:  tensor([0.1023, 0.1023, 0.1017, 0.1012, 0.1001, 0.0993, 0.0988, 0.0988, 0.0975,
        0.0980])
Federated model performance: Loss: 0.591157. Accuracy: 73.4973%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['60.706%', '61.925%', '62.866%', '63.358%', '64.492%', '65.283%', '65.882%', '66.824%', '67.465%', '67.658%']
Workers federated accuracies:  ['69.519%', '69.775%', '70.075%', '70.695%', '70.866%', '71.358%', '71.572%', '72.021%', '72.257%', '72.257%']
Workers improved  accuracies:  ['9.048%', '8.791%', '8.299%', '8.535%', '8.299%', '8.364%', '8.471%', '8.385%', '8.364%', '8.000%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 2:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.0000%', '73.9000%', '74.0000%', '74.1000%', '73.7000%', '73.7000%', '74.4000%', '74.5000%', '74.8000%', '74.8000%']
Computed and normalized credits:  tensor([0.1008, 0.1010, 0.1007, 0.1004, 0.1011, 0.1009, 0.0994, 0.0991, 0.0983,
        0.0984])
Federated model performance: Loss: 0.551864. Accuracy: 74.7808%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['61.048%', '62.545%', '63.786%', '65.283%', '66.267%', '67.679%', '68.107%', '69.091%', '69.775%', '70.053%']
Workers federated accuracies:  ['73.027%', '73.134%', '73.262%', '73.604%', '73.519%', '73.519%', '74.075%', '74.011%', '74.118%', '74.225%']
Workers improved  accuracies:  ['12.556%', '12.150%', '11.487%', '11.444%', '10.952%', '10.524%', '10.973%', '10.374%', '10.225%', '9.968%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 3:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2000%', '74.4000%', '74.6000%', '74.9000%', '74.9000%', '75.1000%', '75.0000%', '75.1000%', '74.9000%']
Computed and normalized credits:  tensor([0.1013, 0.1013, 0.1008, 0.1003, 0.0998, 0.0998, 0.0991, 0.0993, 0.0989,
        0.0994])
Federated model performance: Loss: 0.533290. Accuracy: 75.7647%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['61.390%', '63.187%', '65.198%', '66.866%', '67.893%', '69.048%', '70.011%', '70.759%', '71.893%', '71.957%']
Workers federated accuracies:  ['73.882%', '73.797%', '74.118%', '74.417%', '74.396%', '74.503%', '74.610%', '74.717%', '74.717%', '74.717%']
Workers improved  accuracies:  ['13.412%', '12.813%', '12.342%', '12.257%', '11.829%', '11.508%', '11.508%', '11.080%', '10.824%', '10.460%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 4:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.1000%', '75.1000%', '75.1000%', '75.0000%', '74.9000%', '74.9000%', '75.1000%', '75.1000%', '75.2000%']
Computed and normalized credits:  tensor([0.1003, 0.1001, 0.1000, 0.1000, 0.1001, 0.1003, 0.1002, 0.0998, 0.0997,
        0.0996])
Federated model performance: Loss: 0.523828. Accuracy: 76.0428%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['61.690%', '63.722%', '66.417%', '68.257%', '68.984%', '70.503%', '70.824%', '72.513%', '72.963%', '72.770%']
Workers federated accuracies:  ['74.353%', '74.481%', '74.610%', '74.930%', '74.845%', '74.888%', '75.102%', '75.123%', '75.187%', '75.273%']
Workers improved  accuracies:  ['13.882%', '13.497%', '12.834%', '12.770%', '12.278%', '11.893%', '12.000%', '11.487%', '11.294%', '11.016%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 5:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.0000%', '75.1000%', '75.1000%', '75.0000%', '75.1000%', '75.0000%', '75.4000%', '75.6000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1001, 0.1001, 0.1003, 0.1001, 0.1002, 0.0994,
        0.0990])
Federated model performance: Loss: 0.518444. Accuracy: 76.4064%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['61.947%', '64.449%', '67.337%', '69.326%', '70.011%', '71.765%', '72.257%', '73.198%', '73.583%', '73.668%']
Workers federated accuracies:  ['74.888%', '74.995%', '74.973%', '75.251%', '75.166%', '75.230%', '75.465%', '75.444%', '75.465%', '75.658%']
Workers improved  accuracies:  ['14.417%', '14.011%', '13.198%', '13.091%', '12.599%', '12.235%', '12.364%', '11.807%', '11.572%', '11.401%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 6:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '74.9000%', '75.0000%', '75.0000%', '75.2000%', '75.4000%', '75.4000%', '75.5000%', '75.6000%', '75.7000%']
Computed and normalized credits:  tensor([0.1006, 0.1008, 0.1006, 0.1006, 0.1002, 0.0998, 0.0997, 0.0996, 0.0992,
        0.0989])
Federated model performance: Loss: 0.513866. Accuracy: 76.6845%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['62.160%', '65.219%', '68.513%', '70.182%', '71.166%', '72.471%', '73.048%', '73.775%', '73.947%', '74.075%']
Workers federated accuracies:  ['75.209%', '75.401%', '75.380%', '75.572%', '75.380%', '75.572%', '75.679%', '75.743%', '75.914%', '76.107%']
Workers improved  accuracies:  ['14.738%', '14.417%', '13.604%', '13.412%', '12.813%', '12.578%', '12.578%', '12.107%', '12.021%', '11.850%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 7:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.3000%', '75.3000%', '75.4000%', '75.4000%', '75.5000%', '75.5000%', '75.6000%', '75.6000%', '75.7000%', '75.4000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1002, 0.1002, 0.1000, 0.0999, 0.0997, 0.0997, 0.0994,
        0.1000])
Federated model performance: Loss: 0.509737. Accuracy: 77.0695%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['62.503%', '65.947%', '69.005%', '70.909%', '71.807%', '73.005%', '73.583%', '74.011%', '74.203%', '74.374%']
Workers federated accuracies:  ['75.615%', '75.594%', '75.679%', '75.807%', '75.765%', '75.893%', '76.000%', '76.235%', '76.214%', '76.684%']
Workers improved  accuracies:  ['15.144%', '14.610%', '13.904%', '13.647%', '13.198%', '12.898%', '12.898%', '12.599%', '12.321%', '12.428%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 8:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.6000%', '75.7000%', '75.7000%', '75.6000%', '75.8000%', '75.5000%', '75.3000%', '75.4000%', '75.6000%']
Computed and normalized credits:  tensor([0.1004, 0.1000, 0.0998, 0.0997, 0.0999, 0.0995, 0.1001, 0.1005, 0.1002,
        0.0999])
Federated model performance: Loss: 0.505853. Accuracy: 77.5187%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['62.695%', '66.567%', '69.626%', '71.615%', '72.428%', '73.455%', '73.989%', '74.396%', '74.567%', '74.738%']
Workers federated accuracies:  ['75.979%', '75.765%', '75.850%', '76.235%', '76.021%', '76.193%', '76.385%', '76.620%', '76.535%', '76.984%']
Workers improved  accuracies:  ['15.508%', '14.781%', '14.075%', '14.075%', '13.455%', '13.198%', '13.283%', '12.984%', '12.642%', '12.727%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 9:
Federated model validation accuracy : 75.5000%
Leave-one-out validation accuracies :  ['75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.3000%', '75.6000%', '75.6000%', '75.8000%', '75.9000%', '76.1000%']
Computed and normalized credits:  tensor([0.1005, 0.1004, 0.1004, 0.1004, 0.1006, 0.0999, 0.1000, 0.0996, 0.0994,
        0.0989])
Federated model performance: Loss: 0.502491. Accuracy: 77.8182%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['62.738%', '67.294%', '70.160%', '72.428%', '72.749%', '73.668%', '74.310%', '74.824%', '75.059%', '75.059%']
Workers federated accuracies:  ['76.235%', '76.150%', '76.171%', '76.406%', '76.342%', '76.642%', '76.770%', '76.898%', '76.856%', '77.326%']
Workers improved  accuracies:  ['15.765%', '15.166%', '14.396%', '14.246%', '13.775%', '13.647%', '13.668%', '13.262%', '12.963%', '13.070%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 10:
Federated model validation accuracy : 75.7000%
Leave-one-out validation accuracies :  ['75.7000%', '75.7000%', '75.7000%', '75.9000%', '75.9000%', '76.0000%', '76.1000%', '76.1000%', '76.2000%', '76.4000%']
Computed and normalized credits:  tensor([0.1006, 0.1006, 0.1006, 0.1002, 0.1002, 0.0999, 0.0997, 0.0997, 0.0994,
        0.0989])
Federated model performance: Loss: 0.499637. Accuracy: 78.0963%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['62.930%', '67.872%', '70.674%', '72.877%', '73.262%', '74.075%', '74.353%', '74.995%', '75.251%', '75.358%']
Workers federated accuracies:  ['76.342%', '76.278%', '76.406%', '76.620%', '76.578%', '76.706%', '76.920%', '77.048%', '77.112%', '77.561%']
Workers improved  accuracies:  ['15.872%', '15.294%', '14.631%', '14.460%', '14.011%', '13.711%', '13.818%', '13.412%', '13.219%', '13.305%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 11:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.2000%', '76.1000%', '76.1000%', '76.3000%', '76.4000%', '76.3000%', '76.4000%', '76.7000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1004, 0.1004, 0.1000, 0.0997, 0.0999, 0.0997,
        0.0990])
Federated model performance: Loss: 0.497068. Accuracy: 78.3743%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['63.102%', '68.406%', '71.251%', '73.262%', '73.519%', '74.289%', '74.717%', '75.209%', '75.465%', '75.529%']
Workers federated accuracies:  ['76.428%', '76.471%', '76.642%', '76.877%', '76.770%', '76.984%', '77.027%', '77.091%', '77.412%', '77.711%']
Workers improved  accuracies:  ['15.957%', '15.487%', '14.866%', '14.717%', '14.203%', '13.989%', '13.925%', '13.455%', '13.519%', '13.455%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 12:
Federated model validation accuracy : 76.5000%
Leave-one-out validation accuracies :  ['76.5000%', '76.6000%', '76.6000%', '76.4000%', '76.4000%', '76.4000%', '76.3000%', '76.5000%', '76.8000%', '76.8000%']
Computed and normalized credits:  tensor([0.1001, 0.0999, 0.0999, 0.1003, 0.1003, 0.1003, 0.1004, 0.1000, 0.0994,
        0.0993])
Federated model performance: Loss: 0.494726. Accuracy: 78.5455%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['63.337%', '68.642%', '71.722%', '73.583%', '73.711%', '74.460%', '75.037%', '75.529%', '75.743%', '75.979%']
Workers federated accuracies:  ['76.642%', '76.620%', '76.749%', '77.048%', '76.920%', '77.134%', '77.176%', '77.412%', '77.497%', '77.947%']
Workers improved  accuracies:  ['16.171%', '15.636%', '14.973%', '14.888%', '14.353%', '14.139%', '14.075%', '13.775%', '13.604%', '13.690%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 13:
Federated model validation accuracy : 76.7000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.8000%', '76.6000%', '76.5000%', '76.7000%', '76.8000%', '76.8000%', '77.0000%', '77.4000%']
Computed and normalized credits:  tensor([0.1001, 0.1000, 0.1000, 0.1005, 0.1007, 0.1003, 0.1001, 0.1000, 0.0995,
        0.0987])
Federated model performance: Loss: 0.492689. Accuracy: 78.8235%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['63.722%', '68.984%', '72.064%', '73.775%', '73.754%', '74.610%', '75.187%', '75.701%', '76.043%', '76.171%']
Workers federated accuracies:  ['76.770%', '76.727%', '76.898%', '77.048%', '77.070%', '77.305%', '77.369%', '77.626%', '77.647%', '78.053%']
Workers improved  accuracies:  ['16.299%', '15.743%', '15.123%', '14.888%', '14.503%', '14.310%', '14.267%', '13.989%', '13.754%', '13.797%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 14:
Federated model validation accuracy : 76.9000%
Leave-one-out validation accuracies :  ['77.0000%', '77.0000%', '76.9000%', '76.9000%', '77.0000%', '77.1000%', '77.2000%', '77.4000%', '77.5000%', '77.5000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1005, 0.1006, 0.1004, 0.1001, 0.0999, 0.0995, 0.0992,
        0.0991])
Federated model performance: Loss: 0.490794. Accuracy: 78.9091%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['63.979%', '69.390%', '72.321%', '73.989%', '74.032%', '74.738%', '75.444%', '75.765%', '76.171%', '76.492%']
Workers federated accuracies:  ['76.856%', '76.877%', '77.134%', '77.305%', '77.176%', '77.519%', '77.519%', '77.818%', '77.775%', '78.246%']
Workers improved  accuracies:  ['16.385%', '15.893%', '15.358%', '15.144%', '14.610%', '14.524%', '14.417%', '14.182%', '13.882%', '13.989%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 15:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.5000%', '77.5000%', '77.5000%', '77.4000%', '77.5000%', '77.5000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1000, 0.0999, 0.0999, 0.1000, 0.0998,
        0.0997])
Federated model performance: Loss: 0.489016. Accuracy: 79.0160%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['64.128%', '69.626%', '72.449%', '74.182%', '74.182%', '74.738%', '75.679%', '75.893%', '76.299%', '76.578%']
Workers federated accuracies:  ['76.984%', '76.984%', '77.369%', '77.326%', '77.262%', '77.604%', '77.690%', '77.968%', '77.947%', '78.439%']
Workers improved  accuracies:  ['16.513%', '16.000%', '15.594%', '15.166%', '14.695%', '14.610%', '14.588%', '14.332%', '14.053%', '14.182%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 16:
Federated model validation accuracy : 77.5000%
Leave-one-out validation accuracies :  ['77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.6000%', '77.4000%', '77.5000%', '77.5000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.0998, 0.1002, 0.1000,
        0.1000])
Federated model performance: Loss: 0.487405. Accuracy: 79.2727%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['64.428%', '69.925%', '72.578%', '74.353%', '74.503%', '74.845%', '75.807%', '76.043%', '76.385%', '76.770%']
Workers federated accuracies:  ['76.941%', '77.134%', '77.455%', '77.412%', '77.390%', '77.733%', '77.904%', '78.053%', '78.139%', '78.631%']
Workers improved  accuracies:  ['16.471%', '16.150%', '15.679%', '15.251%', '14.824%', '14.738%', '14.802%', '14.417%', '14.246%', '14.374%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 17:
Federated model validation accuracy : 77.5000%
Leave-one-out validation accuracies :  ['77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.4000%', '77.5000%', '77.5000%', '77.4000%', '77.5000%', '77.6000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1002, 0.1000, 0.0999, 0.1002, 0.1000,
        0.0998])
Federated model performance: Loss: 0.485750. Accuracy: 79.5936%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['64.706%', '70.267%', '72.877%', '74.481%', '74.717%', '75.059%', '75.829%', '76.193%', '76.428%', '76.791%']
Workers federated accuracies:  ['77.112%', '77.305%', '77.519%', '77.412%', '77.540%', '77.947%', '77.925%', '78.246%', '78.396%', '78.759%']
Workers improved  accuracies:  ['16.642%', '16.321%', '15.743%', '15.251%', '14.973%', '14.952%', '14.824%', '14.610%', '14.503%', '14.503%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 18:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.5000%', '77.6000%', '77.5000%', '77.5000%', '77.6000%', '77.6000%', '77.5000%', '77.5000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1000, 0.0998, 0.1001, 0.1000, 0.0998, 0.0999, 0.1000,
        0.1000])
Federated model performance: Loss: 0.484241. Accuracy: 79.5294%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['64.856%', '70.888%', '73.369%', '74.695%', '74.802%', '75.209%', '75.850%', '76.171%', '76.556%', '77.176%']
Workers federated accuracies:  ['77.326%', '77.305%', '77.604%', '77.519%', '77.583%', '78.011%', '77.989%', '78.332%', '78.396%', '78.845%']
Workers improved  accuracies:  ['16.856%', '16.321%', '15.829%', '15.358%', '15.016%', '15.016%', '14.888%', '14.695%', '14.503%', '14.588%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 19:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.0999, 0.0998, 0.1001, 0.1001, 0.1000, 0.1001, 0.1001,
        0.1001])
Federated model performance: Loss: 0.482970. Accuracy: 79.7219%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['65.155%', '71.037%', '73.711%', '74.781%', '74.845%', '75.358%', '76.128%', '76.364%', '76.535%', '77.241%']
Workers federated accuracies:  ['77.455%', '77.241%', '77.690%', '77.604%', '77.647%', '77.968%', '77.989%', '78.417%', '78.417%', '78.888%']
Workers improved  accuracies:  ['16.984%', '16.257%', '15.914%', '15.444%', '15.080%', '14.973%', '14.888%', '14.781%', '14.524%', '14.631%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 20:
Federated model validation accuracy : 77.5000%
Leave-one-out validation accuracies :  ['77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.5000%', '77.6000%', '77.6000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999,
        0.0999])
Federated model performance: Loss: 0.481588. Accuracy: 79.7005%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['65.219%', '71.422%', '73.947%', '74.824%', '74.973%', '75.508%', '76.150%', '76.471%', '76.663%', '77.390%']
Workers federated accuracies:  ['77.604%', '77.326%', '77.797%', '77.711%', '77.626%', '77.947%', '78.139%', '78.695%', '78.545%', '78.952%']
Workers improved  accuracies:  ['17.134%', '16.342%', '16.021%', '15.551%', '15.059%', '14.952%', '15.037%', '15.059%', '14.652%', '14.695%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.481588. Accuracy: 79.7005%.
Workers before    accuracies:  ['60.471%', '60.984%', '61.775%', '62.160%', '62.567%', '62.995%', '63.102%', '63.636%', '63.893%', '64.257%']
Workers standlone accuracies:  ['65.219%', '71.422%', '73.947%', '74.824%', '74.973%', '75.508%', '76.150%', '76.471%', '76.663%', '77.390%']
Workers federated accuracies:  ['77.604%', '77.326%', '77.797%', '77.711%', '77.626%', '77.947%', '78.139%', '78.695%', '78.545%', '78.952%']
Workers improved  accuracies:  ['17.134%', '16.342%', '16.021%', '15.551%', '15.059%', '14.952%', '15.037%', '15.059%', '14.652%', '14.695%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]
Workers sharing_contributions :  tensor([ 11.2000,  28.8000,  46.4000,  64.0000,  81.6000,  99.2000, 116.8000,
        134.4000, 152.0000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.5808770182001208, 0.0782512839646733)
Correlation between stand alone test acc & collaborative final model acc:  (0.6444737695902572, 0.044270454859701734)
Correlation between test_acc & sharing contributions:  (0.918375440998458, 0.00017582255301659547)
Correlation between test_acc improvements & sharing_contributions:  (-0.9120186431819998, 0.00023546970769011395)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.747477. Accuracy: 56.3422%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 67.2000%
Leave-one-out validation accuracies :  ['67.3000%', '68.0000%', '68.4000%', '69.0000%', '70.1000%', '70.4000%', '71.6000%', '71.7000%', '72.3000%', '72.4000%']
Computed and normalized credits:  tensor([0.1068, 0.1050, 0.1041, 0.1026, 0.1000, 0.0993, 0.0965, 0.0962, 0.0949,
        0.0946])
Federated model performance: Loss: 0.650825. Accuracy: 69.6898%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['53.797%', '55.209%', '56.791%', '58.139%', '59.294%', '60.021%', '60.770%', '61.818%', '62.866%', '63.487%']
Workers federated accuracies:  ['53.797%', '55.209%', '56.791%', '58.139%', '59.294%', '60.021%', '60.770%', '61.818%', '62.866%', '63.487%']
Workers improved  accuracies:  ['0.727%', '1.283%', '2.160%', '2.888%', '3.209%', '3.273%', '3.273%', '3.679%', '4.214%', '4.449%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 2:
Federated model validation accuracy : 71.2000%
Leave-one-out validation accuracies :  ['71.2000%', '71.5000%', '71.5000%', '71.7000%', '72.0000%', '72.3000%', '72.5000%', '72.5000%', '73.0000%', '73.4000%']
Computed and normalized credits:  tensor([0.1033, 0.1023, 0.1022, 0.1015, 0.1003, 0.0996, 0.0986, 0.0986, 0.0973,
        0.0964])
Federated model performance: Loss: 0.598582. Accuracy: 72.3850%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['54.075%', '56.578%', '58.567%', '60.086%', '61.840%', '62.995%', '63.893%', '64.834%', '65.690%', '66.524%']
Workers federated accuracies:  ['54.075%', '56.578%', '58.567%', '60.086%', '61.840%', '62.995%', '63.893%', '64.834%', '65.690%', '66.524%']
Workers improved  accuracies:  ['1.005%', '2.652%', '3.936%', '4.834%', '5.754%', '6.246%', '6.396%', '6.695%', '7.037%', '7.487%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 3:
Federated model validation accuracy : 72.6000%
Leave-one-out validation accuracies :  ['72.6000%', '72.6000%', '72.3000%', '72.5000%', '73.0000%', '73.5000%', '73.3000%', '73.7000%', '73.7000%', '73.7000%']
Computed and normalized credits:  tensor([0.1016, 0.1014, 0.1021, 0.1015, 0.1002, 0.0990, 0.0993, 0.0984, 0.0982,
        0.0981])
Federated model performance: Loss: 0.575392. Accuracy: 73.8396%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['54.524%', '57.583%', '59.979%', '61.840%', '63.572%', '64.898%', '65.989%', '66.695%', '68.000%', '68.684%']
Workers federated accuracies:  ['54.524%', '57.583%', '59.979%', '61.840%', '63.572%', '64.898%', '65.989%', '66.695%', '68.000%', '68.684%']
Workers improved  accuracies:  ['1.455%', '3.658%', '5.348%', '6.588%', '7.487%', '8.150%', '8.492%', '8.556%', '9.348%', '9.647%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 4:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.7000%', '73.5000%', '73.6000%', '73.8000%', '73.9000%', '73.8000%', '73.9000%', '74.3000%', '74.2000%', '74.4000%']
Computed and normalized credits:  tensor([0.1007, 0.1011, 0.1010, 0.1005, 0.1001, 0.1001, 0.0999, 0.0989, 0.0991,
        0.0986])
Federated model performance: Loss: 0.570315. Accuracy: 74.8021%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['54.930%', '58.695%', '61.497%', '63.251%', '64.963%', '66.545%', '67.636%', '68.364%', '69.326%', '70.139%']
Workers federated accuracies:  ['54.930%', '58.695%', '61.497%', '63.251%', '64.963%', '66.545%', '67.636%', '68.364%', '69.326%', '70.139%']
Workers improved  accuracies:  ['1.861%', '4.770%', '6.866%', '8.000%', '8.877%', '9.797%', '10.139%', '10.225%', '10.674%', '11.102%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 5:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.0000%', '73.8000%', '74.0000%', '74.1000%', '74.2000%', '74.1000%', '74.2000%', '74.4000%', '74.7000%', '74.6000%']
Computed and normalized credits:  tensor([0.1006, 0.1011, 0.1006, 0.1003, 0.1000, 0.1002, 0.1000, 0.0994, 0.0988,
        0.0989])
Federated model performance: Loss: 0.576262. Accuracy: 75.3583%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['55.444%', '59.658%', '62.460%', '64.791%', '66.032%', '67.572%', '69.176%', '69.519%', '70.481%', '70.995%']
Workers federated accuracies:  ['55.444%', '59.658%', '62.460%', '64.791%', '66.032%', '67.572%', '69.176%', '69.519%', '70.481%', '70.995%']
Workers improved  accuracies:  ['2.374%', '5.733%', '7.829%', '9.540%', '9.947%', '10.824%', '11.679%', '11.380%', '11.829%', '11.957%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 6:
Federated model validation accuracy : 74.5000%
Leave-one-out validation accuracies :  ['74.5000%', '74.5000%', '74.5000%', '74.6000%', '74.8000%', '74.8000%', '74.7000%', '74.8000%', '74.7000%', '74.8000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1005, 0.1002, 0.0997, 0.0998, 0.0999, 0.0996, 0.0997,
        0.0996])
Federated model performance: Loss: 0.589339. Accuracy: 75.7647%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['55.936%', '60.471%', '63.722%', '65.925%', '67.251%', '68.749%', '70.160%', '70.460%', '71.380%', '71.829%']
Workers federated accuracies:  ['55.936%', '60.471%', '63.722%', '65.925%', '67.251%', '68.749%', '70.160%', '70.460%', '71.380%', '71.829%']
Workers improved  accuracies:  ['2.866%', '6.545%', '9.091%', '10.674%', '11.166%', '12.000%', '12.663%', '12.321%', '12.727%', '12.791%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 7:
Federated model validation accuracy : 74.7000%
Leave-one-out validation accuracies :  ['74.7000%', '74.7000%', '74.7000%', '74.8000%', '74.8000%', '74.8000%', '74.8000%', '74.9000%', '75.1000%', '75.3000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1002, 0.1001, 0.1001, 0.1001, 0.0999, 0.0995,
        0.0990])
Federated model performance: Loss: 0.606564. Accuracy: 76.0856%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['56.385%', '61.326%', '64.599%', '66.503%', '68.364%', '69.647%', '70.759%', '71.102%', '72.128%', '72.578%']
Workers federated accuracies:  ['56.385%', '61.326%', '64.599%', '66.503%', '68.364%', '69.647%', '70.759%', '71.102%', '72.128%', '72.578%']
Workers improved  accuracies:  ['3.316%', '7.401%', '9.968%', '11.251%', '12.278%', '12.898%', '13.262%', '12.963%', '13.476%', '13.540%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 8:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.1000%', '75.1000%', '75.0000%', '75.1000%', '75.3000%', '75.4000%', '75.4000%', '75.5000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1003, 0.1002, 0.1004, 0.1002, 0.0998, 0.0995, 0.0995,
        0.0992])
Federated model performance: Loss: 0.624788. Accuracy: 76.2353%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['56.941%', '62.096%', '65.134%', '67.401%', '69.112%', '70.289%', '71.529%', '71.957%', '72.791%', '73.198%']
Workers federated accuracies:  ['56.941%', '62.096%', '65.134%', '67.401%', '69.112%', '70.289%', '71.529%', '71.957%', '72.791%', '73.198%']
Workers improved  accuracies:  ['3.872%', '8.171%', '10.503%', '12.150%', '13.027%', '13.540%', '14.032%', '13.818%', '14.139%', '14.160%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 9:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.2000%', '75.3000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.3000%', '75.2000%']
Computed and normalized credits:  tensor([0.1004, 0.1002, 0.0999, 0.0999, 0.0999, 0.0999, 0.0998, 0.0998, 0.1000,
        0.1002])
Federated model performance: Loss: 0.642568. Accuracy: 76.4920%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['57.176%', '62.845%', '65.775%', '68.193%', '69.604%', '71.016%', '72.107%', '72.599%', '73.390%', '73.561%']
Workers federated accuracies:  ['57.176%', '62.845%', '65.775%', '68.193%', '69.604%', '71.016%', '72.107%', '72.599%', '73.390%', '73.561%']
Workers improved  accuracies:  ['4.107%', '8.920%', '11.144%', '12.941%', '13.519%', '14.267%', '14.610%', '14.460%', '14.738%', '14.524%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 10:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.3000%', '75.4000%']
Computed and normalized credits:  tensor([0.0999, 0.0998, 0.0998, 0.0998, 0.1002, 0.1002, 0.1002, 0.1002, 0.1000,
        0.0998])
Federated model performance: Loss: 0.660565. Accuracy: 76.6203%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['57.497%', '63.765%', '66.225%', '68.920%', '70.182%', '71.465%', '72.299%', '73.112%', '74.032%', '73.947%']
Workers federated accuracies:  ['57.497%', '63.765%', '66.225%', '68.920%', '70.182%', '71.465%', '72.299%', '73.112%', '74.032%', '73.947%']
Workers improved  accuracies:  ['4.428%', '9.840%', '11.594%', '13.668%', '14.096%', '14.717%', '14.802%', '14.973%', '15.380%', '14.909%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 11:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.5000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1002, 0.1000, 0.1000, 0.0999, 0.0999,
        0.0997])
Federated model performance: Loss: 0.678209. Accuracy: 76.7487%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['57.925%', '64.193%', '66.845%', '69.412%', '70.481%', '72.064%', '72.963%', '73.733%', '74.567%', '74.588%']
Workers federated accuracies:  ['57.925%', '64.193%', '66.845%', '69.412%', '70.481%', '72.064%', '72.963%', '73.733%', '74.567%', '74.588%']
Workers improved  accuracies:  ['4.856%', '10.267%', '12.214%', '14.160%', '14.396%', '15.316%', '15.465%', '15.594%', '15.914%', '15.551%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 12:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.4000%', '75.4000%', '75.4000%', '75.3000%', '75.4000%', '75.5000%', '75.5000%', '75.6000%', '75.6000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1003, 0.1001, 0.0999, 0.0999, 0.0997,
        0.0996])
Federated model performance: Loss: 0.694039. Accuracy: 76.8128%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['58.225%', '64.770%', '67.144%', '69.925%', '71.144%', '72.364%', '73.369%', '74.289%', '75.080%', '75.016%']
Workers federated accuracies:  ['58.225%', '64.770%', '67.144%', '69.925%', '71.144%', '72.364%', '73.369%', '74.289%', '75.080%', '75.016%']
Workers improved  accuracies:  ['5.155%', '10.845%', '12.513%', '14.674%', '15.059%', '15.615%', '15.872%', '16.150%', '16.428%', '15.979%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 13:
Federated model validation accuracy : 75.7000%
Leave-one-out validation accuracies :  ['75.7000%', '75.7000%', '75.7000%', '75.7000%', '75.5000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.9000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.0999, 0.0999, 0.1004, 0.1001, 0.1001, 0.1001, 0.1001,
        0.0994])
Federated model performance: Loss: 0.709019. Accuracy: 76.8770%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['58.610%', '65.219%', '67.636%', '70.396%', '71.508%', '72.791%', '73.818%', '74.717%', '75.358%', '75.294%']
Workers federated accuracies:  ['58.610%', '65.219%', '67.636%', '70.396%', '71.508%', '72.791%', '73.818%', '74.717%', '75.358%', '75.294%']
Workers improved  accuracies:  ['5.540%', '11.294%', '13.005%', '15.144%', '15.422%', '16.043%', '16.321%', '16.578%', '16.706%', '16.257%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 14:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.6000%', '75.7000%', '75.7000%', '75.8000%', '75.8000%', '75.9000%', '75.9000%', '75.8000%', '75.9000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1001, 0.1001, 0.1000, 0.1000, 0.0997, 0.0997, 0.0999,
        0.0996])
Federated model performance: Loss: 0.723854. Accuracy: 76.9412%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['59.037%', '65.433%', '68.171%', '70.930%', '71.722%', '72.749%', '74.139%', '74.973%', '75.487%', '75.615%']
Workers federated accuracies:  ['59.037%', '65.433%', '68.171%', '70.930%', '71.722%', '72.749%', '74.139%', '74.973%', '75.487%', '75.615%']
Workers improved  accuracies:  ['5.968%', '11.508%', '13.540%', '15.679%', '15.636%', '16.000%', '16.642%', '16.834%', '16.834%', '16.578%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 15:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '75.9000%', '75.9000%', '75.9000%', '75.8000%', '76.0000%', '75.9000%', '75.9000%', '76.1000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1000, 0.1000, 0.1000, 0.1002, 0.0998, 0.1000, 0.1000,
        0.0995])
Federated model performance: Loss: 0.737923. Accuracy: 77.1979%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['59.422%', '65.840%', '68.556%', '71.230%', '71.957%', '73.027%', '74.460%', '75.123%', '75.508%', '75.829%']
Workers federated accuracies:  ['59.422%', '65.840%', '68.556%', '71.230%', '71.957%', '73.027%', '74.460%', '75.123%', '75.508%', '75.829%']
Workers improved  accuracies:  ['6.353%', '11.914%', '13.925%', '15.979%', '15.872%', '16.278%', '16.963%', '16.984%', '16.856%', '16.791%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 16:
Federated model validation accuracy : 75.9000%
Leave-one-out validation accuracies :  ['75.9000%', '75.9000%', '75.9000%', '75.9000%', '75.9000%', '75.9000%', '76.0000%', '76.1000%', '76.1000%', '76.2000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.0999, 0.0997, 0.0998,
        0.0995])
Federated model performance: Loss: 0.751927. Accuracy: 77.3476%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['59.786%', '66.096%', '68.856%', '71.701%', '72.278%', '73.262%', '74.845%', '75.230%', '75.594%', '75.957%']
Workers federated accuracies:  ['59.786%', '66.096%', '68.856%', '71.701%', '72.278%', '73.262%', '74.845%', '75.230%', '75.594%', '75.957%']
Workers improved  accuracies:  ['6.717%', '12.171%', '14.225%', '16.449%', '16.193%', '16.513%', '17.348%', '17.091%', '16.941%', '16.920%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 17:
Federated model validation accuracy : 76.1000%
Leave-one-out validation accuracies :  ['76.1000%', '76.1000%', '76.1000%', '76.1000%', '76.1000%', '76.1000%', '76.3000%', '76.2000%', '76.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.0997, 0.0999, 0.0999,
        0.0998])
Federated model performance: Loss: 0.765015. Accuracy: 77.3904%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['59.914%', '66.610%', '69.091%', '72.214%', '72.599%', '73.540%', '74.930%', '75.487%', '75.786%', '76.107%']
Workers federated accuracies:  ['76.727%', '76.620%', '76.749%', '76.727%', '76.684%', '77.027%', '76.856%', '76.941%', '77.112%', '77.241%']
Workers improved  accuracies:  ['23.658%', '22.695%', '22.118%', '21.476%', '20.599%', '20.278%', '19.358%', '18.802%', '18.460%', '18.203%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 18:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.3000%', '76.3000%', '76.3000%', '76.4000%', '76.5000%', '76.5000%', '76.5000%', '76.6000%', '76.7000%', '76.9000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1002, 0.1000, 0.1000, 0.0999, 0.0998, 0.0996,
        0.0991])
Federated model performance: Loss: 0.728616. Accuracy: 77.6898%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['60.150%', '66.866%', '69.583%', '72.791%', '72.684%', '73.840%', '75.016%', '75.615%', '75.914%', '76.257%']
Workers federated accuracies:  ['76.941%', '76.813%', '76.898%', '77.091%', '76.770%', '77.134%', '76.963%', '77.283%', '77.455%', '77.433%']
Workers improved  accuracies:  ['23.872%', '22.888%', '22.267%', '21.840%', '20.684%', '20.385%', '19.465%', '19.144%', '18.802%', '18.396%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 19:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.7000%', '76.8000%', '76.9000%', '76.9000%', '76.9000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1003, 0.1002, 0.1000, 0.0998, 0.0996, 0.0996,
        0.0995])
Federated model performance: Loss: 0.697288. Accuracy: 77.8824%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['60.471%', '67.059%', '69.754%', '73.134%', '72.770%', '74.032%', '75.251%', '75.893%', '76.021%', '76.321%']
Workers federated accuracies:  ['76.963%', '77.048%', '76.898%', '77.262%', '77.048%', '77.369%', '77.241%', '77.519%', '77.647%', '77.733%']
Workers improved  accuracies:  ['23.893%', '23.123%', '22.267%', '22.011%', '20.963%', '20.620%', '19.743%', '19.380%', '18.995%', '18.695%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 20:
Federated model validation accuracy : 76.7000%
Leave-one-out validation accuracies :  ['76.7000%', '76.7000%', '76.9000%', '76.9000%', '76.9000%', '76.9000%', '76.7000%', '76.8000%', '76.8000%', '77.0000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.0999, 0.0999, 0.0999, 0.0999, 0.1002, 0.1000, 0.1000,
        0.0996])
Federated model performance: Loss: 0.670745. Accuracy: 77.8610%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['60.706%', '67.487%', '70.032%', '73.219%', '72.963%', '74.267%', '75.444%', '75.979%', '76.086%', '76.428%']
Workers federated accuracies:  ['76.963%', '77.112%', '77.048%', '77.219%', '77.390%', '77.433%', '77.390%', '77.668%', '77.711%', '77.882%']
Workers improved  accuracies:  ['23.893%', '23.187%', '22.417%', '21.968%', '21.305%', '20.684%', '19.893%', '19.529%', '19.059%', '18.845%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.670745. Accuracy: 77.8610%.
Workers before    accuracies:  ['53.070%', '53.925%', '54.631%', '55.251%', '56.086%', '56.749%', '57.497%', '58.139%', '58.652%', '59.037%']
Workers standlone accuracies:  ['60.706%', '67.487%', '70.032%', '73.219%', '72.963%', '74.267%', '75.444%', '75.979%', '76.086%', '76.428%']
Workers federated accuracies:  ['76.963%', '77.112%', '77.048%', '77.219%', '77.390%', '77.433%', '77.390%', '77.668%', '77.711%', '77.882%']
Workers improved  accuracies:  ['23.893%', '23.187%', '22.417%', '21.968%', '21.305%', '20.684%', '19.893%', '19.529%', '19.059%', '18.845%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]
Workers sharing_contributions :  tensor([ 11.2000,  28.8000,  46.4000,  64.0000,  81.6000,  99.2000, 116.8000,
        134.4000, 152.0000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.16574575211350384, 0.6472284301254401)
Correlation between stand alone test acc & collaborative final model acc:  (0.828677935285452, 0.003048139174148351)
Correlation between test_acc & sharing contributions:  (0.9744237158241463, 1.8152474638713762e-06)
Correlation between test_acc improvements & sharing_contributions:  (-0.9941536714171564, 5.075289683199329e-09)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.681736. Accuracy: 62.5455%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 69.9000%
Leave-one-out validation accuracies :  ['69.9000%', '69.9000%', '70.4000%', '71.2000%', '71.3000%', '72.1000%', '72.6000%', '73.1000%', '73.5000%', '73.6000%']
Computed and normalized credits:  tensor([0.1042, 0.1042, 0.1031, 0.1012, 0.1010, 0.0992, 0.0981, 0.0970, 0.0961,
        0.0959])
Federated model performance: Loss: 0.611952. Accuracy: 71.1230%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['60.898%', '61.626%', '62.652%', '63.636%', '64.620%', '65.112%', '65.797%', '66.075%', '67.080%', '67.358%']
Workers federated accuracies:  ['60.898%', '61.626%', '62.652%', '63.636%', '64.620%', '65.112%', '65.797%', '66.075%', '67.080%', '67.358%']
Workers improved  accuracies:  ['0.449%', '0.449%', '1.048%', '1.754%', '2.246%', '2.289%', '2.545%', '2.503%', '2.973%', '3.123%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 2:
Federated model validation accuracy : 72.2000%
Leave-one-out validation accuracies :  ['72.2000%', '72.3000%', '72.7000%', '73.0000%', '73.5000%', '73.5000%', '73.3000%', '73.4000%', '73.8000%', '73.6000%']
Computed and normalized credits:  tensor([0.1028, 0.1025, 0.1015, 0.1005, 0.0994, 0.0991, 0.0993, 0.0989, 0.0979,
        0.0983])
Federated model performance: Loss: 0.577791. Accuracy: 73.0053%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['61.241%', '62.310%', '63.936%', '64.963%', '66.032%', '66.930%', '67.936%', '68.535%', '69.369%', '69.754%']
Workers federated accuracies:  ['61.241%', '62.310%', '63.936%', '64.963%', '66.032%', '66.930%', '67.936%', '68.535%', '69.369%', '69.754%']
Workers improved  accuracies:  ['0.791%', '1.134%', '2.332%', '3.080%', '3.658%', '4.107%', '4.684%', '4.963%', '5.262%', '5.519%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 3:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.8000%', '73.7000%', '73.7000%', '73.8000%', '73.7000%', '73.6000%', '73.5000%', '73.6000%', '74.1000%', '74.1000%']
Computed and normalized credits:  tensor([0.1004, 0.1005, 0.1004, 0.1000, 0.1000, 0.1002, 0.1004, 0.1002, 0.0989,
        0.0990])
Federated model performance: Loss: 0.566146. Accuracy: 74.1390%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['61.519%', '63.037%', '65.155%', '66.674%', '67.658%', '68.749%', '69.840%', '70.289%', '70.888%', '71.444%']
Workers federated accuracies:  ['61.519%', '63.037%', '65.155%', '66.674%', '67.658%', '68.749%', '69.840%', '70.289%', '70.888%', '71.444%']
Workers improved  accuracies:  ['1.070%', '1.861%', '3.551%', '4.791%', '5.283%', '5.925%', '6.588%', '6.717%', '6.781%', '7.209%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 4:
Federated model validation accuracy : 73.9000%
Leave-one-out validation accuracies :  ['73.9000%', '73.9000%', '73.6000%', '73.9000%', '74.1000%', '73.9000%', '73.9000%', '74.0000%', '73.7000%', '73.8000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1006, 0.0999, 0.0995, 0.1000, 0.1000, 0.0998, 0.1002,
        0.1000])
Federated model performance: Loss: 0.569348. Accuracy: 74.8235%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['61.733%', '63.872%', '65.904%', '67.487%', '68.920%', '70.032%', '70.610%', '71.422%', '72.086%', '72.086%']
Workers federated accuracies:  ['61.733%', '63.872%', '65.904%', '67.487%', '68.920%', '70.032%', '70.610%', '71.422%', '72.086%', '72.086%']
Workers improved  accuracies:  ['1.283%', '2.695%', '4.299%', '5.604%', '6.545%', '7.209%', '7.358%', '7.850%', '7.979%', '7.850%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 5:
Federated model validation accuracy : 74.1000%
Leave-one-out validation accuracies :  ['74.1000%', '74.0000%', '73.9000%', '73.9000%', '73.8000%', '73.8000%', '74.0000%', '74.0000%', '73.9000%', '73.8000%']
Computed and normalized credits:  tensor([0.0996, 0.0998, 0.1001, 0.1000, 0.1002, 0.1002, 0.0998, 0.0998, 0.1001,
        0.1002])
Federated model performance: Loss: 0.581572. Accuracy: 75.2513%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['61.861%', '64.578%', '66.866%', '68.321%', '70.011%', '70.995%', '71.465%', '72.235%', '72.834%', '73.262%']
Workers federated accuracies:  ['61.861%', '64.578%', '66.866%', '68.321%', '70.011%', '70.995%', '71.465%', '72.235%', '72.834%', '73.262%']
Workers improved  accuracies:  ['1.412%', '3.401%', '5.262%', '6.439%', '7.636%', '8.171%', '8.214%', '8.663%', '8.727%', '9.027%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 6:
Federated model validation accuracy : 73.9000%
Leave-one-out validation accuracies :  ['73.9000%', '74.0000%', '73.9000%', '73.9000%', '73.8000%', '74.0000%', '73.9000%', '74.2000%', '74.3000%', '74.4000%']
Computed and normalized credits:  tensor([0.1002, 0.1000, 0.1003, 0.1003, 0.1005, 0.1001, 0.1002, 0.0996, 0.0994,
        0.0993])
Federated model performance: Loss: 0.599210. Accuracy: 75.6364%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['62.053%', '65.070%', '68.021%', '69.070%', '70.503%', '71.615%', '72.257%', '73.112%', '73.733%', '73.904%']
Workers federated accuracies:  ['62.053%', '65.070%', '68.021%', '69.070%', '70.503%', '71.615%', '72.257%', '73.112%', '73.733%', '73.904%']
Workers improved  accuracies:  ['1.604%', '3.893%', '6.417%', '7.187%', '8.128%', '8.791%', '9.005%', '9.540%', '9.626%', '9.668%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 7:
Federated model validation accuracy : 73.9000%
Leave-one-out validation accuracies :  ['73.9000%', '73.9000%', '74.1000%', '74.0000%', '74.2000%', '74.3000%', '74.4000%', '74.6000%', '74.6000%', '74.7000%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1004, 0.1006, 0.1002, 0.1000, 0.0998, 0.0992, 0.0992,
        0.0990])
Federated model performance: Loss: 0.620644. Accuracy: 75.7433%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['62.417%', '65.519%', '68.898%', '70.053%', '71.294%', '71.936%', '73.005%', '73.626%', '74.374%', '74.439%']
Workers federated accuracies:  ['62.417%', '65.519%', '68.898%', '70.053%', '71.294%', '71.936%', '73.005%', '73.626%', '74.374%', '74.439%']
Workers improved  accuracies:  ['1.968%', '4.342%', '7.294%', '8.171%', '8.920%', '9.112%', '9.754%', '10.053%', '10.267%', '10.203%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 8:
Federated model validation accuracy : 74.5000%
Leave-one-out validation accuracies :  ['74.5000%', '74.5000%', '74.5000%', '74.6000%', '74.6000%', '74.7000%', '74.6000%', '74.7000%', '74.7000%', '74.9000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1003, 0.1002, 0.1001, 0.0998, 0.1000, 0.0997, 0.0997,
        0.0993])
Federated model performance: Loss: 0.643895. Accuracy: 75.9572%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['62.695%', '65.947%', '69.519%', '71.080%', '71.722%', '72.684%', '73.540%', '74.032%', '74.909%', '74.866%']
Workers federated accuracies:  ['62.695%', '65.947%', '69.519%', '71.080%', '71.722%', '72.684%', '73.540%', '74.032%', '74.909%', '74.866%']
Workers improved  accuracies:  ['2.246%', '4.770%', '7.914%', '9.198%', '9.348%', '9.861%', '10.289%', '10.460%', '10.802%', '10.631%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 9:
Federated model validation accuracy : 74.7000%
Leave-one-out validation accuracies :  ['74.7000%', '74.7000%', '74.7000%', '74.7000%', '74.7000%', '74.7000%', '74.7000%', '75.0000%', '75.1000%', '75.0000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1002, 0.1002, 0.1002, 0.1002, 0.0995, 0.0993,
        0.0995])
Federated model performance: Loss: 0.667457. Accuracy: 76.0642%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['62.909%', '66.652%', '70.139%', '71.872%', '72.364%', '73.048%', '73.947%', '74.567%', '75.102%', '75.251%']
Workers federated accuracies:  ['62.909%', '66.652%', '70.139%', '71.872%', '72.364%', '73.048%', '73.947%', '74.567%', '75.102%', '75.251%']
Workers improved  accuracies:  ['2.460%', '5.476%', '8.535%', '9.989%', '9.989%', '10.225%', '10.695%', '10.995%', '10.995%', '11.016%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 10:
Federated model validation accuracy : 74.9000%
Leave-one-out validation accuracies :  ['74.9000%', '74.9000%', '74.8000%', '74.8000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1003, 0.1003, 0.0999, 0.0999, 0.0999, 0.0998, 0.0998,
        0.0998])
Federated model performance: Loss: 0.691131. Accuracy: 76.2139%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['63.144%', '67.251%', '70.503%', '72.428%', '72.877%', '73.369%', '74.267%', '74.952%', '75.316%', '75.594%']
Workers federated accuracies:  ['63.144%', '67.251%', '70.503%', '72.428%', '72.877%', '73.369%', '74.267%', '74.952%', '75.316%', '75.594%']
Workers improved  accuracies:  ['2.695%', '6.075%', '8.898%', '10.545%', '10.503%', '10.545%', '11.016%', '11.380%', '11.209%', '11.358%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 11:
Federated model validation accuracy : 75.1000%
Leave-one-out validation accuracies :  ['75.1000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.1000%', '75.1000%']
Computed and normalized credits:  tensor([0.0999, 0.1001, 0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.0998,
        0.0998])
Federated model performance: Loss: 0.715007. Accuracy: 76.2567%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['63.273%', '67.679%', '70.930%', '72.706%', '73.112%', '73.626%', '74.674%', '75.187%', '75.551%', '75.957%']
Workers federated accuracies:  ['63.273%', '67.679%', '70.930%', '72.706%', '73.112%', '73.626%', '74.674%', '75.187%', '75.551%', '75.957%']
Workers improved  accuracies:  ['2.824%', '6.503%', '9.326%', '10.824%', '10.738%', '10.802%', '11.422%', '11.615%', '11.444%', '11.722%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 12:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.1000%', '75.1000%', '75.1000%', '75.1000%', '75.1000%', '75.1000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.0999, 0.0999, 0.0999, 0.0999, 0.0999,
        0.0999])
Federated model performance: Loss: 0.738697. Accuracy: 76.3209%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['63.380%', '68.128%', '71.187%', '73.070%', '73.369%', '74.053%', '74.930%', '75.444%', '75.914%', '76.150%']
Workers federated accuracies:  ['75.807%', '75.936%', '75.979%', '76.235%', '76.128%', '76.257%', '76.235%', '76.364%', '76.428%', '76.535%']
Workers improved  accuracies:  ['15.358%', '14.759%', '14.374%', '14.353%', '13.754%', '13.433%', '12.984%', '12.791%', '12.321%', '12.299%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 13:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.3000%', '75.3000%', '75.3000%', '75.3000%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.3000%', '75.5000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1002, 0.1002, 0.1002, 0.1002, 0.0999,
        0.0995])
Federated model performance: Loss: 0.709557. Accuracy: 76.3850%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['63.615%', '68.406%', '71.636%', '73.198%', '73.497%', '74.267%', '75.123%', '75.786%', '76.107%', '76.364%']
Workers federated accuracies:  ['75.914%', '75.893%', '76.021%', '76.385%', '76.235%', '76.449%', '76.406%', '76.578%', '76.599%', '76.706%']
Workers improved  accuracies:  ['15.465%', '14.717%', '14.417%', '14.503%', '13.861%', '13.626%', '13.155%', '13.005%', '12.492%', '12.471%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 14:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.3000%', '75.3000%', '75.4000%', '75.5000%', '75.6000%', '75.6000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1003, 0.1001, 0.1001, 0.0999, 0.0997, 0.0995,
        0.0994])
Federated model performance: Loss: 0.684698. Accuracy: 76.5775%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['63.914%', '69.005%', '71.850%', '73.497%', '73.797%', '74.631%', '75.294%', '75.914%', '76.214%', '76.556%']
Workers federated accuracies:  ['76.107%', '76.021%', '76.235%', '76.620%', '76.278%', '76.513%', '76.471%', '76.727%', '76.920%', '76.791%']
Workers improved  accuracies:  ['15.658%', '14.845%', '14.631%', '14.738%', '13.904%', '13.690%', '13.219%', '13.155%', '12.813%', '12.556%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 15:
Federated model validation accuracy : 75.5000%
Leave-one-out validation accuracies :  ['75.5000%', '75.5000%', '75.5000%', '75.5000%', '75.6000%', '75.5000%', '75.6000%', '75.6000%', '75.6000%', '75.8000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1000, 0.1002, 0.0999, 0.0999, 0.0998,
        0.0994])
Federated model performance: Loss: 0.663509. Accuracy: 76.8556%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['64.150%', '69.326%', '72.150%', '73.968%', '74.139%', '74.759%', '75.615%', '76.043%', '76.299%', '76.941%']
Workers federated accuracies:  ['76.214%', '76.214%', '76.428%', '76.642%', '76.321%', '76.663%', '76.620%', '76.856%', '77.070%', '76.963%']
Workers improved  accuracies:  ['15.765%', '15.037%', '14.824%', '14.759%', '13.947%', '13.840%', '13.369%', '13.283%', '12.963%', '12.727%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 16:
Federated model validation accuracy : 75.5000%
Leave-one-out validation accuracies :  ['75.5000%', '75.5000%', '75.6000%', '75.6000%', '75.6000%', '75.6000%', '75.7000%', '75.7000%', '75.7000%', '75.7000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1001, 0.1001, 0.1000, 0.1001, 0.0998, 0.0998, 0.0998,
        0.0997])
Federated model performance: Loss: 0.644841. Accuracy: 77.0481%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['64.471%', '69.412%', '72.385%', '74.182%', '74.289%', '74.888%', '75.872%', '76.064%', '76.278%', '76.963%']
Workers federated accuracies:  ['76.214%', '76.364%', '76.535%', '76.642%', '76.449%', '76.791%', '76.791%', '76.963%', '77.241%', '77.048%']
Workers improved  accuracies:  ['15.765%', '15.187%', '14.930%', '14.759%', '14.075%', '13.968%', '13.540%', '13.390%', '13.134%', '12.813%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 17:
Federated model validation accuracy : 75.7000%
Leave-one-out validation accuracies :  ['75.7000%', '75.7000%', '75.7000%', '75.7000%', '75.7000%', '75.7000%', '75.7000%', '75.7000%', '75.8000%', '76.0000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.0998,
        0.0994])
Federated model performance: Loss: 0.627907. Accuracy: 77.1551%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['64.727%', '69.626%', '72.449%', '74.503%', '74.524%', '75.166%', '75.957%', '76.342%', '76.342%', '76.984%']
Workers federated accuracies:  ['76.385%', '76.428%', '76.513%', '76.684%', '76.471%', '76.877%', '76.877%', '77.176%', '77.348%', '77.176%']
Workers improved  accuracies:  ['15.936%', '15.251%', '14.909%', '14.802%', '14.096%', '14.053%', '13.626%', '13.604%', '13.241%', '12.941%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 18:
Federated model validation accuracy : 75.7000%
Leave-one-out validation accuracies :  ['75.7000%', '75.7000%', '75.7000%', '75.7000%', '75.7000%', '75.8000%', '75.9000%', '76.1000%', '76.2000%', '76.3000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1004, 0.1004, 0.1002, 0.1000, 0.0996, 0.0993,
        0.0990])
Federated model performance: Loss: 0.612635. Accuracy: 77.3690%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['64.941%', '69.904%', '72.578%', '74.802%', '74.717%', '75.316%', '76.043%', '76.406%', '76.385%', '76.984%']
Workers federated accuracies:  ['76.428%', '76.513%', '76.578%', '76.813%', '76.599%', '76.920%', '76.898%', '77.283%', '77.433%', '77.262%']
Workers improved  accuracies:  ['15.979%', '15.337%', '14.973%', '14.930%', '14.225%', '14.096%', '13.647%', '13.711%', '13.326%', '13.027%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 19:
Federated model validation accuracy : 76.1000%
Leave-one-out validation accuracies :  ['76.1000%', '76.1000%', '76.1000%', '76.1000%', '76.2000%', '76.3000%', '76.2000%', '76.3000%', '76.1000%', '76.3000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1000, 0.0998, 0.1000, 0.0997, 0.1000,
        0.0996])
Federated model performance: Loss: 0.598625. Accuracy: 77.5615%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['65.283%', '70.032%', '72.813%', '75.144%', '74.866%', '75.358%', '76.171%', '76.492%', '76.578%', '77.070%']
Workers federated accuracies:  ['76.471%', '76.556%', '76.642%', '76.920%', '76.663%', '77.070%', '76.898%', '77.369%', '77.519%', '77.455%']
Workers improved  accuracies:  ['16.021%', '15.380%', '15.037%', '15.037%', '14.289%', '14.246%', '13.647%', '13.797%', '13.412%', '13.219%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 20:
Federated model validation accuracy : 76.3000%
Leave-one-out validation accuracies :  ['76.3000%', '76.3000%', '76.3000%', '76.3000%', '76.3000%', '76.2000%', '76.1000%', '76.2000%', '76.3000%', '76.3000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.0999, 0.1001, 0.1003, 0.1001, 0.0999,
        0.0999])
Federated model performance: Loss: 0.586499. Accuracy: 77.6471%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['65.497%', '70.332%', '73.070%', '75.209%', '75.080%', '75.508%', '76.321%', '76.578%', '76.791%', '77.155%']
Workers federated accuracies:  ['76.449%', '76.620%', '76.770%', '77.005%', '76.749%', '77.198%', '77.134%', '77.476%', '77.540%', '77.754%']
Workers improved  accuracies:  ['16.000%', '15.444%', '15.166%', '15.123%', '14.374%', '14.374%', '13.882%', '13.904%', '13.433%', '13.519%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.586499. Accuracy: 77.6471%.
Workers before    accuracies:  ['60.449%', '61.176%', '61.604%', '61.882%', '62.374%', '62.824%', '63.251%', '63.572%', '64.107%', '64.235%']
Workers standlone accuracies:  ['65.497%', '70.332%', '73.070%', '75.209%', '75.080%', '75.508%', '76.321%', '76.578%', '76.791%', '77.155%']
Workers federated accuracies:  ['76.449%', '76.620%', '76.770%', '77.005%', '76.749%', '77.198%', '77.134%', '77.476%', '77.540%', '77.754%']
Workers improved  accuracies:  ['16.000%', '15.444%', '15.166%', '15.123%', '14.374%', '14.374%', '13.882%', '13.904%', '13.433%', '13.519%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]
Workers sharing_contributions :  tensor([ 11.2000,  28.8000,  46.4000,  64.0000,  81.6000,  99.2000, 116.8000,
        134.4000, 152.0000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.1771936555607178, 0.6243313817875309)
Correlation between stand alone test acc & collaborative final model acc:  (0.821337091477529, 0.0035713588371644005)
Correlation between test_acc & sharing contributions:  (0.9635402602486843, 7.397810186883771e-06)
Correlation between test_acc improvements & sharing_contributions:  (-0.9776547697827775, 1.061754625645971e-06)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.740773. Accuracy: 57.6471%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 70.4000%
Leave-one-out validation accuracies :  ['70.7000%', '71.0000%', '71.3000%', '71.8000%', '71.9000%', '73.0000%', '73.2000%', '73.1000%', '72.9000%', '72.3000%']
Computed and normalized credits:  tensor([0.1032, 0.1025, 0.1018, 0.1007, 0.1005, 0.0980, 0.0976, 0.0978, 0.0982,
        0.0996])
Federated model performance: Loss: 0.647789. Accuracy: 71.5936%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['54.759%', '56.449%', '58.096%', '59.422%', '61.219%', '62.738%', '63.230%', '63.829%', '64.856%', '65.283%']
Workers federated accuracies:  ['65.305%', '65.947%', '66.417%', '67.444%', '67.914%', '68.193%', '68.791%', '68.813%', '69.369%', '69.583%']
Workers improved  accuracies:  ['10.802%', '10.802%', '10.417%', '10.802%', '10.460%', '9.412%', '9.583%', '9.433%', '9.048%', '8.898%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 2:
Federated model validation accuracy : 73.1000%
Leave-one-out validation accuracies :  ['73.1000%', '73.5000%', '73.3000%', '73.2000%', '73.3000%', '73.3000%', '73.5000%', '73.4000%', '72.9000%', '73.0000%']
Computed and normalized credits:  tensor([0.1009, 0.0999, 0.1002, 0.1002, 0.1000, 0.0996, 0.0991, 0.0993, 0.1005,
        0.1005])
Federated model performance: Loss: 0.606377. Accuracy: 73.7540%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['55.080%', '57.733%', '60.150%', '61.840%', '63.701%', '65.112%', '66.096%', '66.439%', '67.893%', '68.235%']
Workers federated accuracies:  ['69.904%', '70.588%', '70.781%', '71.444%', '72.128%', '72.321%', '72.727%', '72.834%', '72.856%', '72.749%']
Workers improved  accuracies:  ['15.401%', '15.444%', '14.781%', '14.802%', '14.674%', '13.540%', '13.519%', '13.455%', '12.535%', '12.064%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 3:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.0000%', '74.0000%', '74.0000%', '74.0000%', '74.1000%', '74.0000%', '73.8000%', '73.7000%', '74.1000%', '74.2000%']
Computed and normalized credits:  tensor([0.1001, 0.1000, 0.1000, 0.1000, 0.0998, 0.0999, 0.1002, 0.1005, 0.0998,
        0.0996])
Federated model performance: Loss: 0.583601. Accuracy: 74.6310%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['55.615%', '59.187%', '61.968%', '63.850%', '65.968%', '67.016%', '68.599%', '68.492%', '70.118%', '70.417%']
Workers federated accuracies:  ['71.679%', '72.556%', '72.663%', '73.262%', '73.283%', '73.561%', '73.583%', '73.626%', '73.733%', '73.840%']
Workers improved  accuracies:  ['17.176%', '17.412%', '16.663%', '16.620%', '15.829%', '14.781%', '14.374%', '14.246%', '13.412%', '13.155%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 4:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.0000%', '74.1000%', '74.1000%', '74.3000%', '74.4000%', '74.4000%', '74.4000%', '74.5000%', '74.4000%', '74.5000%']
Computed and normalized credits:  tensor([0.1007, 0.1004, 0.1004, 0.1000, 0.0998, 0.0998, 0.0999, 0.0997, 0.0998,
        0.0995])
Federated model performance: Loss: 0.569898. Accuracy: 75.1016%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['56.128%', '60.385%', '63.487%', '65.519%', '67.337%', '69.005%', '70.225%', '70.374%', '71.594%', '71.679%']
Workers federated accuracies:  ['73.027%', '73.412%', '73.540%', '73.733%', '73.925%', '74.225%', '74.160%', '74.139%', '74.396%', '74.652%']
Workers improved  accuracies:  ['18.524%', '18.267%', '17.540%', '17.091%', '16.471%', '15.444%', '14.952%', '14.759%', '14.075%', '13.968%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 5:
Federated model validation accuracy : 74.5000%
Leave-one-out validation accuracies :  ['74.5000%', '74.6000%', '74.5000%', '74.3000%', '74.4000%', '74.5000%', '74.6000%', '74.8000%', '75.0000%', '75.2000%']
Computed and normalized credits:  tensor([0.1004, 0.1002, 0.1004, 0.1007, 0.1005, 0.1003, 0.1001, 0.0996, 0.0992,
        0.0988])
Federated model performance: Loss: 0.558761. Accuracy: 75.7433%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['56.299%', '61.433%', '64.449%', '66.952%', '68.898%', '70.182%', '71.765%', '71.786%', '72.749%', '72.727%']
Workers federated accuracies:  ['73.690%', '74.032%', '74.160%', '74.225%', '74.652%', '74.781%', '74.995%', '74.952%', '75.251%', '75.251%']
Workers improved  accuracies:  ['19.187%', '18.888%', '18.160%', '17.583%', '17.198%', '16.000%', '15.786%', '15.572%', '14.930%', '14.567%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 6:
Federated model validation accuracy : 74.9000%
Leave-one-out validation accuracies :  ['74.9000%', '74.9000%', '74.9000%', '74.9000%', '74.9000%', '74.9000%', '74.9000%', '75.4000%', '75.4000%', '75.9000%']
Computed and normalized credits:  tensor([0.1005, 0.1004, 0.1005, 0.1005, 0.1005, 0.1005, 0.1004, 0.0993, 0.0992,
        0.0981])
Federated model performance: Loss: 0.549205. Accuracy: 76.1925%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['56.877%', '62.503%', '65.647%', '68.021%', '70.053%', '71.337%', '72.749%', '72.984%', '73.519%', '73.348%']
Workers federated accuracies:  ['74.246%', '74.631%', '74.631%', '74.824%', '75.016%', '75.080%', '75.743%', '75.529%', '75.807%', '75.572%']
Workers improved  accuracies:  ['19.743%', '19.487%', '18.631%', '18.182%', '17.562%', '16.299%', '16.535%', '16.150%', '15.487%', '14.888%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 7:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.5000%', '75.5000%', '75.4000%', '75.4000%', '75.5000%', '75.5000%', '75.6000%', '76.0000%', '76.1000%', '76.2000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1006, 0.1007, 0.1004, 0.1004, 0.1002, 0.0992, 0.0990,
        0.0986])
Federated model performance: Loss: 0.541271. Accuracy: 76.5989%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['57.305%', '63.380%', '66.460%', '69.305%', '71.080%', '72.299%', '73.241%', '73.561%', '74.032%', '74.032%']
Workers federated accuracies:  ['74.674%', '74.973%', '75.080%', '75.294%', '75.358%', '75.401%', '75.829%', '75.872%', '75.979%', '75.872%']
Workers improved  accuracies:  ['20.171%', '19.829%', '19.080%', '18.652%', '17.904%', '16.620%', '16.620%', '16.492%', '15.658%', '15.187%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 8:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '76.1000%', '76.0000%', '76.1000%', '76.1000%', '76.2000%', '76.2000%', '76.2000%', '76.3000%', '76.4000%']
Computed and normalized credits:  tensor([0.1004, 0.1002, 0.1004, 0.1002, 0.1002, 0.1000, 0.1000, 0.0998, 0.0995,
        0.0993])
Federated model performance: Loss: 0.533960. Accuracy: 76.9412%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['57.797%', '64.086%', '67.209%', '69.989%', '71.979%', '73.027%', '73.626%', '73.904%', '74.267%', '74.545%']
Workers federated accuracies:  ['74.952%', '75.187%', '75.401%', '75.679%', '75.636%', '75.786%', '76.064%', '76.128%', '76.235%', '76.321%']
Workers improved  accuracies:  ['20.449%', '20.043%', '19.401%', '19.037%', '18.182%', '17.005%', '16.856%', '16.749%', '15.914%', '15.636%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 9:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.3000%', '76.2000%', '76.3000%', '76.3000%', '76.3000%', '76.5000%', '76.4000%', '76.5000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1001, 0.1003, 0.1001, 0.1000, 0.1000, 0.0996, 0.0998,
        0.0995])
Federated model performance: Loss: 0.527327. Accuracy: 77.4759%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['58.545%', '65.027%', '67.722%', '71.016%', '72.385%', '73.540%', '74.032%', '74.289%', '74.674%', '74.802%']
Workers federated accuracies:  ['75.230%', '75.679%', '75.679%', '75.979%', '75.786%', '76.086%', '76.278%', '76.385%', '76.428%', '76.513%']
Workers improved  accuracies:  ['20.727%', '20.535%', '19.679%', '19.337%', '18.332%', '17.305%', '17.070%', '17.005%', '16.107%', '15.829%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 10:
Federated model validation accuracy : 76.5000%
Leave-one-out validation accuracies :  ['76.5000%', '76.5000%', '76.6000%', '76.5000%', '76.4000%', '76.4000%', '76.5000%', '76.6000%', '76.6000%', '76.7000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.0999, 0.1001, 0.1003, 0.1003, 0.1001, 0.0998, 0.0998,
        0.0996])
Federated model performance: Loss: 0.521667. Accuracy: 77.6684%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['59.037%', '65.561%', '68.471%', '71.979%', '72.834%', '73.904%', '74.118%', '74.545%', '74.930%', '75.123%']
Workers federated accuracies:  ['75.465%', '75.850%', '75.872%', '76.385%', '75.957%', '76.342%', '76.492%', '76.620%', '76.706%', '76.877%']
Workers improved  accuracies:  ['20.963%', '20.706%', '19.872%', '19.743%', '18.503%', '17.562%', '17.283%', '17.241%', '16.385%', '16.193%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 11:
Federated model validation accuracy : 76.5000%
Leave-one-out validation accuracies :  ['76.6000%', '76.7000%', '76.7000%', '76.7000%', '76.7000%', '76.6000%', '76.7000%', '76.7000%', '76.7000%', '76.6000%']
Computed and normalized credits:  tensor([0.1002, 0.1000, 0.0999, 0.1000, 0.1000, 0.1002, 0.0999, 0.0999, 0.0999,
        0.1001])
Federated model performance: Loss: 0.516590. Accuracy: 77.7754%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['59.230%', '66.332%', '69.070%', '72.578%', '73.305%', '74.203%', '74.503%', '74.717%', '74.973%', '75.401%']
Workers federated accuracies:  ['75.807%', '76.043%', '76.150%', '76.642%', '76.193%', '76.513%', '76.684%', '76.963%', '76.898%', '77.070%']
Workers improved  accuracies:  ['21.305%', '20.898%', '20.150%', '20.000%', '18.738%', '17.733%', '17.476%', '17.583%', '16.578%', '16.385%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 12:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.8000%', '76.8000%', '76.7000%', '76.7000%', '76.6000%', '76.7000%', '76.6000%', '76.8000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.0998, 0.0999, 0.1001, 0.1001, 0.1003, 0.1000, 0.1002,
        0.0999])
Federated model performance: Loss: 0.512273. Accuracy: 77.9465%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['59.615%', '67.016%', '69.733%', '73.134%', '73.455%', '74.524%', '74.888%', '74.781%', '75.166%', '75.829%']
Workers federated accuracies:  ['75.914%', '76.235%', '76.342%', '76.813%', '76.449%', '76.770%', '76.856%', '77.219%', '77.241%', '77.455%']
Workers improved  accuracies:  ['21.412%', '21.091%', '20.342%', '20.171%', '18.995%', '17.989%', '17.647%', '17.840%', '16.920%', '16.770%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 13:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.8000%', '76.8000%', '76.9000%', '76.8000%', '76.7000%', '76.8000%', '76.8000%', '76.9000%', '77.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.0998, 0.1001, 0.1003, 0.1001, 0.1001, 0.0999,
        0.0996])
Federated model performance: Loss: 0.508492. Accuracy: 78.3743%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['60.257%', '67.615%', '70.203%', '73.433%', '73.690%', '74.888%', '75.059%', '75.059%', '75.294%', '76.193%']
Workers federated accuracies:  ['76.150%', '76.471%', '76.471%', '76.834%', '76.706%', '76.984%', '77.198%', '77.390%', '77.412%', '77.561%']
Workers improved  accuracies:  ['21.647%', '21.326%', '20.471%', '20.193%', '19.251%', '18.203%', '17.989%', '18.011%', '17.091%', '16.877%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 14:
Federated model validation accuracy : 76.9000%
Leave-one-out validation accuracies :  ['76.9000%', '76.9000%', '76.9000%', '76.8000%', '76.8000%', '76.8000%', '77.0000%', '77.3000%', '77.4000%', '77.4000%']
Computed and normalized credits:  tensor([0.1003, 0.1002, 0.1002, 0.1004, 0.1005, 0.1005, 0.1001, 0.0994, 0.0992,
        0.0992])
Federated model performance: Loss: 0.505199. Accuracy: 78.5241%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['60.706%', '68.364%', '70.717%', '73.690%', '73.925%', '75.016%', '75.294%', '75.230%', '75.337%', '76.385%']
Workers federated accuracies:  ['76.364%', '76.578%', '76.535%', '77.027%', '76.770%', '77.176%', '77.305%', '77.561%', '77.668%', '77.690%']
Workers improved  accuracies:  ['21.861%', '21.433%', '20.535%', '20.385%', '19.316%', '18.396%', '18.096%', '18.182%', '17.348%', '17.005%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 15:
Federated model validation accuracy : 77.1000%
Leave-one-out validation accuracies :  ['77.1000%', '77.1000%', '77.1000%', '77.2000%', '77.4000%', '77.4000%', '77.3000%', '77.3000%', '77.3000%', '77.4000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1002, 0.0998, 0.0998, 0.0999, 0.0998, 0.0998,
        0.0996])
Federated model performance: Loss: 0.502289. Accuracy: 78.6310%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['61.091%', '68.920%', '71.251%', '73.818%', '73.968%', '75.123%', '75.380%', '75.487%', '75.679%', '76.578%']
Workers federated accuracies:  ['76.513%', '76.813%', '76.663%', '77.198%', '76.877%', '77.305%', '77.561%', '77.818%', '77.690%', '77.733%']
Workers improved  accuracies:  ['22.011%', '21.668%', '20.663%', '20.556%', '19.422%', '18.524%', '18.353%', '18.439%', '17.369%', '17.048%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 16:
Federated model validation accuracy : 77.3000%
Leave-one-out validation accuracies :  ['77.3000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.3000%', '77.4000%', '77.5000%']
Computed and normalized credits:  tensor([0.1002, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999, 0.1000, 0.1002, 0.0999,
        0.0997])
Federated model performance: Loss: 0.499788. Accuracy: 78.6310%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['61.412%', '69.390%', '71.594%', '73.904%', '74.182%', '75.337%', '75.551%', '75.743%', '75.807%', '76.642%']
Workers federated accuracies:  ['76.535%', '76.984%', '76.856%', '77.497%', '76.984%', '77.412%', '77.775%', '77.904%', '77.797%', '77.797%']
Workers improved  accuracies:  ['22.032%', '21.840%', '20.856%', '20.856%', '19.529%', '18.631%', '18.567%', '18.524%', '17.476%', '17.112%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 17:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.4000%', '77.5000%', '77.4000%', '77.5000%', '77.5000%', '77.6000%', '77.5000%']
Computed and normalized credits:  tensor([0.1002, 0.1001, 0.1001, 0.1001, 0.0999, 0.1001, 0.0999, 0.0999, 0.0997,
        0.0999])
Federated model performance: Loss: 0.497563. Accuracy: 78.7166%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['61.797%', '69.818%', '71.957%', '74.032%', '74.439%', '75.508%', '75.722%', '75.936%', '76.000%', '76.706%']
Workers federated accuracies:  ['76.556%', '77.048%', '76.856%', '77.604%', '77.027%', '77.626%', '78.032%', '78.160%', '77.968%', '77.989%']
Workers improved  accuracies:  ['22.053%', '21.904%', '20.856%', '20.963%', '19.572%', '18.845%', '18.824%', '18.781%', '17.647%', '17.305%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 18:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.5000%', '77.6000%', '77.8000%', '77.9000%', '77.7000%', '77.7000%', '77.6000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1003, 0.1001, 0.0997, 0.0995, 0.0999, 0.0999,
        0.1001])
Federated model performance: Loss: 0.495580. Accuracy: 78.9305%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['62.075%', '70.289%', '72.171%', '74.032%', '74.652%', '75.636%', '75.850%', '76.150%', '76.021%', '76.898%']
Workers federated accuracies:  ['76.706%', '77.134%', '77.005%', '77.690%', '77.176%', '77.861%', '78.075%', '78.203%', '78.075%', '78.182%']
Workers improved  accuracies:  ['22.203%', '21.989%', '21.005%', '21.048%', '19.722%', '19.080%', '18.866%', '18.824%', '17.754%', '17.497%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 19:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.7000%', '77.6000%', '77.6000%', '77.6000%', '77.7000%', '77.5000%', '77.7000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.0999, 0.1001, 0.1000, 0.1000, 0.0998, 0.1002,
        0.0999])
Federated model performance: Loss: 0.493839. Accuracy: 79.0802%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['62.396%', '70.674%', '72.599%', '74.182%', '74.717%', '75.679%', '76.086%', '76.278%', '76.107%', '77.070%']
Workers federated accuracies:  ['76.813%', '77.198%', '77.091%', '77.754%', '77.390%', '77.925%', '78.096%', '78.225%', '78.118%', '78.524%']
Workers improved  accuracies:  ['22.310%', '22.053%', '21.091%', '21.112%', '19.936%', '19.144%', '18.888%', '18.845%', '17.797%', '17.840%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Epoch 20:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.7000%', '77.7000%', '77.6000%', '77.6000%', '77.5000%', '77.4000%', '77.4000%', '77.6000%', '77.6000%', '77.5000%']
Computed and normalized credits:  tensor([0.0997, 0.0997, 0.0999, 0.0999, 0.1001, 0.1003, 0.1003, 0.0999, 0.1000,
        0.1001])
Federated model performance: Loss: 0.492256. Accuracy: 79.1230%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['62.717%', '71.016%', '72.856%', '74.310%', '74.888%', '75.807%', '76.193%', '76.428%', '76.214%', '77.176%']
Workers federated accuracies:  ['76.877%', '77.283%', '77.070%', '77.818%', '77.583%', '77.882%', '78.160%', '78.332%', '78.096%', '78.588%']
Workers improved  accuracies:  ['22.374%', '22.139%', '21.070%', '21.176%', '20.128%', '19.102%', '18.952%', '18.952%', '17.775%', '17.904%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.492256. Accuracy: 79.1230%.
Workers before    accuracies:  ['54.503%', '55.144%', '56.000%', '56.642%', '57.455%', '58.781%', '59.209%', '59.380%', '60.321%', '60.684%']
Workers standlone accuracies:  ['62.717%', '71.016%', '72.856%', '74.310%', '74.888%', '75.807%', '76.193%', '76.428%', '76.214%', '77.176%']
Workers federated accuracies:  ['76.877%', '77.283%', '77.070%', '77.818%', '77.583%', '77.882%', '78.160%', '78.332%', '78.096%', '78.588%']
Workers improved  accuracies:  ['22.374%', '22.139%', '21.070%', '21.176%', '20.128%', '19.102%', '18.952%', '18.952%', '17.775%', '17.904%']
Workers shard sizes:  [112, 288, 464, 640, 816, 992, 1168, 1344, 1520, 1696]
Workers sharing_contributions :  tensor([ 11.2000,  28.8000,  46.4000,  64.0000,  81.6000,  99.2000, 116.8000,
        134.4000, 152.0000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.1846492166453811, 0.6095721858535647)
Correlation between stand alone test acc & collaborative final model acc:  (0.8264663423656842, 0.003199534381389537)
Correlation between test_acc & sharing contributions:  (0.9419448368992687, 4.631905721418503e-05)
Correlation between test_acc improvements & sharing_contributions:  (-0.9789322480780529, 8.402890602138895e-07)
standalone_vs_final_corr [[0.779258696982579], [0.6444737695902572], [0.828677935285452], [0.821337091477529], [0.8264663423656842]]
standalone_vs_final_corr_mean [0.7800427671403003]
standalone_vs_final_corr_std [0.07015029152101668]
sharingcontribution_vs_final_corr [[0.9608605947653236], [0.918375440998458], [0.9744237158241463], [0.9635402602486843], [0.9419448368992687]]
sharingcontribution_vs_final_corr_mean [0.9518289697471761]
sharingcontribution_vs_final_corr_std [0.019728567073451105]
standalone_vs_federated_perturbed_corr [[-0.20784271552195993], [-0.5808770182001208], [-0.16574575211350384], [0.1771936555607178], [0.1846492166453811]]
standalone_vs_federated_perturbed_corr_mean [-0.11852452272589717]
standalone_vs_federated_perturbed_corr_std [0.28402146797521893]
federated_final_performance [0.7848128080368042, 0.7970053553581238, 0.7786096334457397, 0.7764706015586853, 0.7912299633026123]
federated_final_performance_mean 0.785625672340393
federated_final_performance_std 0.0076760163358171336
CFFL_best_worker [0.7807486653327942, 0.7895187139511108, 0.7788235545158386, 0.7775400876998901, 0.7858823537826538]
CFFL_best_worker_mean 0.7825026750564575
CFFL_best_worker_std 0.004514128518291516
standalone_best_worker [0.766631007194519, 0.7739037275314331, 0.7642780542373657, 0.7715507745742798, 0.7717646956443787]
standalone_best_worker_mean 0.7696256518363953
standalone_best_worker_std 0.003581849640426859
