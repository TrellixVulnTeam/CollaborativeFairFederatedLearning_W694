Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 5000, 'n_workers': 10, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 20, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.705054. Accuracy: 54.7594%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 67.2000%
Leave-one-out validation accuracies :  ['67.4000%', '67.8000%', '68.6000%', '70.0000%', '71.2000%', '71.6000%', '72.4000%', '73.6000%', '75.2000%', '76.4000%']
Computed and normalized credits:  tensor([0.1097, 0.1087, 0.1067, 0.1032, 0.1003, 0.0994, 0.0975, 0.0947, 0.0912,
        0.0886])
Federated model performance: Loss: 0.632988. Accuracy: 65.5615%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['53.968%', '54.353%', '54.824%', '55.209%', '56.321%', '56.342%', '56.599%', '57.369%', '57.369%', '58.631%']
Workers federated accuracies:  ['53.968%', '54.353%', '54.824%', '55.209%', '56.321%', '56.342%', '56.599%', '57.369%', '57.369%', '58.631%']
Workers improved  accuracies:  ['0.321%', '0.406%', '0.663%', '0.749%', '1.583%', '1.497%', '1.604%', '2.096%', '1.989%', '2.439%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 2:
Federated model validation accuracy : 73.0000%
Leave-one-out validation accuracies :  ['73.0000%', '72.8000%', '73.4000%', '74.2000%', '75.2000%', '76.2000%', '76.2000%', '76.0000%', '76.2000%', '76.4000%']
Computed and normalized credits:  tensor([0.1060, 0.1062, 0.1046, 0.1022, 0.0995, 0.0972, 0.0969, 0.0968, 0.0958,
        0.0949])
Federated model performance: Loss: 0.579156. Accuracy: 71.8717%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['54.139%', '54.738%', '55.294%', '56.321%', '57.604%', '57.433%', '57.882%', '58.888%', '59.037%', '61.241%']
Workers federated accuracies:  ['54.139%', '54.738%', '55.294%', '56.321%', '57.604%', '57.433%', '57.882%', '58.888%', '59.037%', '61.241%']
Workers improved  accuracies:  ['0.492%', '0.791%', '1.134%', '1.861%', '2.866%', '2.588%', '2.888%', '3.615%', '3.658%', '5.048%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 3:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.4000%', '76.0000%', '75.8000%', '76.0000%', '76.2000%', '76.2000%', '76.0000%', '75.8000%', '75.6000%', '76.2000%']
Computed and normalized credits:  tensor([0.1002, 0.1011, 0.1012, 0.1004, 0.0996, 0.0992, 0.0995, 0.0999, 0.1002,
        0.0988])
Federated model performance: Loss: 0.541189. Accuracy: 73.3690%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['54.203%', '55.016%', '55.936%', '57.219%', '58.973%', '59.230%', '59.636%', '60.770%', '61.262%', '64.171%']
Workers federated accuracies:  ['54.203%', '55.016%', '55.936%', '57.219%', '58.973%', '59.230%', '59.636%', '60.770%', '61.262%', '64.171%']
Workers improved  accuracies:  ['0.556%', '1.070%', '1.775%', '2.759%', '4.235%', '4.385%', '4.642%', '5.497%', '5.882%', '7.979%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 4:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.4000%', '76.4000%', '75.6000%', '75.6000%', '75.4000%', '75.8000%', '76.6000%', '76.8000%', '77.2000%', '77.4000%']
Computed and normalized credits:  tensor([0.0999, 0.1000, 0.1017, 0.1015, 0.1018, 0.1009, 0.0993, 0.0990, 0.0982,
        0.0976])
Federated model performance: Loss: 0.515766. Accuracy: 74.0321%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['54.396%', '55.508%', '56.556%', '58.203%', '60.257%', '60.791%', '61.155%', '62.652%', '63.187%', '66.246%']
Workers federated accuracies:  ['54.396%', '55.508%', '56.556%', '58.203%', '60.257%', '60.791%', '61.155%', '62.652%', '63.187%', '66.246%']
Workers improved  accuracies:  ['0.749%', '1.561%', '2.396%', '3.743%', '5.519%', '5.947%', '6.160%', '7.380%', '7.807%', '10.053%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 5:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.4000%', '76.6000%', '76.6000%', '76.6000%', '76.8000%', '77.4000%', '77.8000%', '78.0000%', '78.2000%', '78.2000%']
Computed and normalized credits:  tensor([0.1017, 0.1014, 0.1016, 0.1016, 0.1012, 0.0999, 0.0988, 0.0983, 0.0978,
        0.0977])
Federated model performance: Loss: 0.500537. Accuracy: 74.6952%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['54.674%', '55.807%', '57.176%', '58.952%', '62.096%', '62.588%', '62.781%', '64.385%', '64.984%', '68.364%']
Workers federated accuracies:  ['54.674%', '55.807%', '57.176%', '58.952%', '62.096%', '62.588%', '62.781%', '64.385%', '64.984%', '68.364%']
Workers improved  accuracies:  ['1.027%', '1.861%', '3.016%', '4.492%', '7.358%', '7.743%', '7.786%', '9.112%', '9.604%', '12.171%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 6:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.8000%', '77.8000%', '78.0000%', '78.0000%', '78.2000%', '78.2000%', '78.4000%', '78.4000%', '78.6000%']
Computed and normalized credits:  tensor([0.1013, 0.1008, 0.1009, 0.1005, 0.1004, 0.0998, 0.0996, 0.0991, 0.0990,
        0.0986])
Federated model performance: Loss: 0.492396. Accuracy: 75.1230%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['54.845%', '56.214%', '57.797%', '59.872%', '63.551%', '63.914%', '63.850%', '65.947%', '66.717%', '69.583%']
Workers federated accuracies:  ['54.845%', '56.214%', '57.797%', '59.872%', '63.551%', '63.914%', '63.850%', '65.947%', '66.717%', '69.583%']
Workers improved  accuracies:  ['1.198%', '2.267%', '3.636%', '5.412%', '8.813%', '9.070%', '8.856%', '10.674%', '11.337%', '13.390%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 7:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.6000%', '78.6000%', '78.4000%', '78.4000%']
Computed and normalized credits:  tensor([0.1005, 0.1004, 0.1004, 0.1004, 0.1003, 0.0998, 0.0994, 0.0993, 0.0997,
        0.0996])
Federated model performance: Loss: 0.489925. Accuracy: 75.4866%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['55.059%', '56.385%', '58.289%', '60.770%', '64.770%', '65.412%', '65.433%', '67.444%', '67.979%', '70.781%']
Workers federated accuracies:  ['55.059%', '56.385%', '58.289%', '60.770%', '64.770%', '65.412%', '65.433%', '67.444%', '67.979%', '70.781%']
Workers improved  accuracies:  ['1.412%', '2.439%', '4.128%', '6.310%', '10.032%', '10.567%', '10.439%', '12.171%', '12.599%', '14.588%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 8:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.4000%', '78.4000%', '78.6000%', '79.0000%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1006, 0.1005, 0.1001, 0.0993, 0.0993,
        0.0993])
Federated model performance: Loss: 0.491957. Accuracy: 76.0000%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['55.187%', '56.920%', '59.230%', '61.947%', '65.989%', '66.374%', '66.289%', '68.535%', '69.048%', '71.551%']
Workers federated accuracies:  ['55.187%', '56.920%', '59.230%', '61.947%', '65.989%', '66.374%', '66.289%', '68.535%', '69.048%', '71.551%']
Workers improved  accuracies:  ['1.540%', '2.973%', '5.070%', '7.487%', '11.251%', '11.529%', '11.294%', '13.262%', '13.668%', '15.358%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 9:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.6000%', '78.6000%', '78.8000%', '79.0000%', '79.0000%', '79.2000%', '79.2000%', '79.2000%', '78.8000%']
Computed and normalized credits:  tensor([0.1010, 0.1006, 0.1006, 0.1002, 0.0999, 0.0998, 0.0994, 0.0992, 0.0992,
        0.1000])
Federated model performance: Loss: 0.497110. Accuracy: 76.1283%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['55.401%', '57.326%', '59.743%', '62.952%', '67.102%', '67.529%', '67.316%', '69.818%', '70.225%', '72.385%']
Workers federated accuracies:  ['55.401%', '57.326%', '59.743%', '62.952%', '67.102%', '67.529%', '67.316%', '69.818%', '70.225%', '72.385%']
Workers improved  accuracies:  ['1.754%', '3.380%', '5.583%', '8.492%', '12.364%', '12.684%', '12.321%', '14.545%', '14.845%', '16.193%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 10:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '79.2000%', '79.2000%', '79.2000%', '79.0000%', '79.0000%', '78.8000%', '78.8000%', '79.0000%', '79.2000%']
Computed and normalized credits:  tensor([0.1002, 0.0998, 0.0998, 0.0997, 0.1001, 0.1001, 0.1004, 0.1003, 0.1000,
        0.0997])
Federated model performance: Loss: 0.504650. Accuracy: 76.1711%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['55.594%', '57.647%', '60.299%', '63.957%', '67.786%', '68.578%', '68.107%', '70.802%', '71.166%', '73.048%']
Workers federated accuracies:  ['55.594%', '57.647%', '60.299%', '63.957%', '67.786%', '68.578%', '68.107%', '70.802%', '71.166%', '73.048%']
Workers improved  accuracies:  ['1.947%', '3.701%', '6.139%', '9.497%', '13.048%', '13.733%', '13.112%', '15.529%', '15.786%', '16.856%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 11:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.4000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.0996,
        0.0992])
Federated model performance: Loss: 0.513767. Accuracy: 76.2139%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['55.936%', '58.246%', '61.005%', '64.684%', '68.599%', '69.455%', '69.219%', '71.594%', '71.850%', '73.519%']
Workers federated accuracies:  ['74.738%', '74.781%', '74.930%', '75.316%', '75.615%', '75.465%', '75.636%', '75.701%', '75.829%', '76.257%']
Workers improved  accuracies:  ['21.091%', '20.834%', '20.770%', '20.856%', '20.877%', '20.620%', '20.642%', '20.428%', '20.449%', '20.064%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 12:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.8000%', '79.6000%', '79.6000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1003, 0.1003, 0.1003, 0.1003, 0.0991, 0.0994,
        0.0993])
Federated model performance: Loss: 0.508924. Accuracy: 76.4706%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['56.150%', '58.909%', '61.797%', '65.433%', '69.540%', '70.289%', '70.096%', '72.257%', '72.321%', '73.925%']
Workers federated accuracies:  ['74.802%', '74.802%', '75.080%', '75.444%', '75.636%', '75.594%', '75.872%', '75.807%', '76.021%', '76.342%']
Workers improved  accuracies:  ['21.155%', '20.856%', '20.920%', '20.984%', '20.898%', '20.749%', '20.877%', '20.535%', '20.642%', '20.150%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 13:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%', '80.0000%', '80.0000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1005, 0.1005, 0.1001, 0.1001, 0.0997, 0.0995, 0.0992,
        0.0992])
Federated model performance: Loss: 0.504320. Accuracy: 76.5348%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['56.214%', '59.273%', '62.588%', '66.118%', '69.968%', '70.781%', '70.738%', '72.620%', '72.749%', '74.246%']
Workers federated accuracies:  ['74.866%', '74.866%', '75.251%', '75.508%', '75.701%', '75.679%', '75.957%', '75.893%', '76.086%', '76.471%']
Workers improved  accuracies:  ['21.219%', '20.920%', '21.091%', '21.048%', '20.963%', '20.834%', '20.963%', '20.620%', '20.706%', '20.278%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 14:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '80.0000%', '80.0000%', '80.2000%', '80.4000%', '80.4000%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1007, 0.1007, 0.1003, 0.0999, 0.0998, 0.0994, 0.0989,
        0.0989])
Federated model performance: Loss: 0.499949. Accuracy: 76.5134%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['56.556%', '59.679%', '63.251%', '66.738%', '70.802%', '71.422%', '71.337%', '72.984%', '73.048%', '74.545%']
Workers federated accuracies:  ['74.866%', '74.973%', '75.316%', '75.679%', '75.807%', '75.786%', '75.979%', '76.064%', '76.171%', '76.513%']
Workers improved  accuracies:  ['21.219%', '21.027%', '21.155%', '21.219%', '21.070%', '20.941%', '20.984%', '20.791%', '20.791%', '20.321%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 15:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.2000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1003, 0.0999, 0.0998, 0.0998, 0.0998, 0.0997, 0.0996,
        0.0996])
Federated model performance: Loss: 0.495781. Accuracy: 76.5989%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['56.706%', '60.043%', '63.743%', '67.209%', '71.273%', '71.765%', '71.872%', '73.390%', '73.433%', '74.952%']
Workers federated accuracies:  ['74.845%', '74.952%', '75.316%', '75.679%', '76.021%', '75.850%', '75.957%', '76.171%', '76.150%', '76.599%']
Workers improved  accuracies:  ['21.198%', '21.005%', '21.155%', '21.219%', '21.283%', '21.005%', '20.963%', '20.898%', '20.770%', '20.406%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 16:
Federated model validation accuracy : 80.4000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.4000%', '80.6000%', '80.6000%', '80.6000%', '80.6000%', '80.4000%', '80.8000%', '81.0000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1004, 0.0999, 0.0999, 0.0999, 0.0999, 0.1003, 0.0995,
        0.0991])
Federated model performance: Loss: 0.491924. Accuracy: 76.7059%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['56.963%', '60.428%', '64.321%', '67.765%', '71.701%', '72.257%', '72.321%', '73.818%', '73.668%', '75.358%']
Workers federated accuracies:  ['74.802%', '75.144%', '75.358%', '75.636%', '76.150%', '75.829%', '76.021%', '76.193%', '76.171%', '76.727%']
Workers improved  accuracies:  ['21.155%', '21.198%', '21.198%', '21.176%', '21.412%', '20.984%', '21.027%', '20.920%', '20.791%', '20.535%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 17:
Federated model validation accuracy : 80.6000%
Leave-one-out validation accuracies :  ['80.6000%', '80.6000%', '80.6000%', '80.6000%', '80.8000%', '81.0000%', '81.2000%', '81.0000%', '81.0000%', '81.2000%']
Computed and normalized credits:  tensor([0.1006, 0.1006, 0.1006, 0.1005, 0.1001, 0.0997, 0.0993, 0.0998, 0.0996,
        0.0992])
Federated model performance: Loss: 0.488264. Accuracy: 76.7914%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['57.091%', '60.856%', '65.155%', '68.321%', '72.235%', '72.620%', '72.727%', '73.904%', '73.882%', '75.508%']
Workers federated accuracies:  ['74.973%', '75.102%', '75.422%', '75.722%', '76.150%', '75.829%', '76.107%', '76.193%', '76.278%', '76.791%']
Workers improved  accuracies:  ['21.326%', '21.155%', '21.262%', '21.262%', '21.412%', '20.984%', '21.112%', '20.920%', '20.898%', '20.599%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 18:
Federated model validation accuracy : 81.2000%
Leave-one-out validation accuracies :  ['81.2000%', '81.2000%', '81.2000%', '81.2000%', '81.2000%', '81.2000%', '81.2000%', '81.2000%', '81.0000%', '81.6000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1000, 0.0999, 0.1000, 0.1004,
        0.0991])
Federated model performance: Loss: 0.484820. Accuracy: 76.8984%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['57.155%', '61.369%', '65.668%', '68.791%', '72.663%', '72.963%', '72.984%', '74.096%', '74.203%', '75.658%']
Workers federated accuracies:  ['75.187%', '75.273%', '75.572%', '75.979%', '76.150%', '75.936%', '76.235%', '76.385%', '76.299%', '76.791%']
Workers improved  accuracies:  ['21.540%', '21.326%', '21.412%', '21.519%', '21.412%', '21.091%', '21.241%', '21.112%', '20.920%', '20.599%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 19:
Federated model validation accuracy : 81.0000%
Leave-one-out validation accuracies :  ['81.0000%', '81.0000%', '81.0000%', '81.2000%', '81.2000%', '81.2000%', '81.6000%', '81.4000%', '81.6000%', '81.6000%']
Computed and normalized credits:  tensor([0.1006, 0.1006, 0.1006, 0.1002, 0.1002, 0.1002, 0.0994, 0.0998, 0.0994,
        0.0992])
Federated model performance: Loss: 0.481583. Accuracy: 76.9840%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['57.348%', '61.861%', '66.310%', '69.219%', '73.134%', '73.326%', '73.283%', '74.374%', '74.439%', '75.765%']
Workers federated accuracies:  ['75.251%', '75.337%', '75.636%', '76.086%', '76.235%', '76.021%', '76.385%', '76.492%', '76.364%', '76.834%']
Workers improved  accuracies:  ['21.604%', '21.390%', '21.476%', '21.626%', '21.497%', '21.176%', '21.390%', '21.219%', '20.984%', '20.642%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 20:
Federated model validation accuracy : 81.6000%
Leave-one-out validation accuracies :  ['81.6000%', '81.6000%', '81.6000%', '81.6000%', '81.4000%', '81.6000%', '81.6000%', '81.6000%', '81.6000%', '81.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1003, 0.0999, 0.0998, 0.0999, 0.0998,
        0.1002])
Federated model performance: Loss: 0.478509. Accuracy: 77.0909%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['57.519%', '62.417%', '66.781%', '69.904%', '73.283%', '73.668%', '73.561%', '74.631%', '74.824%', '75.979%']
Workers federated accuracies:  ['75.380%', '75.508%', '75.743%', '76.150%', '76.321%', '76.107%', '76.364%', '76.642%', '76.492%', '76.941%']
Workers improved  accuracies:  ['21.733%', '21.561%', '21.583%', '21.690%', '21.583%', '21.262%', '21.369%', '21.369%', '21.112%', '20.749%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.478509. Accuracy: 77.0909%.
Workers before    accuracies:  ['53.647%', '53.947%', '54.160%', '54.460%', '54.738%', '54.845%', '54.995%', '55.273%', '55.380%', '56.193%']
Workers standlone accuracies:  ['57.519%', '62.417%', '66.781%', '69.904%', '73.283%', '73.668%', '73.561%', '74.631%', '74.824%', '75.979%']
Workers federated accuracies:  ['75.380%', '75.508%', '75.743%', '76.150%', '76.321%', '76.107%', '76.364%', '76.642%', '76.492%', '76.941%']
Workers improved  accuracies:  ['21.733%', '21.561%', '21.583%', '21.690%', '21.583%', '21.262%', '21.369%', '21.369%', '21.112%', '20.749%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]
Workers sharing_contributions :  tensor([ 6.4000, 14.4000, 24.0000, 32.0000, 41.6000, 49.6000, 59.2000, 67.2000,
        76.8000, 84.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.37896672666037323, 0.28015809566008437)
Correlation between stand alone test acc & collaborative final model acc:  (0.9282582713728802, 0.00010621295511893844)
Correlation between test_acc & sharing contributions:  (0.9522784060039297, 2.1416460938759725e-05)
Correlation between test_acc improvements & sharing_contributions:  (-0.8730367887694338, 0.0009726106039006369)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.857439. Accuracy: 40.2353%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 57.6000%
Leave-one-out validation accuracies :  ['57.8000%', '58.0000%', '60.2000%', '63.8000%', '65.8000%', '68.6000%', '71.2000%', '73.8000%', '74.0000%', '74.4000%']
Computed and normalized credits:  tensor([0.1262, 0.1255, 0.1181, 0.1068, 0.1010, 0.0935, 0.0870, 0.0812, 0.0808,
        0.0799])
Federated model performance: Loss: 0.745683. Accuracy: 53.5615%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['39.080%', '39.701%', '40.086%', '41.112%', '42.332%', '42.374%', '42.845%', '43.529%', '43.807%', '45.668%']
Workers federated accuracies:  ['46.717%', '46.845%', '40.086%', '41.112%', '42.332%', '42.374%', '42.845%', '43.529%', '43.807%', '45.668%']
Workers improved  accuracies:  ['8.064%', '7.722%', '0.663%', '1.433%', '2.118%', '2.053%', '2.267%', '2.374%', '2.481%', '3.380%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 2:
Federated model validation accuracy : 72.2000%
Leave-one-out validation accuracies :  ['72.2000%', '72.2000%', '73.0000%', '74.2000%', '74.8000%', '74.0000%', '74.4000%', '75.6000%', '75.4000%', '76.8000%']
Computed and normalized credits:  tensor([0.1091, 0.1090, 0.1059, 0.1013, 0.0990, 0.0994, 0.0974, 0.0938, 0.0941,
        0.0910])
Federated model performance: Loss: 0.661767. Accuracy: 66.1818%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['39.422%', '40.214%', '40.984%', '42.439%', '43.850%', '43.979%', '44.620%', '45.754%', '46.182%', '48.898%']
Workers federated accuracies:  ['46.845%', '47.123%', '40.984%', '42.439%', '43.850%', '43.979%', '44.620%', '45.754%', '46.182%', '48.898%']
Workers improved  accuracies:  ['8.193%', '8.000%', '1.561%', '2.759%', '3.636%', '3.658%', '4.043%', '4.599%', '4.856%', '6.610%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 3:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.4000%', '74.8000%', '75.2000%', '75.6000%', '75.4000%', '76.6000%', '76.6000%', '76.8000%', '76.8000%', '76.8000%']
Computed and normalized credits:  tensor([0.1048, 0.1039, 0.1025, 0.1008, 0.1009, 0.0984, 0.0981, 0.0970, 0.0971,
        0.0965])
Federated model performance: Loss: 0.601274. Accuracy: 71.1872%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['39.594%', '40.898%', '42.032%', '43.444%', '45.904%', '45.818%', '46.888%', '48.342%', '48.578%', '52.128%']
Workers federated accuracies:  ['46.973%', '47.465%', '42.032%', '43.444%', '45.904%', '45.818%', '46.888%', '48.342%', '48.578%', '52.128%']
Workers improved  accuracies:  ['8.321%', '8.342%', '2.610%', '3.765%', '5.690%', '5.497%', '6.310%', '7.187%', '7.251%', '9.840%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 4:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['77.0000%', '76.8000%', '76.6000%', '76.8000%', '76.8000%', '76.6000%', '77.0000%', '77.0000%', '77.4000%', '78.2000%']
Computed and normalized credits:  tensor([0.1008, 0.1011, 0.1013, 0.1006, 0.1006, 0.1006, 0.0997, 0.0995, 0.0987,
        0.0970])
Federated model performance: Loss: 0.560252. Accuracy: 73.2406%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['39.893%', '41.519%', '42.738%', '44.556%', '47.166%', '47.615%', '48.963%', '50.460%', '51.166%', '55.551%']
Workers federated accuracies:  ['47.316%', '47.914%', '42.738%', '44.556%', '47.166%', '47.615%', '48.963%', '50.460%', '51.166%', '55.551%']
Workers improved  accuracies:  ['8.663%', '8.791%', '3.316%', '4.877%', '6.952%', '7.294%', '8.385%', '9.305%', '9.840%', '13.262%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 5:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['77.0000%', '77.0000%', '77.0000%', '77.2000%', '77.2000%', '77.2000%', '77.8000%', '78.6000%', '78.6000%', '78.8000%']
Computed and normalized credits:  tensor([0.1014, 0.1015, 0.1015, 0.1010, 0.1010, 0.1010, 0.0996, 0.0980, 0.0978,
        0.0971])
Federated model performance: Loss: 0.534352. Accuracy: 74.4171%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['40.214%', '42.053%', '43.444%', '45.540%', '48.684%', '49.048%', '50.802%', '53.112%', '53.754%', '59.658%']
Workers federated accuracies:  ['47.358%', '48.150%', '43.444%', '45.540%', '48.684%', '49.048%', '50.802%', '53.112%', '53.754%', '59.658%']
Workers improved  accuracies:  ['8.706%', '9.027%', '4.021%', '5.861%', '8.471%', '8.727%', '10.225%', '11.957%', '12.428%', '17.369%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 6:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4000%', '78.4000%', '78.6000%', '78.6000%', '78.6000%', '79.0000%', '78.8000%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1008, 0.1003, 0.1003, 0.1003, 0.0993, 0.0994, 0.0990,
        0.0989])
Federated model performance: Loss: 0.519835. Accuracy: 74.9733%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['40.663%', '42.289%', '44.299%', '46.888%', '50.225%', '51.209%', '53.048%', '55.551%', '56.278%', '62.203%']
Workers federated accuracies:  ['47.615%', '48.749%', '44.299%', '46.888%', '50.225%', '51.209%', '53.048%', '55.551%', '56.278%', '62.203%']
Workers improved  accuracies:  ['8.963%', '9.626%', '4.877%', '7.209%', '10.011%', '10.888%', '12.471%', '14.396%', '14.952%', '19.914%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 7:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '79.0000%', '79.0000%', '79.0000%', '78.8000%', '79.0000%', '79.2000%', '79.2000%', '79.2000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1001, 0.1001, 0.1001, 0.1005, 0.0999, 0.0995, 0.0994,
        0.0994])
Federated model performance: Loss: 0.513959. Accuracy: 75.3797%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['41.027%', '42.545%', '45.497%', '48.257%', '52.000%', '53.412%', '54.909%', '58.011%', '58.952%', '65.219%']
Workers federated accuracies:  ['47.786%', '49.219%', '45.497%', '48.257%', '52.000%', '53.412%', '54.909%', '58.011%', '58.952%', '65.219%']
Workers improved  accuracies:  ['9.134%', '10.096%', '6.075%', '8.578%', '11.786%', '13.091%', '14.332%', '16.856%', '17.626%', '22.930%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 8:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.2000%', '79.2000%', '79.2000%', '79.4000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.0000%']
Computed and normalized credits:  tensor([0.0997, 0.1001, 0.1001, 0.1000, 0.0997, 0.1001, 0.1000, 0.1000, 0.0999,
        0.1003])
Federated model performance: Loss: 0.513569. Accuracy: 75.3797%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['41.390%', '43.166%', '46.139%', '49.412%', '53.733%', '55.102%', '56.663%', '60.043%', '61.882%', '67.594%']
Workers federated accuracies:  ['47.957%', '49.626%', '46.139%', '49.412%', '53.733%', '55.102%', '56.663%', '60.043%', '61.882%', '67.594%']
Workers improved  accuracies:  ['9.305%', '10.503%', '6.717%', '9.733%', '13.519%', '14.781%', '16.086%', '18.888%', '20.556%', '25.305%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 9:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%']
Computed and normalized credits:  tensor([0.0998, 0.0999, 0.0999, 0.0999, 0.0998, 0.0999, 0.1003, 0.1003, 0.1003,
        0.0999])
Federated model performance: Loss: 0.517863. Accuracy: 75.4652%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['41.797%', '43.786%', '46.845%', '50.503%', '55.722%', '56.599%', '58.930%', '62.267%', '64.770%', '69.733%']
Workers federated accuracies:  ['48.257%', '49.968%', '46.845%', '50.503%', '55.722%', '56.599%', '58.930%', '62.267%', '64.770%', '69.733%']
Workers improved  accuracies:  ['9.604%', '10.845%', '7.422%', '10.824%', '15.508%', '16.278%', '18.353%', '21.112%', '23.444%', '27.444%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 10:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.2000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.2000%', '79.2000%', '79.4000%']
Computed and normalized credits:  tensor([0.0995, 0.0999, 0.1003, 0.1003, 0.1003, 0.1003, 0.1000, 0.1000, 0.1000,
        0.0995])
Federated model performance: Loss: 0.525341. Accuracy: 75.5936%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['42.096%', '44.364%', '47.551%', '51.914%', '57.540%', '58.310%', '60.706%', '64.342%', '66.267%', '70.866%']
Workers federated accuracies:  ['48.513%', '50.374%', '47.551%', '51.914%', '57.540%', '58.310%', '60.706%', '64.342%', '66.267%', '70.866%']
Workers improved  accuracies:  ['9.861%', '11.251%', '8.128%', '12.235%', '17.326%', '17.989%', '20.128%', '23.187%', '24.941%', '28.578%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 11:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.4000%', '79.4000%', '79.6000%', '79.6000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1003, 0.1003, 0.1003, 0.1003, 0.0998, 0.0998, 0.0994,
        0.0994])
Federated model performance: Loss: 0.535049. Accuracy: 75.8717%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['42.353%', '44.813%', '48.535%', '53.134%', '59.422%', '59.936%', '63.144%', '65.882%', '67.936%', '71.914%']
Workers federated accuracies:  ['48.578%', '50.845%', '48.535%', '53.134%', '59.422%', '59.936%', '63.144%', '65.882%', '67.936%', '71.914%']
Workers improved  accuracies:  ['9.925%', '11.722%', '9.112%', '13.455%', '19.209%', '19.615%', '22.567%', '24.727%', '26.610%', '29.626%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 12:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1000, 0.1000, 0.1000, 0.0999, 0.0999, 0.0995,
        0.0995])
Federated model performance: Loss: 0.546596. Accuracy: 75.9572%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['42.545%', '45.433%', '49.262%', '54.396%', '61.241%', '62.203%', '65.241%', '67.209%', '69.241%', '72.920%']
Workers federated accuracies:  ['48.984%', '51.209%', '49.262%', '54.396%', '61.241%', '62.203%', '65.241%', '67.209%', '69.241%', '72.920%']
Workers improved  accuracies:  ['10.332%', '12.086%', '9.840%', '14.717%', '21.027%', '21.882%', '24.663%', '26.053%', '27.914%', '30.631%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 13:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '79.8000%', '79.8000%', '79.6000%', '79.8000%', '80.2000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1003, 0.0999, 0.0999, 0.0999, 0.1003, 0.0998,
        0.0990])
Federated model performance: Loss: 0.559489. Accuracy: 76.0000%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['42.610%', '46.203%', '49.861%', '55.765%', '62.973%', '63.187%', '66.203%', '68.513%', '70.225%', '73.583%']
Workers federated accuracies:  ['49.262%', '51.401%', '49.861%', '55.765%', '62.973%', '63.187%', '66.203%', '68.513%', '70.225%', '73.583%']
Workers improved  accuracies:  ['10.610%', '12.278%', '10.439%', '16.086%', '22.759%', '22.866%', '25.626%', '27.358%', '28.898%', '31.294%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 14:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '79.8000%', '79.8000%', '80.0000%', '80.0000%', '80.0000%', '79.8000%', '80.0000%', '80.2000%', '80.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1004, 0.1004, 0.1000, 0.0999, 0.0999, 0.1003, 0.1000, 0.0995,
        0.0998])
Federated model performance: Loss: 0.572606. Accuracy: 76.0428%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['42.973%', '46.610%', '50.866%', '56.834%', '64.449%', '64.642%', '67.123%', '69.583%', '71.209%', '74.096%']
Workers federated accuracies:  ['75.123%', '75.144%', '75.251%', '75.658%', '75.572%', '75.615%', '75.893%', '75.615%', '76.021%', '76.171%']
Workers improved  accuracies:  ['36.471%', '36.021%', '35.829%', '35.979%', '35.358%', '35.294%', '35.316%', '34.460%', '34.695%', '33.882%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 15:
Federated model validation accuracy : 80.2000%
Leave-one-out validation accuracies :  ['80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.4000%', '80.6000%']
Computed and normalized credits:  tensor([0.1001, 0.1002, 0.1002, 0.1001, 0.1001, 0.1001, 0.1002, 0.1001, 0.0996,
        0.0993])
Federated model performance: Loss: 0.564950. Accuracy: 76.1925%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['43.059%', '47.016%', '52.064%', '58.053%', '65.861%', '65.626%', '68.193%', '70.396%', '71.829%', '74.695%']
Workers federated accuracies:  ['75.166%', '75.251%', '75.316%', '75.701%', '75.636%', '75.636%', '75.914%', '75.701%', '76.021%', '76.278%']
Workers improved  accuracies:  ['36.513%', '36.128%', '35.893%', '36.021%', '35.422%', '35.316%', '35.337%', '34.545%', '34.695%', '33.989%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 16:
Federated model validation accuracy : 80.2000%
Leave-one-out validation accuracies :  ['80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.4000%', '80.6000%', '80.6000%', '80.6000%', '80.8000%', '81.0000%']
Computed and normalized credits:  tensor([0.1006, 0.1006, 0.1006, 0.1006, 0.1002, 0.0998, 0.0998, 0.0998, 0.0993,
        0.0989])
Federated model performance: Loss: 0.557644. Accuracy: 76.3850%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['43.337%', '47.465%', '52.898%', '59.380%', '67.080%', '66.930%', '69.027%', '70.802%', '72.749%', '75.251%']
Workers federated accuracies:  ['75.273%', '75.465%', '75.444%', '75.807%', '75.722%', '75.701%', '75.914%', '75.743%', '76.257%', '76.385%']
Workers improved  accuracies:  ['36.620%', '36.342%', '36.021%', '36.128%', '35.508%', '35.380%', '35.337%', '34.588%', '34.930%', '34.096%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 17:
Federated model validation accuracy : 80.6000%
Leave-one-out validation accuracies :  ['80.6000%', '80.6000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '81.0000%', '81.0000%', '80.8000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.0996, 0.0995,
        0.0998])
Federated model performance: Loss: 0.550663. Accuracy: 76.4278%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['43.743%', '47.807%', '54.075%', '60.513%', '68.043%', '68.193%', '69.947%', '71.102%', '73.348%', '75.529%']
Workers federated accuracies:  ['75.422%', '75.572%', '75.551%', '75.914%', '75.829%', '75.743%', '76.107%', '75.829%', '76.364%', '76.578%']
Workers improved  accuracies:  ['36.770%', '36.449%', '36.128%', '36.235%', '35.615%', '35.422%', '35.529%', '34.674%', '35.037%', '34.289%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 18:
Federated model validation accuracy : 81.0000%
Leave-one-out validation accuracies :  ['81.0000%', '81.0000%', '81.0000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '81.0000%', '81.0000%', '80.8000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.0998, 0.1002, 0.1002, 0.1002, 0.1002, 0.0997, 0.0997,
        0.1002])
Federated model performance: Loss: 0.544100. Accuracy: 76.6203%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['44.150%', '48.321%', '54.866%', '61.283%', '68.920%', '69.155%', '70.674%', '71.529%', '73.497%', '75.551%']
Workers federated accuracies:  ['75.401%', '75.679%', '75.636%', '75.957%', '76.000%', '75.850%', '76.193%', '75.893%', '76.556%', '76.791%']
Workers improved  accuracies:  ['36.749%', '36.556%', '36.214%', '36.278%', '35.786%', '35.529%', '35.615%', '34.738%', '35.230%', '34.503%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 19:
Federated model validation accuracy : 80.6000%
Leave-one-out validation accuracies :  ['80.6000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '81.0000%', '81.2000%']
Computed and normalized credits:  tensor([0.1004, 0.1001, 0.1000, 0.1001, 0.1001, 0.1001, 0.1001, 0.1000, 0.0996,
        0.0993])
Federated model performance: Loss: 0.537915. Accuracy: 76.6845%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['44.321%', '48.642%', '55.765%', '62.374%', '69.455%', '69.989%', '71.251%', '71.786%', '73.882%', '75.679%']
Workers federated accuracies:  ['75.572%', '75.850%', '75.786%', '76.086%', '76.000%', '76.000%', '76.342%', '76.086%', '76.770%', '76.898%']
Workers improved  accuracies:  ['36.920%', '36.727%', '36.364%', '36.406%', '35.786%', '35.679%', '35.765%', '34.930%', '35.444%', '34.610%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 20:
Federated model validation accuracy : 80.8000%
Leave-one-out validation accuracies :  ['80.8000%', '80.8000%', '80.8000%', '80.8000%', '81.0000%', '81.0000%', '81.2000%', '81.2000%', '81.2000%', '81.2000%']
Computed and normalized credits:  tensor([0.1005, 0.1004, 0.1004, 0.1004, 0.1000, 0.1000, 0.0996, 0.0996, 0.0996,
        0.0995])
Federated model performance: Loss: 0.532173. Accuracy: 76.8984%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['44.492%', '48.813%', '56.642%', '63.401%', '69.904%', '70.738%', '71.722%', '72.321%', '74.417%', '75.850%']
Workers federated accuracies:  ['75.765%', '75.936%', '75.829%', '76.128%', '76.064%', '76.107%', '76.471%', '76.299%', '76.834%', '76.984%']
Workers improved  accuracies:  ['37.112%', '36.813%', '36.406%', '36.449%', '35.850%', '35.786%', '35.893%', '35.144%', '35.508%', '34.695%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.532173. Accuracy: 76.8984%.
Workers before    accuracies:  ['38.652%', '39.123%', '39.422%', '39.679%', '40.214%', '40.321%', '40.578%', '41.155%', '41.326%', '42.289%']
Workers standlone accuracies:  ['44.492%', '48.813%', '56.642%', '63.401%', '69.904%', '70.738%', '71.722%', '72.321%', '74.417%', '75.850%']
Workers federated accuracies:  ['75.765%', '75.936%', '75.829%', '76.128%', '76.064%', '76.107%', '76.471%', '76.299%', '76.834%', '76.984%']
Workers improved  accuracies:  ['37.112%', '36.813%', '36.406%', '36.449%', '35.850%', '35.786%', '35.893%', '35.144%', '35.508%', '34.695%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]
Workers sharing_contributions :  tensor([ 6.4000, 14.4000, 24.0000, 32.0000, 41.6000, 49.6000, 59.2000, 67.2000,
        76.8000, 84.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.3171799371446584, 0.3718580268530621)
Correlation between stand alone test acc & collaborative final model acc:  (0.7864534946651951, 0.006967732329596064)
Correlation between test_acc & sharing contributions:  (0.9265054276962329, 0.00011672739852041462)
Correlation between test_acc improvements & sharing_contributions:  (-0.9558084271628936, 1.581673811904525e-05)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.824834. Accuracy: 37.0267%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 51.8000%
Leave-one-out validation accuracies :  ['52.4000%', '53.6000%', '55.2000%', '58.4000%', '62.8000%', '67.0000%', '70.6000%', '72.2000%', '73.4000%', '74.8000%']
Computed and normalized credits:  tensor([0.1378, 0.1328, 0.1264, 0.1145, 0.0999, 0.0881, 0.0795, 0.0761, 0.0737,
        0.0710])
Federated model performance: Loss: 0.724712. Accuracy: 52.6203%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['36.406%', '36.492%', '37.048%', '37.690%', '38.674%', '38.909%', '39.144%', '40.257%', '40.235%', '43.187%']
Workers federated accuracies:  ['42.952%', '42.973%', '43.636%', '37.690%', '38.674%', '38.909%', '39.144%', '40.257%', '40.235%', '43.187%']
Workers improved  accuracies:  ['6.610%', '6.631%', '7.037%', '0.898%', '1.690%', '1.711%', '1.840%', '2.524%', '2.588%', '4.642%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 2:
Federated model validation accuracy : 71.0000%
Leave-one-out validation accuracies :  ['71.2000%', '71.4000%', '72.2000%', '72.4000%', '73.2000%', '74.4000%', '74.8000%', '75.4000%', '76.2000%', '76.6000%']
Computed and normalized credits:  tensor([0.1125, 0.1112, 0.1082, 0.1056, 0.1012, 0.0965, 0.0940, 0.0921, 0.0900,
        0.0887])
Federated model performance: Loss: 0.649765. Accuracy: 68.3422%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['36.513%', '36.813%', '37.733%', '38.610%', '40.556%', '41.070%', '41.540%', '43.273%', '43.380%', '47.358%']
Workers federated accuracies:  ['51.765%', '52.000%', '44.599%', '38.610%', '40.556%', '41.070%', '41.540%', '43.273%', '43.380%', '47.358%']
Workers improved  accuracies:  ['15.422%', '15.658%', '8.000%', '1.818%', '3.572%', '3.872%', '4.235%', '5.540%', '5.733%', '8.813%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 3:
Federated model validation accuracy : 75.2000%
Leave-one-out validation accuracies :  ['75.4000%', '75.8000%', '75.6000%', '75.6000%', '76.0000%', '76.2000%', '76.0000%', '76.4000%', '76.6000%', '76.8000%']
Computed and normalized credits:  tensor([0.1035, 0.1024, 0.1023, 0.1019, 0.1003, 0.0991, 0.0991, 0.0979, 0.0971,
        0.0965])
Federated model performance: Loss: 0.595383. Accuracy: 72.4920%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['36.599%', '37.241%', '38.567%', '39.936%', '43.123%', '43.529%', '44.000%', '46.267%', '46.845%', '52.535%']
Workers federated accuracies:  ['51.979%', '52.620%', '45.604%', '39.936%', '43.123%', '43.529%', '44.000%', '46.267%', '46.845%', '52.535%']
Workers improved  accuracies:  ['15.636%', '16.278%', '9.005%', '3.144%', '6.139%', '6.332%', '6.695%', '8.535%', '9.198%', '13.989%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 4:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.8000%', '77.0000%', '77.0000%', '77.0000%', '77.0000%', '77.2000%', '77.2000%']
Computed and normalized credits:  tensor([0.1012, 0.1010, 0.1010, 0.1005, 0.0998, 0.0996, 0.0996, 0.0994, 0.0989,
        0.0988])
Federated model performance: Loss: 0.557682. Accuracy: 74.2246%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['36.791%', '37.754%', '39.401%', '41.733%', '45.112%', '45.540%', '46.396%', '49.668%', '50.396%', '57.626%']
Workers federated accuracies:  ['52.342%', '52.856%', '46.909%', '41.733%', '45.112%', '45.540%', '46.396%', '49.668%', '50.396%', '57.626%']
Workers improved  accuracies:  ['16.000%', '16.513%', '10.310%', '4.941%', '8.128%', '8.342%', '9.091%', '11.936%', '12.749%', '19.080%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 5:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.2000%', '77.4000%', '77.2000%', '77.4000%', '77.4000%', '77.2000%', '77.2000%', '77.6000%', '77.2000%', '77.6000%']
Computed and normalized credits:  tensor([0.1005, 0.1000, 0.1005, 0.1000, 0.0999, 0.1002, 0.1002, 0.0994, 0.1001,
        0.0993])
Federated model performance: Loss: 0.532496. Accuracy: 74.8877%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['36.877%', '38.160%', '40.364%', '43.401%', '47.209%', '48.535%', '49.348%', '53.476%', '54.674%', '62.203%']
Workers federated accuracies:  ['70.182%', '70.396%', '71.037%', '72.107%', '72.471%', '72.663%', '72.898%', '73.305%', '73.305%', '74.011%']
Workers improved  accuracies:  ['33.840%', '34.053%', '34.439%', '35.316%', '35.487%', '35.465%', '35.594%', '35.572%', '35.658%', '35.465%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 6:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['77.8000%', '78.2000%', '78.2000%', '78.0000%', '77.8000%', '77.8000%', '77.8000%', '77.8000%', '78.0000%', '78.2000%']
Computed and normalized credits:  tensor([0.1004, 0.0995, 0.0996, 0.0999, 0.1003, 0.1004, 0.1004, 0.1002, 0.0999,
        0.0994])
Federated model performance: Loss: 0.517724. Accuracy: 75.3583%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['37.070%', '38.588%', '41.348%', '44.770%', '49.647%', '51.166%', '52.770%', '57.326%', '58.610%', '65.925%']
Workers federated accuracies:  ['71.316%', '71.765%', '72.214%', '72.920%', '73.241%', '73.348%', '73.626%', '74.139%', '74.032%', '74.524%']
Workers improved  accuracies:  ['34.973%', '35.422%', '35.615%', '36.128%', '36.257%', '36.150%', '36.321%', '36.406%', '36.385%', '35.979%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 7:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['77.8000%', '77.8000%', '77.8000%', '77.8000%', '78.0000%', '77.8000%', '78.0000%', '78.2000%', '78.4000%', '78.6000%']
Computed and normalized credits:  tensor([0.1005, 0.1004, 0.1004, 0.1004, 0.1001, 0.1005, 0.1001, 0.0997, 0.0992,
        0.0987])
Federated model performance: Loss: 0.505968. Accuracy: 75.4439%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['37.369%', '39.144%', '42.631%', '46.332%', '52.364%', '53.882%', '55.893%', '60.535%', '61.840%', '69.091%']
Workers federated accuracies:  ['72.535%', '72.642%', '72.941%', '73.455%', '74.139%', '74.096%', '74.225%', '74.396%', '74.524%', '74.738%']
Workers improved  accuracies:  ['36.193%', '36.299%', '36.342%', '36.663%', '37.155%', '36.898%', '36.920%', '36.663%', '36.877%', '36.193%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 8:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1003, 0.1003, 0.1003, 0.0999, 0.0998, 0.0993,
        0.0992])
Federated model performance: Loss: 0.496332. Accuracy: 75.6578%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['37.583%', '39.487%', '43.679%', '47.701%', '55.380%', '56.642%', '58.567%', '63.380%', '63.829%', '70.952%']
Workers federated accuracies:  ['73.155%', '73.091%', '73.476%', '74.032%', '74.460%', '74.567%', '74.695%', '74.759%', '74.909%', '75.123%']
Workers improved  accuracies:  ['36.813%', '36.749%', '36.877%', '37.241%', '37.476%', '37.369%', '37.390%', '37.027%', '37.262%', '36.578%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 9:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.6000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1004, 0.1000, 0.1000, 0.0999, 0.0999, 0.0998,
        0.0998])
Federated model performance: Loss: 0.488560. Accuracy: 75.7647%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['38.011%', '39.957%', '44.642%', '49.604%', '57.861%', '59.401%', '60.877%', '66.374%', '66.203%', '72.128%']
Workers federated accuracies:  ['73.540%', '73.540%', '74.032%', '74.588%', '74.738%', '74.781%', '75.037%', '75.037%', '75.209%', '75.337%']
Workers improved  accuracies:  ['37.198%', '37.198%', '37.433%', '37.797%', '37.754%', '37.583%', '37.733%', '37.305%', '37.561%', '36.791%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 10:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.2000%', '80.0000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1004, 0.1003, 0.1003, 0.1003, 0.1003, 0.0995,
        0.0979])
Federated model performance: Loss: 0.481890. Accuracy: 75.9572%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['38.310%', '40.235%', '45.840%', '51.979%', '60.150%', '61.989%', '63.422%', '68.684%', '68.749%', '72.770%']
Workers federated accuracies:  ['73.818%', '73.989%', '74.439%', '74.717%', '75.037%', '74.995%', '75.251%', '75.273%', '75.401%', '75.551%']
Workers improved  accuracies:  ['37.476%', '37.647%', '37.840%', '37.925%', '38.053%', '37.797%', '37.947%', '37.540%', '37.754%', '37.005%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 11:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.2000%', '79.2000%', '79.4000%', '79.6000%', '79.6000%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1007, 0.1007, 0.1003, 0.0999, 0.0999, 0.0995, 0.0990,
        0.0987])
Federated model performance: Loss: 0.476175. Accuracy: 76.2781%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['38.374%', '40.642%', '46.866%', '54.160%', '62.845%', '64.278%', '65.283%', '70.503%', '70.225%', '73.412%']
Workers federated accuracies:  ['74.075%', '74.139%', '74.717%', '75.080%', '75.316%', '75.294%', '75.508%', '75.337%', '75.594%', '75.658%']
Workers improved  accuracies:  ['37.733%', '37.797%', '38.118%', '38.289%', '38.332%', '38.096%', '38.203%', '37.604%', '37.947%', '37.112%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 12:
Federated model validation accuracy : 79.8000%
Leave-one-out validation accuracies :  ['79.8000%', '79.8000%', '79.4000%', '79.4000%', '79.4000%', '79.6000%', '79.6000%', '79.8000%', '80.2000%', '80.0000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.1007, 0.1007, 0.1006, 0.1002, 0.1002, 0.0997, 0.0989,
        0.0992])
Federated model performance: Loss: 0.471150. Accuracy: 76.5562%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['38.652%', '41.369%', '47.957%', '55.722%', '64.727%', '66.353%', '67.230%', '71.872%', '71.636%', '73.818%']
Workers federated accuracies:  ['74.246%', '74.396%', '74.845%', '75.251%', '75.465%', '75.380%', '75.615%', '75.572%', '75.765%', '75.722%']
Workers improved  accuracies:  ['37.904%', '38.053%', '38.246%', '38.460%', '38.481%', '38.182%', '38.310%', '37.840%', '38.118%', '37.176%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 13:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.8000%', '80.2000%', '80.0000%', '80.0000%', '80.2000%', '80.0000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1006, 0.1006, 0.1002, 0.0994, 0.0998, 0.0997, 0.0991,
        0.0996])
Federated model performance: Loss: 0.466998. Accuracy: 76.7273%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['38.930%', '41.797%', '48.813%', '57.925%', '66.503%', '68.321%', '68.920%', '72.406%', '72.578%', '74.503%']
Workers federated accuracies:  ['74.588%', '74.674%', '75.059%', '75.444%', '75.422%', '75.508%', '75.701%', '75.807%', '75.786%', '75.829%']
Workers improved  accuracies:  ['38.246%', '38.332%', '38.460%', '38.652%', '38.439%', '38.310%', '38.396%', '38.075%', '38.139%', '37.283%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 14:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.2000%', '80.4000%', '80.4000%', '80.2000%', '80.0000%', '79.8000%', '80.0000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.0999, 0.0995, 0.0993, 0.0998, 0.1001, 0.1004,
        0.1001])
Federated model performance: Loss: 0.463092. Accuracy: 77.0053%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['39.209%', '42.439%', '49.904%', '59.465%', '68.171%', '69.818%', '70.374%', '72.770%', '73.048%', '74.652%']
Workers federated accuracies:  ['74.781%', '74.888%', '75.187%', '75.594%', '75.508%', '75.572%', '75.893%', '75.914%', '75.979%', '75.957%']
Workers improved  accuracies:  ['38.439%', '38.545%', '38.588%', '38.802%', '38.524%', '38.374%', '38.588%', '38.182%', '38.332%', '37.412%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 15:
Federated model validation accuracy : 79.8000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1001, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000, 0.1001,
        0.1000])
Federated model performance: Loss: 0.459520. Accuracy: 77.1551%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['39.487%', '42.845%', '51.080%', '61.091%', '69.690%', '71.080%', '71.487%', '73.262%', '73.583%', '74.973%']
Workers federated accuracies:  ['74.995%', '75.080%', '75.230%', '75.658%', '75.594%', '75.636%', '76.043%', '76.043%', '76.086%', '76.214%']
Workers improved  accuracies:  ['38.652%', '38.738%', '38.631%', '38.866%', '38.610%', '38.439%', '38.738%', '38.310%', '38.439%', '37.668%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 16:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.4000%', '80.8000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.0995,
        0.0987])
Federated model performance: Loss: 0.456348. Accuracy: 77.1979%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['39.807%', '43.508%', '52.299%', '62.503%', '70.802%', '71.829%', '72.128%', '73.647%', '73.882%', '75.123%']
Workers federated accuracies:  ['75.016%', '75.294%', '75.273%', '75.743%', '75.722%', '75.786%', '76.064%', '76.278%', '76.385%', '76.321%']
Workers improved  accuracies:  ['38.674%', '38.952%', '38.674%', '38.952%', '38.738%', '38.588%', '38.759%', '38.545%', '38.738%', '37.775%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 17:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.0000%', '80.2000%', '80.4000%', '80.4000%', '80.8000%', '81.0000%', '81.0000%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1008, 0.1008, 0.1004, 0.1000, 0.1000, 0.0992, 0.0987,
        0.0986])
Federated model performance: Loss: 0.453590. Accuracy: 77.3690%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['40.150%', '44.235%', '53.262%', '63.722%', '71.615%', '72.556%', '72.813%', '74.139%', '74.139%', '75.294%']
Workers federated accuracies:  ['75.166%', '75.294%', '75.401%', '75.807%', '75.765%', '75.829%', '76.257%', '76.321%', '76.364%', '76.556%']
Workers improved  accuracies:  ['38.824%', '38.952%', '38.802%', '39.016%', '38.781%', '38.631%', '38.952%', '38.588%', '38.717%', '38.011%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 18:
Federated model validation accuracy : 80.8000%
Leave-one-out validation accuracies :  ['80.8000%', '80.8000%', '80.8000%', '80.8000%', '81.0000%', '81.0000%', '81.0000%', '81.0000%', '81.2000%', '81.4000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1005, 0.1005, 0.1000, 0.1000, 0.1000, 0.0998, 0.0994,
        0.0989])
Federated model performance: Loss: 0.451078. Accuracy: 77.4545%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['40.556%', '44.684%', '54.545%', '65.070%', '72.214%', '72.920%', '73.048%', '74.353%', '74.417%', '75.401%']
Workers federated accuracies:  ['75.337%', '75.358%', '75.594%', '75.914%', '75.850%', '76.000%', '76.449%', '76.449%', '76.471%', '76.727%']
Workers improved  accuracies:  ['38.995%', '39.016%', '38.995%', '39.123%', '38.866%', '38.802%', '39.144%', '38.717%', '38.824%', '38.182%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 19:
Federated model validation accuracy : 81.0000%
Leave-one-out validation accuracies :  ['81.0000%', '81.0000%', '81.0000%', '81.0000%', '81.0000%', '81.0000%', '81.2000%', '81.4000%', '81.4000%', '81.4000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1004, 0.1003, 0.1003, 0.0999, 0.0995, 0.0994,
        0.0993])
Federated model performance: Loss: 0.448760. Accuracy: 77.6257%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['40.856%', '45.283%', '55.636%', '66.439%', '72.727%', '73.091%', '73.412%', '74.610%', '74.674%', '75.658%']
Workers federated accuracies:  ['75.401%', '75.487%', '75.636%', '76.021%', '76.043%', '76.043%', '76.513%', '76.578%', '76.684%', '76.813%']
Workers improved  accuracies:  ['39.059%', '39.144%', '39.037%', '39.230%', '39.059%', '38.845%', '39.209%', '38.845%', '39.037%', '38.267%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 20:
Federated model validation accuracy : 81.4000%
Leave-one-out validation accuracies :  ['81.4000%', '81.4000%', '81.4000%', '81.4000%', '81.4000%', '81.4000%', '81.4000%', '81.4000%', '81.4000%', '81.6000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1000, 0.0999, 0.0999,
        0.0995])
Federated model performance: Loss: 0.446515. Accuracy: 77.7326%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['41.219%', '46.267%', '56.642%', '67.701%', '72.984%', '73.262%', '73.754%', '74.781%', '74.909%', '75.679%']
Workers federated accuracies:  ['75.465%', '75.658%', '75.722%', '76.000%', '76.128%', '76.086%', '76.578%', '76.578%', '76.877%', '76.920%']
Workers improved  accuracies:  ['39.123%', '39.316%', '39.123%', '39.209%', '39.144%', '38.888%', '39.273%', '38.845%', '39.230%', '38.374%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.446515. Accuracy: 77.7326%.
Workers before    accuracies:  ['36.342%', '36.342%', '36.599%', '36.791%', '36.984%', '37.198%', '37.305%', '37.733%', '37.647%', '38.545%']
Workers standlone accuracies:  ['41.219%', '46.267%', '56.642%', '67.701%', '72.984%', '73.262%', '73.754%', '74.781%', '74.909%', '75.679%']
Workers federated accuracies:  ['75.465%', '75.658%', '75.722%', '76.000%', '76.128%', '76.086%', '76.578%', '76.578%', '76.877%', '76.920%']
Workers improved  accuracies:  ['39.123%', '39.316%', '39.123%', '39.209%', '39.144%', '38.888%', '39.273%', '38.845%', '39.230%', '38.374%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]
Workers sharing_contributions :  tensor([ 6.4000, 14.4000, 24.0000, 32.0000, 41.6000, 49.6000, 59.2000, 67.2000,
        76.8000, 84.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.12212798485367873, 0.7367941819663011)
Correlation between stand alone test acc & collaborative final model acc:  (0.8510047313440283, 0.0017940205813062233)
Correlation between test_acc & sharing contributions:  (0.9852245788080761, 2.048407469129587e-07)
Correlation between test_acc improvements & sharing_contributions:  (-0.563584330004447, 0.08976018937637838)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.643998. Accuracy: 64.1497%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.8000%
Leave-one-out validation accuracies :  ['71.8000%', '71.4000%', '71.2000%', '72.0000%', '72.6000%', '73.4000%', '73.8000%', '74.4000%', '74.2000%', '75.4000%']
Computed and normalized credits:  tensor([0.1027, 0.1036, 0.1040, 0.1022, 0.1009, 0.0991, 0.0983, 0.0970, 0.0974,
        0.0948])
Federated model performance: Loss: 0.598339. Accuracy: 68.9412%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['63.722%', '63.979%', '64.128%', '64.642%', '65.369%', '65.519%', '65.519%', '65.626%', '65.647%', '66.353%']
Workers federated accuracies:  ['63.722%', '63.979%', '64.128%', '64.642%', '65.369%', '65.519%', '65.519%', '65.626%', '65.647%', '66.353%']
Workers improved  accuracies:  ['0.128%', '0.171%', '0.278%', '0.684%', '1.027%', '1.005%', '1.027%', '0.856%', '0.856%', '1.219%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 2:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['73.8000%', '74.2000%', '74.6000%', '74.0000%', '74.0000%', '74.4000%', '74.8000%', '75.0000%', '75.6000%', '76.4000%']
Computed and normalized credits:  tensor([0.1023, 0.1016, 0.1008, 0.1018, 0.1016, 0.1004, 0.0994, 0.0988, 0.0976,
        0.0955])
Federated model performance: Loss: 0.562581. Accuracy: 72.0428%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['63.850%', '64.278%', '64.642%', '65.155%', '65.925%', '66.289%', '66.203%', '66.717%', '66.610%', '67.529%']
Workers federated accuracies:  ['63.850%', '64.278%', '64.642%', '65.155%', '65.925%', '66.289%', '66.203%', '66.717%', '66.610%', '67.529%']
Workers improved  accuracies:  ['0.257%', '0.471%', '0.791%', '1.198%', '1.583%', '1.775%', '1.711%', '1.947%', '1.818%', '2.396%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 3:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.4000%', '75.4000%', '75.0000%', '75.0000%', '75.8000%', '76.2000%', '76.6000%', '77.0000%', '77.8000%']
Computed and normalized credits:  tensor([0.1015, 0.1014, 0.1013, 0.1023, 0.1023, 0.1004, 0.0994, 0.0985, 0.0974,
        0.0955])
Federated model performance: Loss: 0.535439. Accuracy: 73.2834%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['63.914%', '64.770%', '65.134%', '65.647%', '66.674%', '66.781%', '66.952%', '67.380%', '67.401%', '68.492%']
Workers federated accuracies:  ['63.914%', '64.770%', '65.134%', '65.647%', '66.674%', '66.781%', '66.952%', '67.380%', '67.401%', '68.492%']
Workers improved  accuracies:  ['0.321%', '0.963%', '1.283%', '1.690%', '2.332%', '2.267%', '2.460%', '2.610%', '2.610%', '3.358%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 4:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.8000%', '76.6000%', '77.2000%', '77.6000%', '78.2000%', '78.4000%', '78.4000%']
Computed and normalized credits:  tensor([0.1017, 0.1017, 0.1017, 0.1014, 0.1018, 0.1003, 0.0993, 0.0979, 0.0973,
        0.0970])
Federated model performance: Loss: 0.515552. Accuracy: 74.6310%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['64.043%', '65.070%', '65.476%', '66.075%', '67.102%', '67.401%', '67.615%', '68.342%', '68.321%', '69.626%']
Workers federated accuracies:  ['64.043%', '65.070%', '65.476%', '66.075%', '67.102%', '67.401%', '67.615%', '68.342%', '68.321%', '69.626%']
Workers improved  accuracies:  ['0.449%', '1.262%', '1.626%', '2.118%', '2.759%', '2.888%', '3.123%', '3.572%', '3.529%', '4.492%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 5:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.4000%', '78.4000%', '78.0000%', '78.0000%', '78.4000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1003, 0.1000, 0.0997, 0.0996, 0.1001, 0.1000,
        0.0992])
Federated model performance: Loss: 0.501474. Accuracy: 75.2941%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['64.214%', '65.390%', '65.690%', '66.545%', '67.850%', '68.021%', '68.214%', '69.070%', '69.155%', '70.802%']
Workers federated accuracies:  ['64.214%', '65.390%', '65.690%', '66.545%', '67.850%', '68.021%', '68.214%', '69.070%', '69.155%', '70.802%']
Workers improved  accuracies:  ['0.620%', '1.583%', '1.840%', '2.588%', '3.508%', '3.508%', '3.722%', '4.299%', '4.364%', '5.668%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 6:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.4000%', '78.2000%', '77.8000%', '77.8000%', '78.0000%', '78.2000%', '78.0000%', '77.8000%', '78.0000%']
Computed and normalized credits:  tensor([0.0990, 0.0994, 0.0998, 0.1006, 0.1006, 0.1001, 0.0997, 0.1002, 0.1006,
        0.1000])
Federated model performance: Loss: 0.492338. Accuracy: 75.6578%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['64.492%', '65.690%', '66.032%', '66.802%', '68.214%', '68.556%', '69.048%', '69.882%', '69.861%', '71.551%']
Workers federated accuracies:  ['64.492%', '65.690%', '66.032%', '66.802%', '68.214%', '68.556%', '69.048%', '69.882%', '69.861%', '71.551%']
Workers improved  accuracies:  ['0.898%', '1.882%', '2.182%', '2.845%', '3.872%', '4.043%', '4.556%', '5.112%', '5.070%', '6.417%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 7:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['77.8000%', '77.8000%', '78.0000%', '78.2000%', '77.8000%', '78.0000%', '78.4000%', '78.6000%', '78.8000%', '79.2000%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1005, 0.1002, 0.1010, 0.1005, 0.0997, 0.0993, 0.0990,
        0.0981])
Federated model performance: Loss: 0.487289. Accuracy: 75.8717%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['64.642%', '65.882%', '66.225%', '67.251%', '68.877%', '69.091%', '69.476%', '70.503%', '70.781%', '72.492%']
Workers federated accuracies:  ['64.642%', '65.882%', '66.225%', '67.251%', '68.877%', '69.091%', '69.476%', '70.503%', '70.781%', '72.492%']
Workers improved  accuracies:  ['1.048%', '2.075%', '2.374%', '3.294%', '4.535%', '4.578%', '4.984%', '5.733%', '5.989%', '7.358%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 8:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.6000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%', '79.4000%', '79.6000%', '79.6000%']
Computed and normalized credits:  tensor([0.1014, 0.1014, 0.1006, 0.1005, 0.1006, 0.1002, 0.1000, 0.0988, 0.0983,
        0.0982])
Federated model performance: Loss: 0.485642. Accuracy: 75.8717%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['64.663%', '66.075%', '66.567%', '67.722%', '69.112%', '69.497%', '70.225%', '71.080%', '71.658%', '72.856%']
Workers federated accuracies:  ['64.663%', '66.075%', '66.567%', '67.722%', '69.112%', '69.497%', '70.225%', '71.080%', '71.658%', '72.856%']
Workers improved  accuracies:  ['1.070%', '2.267%', '2.717%', '3.765%', '4.770%', '4.984%', '5.733%', '6.310%', '6.866%', '7.722%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 9:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '79.0000%', '79.2000%', '79.2000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%']
Computed and normalized credits:  tensor([0.1012, 0.1008, 0.1002, 0.1002, 0.0998, 0.0997, 0.0997, 0.0995, 0.0994,
        0.0994])
Federated model performance: Loss: 0.486621. Accuracy: 75.9358%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['64.791%', '66.332%', '66.738%', '67.979%', '69.754%', '70.203%', '71.059%', '71.765%', '72.385%', '73.134%']
Workers federated accuracies:  ['64.791%', '66.332%', '66.738%', '67.979%', '69.754%', '70.203%', '71.059%', '71.765%', '72.385%', '73.134%']
Workers improved  accuracies:  ['1.198%', '2.524%', '2.888%', '4.021%', '5.412%', '5.690%', '6.567%', '6.995%', '7.594%', '8.000%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 10:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.2000%', '79.2000%', '79.2000%', '79.4000%', '79.6000%', '80.2000%', '80.6000%', '80.6000%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1010, 0.1010, 0.1009, 0.1005, 0.1001, 0.0989, 0.0981,
        0.0981])
Federated model performance: Loss: 0.490033. Accuracy: 75.8503%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['64.898%', '66.396%', '67.016%', '68.214%', '70.203%', '70.652%', '71.615%', '72.492%', '73.176%', '73.818%']
Workers federated accuracies:  ['64.898%', '66.396%', '67.016%', '68.214%', '70.203%', '70.652%', '71.615%', '72.492%', '73.176%', '73.818%']
Workers improved  accuracies:  ['1.305%', '2.588%', '3.166%', '4.257%', '5.861%', '6.139%', '7.123%', '7.722%', '8.385%', '8.684%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 11:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.8000%', '80.2000%', '80.2000%', '80.2000%', '80.4000%', '80.6000%', '80.8000%', '81.0000%', '80.8000%']
Computed and normalized credits:  tensor([0.1020, 0.1012, 0.1004, 0.1004, 0.1004, 0.1000, 0.0995, 0.0989, 0.0984,
        0.0988])
Federated model performance: Loss: 0.494978. Accuracy: 75.8289%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['65.070%', '66.588%', '67.166%', '68.428%', '70.781%', '70.909%', '72.299%', '72.856%', '73.797%', '74.011%']
Workers federated accuracies:  ['65.070%', '66.588%', '67.166%', '68.428%', '70.781%', '70.909%', '72.299%', '72.856%', '73.797%', '74.011%']
Workers improved  accuracies:  ['1.476%', '2.781%', '3.316%', '4.471%', '6.438%', '6.396%', '7.807%', '8.086%', '9.005%', '8.877%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 12:
Federated model validation accuracy : 80.4000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.6000%', '80.6000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.6000%', '80.6000%']
Computed and normalized credits:  tensor([0.1008, 0.1007, 0.1002, 0.1002, 0.0998, 0.0997, 0.0996, 0.0995, 0.0998,
        0.0999])
Federated model performance: Loss: 0.501520. Accuracy: 75.8717%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['65.134%', '66.952%', '67.358%', '68.963%', '71.209%', '71.187%', '72.813%', '73.348%', '74.353%', '74.374%']
Workers federated accuracies:  ['65.134%', '66.952%', '67.358%', '68.963%', '71.209%', '71.187%', '72.813%', '73.348%', '74.353%', '74.374%']
Workers improved  accuracies:  ['1.540%', '3.144%', '3.508%', '5.005%', '6.866%', '6.674%', '8.321%', '8.578%', '9.562%', '9.241%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 13:
Federated model validation accuracy : 80.6000%
Leave-one-out validation accuracies :  ['80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.8000%', '80.6000%', '80.6000%', '80.6000%', '80.6000%', '80.0000%']
Computed and normalized credits:  tensor([0.0998, 0.0998, 0.0997, 0.0997, 0.0996, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1012])
Federated model performance: Loss: 0.509234. Accuracy: 75.8931%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['65.262%', '67.102%', '67.594%', '69.561%', '71.701%', '71.444%', '73.134%', '73.647%', '74.802%', '74.674%']
Workers federated accuracies:  ['65.262%', '67.102%', '67.594%', '69.561%', '71.701%', '71.444%', '73.134%', '73.647%', '74.802%', '74.674%']
Workers improved  accuracies:  ['1.668%', '3.294%', '3.743%', '5.604%', '7.358%', '6.930%', '8.642%', '8.877%', '10.011%', '9.540%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 14:
Federated model validation accuracy : 80.4000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.2000%', '80.0000%', '80.2000%', '80.2000%', '80.2000%']
Computed and normalized credits:  tensor([0.0997, 0.0997, 0.0997, 0.0997, 0.0997, 0.1002, 0.1005, 0.1002, 0.1002,
        0.1004])
Federated model performance: Loss: 0.517853. Accuracy: 75.8289%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['65.412%', '67.251%', '67.786%', '69.775%', '72.021%', '71.807%', '73.369%', '73.989%', '75.166%', '74.866%']
Workers federated accuracies:  ['65.412%', '67.251%', '67.786%', '69.775%', '72.021%', '71.807%', '73.369%', '73.989%', '75.166%', '74.866%']
Workers improved  accuracies:  ['1.818%', '3.444%', '3.936%', '5.818%', '7.679%', '7.294%', '8.877%', '9.219%', '10.374%', '9.733%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 15:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%']
Computed and normalized credits:  tensor([0.1003, 0.0999, 0.0999, 0.0999, 0.0999, 0.1000, 0.1001, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 0.527041. Accuracy: 75.8503%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['65.604%', '67.380%', '67.979%', '70.096%', '72.364%', '72.235%', '73.818%', '74.332%', '75.529%', '75.209%']
Workers federated accuracies:  ['65.604%', '67.380%', '67.979%', '70.096%', '72.364%', '72.235%', '73.818%', '74.332%', '75.529%', '75.209%']
Workers improved  accuracies:  ['2.011%', '3.572%', '4.128%', '6.139%', '8.021%', '7.722%', '9.326%', '9.561%', '10.738%', '10.075%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 16:
Federated model validation accuracy : 80.2000%
Leave-one-out validation accuracies :  ['80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%']
Computed and normalized credits:  tensor([0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 0.536832. Accuracy: 75.9358%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['65.754%', '67.594%', '68.342%', '70.481%', '72.513%', '72.385%', '74.225%', '74.652%', '76.043%', '75.401%']
Workers federated accuracies:  ['65.754%', '67.594%', '68.342%', '70.481%', '72.513%', '72.385%', '74.225%', '74.652%', '76.043%', '75.401%']
Workers improved  accuracies:  ['2.160%', '3.786%', '4.492%', '6.524%', '8.171%', '7.872%', '9.733%', '9.882%', '11.251%', '10.267%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 17:
Federated model validation accuracy : 80.2000%
Leave-one-out validation accuracies :  ['80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.0997])
Federated model performance: Loss: 0.547132. Accuracy: 75.9358%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['65.882%', '67.829%', '68.556%', '70.802%', '72.856%', '72.535%', '74.545%', '75.187%', '76.171%', '75.529%']
Workers federated accuracies:  ['65.882%', '67.829%', '68.556%', '70.802%', '72.856%', '72.535%', '74.545%', '75.187%', '76.171%', '75.529%']
Workers improved  accuracies:  ['2.289%', '4.021%', '4.706%', '6.845%', '8.513%', '8.021%', '10.053%', '10.417%', '11.380%', '10.396%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 18:
Federated model validation accuracy : 80.4000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.2000%', '80.4000%', '80.4000%']
Computed and normalized credits:  tensor([0.0998, 0.0998, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.0998,
        0.0997])
Federated model performance: Loss: 0.557281. Accuracy: 75.9358%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['65.989%', '68.021%', '68.706%', '71.016%', '73.005%', '72.684%', '74.781%', '75.401%', '76.235%', '75.594%']
Workers federated accuracies:  ['65.989%', '68.021%', '68.706%', '71.016%', '73.005%', '72.684%', '74.781%', '75.401%', '76.235%', '75.594%']
Workers improved  accuracies:  ['2.396%', '4.214%', '4.856%', '7.059%', '8.663%', '8.171%', '10.289%', '10.631%', '11.444%', '10.460%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 19:
Federated model validation accuracy : 80.4000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 0.567653. Accuracy: 75.9572%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['66.032%', '67.893%', '69.112%', '71.465%', '73.326%', '72.963%', '75.144%', '75.572%', '76.406%', '75.979%']
Workers federated accuracies:  ['66.032%', '67.893%', '69.112%', '71.465%', '73.326%', '72.963%', '75.144%', '75.572%', '76.406%', '75.979%']
Workers improved  accuracies:  ['2.439%', '4.086%', '5.262%', '7.508%', '8.984%', '8.449%', '10.652%', '10.802%', '11.615%', '10.845%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 20:
Federated model validation accuracy : 80.4000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%', '80.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 0.578412. Accuracy: 76.0428%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['66.118%', '68.214%', '69.305%', '71.743%', '73.561%', '73.305%', '75.487%', '75.743%', '76.385%', '76.214%']
Workers federated accuracies:  ['66.118%', '68.214%', '69.305%', '71.743%', '73.561%', '73.305%', '75.487%', '75.743%', '76.385%', '76.214%']
Workers improved  accuracies:  ['2.524%', '4.406%', '5.455%', '7.786%', '9.219%', '8.791%', '10.995%', '10.973%', '11.594%', '11.080%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.578412. Accuracy: 76.0428%.
Workers before    accuracies:  ['63.594%', '63.807%', '63.850%', '63.957%', '64.342%', '64.513%', '64.492%', '64.770%', '64.791%', '65.134%']
Workers standlone accuracies:  ['66.118%', '68.214%', '69.305%', '71.743%', '73.561%', '73.305%', '75.487%', '75.743%', '76.385%', '76.214%']
Workers federated accuracies:  ['66.118%', '68.214%', '69.305%', '71.743%', '73.561%', '73.305%', '75.487%', '75.743%', '76.385%', '76.214%']
Workers improved  accuracies:  ['2.524%', '4.406%', '5.455%', '7.786%', '9.219%', '8.791%', '10.995%', '10.973%', '11.594%', '11.080%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]
Workers sharing_contributions :  tensor([ 6.4000, 14.4000, 24.0000, 32.0000, 41.6000, 49.6000, 59.2000, 67.2000,
        76.8000, 84.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.43708176828228384, 0.20655596853259175)
Correlation between stand alone test acc & collaborative final model acc:  (0.9999999999999998, 1.0635035875250972e-62)
Correlation between test_acc & sharing contributions:  (0.9620205539812889, 8.69441746898634e-06)
Correlation between test_acc improvements & sharing_contributions:  (0.9480473691235095, 2.992761778250862e-05)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.753630. Accuracy: 54.4813%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 69.6000%
Leave-one-out validation accuracies :  ['69.8000%', '70.2000%', '70.6000%', '71.2000%', '72.4000%', '72.8000%', '74.6000%', '76.0000%', '76.8000%', '76.8000%']
Computed and normalized credits:  tensor([0.1077, 0.1067, 0.1058, 0.1043, 0.1015, 0.1006, 0.0965, 0.0934, 0.0917,
        0.0917])
Federated model performance: Loss: 0.672486. Accuracy: 64.7914%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['53.390%', '53.925%', '54.417%', '55.294%', '56.513%', '56.877%', '56.898%', '57.497%', '57.840%', '59.444%']
Workers federated accuracies:  ['53.390%', '53.925%', '54.417%', '55.294%', '56.513%', '56.877%', '56.898%', '57.497%', '57.840%', '59.444%']
Workers improved  accuracies:  ['0.171%', '0.599%', '0.770%', '1.390%', '1.925%', '2.160%', '2.011%', '2.353%', '2.289%', '2.909%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 2:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.6000%', '75.6000%', '76.4000%', '76.8000%', '77.4000%', '76.2000%', '77.2000%', '77.6000%', '77.6000%']
Computed and normalized credits:  tensor([0.1046, 0.1031, 0.1030, 0.1010, 0.0997, 0.0983, 0.1001, 0.0975, 0.0964,
        0.0964])
Federated model performance: Loss: 0.613262. Accuracy: 69.8396%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['53.626%', '54.417%', '55.508%', '56.749%', '58.075%', '58.610%', '58.824%', '59.679%', '59.914%', '61.262%']
Workers federated accuracies:  ['53.626%', '54.417%', '55.508%', '56.749%', '58.075%', '58.610%', '58.824%', '59.679%', '59.914%', '61.262%']
Workers improved  accuracies:  ['0.406%', '1.091%', '1.861%', '2.845%', '3.487%', '3.893%', '3.936%', '4.535%', '4.364%', '4.727%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 3:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.6000%', '76.4000%', '76.6000%', '77.0000%', '77.6000%', '77.4000%', '77.6000%', '78.0000%', '77.8000%', '78.0000%']
Computed and normalized credits:  tensor([0.1022, 0.1024, 0.1019, 0.1008, 0.0993, 0.0995, 0.0994, 0.0981, 0.0984,
        0.0979])
Federated model performance: Loss: 0.572706. Accuracy: 72.8984%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['53.775%', '55.059%', '56.513%', '57.668%', '59.529%', '59.850%', '60.278%', '60.941%', '61.412%', '63.957%']
Workers federated accuracies:  ['53.775%', '55.059%', '56.513%', '57.668%', '59.529%', '59.850%', '60.278%', '60.941%', '61.412%', '63.957%']
Workers improved  accuracies:  ['0.556%', '1.733%', '2.866%', '3.765%', '4.941%', '5.134%', '5.390%', '5.797%', '5.861%', '7.422%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 4:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.4000%', '77.2000%', '77.0000%', '77.8000%', '77.8000%', '77.8000%', '78.4000%', '78.4000%', '78.4000%', '78.0000%']
Computed and normalized credits:  tensor([0.1012, 0.1017, 0.1020, 0.1002, 0.0999, 0.1000, 0.0987, 0.0985, 0.0986,
        0.0993])
Federated model performance: Loss: 0.546995. Accuracy: 74.2246%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['54.182%', '55.786%', '57.005%', '58.909%', '60.321%', '61.176%', '61.455%', '62.824%', '63.337%', '65.775%']
Workers federated accuracies:  ['54.182%', '55.786%', '57.005%', '58.909%', '60.321%', '61.176%', '61.455%', '62.824%', '63.337%', '65.775%']
Workers improved  accuracies:  ['0.963%', '2.460%', '3.358%', '5.005%', '5.733%', '6.460%', '6.567%', '7.679%', '7.786%', '9.241%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 5:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2000%', '78.2000%', '78.4000%', '78.4000%', '78.2000%', '78.2000%', '78.4000%', '78.4000%', '78.2000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1005, 0.0998, 0.0997, 0.1002, 0.0999, 0.0995, 0.0995,
        0.1000])
Federated model performance: Loss: 0.532597. Accuracy: 74.8449%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['54.460%', '56.428%', '57.626%', '59.765%', '61.519%', '62.652%', '62.802%', '64.278%', '64.834%', '67.037%']
Workers federated accuracies:  ['54.460%', '56.428%', '57.626%', '59.765%', '61.519%', '62.652%', '62.802%', '64.278%', '64.834%', '67.037%']
Workers improved  accuracies:  ['1.241%', '3.102%', '3.979%', '5.861%', '6.930%', '7.936%', '7.914%', '9.134%', '9.283%', '10.503%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 6:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.2000%', '78.2000%', '78.6000%', '78.6000%', '78.2000%', '78.2000%', '78.4000%', '78.6000%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1003, 0.1002, 0.0994, 0.0994, 0.1002, 0.1001, 0.0997,
        0.0994])
Federated model performance: Loss: 0.526861. Accuracy: 75.0160%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['54.781%', '57.005%', '58.460%', '60.684%', '62.503%', '63.936%', '64.150%', '65.540%', '66.032%', '68.492%']
Workers federated accuracies:  ['54.781%', '57.005%', '58.460%', '60.684%', '62.503%', '63.936%', '64.150%', '65.540%', '66.032%', '68.492%']
Workers improved  accuracies:  ['1.561%', '3.679%', '4.813%', '6.781%', '7.914%', '9.219%', '9.262%', '10.396%', '10.481%', '11.957%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 7:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.2000%', '78.2000%', '78.4000%', '78.2000%', '78.4000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.1002, 0.1006, 0.1006, 0.1001, 0.1004, 0.1000, 0.0998, 0.0997, 0.0993,
        0.0992])
Federated model performance: Loss: 0.528073. Accuracy: 74.8235%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['55.144%', '57.326%', '59.294%', '61.412%', '63.743%', '65.198%', '65.305%', '66.631%', '67.037%', '69.561%']
Workers federated accuracies:  ['55.144%', '57.326%', '59.294%', '61.412%', '63.743%', '65.198%', '65.305%', '66.631%', '67.037%', '69.561%']
Workers improved  accuracies:  ['1.925%', '4.000%', '5.647%', '7.508%', '9.155%', '10.481%', '10.417%', '11.487%', '11.487%', '13.027%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 8:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1003, 0.0999, 0.0998, 0.0998, 0.0998, 0.0997,
        0.0997])
Federated model performance: Loss: 0.534062. Accuracy: 74.8449%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['55.444%', '57.840%', '59.850%', '62.182%', '64.791%', '66.160%', '66.353%', '67.679%', '68.364%', '70.588%']
Workers federated accuracies:  ['55.444%', '57.840%', '59.850%', '62.182%', '64.791%', '66.160%', '66.353%', '67.679%', '68.364%', '70.588%']
Workers improved  accuracies:  ['2.225%', '4.513%', '6.203%', '8.278%', '10.203%', '11.444%', '11.465%', '12.535%', '12.813%', '14.053%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 9:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.6000%', '78.4000%', '78.4000%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.1001, 0.0997, 0.0997, 0.0997, 0.0997, 0.1001, 0.1004, 0.1004, 0.1000,
        0.1000])
Federated model performance: Loss: 0.543932. Accuracy: 74.8877%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['55.701%', '58.246%', '60.321%', '63.102%', '65.840%', '66.674%', '67.102%', '68.620%', '69.283%', '71.358%']
Workers federated accuracies:  ['55.701%', '58.246%', '60.321%', '63.102%', '65.840%', '66.674%', '67.102%', '68.620%', '69.283%', '71.358%']
Workers improved  accuracies:  ['2.481%', '4.920%', '6.674%', '9.198%', '11.251%', '11.957%', '12.214%', '13.476%', '13.733%', '14.824%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 10:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.4000%', '78.4000%', '78.6000%', '78.4000%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.0999, 0.0998, 0.0998, 0.0998, 0.1002, 0.1003, 0.1000, 0.1004, 0.0999,
        0.0999])
Federated model performance: Loss: 0.556448. Accuracy: 74.9305%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['56.064%', '58.610%', '60.984%', '63.829%', '66.460%', '67.465%', '67.850%', '69.283%', '70.075%', '72.171%']
Workers federated accuracies:  ['56.064%', '58.610%', '60.984%', '63.829%', '66.460%', '67.465%', '67.850%', '69.283%', '70.075%', '72.171%']
Workers improved  accuracies:  ['2.845%', '5.283%', '7.337%', '9.925%', '11.872%', '12.749%', '12.963%', '14.139%', '14.524%', '15.636%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 11:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.6000%', '78.4000%', '78.4000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.1003, 0.0999, 0.1003, 0.1003, 0.0999, 0.0999, 0.0999, 0.0999, 0.0999,
        0.0999])
Federated model performance: Loss: 0.570811. Accuracy: 75.0374%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['56.342%', '59.080%', '61.561%', '64.535%', '66.888%', '68.257%', '68.663%', '70.225%', '70.995%', '73.048%']
Workers federated accuracies:  ['56.342%', '59.080%', '61.561%', '64.535%', '66.888%', '68.257%', '68.663%', '70.225%', '70.995%', '73.048%']
Workers improved  accuracies:  ['3.123%', '5.754%', '7.914%', '10.631%', '12.299%', '13.540%', '13.775%', '15.080%', '15.444%', '16.513%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 12:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.8000%', '78.4000%', '78.4000%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.1000, 0.0999, 0.1000, 0.1000, 0.0999, 0.0996, 0.1003, 0.1003, 0.0999,
        0.0999])
Federated model performance: Loss: 0.586804. Accuracy: 75.0374%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['56.599%', '59.487%', '61.989%', '65.005%', '67.294%', '68.727%', '69.519%', '70.802%', '71.807%', '73.733%']
Workers federated accuracies:  ['56.599%', '59.487%', '61.989%', '65.005%', '67.294%', '68.727%', '69.519%', '70.802%', '71.807%', '73.733%']
Workers improved  accuracies:  ['3.380%', '6.160%', '8.342%', '11.102%', '12.706%', '14.011%', '14.631%', '15.658%', '16.257%', '17.198%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 13:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.8000%', '78.8000%', '78.6000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.0995, 0.0995, 0.0999, 0.1002, 0.1003, 0.1003, 0.1003,
        0.1003])
Federated model performance: Loss: 0.603700. Accuracy: 75.0588%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['56.834%', '59.979%', '62.545%', '65.818%', '67.829%', '69.241%', '70.289%', '71.337%', '72.449%', '74.246%']
Workers federated accuracies:  ['56.834%', '59.979%', '62.545%', '65.818%', '67.829%', '69.241%', '70.289%', '71.337%', '72.449%', '74.246%']
Workers improved  accuracies:  ['3.615%', '6.652%', '8.898%', '11.914%', '13.241%', '14.524%', '15.401%', '16.193%', '16.898%', '17.711%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 14:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.6000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.4000%', '78.2000%']
Computed and normalized credits:  tensor([0.0996, 0.1000, 0.0999, 0.0999, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000,
        0.1004])
Federated model performance: Loss: 0.621259. Accuracy: 75.0160%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['57.027%', '60.257%', '63.123%', '66.353%', '68.449%', '70.096%', '70.781%', '72.021%', '72.941%', '74.524%']
Workers federated accuracies:  ['75.209%', '74.930%', '75.187%', '75.337%', '75.401%', '75.465%', '75.422%', '75.465%', '75.658%', '75.701%']
Workers improved  accuracies:  ['21.989%', '21.604%', '21.540%', '21.433%', '20.813%', '20.749%', '20.535%', '20.321%', '20.107%', '19.166%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 15:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1001])
Federated model performance: Loss: 0.611119. Accuracy: 75.2299%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['57.305%', '60.642%', '63.594%', '66.588%', '68.791%', '70.824%', '71.251%', '72.364%', '73.540%', '74.738%']
Workers federated accuracies:  ['75.273%', '75.016%', '75.230%', '75.337%', '75.422%', '75.444%', '75.422%', '75.615%', '75.701%', '75.722%']
Workers improved  accuracies:  ['22.053%', '21.690%', '21.583%', '21.433%', '20.834%', '20.727%', '20.535%', '20.471%', '20.150%', '19.187%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 16:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.6000%', '78.6000%', '78.6000%', '78.8000%', '78.8000%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.0999, 0.1000, 0.1000, 0.1004, 0.1004, 0.1004, 0.1000, 0.1000, 0.0996,
        0.0996])
Federated model performance: Loss: 0.601477. Accuracy: 75.4225%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['57.626%', '60.963%', '64.171%', '67.037%', '69.219%', '71.337%', '71.701%', '72.834%', '74.053%', '75.102%']
Workers federated accuracies:  ['75.316%', '75.187%', '75.380%', '75.444%', '75.487%', '75.401%', '75.529%', '75.722%', '75.850%', '75.743%']
Workers improved  accuracies:  ['22.096%', '21.861%', '21.733%', '21.540%', '20.898%', '20.684%', '20.642%', '20.578%', '20.299%', '19.209%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 17:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8000%', '79.0000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1005, 0.1001, 0.0997, 0.0996, 0.0996, 0.0996,
        0.0996])
Federated model performance: Loss: 0.592154. Accuracy: 75.5080%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['57.775%', '61.283%', '64.663%', '67.765%', '69.775%', '71.679%', '72.578%', '73.283%', '74.332%', '75.230%']
Workers federated accuracies:  ['75.337%', '75.294%', '75.465%', '75.487%', '75.529%', '75.465%', '75.615%', '75.722%', '75.979%', '75.850%']
Workers improved  accuracies:  ['22.118%', '21.968%', '21.818%', '21.583%', '20.941%', '20.749%', '20.727%', '20.578%', '20.428%', '19.316%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 18:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.6000%', '79.4000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1001, 0.1001, 0.1001, 0.1001, 0.0993,
        0.0997])
Federated model performance: Loss: 0.583692. Accuracy: 75.6791%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['58.053%', '61.668%', '65.176%', '68.299%', '70.075%', '72.321%', '73.048%', '73.476%', '74.781%', '75.765%']
Workers federated accuracies:  ['75.337%', '75.294%', '75.551%', '75.508%', '75.551%', '75.508%', '75.679%', '75.850%', '76.086%', '75.979%']
Workers improved  accuracies:  ['22.118%', '21.968%', '21.904%', '21.604%', '20.963%', '20.791%', '20.791%', '20.706%', '20.535%', '19.444%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 19:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2000%', '79.6000%', '79.6000%', '79.6000%', '79.6000%', '79.4000%', '79.4000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1004, 0.1004, 0.0996, 0.0996, 0.0996, 0.0996, 0.0999,
        0.0999])
Federated model performance: Loss: 0.575893. Accuracy: 75.8931%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['58.353%', '62.032%', '65.626%', '68.749%', '70.503%', '72.791%', '73.412%', '73.861%', '75.144%', '75.872%']
Workers federated accuracies:  ['75.422%', '75.316%', '75.551%', '75.529%', '75.594%', '75.594%', '75.743%', '75.957%', '76.214%', '76.171%']
Workers improved  accuracies:  ['22.203%', '21.989%', '21.904%', '21.626%', '21.005%', '20.877%', '20.856%', '20.813%', '20.663%', '19.636%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Epoch 20:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.6000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.0996])
Federated model performance: Loss: 0.568445. Accuracy: 75.8289%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['58.610%', '62.438%', '65.989%', '69.198%', '70.866%', '73.241%', '73.775%', '74.246%', '75.251%', '76.107%']
Workers federated accuracies:  ['75.380%', '75.273%', '75.572%', '75.572%', '75.508%', '75.701%', '75.743%', '75.979%', '76.278%', '76.214%']
Workers improved  accuracies:  ['22.160%', '21.947%', '21.925%', '21.668%', '20.920%', '20.984%', '20.856%', '20.834%', '20.727%', '19.679%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.568445. Accuracy: 75.8289%.
Workers before    accuracies:  ['53.219%', '53.326%', '53.647%', '53.904%', '54.588%', '54.717%', '54.888%', '55.144%', '55.551%', '56.535%']
Workers standlone accuracies:  ['58.610%', '62.438%', '65.989%', '69.198%', '70.866%', '73.241%', '73.775%', '74.246%', '75.251%', '76.107%']
Workers federated accuracies:  ['75.380%', '75.273%', '75.572%', '75.572%', '75.508%', '75.701%', '75.743%', '75.979%', '76.278%', '76.214%']
Workers improved  accuracies:  ['22.160%', '21.947%', '21.925%', '21.668%', '20.920%', '20.984%', '20.856%', '20.834%', '20.727%', '19.679%']
Workers shard sizes:  [64, 144, 240, 320, 416, 496, 592, 672, 768, 848]
Workers sharing_contributions :  tensor([ 6.4000, 14.4000, 24.0000, 32.0000, 41.6000, 49.6000, 59.2000, 67.2000,
        76.8000, 84.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.2547078508227143, 0.4775884887729464)
Correlation between stand alone test acc & collaborative final model acc:  (0.8296363617302491, 0.0029841579080700643)
Correlation between test_acc & sharing contributions:  (0.9397402196170759, 5.362065831470926e-05)
Correlation between test_acc improvements & sharing_contributions:  (-0.939668792938072, 5.3870617988515875e-05)
standalone_vs_final_corr [[0.9282582713728802], [0.7864534946651951], [0.8510047313440283], [0.9999999999999998], [0.8296363617302491]]
standalone_vs_final_corr_mean [0.8790705718224705]
standalone_vs_final_corr_std [0.07596408611543423]
sharingcontribution_vs_final_corr [[0.9522784060039297], [0.9265054276962329], [0.9852245788080761], [0.9620205539812889], [0.9397402196170759]]
sharingcontribution_vs_final_corr_mean [0.9531538372213207]
sharingcontribution_vs_final_corr_std [0.01998989934587978]
standalone_vs_federated_perturbed_corr [[-0.37896672666037323], [0.3171799371446584], [0.12212798485367873], [-0.43708176828228384], [0.2547078508227143]]
standalone_vs_federated_perturbed_corr_mean [-0.02440654442432113]
standalone_vs_federated_perturbed_corr_std [0.32002259342396444]
federated_final_performance [0.7709090709686279, 0.7689839601516724, 0.777326226234436, 0.7604278326034546, 0.7582887411117554]
federated_final_performance_mean 0.7671871662139893
federated_final_performance_std 0.006996458271352566
CFFL_best_worker [0.7694117426872253, 0.7698395848274231, 0.7691978812217712, 0.7638502717018127, 0.7627807259559631]
CFFL_best_worker_mean 0.7670160412788392
CFFL_best_worker_std 0.003047366136337471
standalone_best_worker [0.759786069393158, 0.7585026621818542, 0.7567914724349976, 0.7638502717018127, 0.7610695362091064]
standalone_best_worker_mean 0.7600000023841857
standalone_best_worker_std 0.0023895997933509766
