Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 5000, 'n_workers': 5, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.800244. Accuracy: 45.5187%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 58.4000%
Leave-one-out validation accuracies :  ['58.4000%', '59.0000%', '62.0000%', '66.0000%', '68.2000%']
Computed and normalized credits:  tensor([0.2201, 0.2171, 0.2025, 0.1847, 0.1757])
Federated model performance: Loss: 0.728683. Accuracy: 57.3904%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['42.802%', '45.647%', '49.348%', '52.877%', '54.160%']
Workers federated accuracies:  ['50.310%', '52.299%', '54.139%', '55.979%', '56.513%']
Workers improved  accuracies:  ['7.914%', '8.599%', '8.364%', '8.684%', '8.235%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 2:
Federated model validation accuracy : 65.0000%
Leave-one-out validation accuracies :  ['65.2000%', '66.0000%', '67.0000%', '69.2000%', '71.2000%']
Computed and normalized credits:  tensor([0.2166, 0.2122, 0.2036, 0.1891, 0.1785])
Federated model performance: Loss: 0.677733. Accuracy: 65.5187%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['43.102%', '47.401%', '52.770%', '56.749%', '58.353%']
Workers federated accuracies:  ['55.465%', '57.647%', '59.422%', '61.626%', '62.396%']
Workers improved  accuracies:  ['13.070%', '13.947%', '13.647%', '14.332%', '14.118%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 3:
Federated model validation accuracy : 69.0000%
Leave-one-out validation accuracies :  ['69.2000%', '69.4000%', '70.6000%', '71.8000%', '72.8000%']
Computed and normalized credits:  tensor([0.2110, 0.2089, 0.2016, 0.1927, 0.1858])
Federated model performance: Loss: 0.641987. Accuracy: 68.8984%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['43.337%', '49.283%', '55.658%', '60.064%', '61.775%']
Workers federated accuracies:  ['59.187%', '61.775%', '64.257%', '66.096%', '66.759%']
Workers improved  accuracies:  ['16.791%', '18.075%', '18.481%', '18.802%', '18.481%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 4:
Federated model validation accuracy : 70.8000%
Leave-one-out validation accuracies :  ['70.8000%', '72.0000%', '72.6000%', '72.6000%', '73.4000%']
Computed and normalized credits:  tensor([0.2089, 0.2037, 0.1992, 0.1966, 0.1916])
Federated model performance: Loss: 0.615611. Accuracy: 71.0802%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['43.679%', '51.658%', '57.904%', '62.952%', '64.385%']
Workers federated accuracies:  ['63.016%', '65.818%', '67.936%', '69.155%', '69.947%']
Workers improved  accuracies:  ['20.620%', '22.118%', '22.160%', '21.861%', '21.668%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 5:
Federated model validation accuracy : 72.6000%
Leave-one-out validation accuracies :  ['72.6000%', '72.6000%', '72.8000%', '74.0000%', '74.4000%']
Computed and normalized credits:  tensor([0.2051, 0.2036, 0.2015, 0.1964, 0.1934])
Federated model performance: Loss: 0.596261. Accuracy: 72.5775%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['44.128%', '53.455%', '59.850%', '64.791%', '67.037%']
Workers federated accuracies:  ['65.861%', '68.021%', '69.925%', '71.123%', '71.807%']
Workers improved  accuracies:  ['23.465%', '24.321%', '24.150%', '23.829%', '23.529%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 6:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.6000%', '73.8000%', '74.4000%', '74.8000%', '75.4000%']
Computed and normalized credits:  tensor([0.2044, 0.2032, 0.2004, 0.1975, 0.1944])
Federated model performance: Loss: 0.581356. Accuracy: 73.5829%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['44.599%', '55.080%', '61.904%', '67.123%', '69.070%']
Workers federated accuracies:  ['67.615%', '69.455%', '71.529%', '72.556%', '73.048%']
Workers improved  accuracies:  ['25.219%', '25.754%', '25.754%', '25.262%', '24.770%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 7:
Federated model validation accuracy : 74.6000%
Leave-one-out validation accuracies :  ['74.6000%', '74.8000%', '75.0000%', '75.4000%', '76.0000%']
Computed and normalized credits:  tensor([0.2033, 0.2022, 0.2007, 0.1984, 0.1954])
Federated model performance: Loss: 0.569323. Accuracy: 73.9893%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['44.898%', '56.342%', '63.807%', '68.813%', '70.781%']
Workers federated accuracies:  ['68.578%', '70.610%', '72.364%', '73.219%', '74.011%']
Workers improved  accuracies:  ['26.182%', '26.909%', '26.588%', '25.925%', '25.733%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 8:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '74.8000%', '75.4000%', '76.2000%', '76.8000%']
Computed and normalized credits:  tensor([0.2032, 0.2037, 0.2010, 0.1975, 0.1945])
Federated model performance: Loss: 0.559770. Accuracy: 74.6096%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['45.519%', '57.433%', '65.711%', '70.310%', '72.128%']
Workers federated accuracies:  ['69.497%', '71.551%', '73.241%', '73.947%', '74.781%']
Workers improved  accuracies:  ['27.102%', '27.850%', '27.465%', '26.652%', '26.503%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 9:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.2000%', '76.2000%', '76.6000%', '76.6000%', '76.8000%']
Computed and normalized credits:  tensor([0.2019, 0.2020, 0.1999, 0.1989, 0.1973])
Federated model performance: Loss: 0.551826. Accuracy: 75.1658%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['45.947%', '58.524%', '67.380%', '71.658%', '73.027%']
Workers federated accuracies:  ['70.182%', '72.471%', '73.861%', '74.567%', '75.401%']
Workers improved  accuracies:  ['27.786%', '28.770%', '28.086%', '27.273%', '27.123%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 10:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['77.0000%', '77.0000%', '76.6000%', '77.0000%', '77.0000%']
Computed and normalized credits:  tensor([0.2003, 0.2003, 0.2011, 0.1994, 0.1989])
Federated model performance: Loss: 0.544824. Accuracy: 75.6150%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['46.310%', '59.957%', '68.791%', '72.492%', '73.775%']
Workers federated accuracies:  ['71.080%', '72.941%', '74.267%', '75.230%', '75.401%']
Workers improved  accuracies:  ['28.684%', '29.241%', '28.492%', '27.936%', '27.123%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.544824. Accuracy: 75.6150%.
Workers before    accuracies:  ['42.396%', '43.701%', '45.775%', '47.294%', '48.278%']
Workers standlone accuracies:  ['46.310%', '59.957%', '68.791%', '72.492%', '73.775%']
Workers federated accuracies:  ['71.080%', '72.941%', '74.267%', '75.230%', '75.401%']
Workers improved  accuracies:  ['28.684%', '29.241%', '28.492%', '27.936%', '27.123%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]
Workers sharing_contributions :  tensor([ 22.4000, 102.4000, 182.4000, 262.4000, 339.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.19005555853663775, 0.7594785462482548)
Correlation between stand alone test acc & collaborative final model acc:  (0.9949025528731985, 0.0004365465945211267)
Correlation between test_acc & sharing contributions:  (0.9621234410797755, 0.00879846082070738)
Correlation between test_acc improvements & sharing_contributions:  (-0.8681847284650789, 0.0562993753686494)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.741906. Accuracy: 47.5508%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 63.0000%
Leave-one-out validation accuracies :  ['63.8000%', '66.0000%', '68.8000%', '71.6000%', '74.0000%']
Computed and normalized credits:  tensor([0.2220, 0.2118, 0.1995, 0.1879, 0.1787])
Federated model performance: Loss: 0.665287. Accuracy: 63.7647%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['45.412%', '47.765%', '51.273%', '53.947%', '58.781%']
Workers federated accuracies:  ['51.765%', '53.818%', '57.155%', '59.487%', '61.797%']
Workers improved  accuracies:  ['6.503%', '7.487%', '9.326%', '10.332%', '11.529%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 2:
Federated model validation accuracy : 72.2000%
Leave-one-out validation accuracies :  ['71.8000%', '72.2000%', '74.0000%', '74.6000%', '75.2000%']
Computed and normalized credits:  tensor([0.2131, 0.2085, 0.1982, 0.1926, 0.1877])
Federated model performance: Loss: 0.611818. Accuracy: 71.5508%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['45.733%', '49.540%', '56.214%', '61.048%', '65.947%']
Workers federated accuracies:  ['60.513%', '63.914%', '67.615%', '69.005%', '70.481%']
Workers improved  accuracies:  ['15.251%', '17.583%', '19.786%', '19.850%', '20.214%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 3:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.4000%', '74.8000%', '75.0000%', '75.2000%', '75.2000%']
Computed and normalized credits:  tensor([0.2057, 0.2029, 0.1992, 0.1968, 0.1954])
Federated model performance: Loss: 0.574695. Accuracy: 73.4973%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['46.011%', '51.422%', '61.797%', '66.824%', '70.567%']
Workers federated accuracies:  ['66.759%', '69.112%', '71.594%', '72.449%', '73.241%']
Workers improved  accuracies:  ['21.497%', '22.781%', '23.765%', '23.294%', '22.973%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 4:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['75.8000%', '75.6000%', '75.2000%', '75.4000%', '75.4000%']
Computed and normalized credits:  tensor([0.2005, 0.2004, 0.2007, 0.1994, 0.1990])
Federated model performance: Loss: 0.548105. Accuracy: 74.2460%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['46.374%', '53.604%', '66.631%', '70.481%', '73.091%']
Workers federated accuracies:  ['70.118%', '71.594%', '73.305%', '74.075%', '74.610%']
Workers improved  accuracies:  ['24.856%', '25.262%', '25.476%', '24.920%', '24.342%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 5:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '76.0000%', '75.6000%', '75.8000%']
Computed and normalized credits:  tensor([0.2001, 0.2001, 0.1995, 0.2005, 0.1997])
Federated model performance: Loss: 0.529042. Accuracy: 74.8235%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['46.759%', '55.807%', '69.626%', '72.235%', '74.011%']
Workers federated accuracies:  ['71.701%', '72.963%', '73.818%', '74.503%', '75.166%']
Workers improved  accuracies:  ['26.439%', '26.631%', '25.989%', '25.348%', '24.898%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 6:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '75.8000%', '76.4000%', '76.8000%']
Computed and normalized credits:  tensor([0.2012, 0.2012, 0.2010, 0.1992, 0.1975])
Federated model performance: Loss: 0.514595. Accuracy: 75.1658%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['47.187%', '58.460%', '71.508%', '73.262%', '74.396%']
Workers federated accuracies:  ['72.856%', '73.668%', '74.182%', '74.781%', '75.230%']
Workers improved  accuracies:  ['27.594%', '27.337%', '26.353%', '25.626%', '24.963%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 7:
Federated model validation accuracy : 76.2000%
Leave-one-out validation accuracies :  ['76.4000%', '76.4000%', '76.6000%', '77.8000%', '78.0000%']
Computed and normalized credits:  tensor([0.2026, 0.2026, 0.2018, 0.1971, 0.1959])
Federated model performance: Loss: 0.502955. Accuracy: 75.3369%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['47.529%', '61.112%', '72.385%', '73.711%', '75.166%']
Workers federated accuracies:  ['73.497%', '74.075%', '74.567%', '75.230%', '75.743%']
Workers improved  accuracies:  ['28.235%', '27.743%', '26.738%', '26.075%', '25.476%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 8:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['78.0000%', '77.8000%', '77.8000%', '77.6000%', '78.2000%']
Computed and normalized credits:  tensor([0.2003, 0.2010, 0.2008, 0.2001, 0.1977])
Federated model performance: Loss: 0.493801. Accuracy: 75.4866%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['47.872%', '63.230%', '73.027%', '74.481%', '75.294%']
Workers federated accuracies:  ['74.011%', '74.417%', '74.781%', '75.615%', '75.872%']
Workers improved  accuracies:  ['28.749%', '28.086%', '26.952%', '26.460%', '25.604%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 9:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.0000%', '78.4000%', '78.6000%']
Computed and normalized credits:  tensor([0.2008, 0.2010, 0.2009, 0.1993, 0.1980])
Federated model performance: Loss: 0.486595. Accuracy: 75.7219%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['48.364%', '65.283%', '73.155%', '74.824%', '75.679%']
Workers federated accuracies:  ['74.439%', '74.824%', '75.187%', '75.722%', '76.021%']
Workers improved  accuracies:  ['29.176%', '28.492%', '27.358%', '26.567%', '25.754%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 10:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4000%', '78.6000%', '78.8000%', '78.8000%']
Computed and normalized credits:  tensor([0.2009, 0.2010, 0.2003, 0.1991, 0.1987])
Federated model performance: Loss: 0.480423. Accuracy: 75.9358%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['48.535%', '66.909%', '73.583%', '75.102%', '76.086%']
Workers federated accuracies:  ['74.567%', '74.930%', '75.273%', '75.850%', '76.513%']
Workers improved  accuracies:  ['29.305%', '28.599%', '27.444%', '26.695%', '26.246%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.480423. Accuracy: 75.9358%.
Workers before    accuracies:  ['45.262%', '46.332%', '47.829%', '49.155%', '50.267%']
Workers standlone accuracies:  ['48.535%', '66.909%', '73.583%', '75.102%', '76.086%']
Workers federated accuracies:  ['74.567%', '74.930%', '75.273%', '75.850%', '76.513%']
Workers improved  accuracies:  ['29.305%', '28.599%', '27.444%', '26.695%', '26.246%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]
Workers sharing_contributions :  tensor([ 22.4000, 102.4000, 182.4000, 262.4000, 339.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.46564429738664415, 0.4293056008319503)
Correlation between stand alone test acc & collaborative final model acc:  (0.798350484307452, 0.10535048100356595)
Correlation between test_acc & sharing contributions:  (0.9876478495502113, 0.0016449072254773806)
Correlation between test_acc improvements & sharing_contributions:  (-0.9909958072126361, 0.0010242679763939409)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.725850. Accuracy: 56.3422%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 70.4000%
Leave-one-out validation accuracies :  ['70.2000%', '71.0000%', '72.4000%', '73.8000%', '75.8000%']
Computed and normalized credits:  tensor([0.2094, 0.2062, 0.2008, 0.1955, 0.1881])
Federated model performance: Loss: 0.664100. Accuracy: 67.7647%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['53.797%', '56.449%', '61.283%', '63.380%', '66.289%']
Workers federated accuracies:  ['61.540%', '63.316%', '65.647%', '66.396%', '67.636%']
Workers improved  accuracies:  ['8.278%', '8.813%', '8.749%', '8.449%', '7.636%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 2:
Federated model validation accuracy : 73.2000%
Leave-one-out validation accuracies :  ['73.4000%', '74.0000%', '74.6000%', '76.2000%', '77.4000%']
Computed and normalized credits:  tensor([0.2091, 0.2059, 0.2021, 0.1947, 0.1882])
Federated model performance: Loss: 0.618878. Accuracy: 71.6150%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['54.396%', '58.610%', '65.070%', '67.230%', '69.519%']
Workers federated accuracies:  ['66.674%', '68.064%', '69.305%', '70.246%', '71.187%']
Workers improved  accuracies:  ['13.412%', '13.561%', '12.406%', '12.299%', '11.187%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 3:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.6000%', '76.0000%', '76.6000%', '77.6000%', '78.2000%']
Computed and normalized credits:  tensor([0.2070, 0.2046, 0.2013, 0.1956, 0.1916])
Federated model performance: Loss: 0.586340. Accuracy: 73.1337%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['54.866%', '60.385%', '67.765%', '69.818%', '71.465%']
Workers federated accuracies:  ['69.005%', '70.139%', '71.786%', '72.235%', '73.048%']
Workers improved  accuracies:  ['15.743%', '15.636%', '14.888%', '14.289%', '13.048%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 4:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['77.2000%', '77.2000%', '77.8000%', '78.2000%', '79.2000%']
Computed and normalized credits:  tensor([0.2045, 0.2038, 0.2008, 0.1977, 0.1931])
Federated model performance: Loss: 0.562432. Accuracy: 74.1176%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['55.166%', '62.118%', '69.433%', '71.294%', '72.599%']
Workers federated accuracies:  ['70.396%', '71.743%', '72.813%', '73.091%', '73.754%']
Workers improved  accuracies:  ['17.134%', '17.241%', '15.914%', '15.144%', '13.754%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 5:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '79.0000%', '79.0000%', '79.2000%', '79.8000%']
Computed and normalized credits:  tensor([0.2036, 0.2014, 0.2005, 0.1989, 0.1955])
Federated model performance: Loss: 0.544073. Accuracy: 74.7594%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['55.701%', '63.957%', '70.503%', '72.043%', '73.540%']
Workers federated accuracies:  ['71.765%', '72.556%', '73.775%', '74.118%', '74.674%']
Workers improved  accuracies:  ['18.503%', '18.053%', '16.877%', '16.171%', '14.674%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 6:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.8000%', '80.0000%']
Computed and normalized credits:  tensor([0.2020, 0.2013, 0.2011, 0.1986, 0.1970])
Federated model performance: Loss: 0.529501. Accuracy: 75.1872%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['56.064%', '65.583%', '71.294%', '72.749%', '74.139%']
Workers federated accuracies:  ['72.471%', '73.326%', '74.225%', '74.652%', '75.209%']
Workers improved  accuracies:  ['19.209%', '18.824%', '17.326%', '16.706%', '15.209%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 7:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.6000%', '79.8000%', '79.6000%', '79.8000%', '80.4000%']
Computed and normalized credits:  tensor([0.2014, 0.2005, 0.2011, 0.1997, 0.1972])
Federated model performance: Loss: 0.518234. Accuracy: 75.5080%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['56.364%', '67.080%', '71.957%', '73.348%', '74.674%']
Workers federated accuracies:  ['73.005%', '73.754%', '74.631%', '75.166%', '75.551%']
Workers improved  accuracies:  ['19.743%', '19.251%', '17.733%', '17.219%', '15.551%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 8:
Federated model validation accuracy : 80.2000%
Leave-one-out validation accuracies :  ['80.4000%', '80.4000%', '80.4000%', '80.6000%', '81.0000%']
Computed and normalized credits:  tensor([0.2009, 0.2007, 0.2009, 0.1998, 0.1977])
Federated model performance: Loss: 0.508958. Accuracy: 75.7647%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['56.856%', '68.150%', '72.749%', '73.775%', '74.995%']
Workers federated accuracies:  ['73.668%', '74.160%', '75.273%', '75.273%', '75.807%']
Workers improved  accuracies:  ['20.406%', '19.658%', '18.374%', '17.326%', '15.807%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 9:
Federated model validation accuracy : 80.8000%
Leave-one-out validation accuracies :  ['80.8000%', '80.8000%', '81.0000%', '80.6000%', '81.0000%']
Computed and normalized credits:  tensor([0.2004, 0.2003, 0.1997, 0.2007, 0.1988])
Federated model performance: Loss: 0.501382. Accuracy: 76.0000%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['57.497%', '68.898%', '73.134%', '74.225%', '75.358%']
Workers federated accuracies:  ['74.053%', '74.524%', '75.444%', '75.658%', '76.128%']
Workers improved  accuracies:  ['20.791%', '20.021%', '18.545%', '17.711%', '16.128%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 10:
Federated model validation accuracy : 80.8000%
Leave-one-out validation accuracies :  ['80.8000%', '80.8000%', '81.0000%', '81.2000%', '81.4000%']
Computed and normalized credits:  tensor([0.2009, 0.2009, 0.2000, 0.1997, 0.1985])
Federated model performance: Loss: 0.494585. Accuracy: 76.2781%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['57.947%', '69.219%', '73.561%', '74.738%', '75.786%']
Workers federated accuracies:  ['74.246%', '74.738%', '75.679%', '75.979%', '76.321%']
Workers improved  accuracies:  ['20.984%', '20.235%', '18.781%', '18.032%', '16.321%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.494585. Accuracy: 76.2781%.
Workers before    accuracies:  ['53.262%', '54.503%', '56.898%', '57.947%', '60.000%']
Workers standlone accuracies:  ['57.947%', '69.219%', '73.561%', '74.738%', '75.786%']
Workers federated accuracies:  ['74.246%', '74.738%', '75.679%', '75.979%', '76.321%']
Workers improved  accuracies:  ['20.984%', '20.235%', '18.781%', '18.032%', '16.321%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]
Workers sharing_contributions :  tensor([ 22.4000, 102.4000, 182.4000, 262.4000, 339.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.7198977738688153, 0.17027960494178082)
Correlation between stand alone test acc & collaborative final model acc:  (0.922377944367512, 0.025656019001670236)
Correlation between test_acc & sharing contributions:  (0.9802538365007454, 0.003320988798300602)
Correlation between test_acc improvements & sharing_contributions:  (-0.9899117283793493, 0.0012145089618206184)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.707312. Accuracy: 53.5829%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 62.4000%
Leave-one-out validation accuracies :  ['62.6000%', '65.6000%', '68.8000%', '72.2000%', '75.4000%']
Computed and normalized credits:  tensor([0.2280, 0.2137, 0.1994, 0.1854, 0.1734])
Federated model performance: Loss: 0.645703. Accuracy: 63.7647%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['51.743%', '53.840%', '56.856%', '58.866%', '61.198%']
Workers federated accuracies:  ['56.706%', '58.118%', '60.235%', '61.797%', '63.508%']
Workers improved  accuracies:  ['5.198%', '5.647%', '6.460%', '7.380%', '7.829%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 2:
Federated model validation accuracy : 71.6000%
Leave-one-out validation accuracies :  ['71.4000%', '72.4000%', '73.6000%', '75.2000%', '75.8000%']
Computed and normalized credits:  tensor([0.2170, 0.2089, 0.2000, 0.1899, 0.1842])
Federated model performance: Loss: 0.601218. Accuracy: 70.3957%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['52.086%', '55.187%', '59.850%', '62.845%', '66.738%']
Workers federated accuracies:  ['61.818%', '64.257%', '66.802%', '68.171%', '69.390%']
Workers improved  accuracies:  ['10.310%', '11.786%', '13.027%', '13.754%', '13.711%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 3:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.2000%', '75.6000%', '75.0000%', '76.0000%', '76.0000%']
Computed and normalized credits:  tensor([0.2062, 0.2024, 0.2020, 0.1955, 0.1939])
Federated model performance: Loss: 0.570500. Accuracy: 73.4759%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['52.385%', '56.877%', '63.701%', '66.973%', '69.754%']
Workers federated accuracies:  ['65.604%', '67.765%', '70.332%', '71.893%', '73.198%']
Workers improved  accuracies:  ['14.096%', '15.294%', '16.556%', '17.476%', '17.519%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 4:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.4000%', '75.6000%', '75.0000%', '76.0000%', '76.0000%']
Computed and normalized credits:  tensor([0.2025, 0.2007, 0.2027, 0.1973, 0.1968])
Federated model performance: Loss: 0.548448. Accuracy: 74.4385%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['52.663%', '58.481%', '66.460%', '69.412%', '72.599%']
Workers federated accuracies:  ['68.278%', '70.267%', '73.198%', '73.925%', '74.824%']
Workers improved  accuracies:  ['16.770%', '17.797%', '19.422%', '19.508%', '19.144%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 5:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6000%', '75.8000%', '76.2000%', '76.6000%', '77.0000%']
Computed and normalized credits:  tensor([0.2030, 0.2018, 0.2009, 0.1979, 0.1964])
Federated model performance: Loss: 0.532332. Accuracy: 74.8663%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['53.091%', '60.257%', '68.364%', '71.615%', '74.225%']
Workers federated accuracies:  ['70.246%', '72.086%', '74.139%', '74.973%', '75.572%']
Workers improved  accuracies:  ['18.738%', '19.615%', '20.364%', '20.556%', '19.893%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 6:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.8000%', '77.2000%', '77.6000%']
Computed and normalized credits:  tensor([0.2021, 0.2018, 0.2008, 0.1986, 0.1967])
Federated model performance: Loss: 0.520308. Accuracy: 75.2513%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['53.497%', '61.476%', '70.289%', '73.390%', '74.973%']
Workers federated accuracies:  ['71.358%', '73.283%', '74.631%', '75.316%', '75.872%']
Workers improved  accuracies:  ['19.850%', '20.813%', '20.856%', '20.898%', '20.193%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 7:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.0000%', '77.2000%', '77.4000%', '77.4000%', '77.8000%']
Computed and normalized credits:  tensor([0.2019, 0.2011, 0.2001, 0.1994, 0.1975])
Federated model performance: Loss: 0.510607. Accuracy: 75.4866%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['53.797%', '62.930%', '72.086%', '74.374%', '75.636%']
Workers federated accuracies:  ['72.513%', '74.139%', '75.016%', '75.572%', '76.128%']
Workers improved  accuracies:  ['21.005%', '21.668%', '21.241%', '21.155%', '20.449%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 8:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '78.4000%', '79.0000%']
Computed and normalized credits:  tensor([0.2021, 0.2018, 0.2015, 0.1986, 0.1960])
Federated model performance: Loss: 0.502552. Accuracy: 75.7861%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['54.032%', '64.021%', '73.198%', '75.016%', '76.214%']
Workers federated accuracies:  ['73.348%', '74.909%', '75.358%', '75.807%', '76.492%']
Workers improved  accuracies:  ['21.840%', '22.439%', '21.583%', '21.390%', '20.813%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 9:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4000%', '78.8000%', '79.2000%', '79.4000%']
Computed and normalized credits:  tensor([0.2021, 0.2020, 0.2006, 0.1984, 0.1969])
Federated model performance: Loss: 0.495579. Accuracy: 76.0642%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['54.374%', '65.433%', '74.225%', '75.401%', '76.599%']
Workers federated accuracies:  ['73.968%', '75.337%', '75.594%', '76.257%', '76.706%']
Workers improved  accuracies:  ['22.460%', '22.866%', '21.818%', '21.840%', '21.027%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 10:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.6000%', '80.0000%']
Computed and normalized credits:  tensor([0.2014, 0.2014, 0.2010, 0.1990, 0.1972])
Federated model performance: Loss: 0.489663. Accuracy: 76.2781%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['54.845%', '66.781%', '74.503%', '75.743%', '76.706%']
Workers federated accuracies:  ['74.567%', '75.572%', '75.807%', '76.385%', '76.813%']
Workers improved  accuracies:  ['23.059%', '23.102%', '22.032%', '21.968%', '21.134%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.489663. Accuracy: 76.2781%.
Workers before    accuracies:  ['51.508%', '52.471%', '53.775%', '54.417%', '55.679%']
Workers standlone accuracies:  ['54.845%', '66.781%', '74.503%', '75.743%', '76.706%']
Workers federated accuracies:  ['74.567%', '75.572%', '75.807%', '76.385%', '76.813%']
Workers improved  accuracies:  ['23.059%', '23.102%', '22.032%', '21.968%', '21.134%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]
Workers sharing_contributions :  tensor([ 22.4000, 102.4000, 182.4000, 262.4000, 339.2000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.5319870190762803, 0.35611842151913436)
Correlation between stand alone test acc & collaborative final model acc:  (0.9412737705666103, 0.016932416375763266)
Correlation between test_acc & sharing contributions:  (0.9794716442543802, 0.003519842823102661)
Correlation between test_acc improvements & sharing_contributions:  (-0.9489987912022181, 0.013719995125688517)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.760042. Accuracy: 44.4064%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 59.0000%
Leave-one-out validation accuracies :  ['59.8000%', '61.8000%', '66.0000%', '68.6000%', '71.6000%']
Computed and normalized credits:  tensor([0.2269, 0.2167, 0.1969, 0.1857, 0.1738])
Federated model performance: Loss: 0.672512. Accuracy: 59.0374%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['42.096%', '44.492%', '49.326%', '51.701%', '55.059%']
Workers federated accuracies:  ['50.267%', '52.107%', '54.503%', '55.957%', '58.011%']
Workers improved  accuracies:  ['8.684%', '9.241%', '9.647%', '10.075%', '10.396%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 2:
Federated model validation accuracy : 67.4000%
Leave-one-out validation accuracies :  ['67.6000%', '69.0000%', '70.4000%', '72.2000%', '74.2000%']
Computed and normalized credits:  tensor([0.2207, 0.2117, 0.2000, 0.1894, 0.1782])
Federated model performance: Loss: 0.612430. Accuracy: 67.9572%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['42.289%', '46.503%', '53.241%', '56.278%', '61.476%']
Workers federated accuracies:  ['56.406%', '59.444%', '63.016%', '64.920%', '66.439%']
Workers improved  accuracies:  ['14.824%', '16.578%', '18.160%', '19.037%', '18.824%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 3:
Federated model validation accuracy : 71.4000%
Leave-one-out validation accuracies :  ['71.4000%', '72.4000%', '72.8000%', '74.0000%', '74.6000%']
Computed and normalized credits:  tensor([0.2123, 0.2058, 0.2009, 0.1933, 0.1877])
Federated model performance: Loss: 0.570917. Accuracy: 71.6791%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['42.631%', '48.599%', '57.027%', '61.476%', '66.225%']
Workers federated accuracies:  ['62.096%', '64.749%', '67.551%', '69.027%', '70.353%']
Workers improved  accuracies:  ['20.513%', '21.882%', '22.695%', '23.144%', '22.738%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 4:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2000%', '74.0000%', '74.8000%', '75.4000%']
Computed and normalized credits:  tensor([0.2047, 0.2028, 0.2021, 0.1970, 0.1933])
Federated model performance: Loss: 0.541490. Accuracy: 72.9840%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['42.973%', '50.738%', '61.048%', '65.497%', '68.941%']
Workers federated accuracies:  ['65.818%', '68.021%', '70.439%', '71.487%', '72.342%']
Workers improved  accuracies:  ['24.235%', '25.155%', '25.583%', '25.604%', '24.727%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 5:
Federated model validation accuracy : 74.8000%
Leave-one-out validation accuracies :  ['74.8000%', '75.0000%', '75.2000%', '75.4000%', '77.2000%']
Computed and normalized credits:  tensor([0.2039, 0.2027, 0.2017, 0.1996, 0.1921])
Federated model performance: Loss: 0.520096. Accuracy: 74.3102%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['43.508%', '52.706%', '64.513%', '68.278%', '70.695%']
Workers federated accuracies:  ['68.278%', '69.968%', '71.829%', '73.390%', '74.011%']
Workers improved  accuracies:  ['26.695%', '27.102%', '26.973%', '27.508%', '26.396%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 6:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.6000%', '75.4000%', '76.8000%', '77.6000%', '77.8000%']
Computed and normalized credits:  tensor([0.2049, 0.2052, 0.1999, 0.1964, 0.1936])
Federated model performance: Loss: 0.504259. Accuracy: 74.9519%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['44.086%', '54.545%', '66.845%', '70.203%', '72.107%']
Workers federated accuracies:  ['69.626%', '71.679%', '73.219%', '74.888%', '75.422%']
Workers improved  accuracies:  ['28.043%', '28.813%', '28.364%', '29.005%', '27.807%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 7:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.2000%', '77.4000%', '77.6000%', '78.0000%', '78.0000%']
Computed and normalized credits:  tensor([0.2029, 0.2023, 0.2001, 0.1977, 0.1969])
Federated model performance: Loss: 0.492269. Accuracy: 75.8289%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['44.599%', '56.043%', '68.342%', '71.358%', '73.476%']
Workers federated accuracies:  ['70.909%', '72.642%', '73.882%', '75.337%', '75.914%']
Workers improved  accuracies:  ['29.326%', '29.775%', '29.027%', '29.455%', '28.299%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 8:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['77.8000%', '77.6000%', '78.0000%', '78.2000%', '78.4000%']
Computed and normalized credits:  tensor([0.2015, 0.2020, 0.2000, 0.1987, 0.1977])
Federated model performance: Loss: 0.482787. Accuracy: 76.2567%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['45.027%', '57.861%', '69.604%', '72.599%', '74.267%']
Workers federated accuracies:  ['71.850%', '73.647%', '75.059%', '75.807%', '75.979%']
Workers improved  accuracies:  ['30.267%', '30.781%', '30.203%', '29.925%', '28.364%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 9:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0000%', '78.4000%', '78.6000%', '78.8000%']
Computed and normalized credits:  tensor([0.2017, 0.2018, 0.1999, 0.1988, 0.1978])
Federated model performance: Loss: 0.475255. Accuracy: 76.4492%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['45.433%', '59.893%', '70.417%', '73.733%', '74.845%']
Workers federated accuracies:  ['72.406%', '74.396%', '75.615%', '76.043%', '76.257%']
Workers improved  accuracies:  ['30.824%', '31.529%', '30.759%', '30.160%', '28.642%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Epoch 10:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.8000%', '78.8000%', '78.8000%', '79.4000%']
Computed and normalized credits:  tensor([0.2014, 0.2008, 0.2002, 0.1999, 0.1976])
Federated model performance: Loss: 0.469099. Accuracy: 76.5134%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']
Workers standlone accuracies:  ['45.968%', '61.112%', '71.251%', '74.503%', '75.465%']
Workers federated accuracies:  ['73.048%', '74.781%', '75.872%', '76.171%', '76.556%']
Workers improved  accuracies:  ['31.465%', '31.914%', '31.016%', '30.289%', '28.941%']
Workers shard sizes:  [112, 512, 912, 1312, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.469099. Accuracy: 76.5134%.
Workers before    accuracies:  ['41.583%', '42.866%', '44.856%', '45.882%', '47.615%']