Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 15000, 'n_workers': 10, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 20, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.776162. Accuracy: 46.8021%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 73.4667%
Leave-one-out validation accuracies :  ['73.8000%', '74.4000%', '74.9333%', '75.2667%', '75.1333%', '74.8667%', '75.2000%', '75.7333%', '76.0000%', '75.8667%']
Computed and normalized credits:  tensor([0.1029, 0.1016, 0.1004, 0.0997, 0.1000, 0.1005, 0.0998, 0.0987, 0.0981,
        0.0984])
Federated model performance: Loss: 0.595952. Accuracy: 72.4706%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['42.417%', '44.684%', '46.995%', '49.070%', '51.807%', '54.759%', '57.369%', '58.610%', '62.160%', '63.273%']
Workers federated accuracies:  ['42.417%', '44.684%', '46.995%', '49.070%', '51.807%', '54.759%', '57.369%', '58.610%', '62.160%', '63.273%']
Workers improved  accuracies:  ['0.749%', '1.818%', '3.080%', '3.786%', '5.540%', '6.824%', '8.086%', '8.706%', '10.845%', '11.102%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 2:
Federated model validation accuracy : 75.6667%
Leave-one-out validation accuracies :  ['75.6667%', '75.8000%', '76.0000%', '75.9333%', '76.1333%', '76.0667%', '75.8667%', '76.1333%', '76.1333%', '76.0000%']
Computed and normalized credits:  tensor([0.1011, 0.1006, 0.1000, 0.1000, 0.0997, 0.0999, 0.1002, 0.0994, 0.0994,
        0.0997])
Federated model performance: Loss: 0.524626. Accuracy: 75.0160%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['43.037%', '46.588%', '50.417%', '53.561%', '57.668%', '61.455%', '64.898%', '66.695%', '68.941%', '70.075%']
Workers federated accuracies:  ['43.037%', '46.588%', '50.417%', '53.561%', '57.668%', '61.455%', '64.898%', '66.695%', '68.941%', '70.075%']
Workers improved  accuracies:  ['1.369%', '3.722%', '6.503%', '8.278%', '11.401%', '13.519%', '15.615%', '16.791%', '17.626%', '17.904%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 3:
Federated model validation accuracy : 76.2667%
Leave-one-out validation accuracies :  ['76.2667%', '76.2667%', '76.2667%', '76.2667%', '76.2667%', '76.2000%', '76.1333%', '76.2000%', '76.2667%', '76.3333%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.1001, 0.1003, 0.1000, 0.0999,
        0.0998])
Federated model performance: Loss: 0.508323. Accuracy: 75.8289%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['43.551%', '48.770%', '53.519%', '58.203%', '62.824%', '66.909%', '69.241%', '70.759%', '72.107%', '72.834%']
Workers federated accuracies:  ['73.775%', '74.118%', '74.652%', '74.845%', '75.187%', '75.187%', '75.337%', '75.572%', '75.551%', '75.957%']
Workers improved  accuracies:  ['32.107%', '31.251%', '30.738%', '29.561%', '28.920%', '27.251%', '26.053%', '25.668%', '24.235%', '23.786%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 4:
Federated model validation accuracy : 77.1333%
Leave-one-out validation accuracies :  ['77.1333%', '77.1333%', '77.2000%', '77.3333%', '77.6667%', '77.9333%', '78.0667%', '78.2667%', '78.2667%', '78.5333%']
Computed and normalized credits:  tensor([0.1013, 0.1013, 0.1011, 0.1008, 0.1002, 0.0996, 0.0994, 0.0990, 0.0989,
        0.0984])
Federated model performance: Loss: 0.491275. Accuracy: 76.5562%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['44.471%', '50.845%', '56.620%', '62.182%', '66.674%', '69.904%', '71.829%', '72.642%', '73.497%', '74.118%']
Workers federated accuracies:  ['74.225%', '74.802%', '75.166%', '75.337%', '75.444%', '75.722%', '75.979%', '76.107%', '76.086%', '76.257%']
Workers improved  accuracies:  ['32.556%', '31.936%', '31.251%', '30.053%', '29.176%', '27.786%', '26.695%', '26.203%', '24.770%', '24.086%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 5:
Federated model validation accuracy : 78.1333%
Leave-one-out validation accuracies :  ['78.1333%', '78.1333%', '78.2000%', '78.3333%', '78.2667%', '78.3333%', '78.5333%', '78.5333%', '78.8000%', '78.8667%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1006, 0.1003, 0.1003, 0.1001, 0.0997, 0.0996, 0.0990,
        0.0988])
Federated model performance: Loss: 0.479434. Accuracy: 77.1337%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['45.369%', '52.556%', '59.936%', '65.497%', '69.390%', '71.957%', '72.920%', '74.032%', '74.203%', '75.144%']
Workers federated accuracies:  ['74.845%', '75.166%', '75.743%', '75.551%', '75.829%', '76.086%', '76.385%', '76.449%', '76.235%', '76.663%']
Workers improved  accuracies:  ['33.176%', '32.299%', '31.829%', '30.267%', '29.561%', '28.150%', '27.102%', '26.545%', '24.920%', '24.492%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 6:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4000%', '78.6000%', '78.5333%', '78.8000%', '78.7333%', '78.6667%', '78.8667%', '79.0000%', '78.8667%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1003, 0.1004, 0.0998, 0.0999, 0.1000, 0.0996, 0.0992,
        0.0994])
Federated model performance: Loss: 0.470850. Accuracy: 77.5829%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['46.139%', '54.567%', '62.909%', '67.615%', '71.166%', '73.005%', '74.118%', '75.037%', '74.930%', '75.743%']
Workers federated accuracies:  ['75.123%', '75.615%', '76.257%', '76.193%', '76.342%', '76.406%', '76.791%', '76.898%', '76.834%', '77.219%']
Workers improved  accuracies:  ['33.455%', '32.749%', '32.342%', '30.909%', '30.075%', '28.471%', '27.508%', '26.995%', '25.519%', '25.048%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 7:
Federated model validation accuracy : 78.8667%
Leave-one-out validation accuracies :  ['78.8667%', '78.8667%', '79.0000%', '79.2000%', '79.0000%', '78.9333%', '78.7333%', '78.8667%', '79.0000%', '79.0667%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1000, 0.0996, 0.0999, 0.1000, 0.1004, 0.1001, 0.0998,
        0.0997])
Federated model performance: Loss: 0.465137. Accuracy: 78.1176%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['46.717%', '56.278%', '65.989%', '69.711%', '72.321%', '73.840%', '74.824%', '75.529%', '75.529%', '76.193%']
Workers federated accuracies:  ['75.572%', '76.000%', '76.684%', '76.663%', '76.834%', '76.813%', '77.198%', '77.262%', '77.176%', '77.561%']
Workers improved  accuracies:  ['33.904%', '33.134%', '32.770%', '31.380%', '30.567%', '28.877%', '27.914%', '27.358%', '25.861%', '25.390%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 8:
Federated model validation accuracy : 78.8667%
Leave-one-out validation accuracies :  ['79.0000%', '78.9333%', '78.9333%', '78.9333%', '79.0667%', '79.0667%', '79.0667%', '79.0667%', '79.2000%', '79.2667%']
Computed and normalized credits:  tensor([0.1002, 0.1003, 0.1002, 0.1002, 0.1000, 0.1000, 0.1000, 0.1000, 0.0997,
        0.0995])
Federated model performance: Loss: 0.461187. Accuracy: 78.5027%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['47.572%', '58.545%', '68.021%', '71.102%', '73.198%', '74.503%', '75.037%', '75.722%', '75.743%', '76.385%']
Workers federated accuracies:  ['75.957%', '76.428%', '77.027%', '76.877%', '77.112%', '77.134%', '77.433%', '77.583%', '77.583%', '77.840%']
Workers improved  accuracies:  ['34.289%', '33.561%', '33.112%', '31.594%', '30.845%', '29.198%', '28.150%', '27.679%', '26.267%', '25.668%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 9:
Federated model validation accuracy : 79.1333%
Leave-one-out validation accuracies :  ['79.1333%', '79.1333%', '79.2000%', '79.2667%', '79.2000%', '79.2000%', '79.1333%', '79.2000%', '79.2000%', '79.4667%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1001, 0.0999, 0.1000, 0.1000, 0.1002, 0.1000, 0.1000,
        0.0994])
Federated model performance: Loss: 0.458650. Accuracy: 78.8663%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['48.492%', '60.278%', '69.262%', '71.936%', '73.733%', '74.845%', '75.230%', '76.064%', '75.914%', '76.620%']
Workers federated accuracies:  ['76.214%', '76.684%', '77.176%', '77.134%', '77.348%', '77.305%', '77.519%', '77.861%', '77.754%', '78.160%']
Workers improved  accuracies:  ['34.545%', '33.818%', '33.262%', '31.850%', '31.080%', '29.369%', '28.235%', '27.957%', '26.438%', '25.989%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 10:
Federated model validation accuracy : 79.3333%
Leave-one-out validation accuracies :  ['79.3333%', '79.2667%', '79.2667%', '79.4000%', '79.3333%', '79.2667%', '79.5333%', '79.5333%', '79.6000%', '79.3333%']
Computed and normalized credits:  tensor([0.1001, 0.1003, 0.1002, 0.1000, 0.1001, 0.1002, 0.0997, 0.0997, 0.0996,
        0.1000])
Federated model performance: Loss: 0.457054. Accuracy: 79.1444%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['49.155%', '61.882%', '70.118%', '72.770%', '74.289%', '75.059%', '75.401%', '76.299%', '76.021%', '76.856%']
Workers federated accuracies:  ['76.299%', '76.684%', '77.412%', '77.262%', '77.455%', '77.390%', '77.690%', '78.246%', '77.818%', '78.332%']
Workers improved  accuracies:  ['34.631%', '33.818%', '33.497%', '31.979%', '31.187%', '29.455%', '28.406%', '28.342%', '26.503%', '26.160%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 11:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4000%', '79.4667%', '79.4000%', '79.4667%', '79.4667%', '79.1333%', '79.1333%', '79.0667%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.0999, 0.0997, 0.0999, 0.0998, 0.0997, 0.1003, 0.1003,
        0.1005])
Federated model performance: Loss: 0.456406. Accuracy: 79.2727%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['49.540%', '63.722%', '71.209%', '73.305%', '74.610%', '75.273%', '75.679%', '76.449%', '76.278%', '77.070%']
Workers federated accuracies:  ['76.535%', '76.984%', '77.647%', '77.519%', '77.647%', '77.476%', '77.797%', '78.310%', '78.118%', '78.631%']
Workers improved  accuracies:  ['34.866%', '34.118%', '33.733%', '32.235%', '31.380%', '29.540%', '28.513%', '28.406%', '26.802%', '26.460%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 12:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.3333%', '79.0667%', '79.1333%', '79.2667%', '79.1333%', '79.4000%', '79.3333%', '79.3333%']
Computed and normalized credits:  tensor([0.0997, 0.0997, 0.0999, 0.1004, 0.1003, 0.1000, 0.1002, 0.0998, 0.0999,
        0.1000])
Federated model performance: Loss: 0.456395. Accuracy: 79.6150%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['50.524%', '65.476%', '71.893%', '73.626%', '74.866%', '75.529%', '75.936%', '76.578%', '76.321%', '77.262%']
Workers federated accuracies:  ['76.727%', '77.283%', '77.797%', '77.711%', '77.733%', '77.818%', '78.011%', '78.567%', '78.267%', '78.824%']
Workers improved  accuracies:  ['35.059%', '34.417%', '33.882%', '32.428%', '31.465%', '29.882%', '28.727%', '28.663%', '26.952%', '26.652%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 13:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.2667%', '79.5333%', '79.3333%', '79.3333%', '79.6000%', '79.6000%', '79.6000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1003, 0.0998, 0.1001, 0.1001, 0.0995, 0.0996,
        0.0996])
Federated model performance: Loss: 0.456863. Accuracy: 79.9144%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['51.337%', '66.930%', '72.770%', '74.053%', '74.973%', '75.701%', '76.043%', '76.727%', '76.492%', '77.390%']
Workers federated accuracies:  ['76.856%', '77.390%', '77.989%', '77.818%', '77.818%', '77.861%', '78.289%', '78.738%', '78.503%', '79.016%']
Workers improved  accuracies:  ['35.187%', '34.524%', '34.075%', '32.535%', '31.551%', '29.925%', '29.005%', '28.834%', '27.187%', '26.845%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 14:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.5333%', '79.4667%', '79.4667%', '79.5333%', '79.5333%', '79.6667%', '79.7333%', '79.8667%', '79.8667%', '79.9333%']
Computed and normalized credits:  tensor([0.1003, 0.1004, 0.1004, 0.1003, 0.1002, 0.1000, 0.0999, 0.0995, 0.0995,
        0.0994])
Federated model performance: Loss: 0.457637. Accuracy: 80.0000%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['51.743%', '68.107%', '73.348%', '74.374%', '75.102%', '75.807%', '76.150%', '76.941%', '76.663%', '77.561%']
Workers federated accuracies:  ['77.027%', '77.476%', '78.118%', '77.925%', '77.989%', '78.032%', '78.503%', '78.845%', '78.674%', '79.037%']
Workers improved  accuracies:  ['35.358%', '34.610%', '34.203%', '32.642%', '31.722%', '30.096%', '29.219%', '28.941%', '27.358%', '26.866%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 15:
Federated model validation accuracy : 79.7333%
Leave-one-out validation accuracies :  ['79.7333%', '79.7333%', '79.8000%', '79.8000%', '79.8667%', '79.9333%', '80.0000%', '80.0667%', '80.0000%', '79.9333%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1002, 0.1002, 0.1001, 0.0999, 0.0998, 0.0996, 0.0997,
        0.0998])
Federated model performance: Loss: 0.458814. Accuracy: 80.3422%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['52.449%', '69.155%', '73.797%', '74.631%', '75.358%', '75.765%', '76.193%', '77.112%', '76.706%', '77.711%']
Workers federated accuracies:  ['77.070%', '77.647%', '78.246%', '78.032%', '78.118%', '78.053%', '78.545%', '78.909%', '78.781%', '79.209%']
Workers improved  accuracies:  ['35.401%', '34.781%', '34.332%', '32.749%', '31.850%', '30.118%', '29.262%', '29.005%', '27.465%', '27.037%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 16:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.0667%', '80.0667%', '80.0667%', '80.1333%', '80.0667%', '80.0667%', '80.1333%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1000, 0.1000, 0.1000, 0.0998, 0.0999, 0.0999,
        0.0998])
Federated model performance: Loss: 0.460142. Accuracy: 80.3209%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['53.348%', '69.840%', '73.861%', '74.824%', '75.551%', '75.914%', '76.278%', '77.134%', '76.877%', '77.882%']
Workers federated accuracies:  ['77.176%', '77.818%', '78.332%', '78.182%', '78.160%', '78.139%', '78.588%', '79.144%', '78.909%', '79.273%']
Workers improved  accuracies:  ['35.508%', '34.952%', '34.417%', '32.898%', '31.893%', '30.203%', '29.305%', '29.241%', '27.594%', '27.102%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 17:
Federated model validation accuracy : 79.9333%
Leave-one-out validation accuracies :  ['79.9333%', '79.9333%', '79.9333%', '80.0667%', '80.1333%', '80.1333%', '80.0667%', '80.2000%', '80.1333%', '80.1333%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1000, 0.0999, 0.0999, 0.1000, 0.0997, 0.0999,
        0.0998])
Federated model performance: Loss: 0.461668. Accuracy: 80.4278%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['53.989%', '70.610%', '74.417%', '75.037%', '75.765%', '76.000%', '76.428%', '77.241%', '77.112%', '78.118%']
Workers federated accuracies:  ['77.283%', '77.968%', '78.503%', '78.246%', '78.310%', '78.289%', '78.588%', '79.123%', '78.930%', '79.337%']
Workers improved  accuracies:  ['35.615%', '35.102%', '34.588%', '32.963%', '32.043%', '30.353%', '29.305%', '29.219%', '27.615%', '27.166%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 18:
Federated model validation accuracy : 80.0667%
Leave-one-out validation accuracies :  ['80.0667%', '80.0667%', '80.0667%', '80.1333%', '80.0667%', '80.0667%', '80.0000%', '80.0000%', '80.0667%', '80.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.0998, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000,
        0.1001])
Federated model performance: Loss: 0.463234. Accuracy: 80.4278%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['54.674%', '70.888%', '74.824%', '75.230%', '75.872%', '76.128%', '76.535%', '77.348%', '77.155%', '78.182%']
Workers federated accuracies:  ['77.305%', '78.075%', '78.759%', '78.374%', '78.396%', '78.460%', '78.567%', '79.102%', '78.909%', '79.529%']
Workers improved  accuracies:  ['35.636%', '35.209%', '34.845%', '33.091%', '32.128%', '30.524%', '29.283%', '29.198%', '27.594%', '27.358%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 19:
Federated model validation accuracy : 80.1333%
Leave-one-out validation accuracies :  ['80.2000%', '80.2000%', '80.1333%', '80.0667%', '79.9333%', '80.0000%', '79.9333%', '79.9333%', '79.9333%', '80.0000%']
Computed and normalized credits:  tensor([0.0997, 0.0997, 0.0998, 0.0999, 0.1002, 0.1001, 0.1002, 0.1002, 0.1002,
        0.1001])
Federated model performance: Loss: 0.464786. Accuracy: 80.4920%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['55.594%', '71.508%', '74.973%', '75.401%', '75.893%', '76.171%', '76.663%', '77.519%', '77.305%', '78.160%']
Workers federated accuracies:  ['77.390%', '78.267%', '78.781%', '78.503%', '78.481%', '78.460%', '78.674%', '79.358%', '79.144%', '79.551%']
Workers improved  accuracies:  ['35.722%', '35.401%', '34.866%', '33.219%', '32.214%', '30.524%', '29.390%', '29.455%', '27.829%', '27.380%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 20:
Federated model validation accuracy : 79.8667%
Leave-one-out validation accuracies :  ['79.8667%', '79.9333%', '79.8000%', '79.8667%', '79.9333%', '80.0667%', '80.1333%', '80.1333%', '80.2667%', '80.2667%']
Computed and normalized credits:  tensor([0.1003, 0.1001, 0.1004, 0.1003, 0.1002, 0.0999, 0.0998, 0.0998, 0.0996,
        0.0995])
Federated model performance: Loss: 0.466559. Accuracy: 80.4920%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['56.492%', '72.021%', '75.294%', '75.551%', '75.936%', '76.235%', '76.727%', '77.733%', '77.283%', '78.246%']
Workers federated accuracies:  ['77.497%', '78.332%', '78.930%', '78.652%', '78.610%', '78.588%', '78.888%', '79.465%', '79.230%', '79.508%']
Workers improved  accuracies:  ['35.829%', '35.465%', '35.016%', '33.369%', '32.342%', '30.652%', '29.604%', '29.561%', '27.914%', '27.337%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.466559. Accuracy: 80.4920%.
Workers before    accuracies:  ['41.668%', '42.866%', '43.914%', '45.283%', '46.267%', '47.936%', '49.283%', '49.904%', '51.316%', '52.171%']
Workers standlone accuracies:  ['56.492%', '72.021%', '75.294%', '75.551%', '75.936%', '76.235%', '76.727%', '77.733%', '77.283%', '78.246%']
Workers federated accuracies:  ['77.497%', '78.332%', '78.930%', '78.652%', '78.610%', '78.588%', '78.888%', '79.465%', '79.230%', '79.508%']
Workers improved  accuracies:  ['35.829%', '35.465%', '35.016%', '33.369%', '32.342%', '30.652%', '29.604%', '29.561%', '27.914%', '27.337%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]
Workers sharing_contributions :  tensor([ 16.0000,  43.2000,  70.4000,  96.0000, 123.2000, 148.8000, 176.0000,
        201.6000, 228.8000, 254.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.7158208426905426, 0.01990815480191935)
Correlation between stand alone test acc & collaborative final model acc:  (0.8735747749271434, 0.0009568774011054408)
Correlation between test_acc & sharing contributions:  (0.8600237632976422, 0.0014135661962095735)
Correlation between test_acc improvements & sharing_contributions:  (-0.9898984951440598, 4.500369379226453e-08)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.743848. Accuracy: 48.3422%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 74.0667%
Leave-one-out validation accuracies :  ['74.1333%', '74.5333%', '74.8667%', '74.9333%', '74.6667%', '74.6667%', '74.8667%', '75.1333%', '74.9333%', '75.1333%']
Computed and normalized credits:  tensor([0.1014, 0.1005, 0.0998, 0.0997, 0.1003, 0.1003, 0.0998, 0.0993, 0.0997,
        0.0993])
Federated model performance: Loss: 0.573839. Accuracy: 73.5187%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['43.230%', '45.540%', '48.834%', '51.487%', '53.754%', '56.984%', '58.866%', '59.829%', '62.053%', '63.679%']
Workers federated accuracies:  ['65.925%', '67.209%', '67.701%', '68.214%', '69.155%', '70.182%', '70.588%', '71.144%', '71.337%', '71.786%']
Workers improved  accuracies:  ['23.337%', '23.594%', '22.610%', '22.096%', '21.733%', '20.642%', '20.235%', '19.508%', '18.118%', '17.497%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 2:
Federated model validation accuracy : 75.2667%
Leave-one-out validation accuracies :  ['75.3333%', '75.4000%', '75.4667%', '75.7333%', '75.8667%', '75.8667%', '76.0667%', '76.2667%', '76.3333%', '76.3333%']
Computed and normalized credits:  tensor([0.1013, 0.1011, 0.1008, 0.1002, 0.1000, 0.1000, 0.0996, 0.0990, 0.0990,
        0.0989])
Federated model performance: Loss: 0.529352. Accuracy: 75.4225%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['44.043%', '47.786%', '53.091%', '55.722%', '59.123%', '62.139%', '64.171%', '65.947%', '67.615%', '68.727%']
Workers federated accuracies:  ['71.487%', '72.193%', '72.834%', '72.984%', '73.519%', '73.861%', '74.353%', '74.139%', '74.524%', '74.995%']
Workers improved  accuracies:  ['28.898%', '28.578%', '27.743%', '26.866%', '26.096%', '24.321%', '24.000%', '22.503%', '21.305%', '20.706%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 3:
Federated model validation accuracy : 76.1333%
Leave-one-out validation accuracies :  ['76.1333%', '76.1333%', '76.1333%', '76.2000%', '76.3333%', '76.6667%', '76.8667%', '76.8000%', '76.8000%', '76.9333%']
Computed and normalized credits:  tensor([0.1010, 0.1009, 0.1009, 0.1007, 0.1003, 0.0997, 0.0992, 0.0992, 0.0992,
        0.0989])
Federated model performance: Loss: 0.514926. Accuracy: 76.0000%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['44.749%', '50.503%', '56.107%', '59.358%', '62.995%', '65.925%', '68.235%', '69.647%', '70.802%', '72.043%']
Workers federated accuracies:  ['73.305%', '73.904%', '74.567%', '74.567%', '75.102%', '75.487%', '75.893%', '75.807%', '76.064%', '76.064%']
Workers improved  accuracies:  ['30.717%', '30.289%', '29.476%', '28.449%', '27.679%', '25.947%', '25.540%', '24.171%', '22.845%', '21.775%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 4:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['77.0000%', '77.0667%', '77.1333%', '77.2000%', '77.2667%', '77.2000%', '77.3333%', '77.4667%', '77.4667%', '77.6000%']
Computed and normalized credits:  tensor([0.1007, 0.1006, 0.1004, 0.1003, 0.1001, 0.1001, 0.0997, 0.0995, 0.0995,
        0.0992])
Federated model performance: Loss: 0.507056. Accuracy: 76.3209%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['45.604%', '52.406%', '58.759%', '62.481%', '66.267%', '68.749%', '70.439%', '71.529%', '72.877%', '73.711%']
Workers federated accuracies:  ['74.417%', '74.909%', '75.358%', '75.508%', '75.829%', '76.043%', '76.278%', '76.235%', '76.492%', '76.684%']
Workers improved  accuracies:  ['31.829%', '31.294%', '30.267%', '29.390%', '28.406%', '26.503%', '25.925%', '24.599%', '23.273%', '22.396%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 5:
Federated model validation accuracy : 77.2667%
Leave-one-out validation accuracies :  ['77.3333%', '77.3333%', '77.3333%', '77.4667%', '77.6667%', '77.6667%', '77.7333%', '78.1333%', '78.0000%', '78.1333%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1008, 0.1005, 0.1000, 0.1000, 0.0998, 0.0990, 0.0993,
        0.0989])
Federated model performance: Loss: 0.499770. Accuracy: 76.8342%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['46.503%', '54.545%', '61.241%', '64.727%', '68.513%', '70.802%', '72.406%', '73.348%', '74.032%', '75.166%']
Workers federated accuracies:  ['75.594%', '76.086%', '76.321%', '76.321%', '76.578%', '76.791%', '76.856%', '76.856%', '77.048%', '77.198%']
Workers improved  accuracies:  ['33.005%', '32.471%', '31.230%', '30.203%', '29.155%', '27.251%', '26.503%', '25.219%', '23.829%', '22.909%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 6:
Federated model validation accuracy : 77.8000%
Leave-one-out validation accuracies :  ['77.8000%', '77.8667%', '77.8667%', '77.8667%', '77.8667%', '78.0000%', '78.0667%', '78.2667%', '78.2667%', '78.4000%']
Computed and normalized credits:  tensor([0.1006, 0.1005, 0.1005, 0.1004, 0.1003, 0.1001, 0.0999, 0.0993, 0.0994,
        0.0991])
Federated model performance: Loss: 0.493793. Accuracy: 77.1123%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['47.422%', '56.299%', '63.230%', '66.417%', '70.310%', '72.214%', '74.160%', '74.567%', '75.080%', '75.872%']
Workers federated accuracies:  ['76.064%', '76.471%', '76.727%', '76.513%', '76.791%', '76.898%', '77.091%', '77.390%', '77.412%', '77.626%']
Workers improved  accuracies:  ['33.476%', '32.856%', '31.636%', '30.396%', '29.369%', '27.358%', '26.738%', '25.754%', '24.193%', '23.337%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 7:
Federated model validation accuracy : 77.9333%
Leave-one-out validation accuracies :  ['77.9333%', '78.0000%', '78.0000%', '78.0000%', '78.2000%', '78.2667%', '78.3333%', '78.5333%', '78.5333%', '78.6000%']
Computed and normalized credits:  tensor([0.1007, 0.1006, 0.1006, 0.1005, 0.1001, 0.1000, 0.0998, 0.0993, 0.0993,
        0.0991])
Federated model performance: Loss: 0.488981. Accuracy: 77.6257%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['48.428%', '58.353%', '65.091%', '67.893%', '71.658%', '73.412%', '75.080%', '75.273%', '75.872%', '76.492%']
Workers federated accuracies:  ['76.342%', '76.727%', '77.048%', '76.599%', '77.005%', '77.241%', '77.455%', '77.668%', '77.711%', '77.840%']
Workers improved  accuracies:  ['33.754%', '33.112%', '31.957%', '30.481%', '29.583%', '27.701%', '27.102%', '26.032%', '24.492%', '23.551%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 8:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4667%', '78.5333%', '78.6667%', '78.6667%', '78.4667%', '78.6000%', '78.5333%', '78.4000%', '78.4000%']
Computed and normalized credits:  tensor([0.1003, 0.1002, 0.1001, 0.0998, 0.0997, 0.1001, 0.0998, 0.0998, 0.1001,
        0.1001])
Federated model performance: Loss: 0.484585. Accuracy: 77.8396%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['49.497%', '59.636%', '66.503%', '69.326%', '72.492%', '73.989%', '75.743%', '75.786%', '76.150%', '76.706%']
Workers federated accuracies:  ['76.599%', '77.027%', '77.326%', '76.963%', '77.219%', '77.476%', '77.797%', '77.882%', '77.818%', '77.989%']
Workers improved  accuracies:  ['34.011%', '33.412%', '32.235%', '30.845%', '29.797%', '27.936%', '27.444%', '26.246%', '24.599%', '23.701%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 9:
Federated model validation accuracy : 78.4667%
Leave-one-out validation accuracies :  ['78.4667%', '78.4667%', '78.5333%', '78.5333%', '78.4667%', '78.3333%', '78.2667%', '78.4667%', '78.6000%', '78.6000%']
Computed and normalized credits:  tensor([0.1001, 0.1000, 0.0999, 0.0998, 0.1000, 0.1003, 0.1004, 0.1000, 0.0998,
        0.0998])
Federated model performance: Loss: 0.480669. Accuracy: 78.2246%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['50.374%', '60.749%', '67.529%', '70.203%', '73.262%', '74.695%', '76.364%', '76.000%', '76.385%', '77.070%']
Workers federated accuracies:  ['76.727%', '77.070%', '77.412%', '77.198%', '77.412%', '77.861%', '78.075%', '78.075%', '78.118%', '78.246%']
Workers improved  accuracies:  ['34.139%', '33.455%', '32.321%', '31.080%', '29.989%', '28.321%', '27.722%', '26.439%', '24.898%', '23.957%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 10:
Federated model validation accuracy : 78.5333%
Leave-one-out validation accuracies :  ['78.4667%', '78.5333%', '78.6000%', '78.6667%', '78.6667%', '78.7333%', '78.6667%', '78.6000%', '78.7333%', '78.7333%']
Computed and normalized credits:  tensor([0.1004, 0.1002, 0.1001, 0.0999, 0.0999, 0.0999, 0.1000, 0.1001, 0.0998,
        0.0998])
Federated model performance: Loss: 0.477280. Accuracy: 78.2032%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['51.016%', '62.332%', '68.556%', '71.273%', '74.160%', '75.123%', '76.535%', '76.235%', '76.663%', '77.305%']
Workers federated accuracies:  ['76.856%', '77.348%', '77.561%', '77.326%', '77.668%', '78.160%', '78.267%', '78.289%', '78.139%', '78.524%']
Workers improved  accuracies:  ['34.267%', '33.733%', '32.471%', '31.209%', '30.246%', '28.620%', '27.914%', '26.652%', '24.920%', '24.235%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 11:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.6000%', '78.6000%', '78.6000%', '78.6000%', '78.6667%', '78.8000%', '78.7333%', '78.6000%', '78.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.0999, 0.0997, 0.0998, 0.1000,
        0.1004])
Federated model performance: Loss: 0.474263. Accuracy: 78.3743%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['51.829%', '63.636%', '69.433%', '72.257%', '74.588%', '75.529%', '76.813%', '76.599%', '76.984%', '77.348%']
Workers federated accuracies:  ['76.898%', '77.540%', '77.797%', '77.519%', '77.711%', '78.332%', '78.439%', '78.353%', '78.310%', '78.631%']
Workers improved  accuracies:  ['34.310%', '33.925%', '32.706%', '31.401%', '30.289%', '28.791%', '28.086%', '26.717%', '25.091%', '24.342%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 12:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.6667%', '78.6000%', '78.6000%', '78.5333%', '78.5333%', '78.5333%', '78.6000%', '78.5333%', '78.4000%']
Computed and normalized credits:  tensor([0.0998, 0.0998, 0.0999, 0.0999, 0.1001, 0.1000, 0.1000, 0.0999, 0.1001,
        0.1004])
Federated model performance: Loss: 0.471737. Accuracy: 78.5027%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['52.877%', '64.770%', '70.289%', '73.005%', '75.102%', '76.086%', '77.005%', '76.663%', '76.963%', '77.497%']
Workers federated accuracies:  ['76.941%', '77.668%', '78.011%', '77.733%', '77.861%', '78.417%', '78.652%', '78.524%', '78.695%', '78.652%']
Workers improved  accuracies:  ['34.353%', '34.053%', '32.920%', '31.615%', '30.439%', '28.877%', '28.299%', '26.888%', '25.476%', '24.364%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 13:
Federated model validation accuracy : 78.4667%
Leave-one-out validation accuracies :  ['78.4667%', '78.5333%', '78.6000%', '78.5333%', '78.6000%', '78.6000%', '78.4667%', '78.4667%', '78.4000%', '78.3333%']
Computed and normalized credits:  tensor([0.1000, 0.0999, 0.0998, 0.0999, 0.0998, 0.0998, 0.1001, 0.1000, 0.1002,
        0.1004])
Federated model performance: Loss: 0.469729. Accuracy: 78.7166%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['53.433%', '65.925%', '71.059%', '73.433%', '75.551%', '76.321%', '77.455%', '76.898%', '77.048%', '77.604%']
Workers federated accuracies:  ['77.070%', '77.733%', '78.203%', '77.989%', '78.075%', '78.481%', '78.845%', '78.695%', '78.866%', '78.738%']
Workers improved  accuracies:  ['34.481%', '34.118%', '33.112%', '31.872%', '30.652%', '28.941%', '28.492%', '27.059%', '25.647%', '24.449%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 14:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4667%', '78.4667%', '78.4000%', '78.4667%', '78.4667%', '78.3333%', '78.4000%', '78.5333%', '78.5333%', '78.5333%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1001, 0.1000, 0.1000, 0.1002, 0.1001, 0.0999, 0.0999,
        0.0999])
Federated model performance: Loss: 0.467859. Accuracy: 78.7166%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['54.374%', '66.759%', '71.529%', '74.032%', '75.807%', '76.599%', '77.561%', '77.176%', '77.348%', '77.754%']
Workers federated accuracies:  ['77.262%', '77.733%', '78.139%', '78.182%', '78.353%', '78.588%', '78.952%', '78.845%', '78.930%', '78.888%']
Workers improved  accuracies:  ['34.674%', '34.118%', '33.048%', '32.064%', '30.930%', '29.048%', '28.599%', '27.209%', '25.711%', '24.599%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 15:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4000%', '78.4000%', '78.6000%', '78.5333%', '78.6000%', '78.6000%', '78.5333%', '78.6667%', '78.8667%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.0999, 0.1000, 0.1000, 0.0999, 0.1000, 0.0998,
        0.0994])
Federated model performance: Loss: 0.466215. Accuracy: 78.7807%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['55.037%', '67.273%', '72.342%', '74.267%', '76.257%', '76.791%', '77.455%', '77.198%', '77.647%', '77.882%']
Workers federated accuracies:  ['77.390%', '77.818%', '78.267%', '78.203%', '78.588%', '78.759%', '78.995%', '78.845%', '79.102%', '79.037%']
Workers improved  accuracies:  ['34.802%', '34.203%', '33.176%', '32.086%', '31.166%', '29.219%', '28.642%', '27.209%', '25.882%', '24.749%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 16:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6667%', '78.6000%', '78.6667%', '78.6667%', '78.5333%', '78.6667%', '78.7333%', '78.8000%', '78.8000%', '78.8667%']
Computed and normalized credits:  tensor([0.1001, 0.1003, 0.1001, 0.1001, 0.1003, 0.1001, 0.0999, 0.0998, 0.0998,
        0.0996])
Federated model performance: Loss: 0.465129. Accuracy: 78.9519%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['55.722%', '68.064%', '72.941%', '74.738%', '76.278%', '76.727%', '77.583%', '77.369%', '77.668%', '77.968%']
Workers federated accuracies:  ['77.455%', '77.818%', '78.374%', '78.246%', '78.610%', '78.845%', '79.016%', '79.016%', '79.187%', '79.251%']
Workers improved  accuracies:  ['34.866%', '34.203%', '33.283%', '32.128%', '31.187%', '29.305%', '28.663%', '27.380%', '25.968%', '24.963%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 17:
Federated model validation accuracy : 78.8667%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8667%', '78.8667%', '78.8667%', '78.8667%', '78.8667%', '78.7333%', '78.8667%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.0999, 0.1000, 0.0999, 0.0999, 0.0999, 0.1002,
        0.0999])
Federated model performance: Loss: 0.464321. Accuracy: 78.9946%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['56.299%', '68.813%', '73.583%', '74.973%', '76.471%', '76.770%', '77.647%', '77.455%', '77.690%', '78.118%']
Workers federated accuracies:  ['77.433%', '77.861%', '78.460%', '78.267%', '78.717%', '78.824%', '79.144%', '78.973%', '79.251%', '79.337%']
Workers improved  accuracies:  ['34.845%', '34.246%', '33.369%', '32.150%', '31.294%', '29.283%', '28.791%', '27.337%', '26.032%', '25.048%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 18:
Federated model validation accuracy : 78.7333%
Leave-one-out validation accuracies :  ['78.7333%', '78.7333%', '78.7333%', '78.7333%', '78.6667%', '78.7333%', '78.8000%', '78.8667%', '78.9333%', '79.0000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1001, 0.1002, 0.1001, 0.1000, 0.0998, 0.0997,
        0.0996])
Federated model performance: Loss: 0.463882. Accuracy: 79.0588%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['57.176%', '69.390%', '73.904%', '75.166%', '76.727%', '76.920%', '77.754%', '77.540%', '77.690%', '78.267%']
Workers federated accuracies:  ['77.476%', '77.925%', '78.481%', '78.267%', '78.781%', '78.909%', '79.123%', '79.037%', '79.294%', '79.401%']
Workers improved  accuracies:  ['34.888%', '34.310%', '33.390%', '32.150%', '31.358%', '29.369%', '28.770%', '27.401%', '26.075%', '25.112%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 19:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.7333%', '78.8000%', '78.9333%', '79.0000%', '79.0000%', '79.0000%', '79.2000%', '79.0667%', '79.0667%']
Computed and normalized credits:  tensor([0.1003, 0.1005, 0.1003, 0.1001, 0.1000, 0.0999, 0.0999, 0.0995, 0.0997,
        0.0997])
Federated model performance: Loss: 0.463722. Accuracy: 79.1230%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['57.925%', '70.118%', '74.267%', '75.251%', '76.813%', '77.155%', '77.904%', '77.775%', '77.711%', '78.332%']
Workers federated accuracies:  ['77.540%', '78.032%', '78.567%', '78.396%', '78.759%', '78.995%', '79.187%', '78.973%', '79.401%', '79.273%']
Workers improved  accuracies:  ['34.952%', '34.417%', '33.476%', '32.278%', '31.337%', '29.455%', '28.834%', '27.337%', '26.182%', '24.984%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 20:
Federated model validation accuracy : 79.0667%
Leave-one-out validation accuracies :  ['79.0667%', '79.0000%', '79.0000%', '79.0667%', '79.0667%', '79.0667%', '79.0667%', '79.2000%', '79.0667%', '79.1333%']
Computed and normalized credits:  tensor([0.1001, 0.1002, 0.1002, 0.1000, 0.1000, 0.1000, 0.1000, 0.0997, 0.1000,
        0.0998])
Federated model performance: Loss: 0.463728. Accuracy: 79.1016%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['58.417%', '70.567%', '74.738%', '75.551%', '76.770%', '77.155%', '78.053%', '77.775%', '77.818%', '78.289%']
Workers federated accuracies:  ['77.497%', '78.096%', '78.631%', '78.396%', '78.845%', '79.016%', '79.380%', '79.102%', '79.401%', '79.422%']
Workers improved  accuracies:  ['34.909%', '34.481%', '33.540%', '32.278%', '31.422%', '29.476%', '29.027%', '27.465%', '26.182%', '25.134%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.463728. Accuracy: 79.1016%.
Workers before    accuracies:  ['42.588%', '43.615%', '45.091%', '46.118%', '47.422%', '49.540%', '50.353%', '51.636%', '53.219%', '54.289%']
Workers standlone accuracies:  ['58.417%', '70.567%', '74.738%', '75.551%', '76.770%', '77.155%', '78.053%', '77.775%', '77.818%', '78.289%']
Workers federated accuracies:  ['77.497%', '78.096%', '78.631%', '78.396%', '78.845%', '79.016%', '79.380%', '79.102%', '79.401%', '79.422%']
Workers improved  accuracies:  ['34.909%', '34.481%', '33.540%', '32.278%', '31.422%', '29.476%', '29.027%', '27.465%', '26.182%', '25.134%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]
Workers sharing_contributions :  tensor([ 16.0000,  43.2000,  70.4000,  96.0000, 123.2000, 148.8000, 176.0000,
        201.6000, 228.8000, 254.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.1261028586432133, 0.7284948501394404)
Correlation between stand alone test acc & collaborative final model acc:  (0.9001091765319406, 0.000385520698268751)
Correlation between test_acc & sharing contributions:  (0.9280558201718163, 0.00010739015157200229)
Correlation between test_acc improvements & sharing_contributions:  (-0.9947486757725102, 3.306084942456999e-09)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.660148. Accuracy: 60.6845%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 75.3333%
Leave-one-out validation accuracies :  ['75.4667%', '75.4667%', '75.8000%', '75.7333%', '76.0000%', '75.8667%', '76.1333%', '76.0667%', '76.3333%', '76.7333%']
Computed and normalized credits:  tensor([0.1010, 0.1010, 0.1003, 0.1005, 0.0999, 0.1002, 0.0996, 0.0998, 0.0992,
        0.0984])
Federated model performance: Loss: 0.546427. Accuracy: 73.3690%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['58.460%', '59.743%', '60.727%', '61.390%', '62.973%', '63.979%', '65.455%', '65.925%', '66.374%', '67.316%']
Workers federated accuracies:  ['58.460%', '59.743%', '60.727%', '61.390%', '62.973%', '63.979%', '65.455%', '65.925%', '66.374%', '67.316%']
Workers improved  accuracies:  ['0.428%', '1.091%', '1.626%', '1.797%', '2.567%', '2.995%', '3.807%', '3.957%', '3.765%', '4.257%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 2:
Federated model validation accuracy : 76.0667%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '76.0667%', '76.1333%', '76.3333%', '76.4667%', '76.7333%', '77.0000%', '77.5333%', '77.3333%']
Computed and normalized credits:  tensor([0.1013, 0.1013, 0.1011, 0.1010, 0.1004, 0.1002, 0.0996, 0.0991, 0.0979,
        0.0981])
Federated model performance: Loss: 0.498090. Accuracy: 75.2086%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['58.888%', '60.642%', '62.053%', '63.273%', '65.283%', '66.524%', '67.979%', '68.385%', '69.326%', '70.802%']
Workers federated accuracies:  ['58.888%', '60.642%', '62.053%', '63.273%', '65.283%', '66.524%', '67.979%', '68.385%', '69.326%', '70.802%']
Workers improved  accuracies:  ['0.856%', '1.989%', '2.952%', '3.679%', '4.877%', '5.540%', '6.332%', '6.417%', '6.717%', '7.743%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 3:
Federated model validation accuracy : 77.0667%
Leave-one-out validation accuracies :  ['77.0000%', '77.0000%', '77.2667%', '77.3333%', '77.4000%', '77.2000%', '77.3333%', '77.4000%', '77.8000%', '77.8667%']
Computed and normalized credits:  tensor([0.1010, 0.1010, 0.1004, 0.1002, 0.1000, 0.1004, 0.1000, 0.0998, 0.0988,
        0.0987])
Federated model performance: Loss: 0.484495. Accuracy: 75.9358%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['59.251%', '61.433%', '63.722%', '64.706%', '67.187%', '68.406%', '69.733%', '70.759%', '71.273%', '72.513%']
Workers federated accuracies:  ['59.251%', '61.433%', '63.722%', '64.706%', '67.187%', '68.406%', '69.733%', '70.759%', '71.273%', '72.513%']
Workers improved  accuracies:  ['1.219%', '2.781%', '4.620%', '5.112%', '6.781%', '7.422%', '8.086%', '8.791%', '8.663%', '9.455%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 4:
Federated model validation accuracy : 77.3333%
Leave-one-out validation accuracies :  ['77.3333%', '77.4000%', '77.3333%', '77.4667%', '77.6667%', '77.8000%', '77.9333%', '77.9333%', '77.8667%', '78.0000%']
Computed and normalized credits:  tensor([0.1008, 0.1007, 0.1008, 0.1005, 0.1000, 0.0998, 0.0995, 0.0994, 0.0994,
        0.0991])
Federated model performance: Loss: 0.489055. Accuracy: 76.3209%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['59.743%', '62.374%', '64.856%', '66.374%', '68.578%', '69.476%', '71.358%', '72.299%', '72.684%', '73.733%']
Workers federated accuracies:  ['75.144%', '75.358%', '75.487%', '75.572%', '75.658%', '75.701%', '75.914%', '76.043%', '75.979%', '76.278%']
Workers improved  accuracies:  ['17.112%', '16.706%', '16.385%', '15.979%', '15.251%', '14.717%', '14.267%', '14.075%', '13.369%', '13.219%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 5:
Federated model validation accuracy : 77.5333%
Leave-one-out validation accuracies :  ['77.6000%', '77.6667%', '77.9333%', '78.0000%', '78.0000%', '78.0000%', '78.0000%', '78.1333%', '78.3333%', '78.2000%']
Computed and normalized credits:  tensor([0.1009, 0.1008, 0.1002, 0.1000, 0.1000, 0.0999, 0.0999, 0.0996, 0.0992,
        0.0994])
Federated model performance: Loss: 0.477986. Accuracy: 76.7914%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['60.299%', '63.401%', '66.053%', '67.422%', '69.326%', '71.187%', '72.749%', '73.455%', '73.668%', '74.503%']
Workers federated accuracies:  ['75.529%', '75.615%', '75.893%', '75.936%', '75.979%', '76.214%', '76.364%', '76.428%', '76.471%', '76.877%']
Workers improved  accuracies:  ['17.497%', '16.963%', '16.791%', '16.342%', '15.572%', '15.230%', '14.717%', '14.460%', '13.861%', '13.818%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 6:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.0667%', '78.1333%', '78.4000%', '78.4667%', '78.5333%', '78.4667%', '78.4000%', '78.5333%', '78.4000%', '78.6000%']
Computed and normalized credits:  tensor([0.1008, 0.1007, 0.1000, 0.0999, 0.0997, 0.0999, 0.1000, 0.0997, 0.0999,
        0.0995])
Federated model performance: Loss: 0.469301. Accuracy: 77.1123%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['60.706%', '64.299%', '66.930%', '68.556%', '70.652%', '71.893%', '73.326%', '74.096%', '74.332%', '75.059%']
Workers federated accuracies:  ['75.743%', '76.064%', '76.299%', '76.428%', '76.321%', '76.620%', '76.770%', '77.027%', '76.920%', '77.262%']
Workers improved  accuracies:  ['17.711%', '17.412%', '17.198%', '16.834%', '15.914%', '15.636%', '15.123%', '15.059%', '14.310%', '14.203%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 7:
Federated model validation accuracy : 78.3333%
Leave-one-out validation accuracies :  ['78.3333%', '78.2000%', '78.2667%', '78.4667%', '78.5333%', '78.6000%', '78.6000%', '78.6000%', '78.7333%', '78.8000%']
Computed and normalized credits:  tensor([0.1005, 0.1007, 0.1005, 0.1001, 0.0999, 0.0998, 0.0998, 0.0998, 0.0995,
        0.0993])
Federated model performance: Loss: 0.462446. Accuracy: 77.6257%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['60.813%', '65.070%', '68.021%', '69.433%', '71.316%', '72.620%', '74.289%', '74.652%', '75.102%', '75.615%']
Workers federated accuracies:  ['76.214%', '76.385%', '76.599%', '76.663%', '76.684%', '77.005%', '77.198%', '77.176%', '77.497%', '77.733%']
Workers improved  accuracies:  ['18.182%', '17.733%', '17.497%', '17.070%', '16.278%', '16.021%', '15.551%', '15.209%', '14.888%', '14.674%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 8:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.6667%', '78.7333%', '78.7333%', '78.7333%', '78.8667%', '78.8667%', '78.8667%', '78.8000%', '78.7333%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1001, 0.1001, 0.1001, 0.0998, 0.0998, 0.0998, 0.0999,
        0.1000])
Federated model performance: Loss: 0.456871. Accuracy: 77.9679%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['61.241%', '65.775%', '68.684%', '70.096%', '72.278%', '72.984%', '74.930%', '75.016%', '75.166%', '75.829%']
Workers federated accuracies:  ['76.385%', '76.706%', '76.984%', '76.984%', '76.941%', '77.326%', '77.540%', '77.561%', '77.668%', '77.925%']
Workers improved  accuracies:  ['18.353%', '18.053%', '17.882%', '17.390%', '16.535%', '16.342%', '15.893%', '15.594%', '15.059%', '14.866%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 9:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.8000%', '78.8667%', '78.9333%', '78.8667%', '79.0000%', '79.0667%', '79.1333%', '79.0667%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1001, 0.1000, 0.1001, 0.0998, 0.0997, 0.0996,
        0.0997])
Federated model performance: Loss: 0.452676. Accuracy: 78.2246%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['61.647%', '66.460%', '69.369%', '70.695%', '72.963%', '73.433%', '75.273%', '75.551%', '75.337%', '76.043%']
Workers federated accuracies:  ['76.706%', '77.091%', '77.305%', '77.241%', '77.305%', '77.369%', '77.840%', '77.733%', '77.861%', '78.182%']
Workers improved  accuracies:  ['18.674%', '18.439%', '18.203%', '17.647%', '16.898%', '16.385%', '16.193%', '15.765%', '15.251%', '15.123%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 10:
Federated model validation accuracy : 78.9333%
Leave-one-out validation accuracies :  ['78.9333%', '78.8667%', '79.0000%', '79.0667%', '79.1333%', '79.1333%', '79.1333%', '79.2000%', '79.2000%', '79.5333%']
Computed and normalized credits:  tensor([0.1004, 0.1006, 0.1003, 0.1001, 0.1000, 0.1000, 0.0999, 0.0998, 0.0998,
        0.0991])
Federated model performance: Loss: 0.449207. Accuracy: 78.5668%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['61.989%', '66.930%', '70.460%', '71.251%', '73.283%', '73.989%', '75.594%', '75.722%', '75.422%', '76.406%']
Workers federated accuracies:  ['76.920%', '77.241%', '77.583%', '77.626%', '77.561%', '77.604%', '78.075%', '77.947%', '78.139%', '78.481%']
Workers improved  accuracies:  ['18.888%', '18.588%', '18.481%', '18.032%', '17.155%', '16.620%', '16.428%', '15.979%', '15.529%', '15.422%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 11:
Federated model validation accuracy : 79.0667%
Leave-one-out validation accuracies :  ['79.0667%', '79.0667%', '79.0667%', '79.1333%', '79.2000%', '79.3333%', '79.5333%', '79.5333%', '79.5333%', '79.5333%']
Computed and normalized credits:  tensor([0.1005, 0.1006, 0.1005, 0.1004, 0.1002, 0.0999, 0.0995, 0.0995, 0.0995,
        0.0994])
Federated model performance: Loss: 0.446206. Accuracy: 78.7807%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['62.524%', '67.508%', '71.102%', '71.786%', '73.668%', '74.225%', '75.829%', '75.872%', '75.679%', '76.642%']
Workers federated accuracies:  ['77.091%', '77.305%', '77.797%', '77.968%', '77.882%', '77.925%', '78.396%', '78.053%', '78.417%', '78.738%']
Workers improved  accuracies:  ['19.059%', '18.652%', '18.695%', '18.374%', '17.476%', '16.941%', '16.749%', '16.086%', '15.807%', '15.679%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 12:
Federated model validation accuracy : 79.5333%
Leave-one-out validation accuracies :  ['79.5333%', '79.5333%', '79.5333%', '79.5333%', '79.5333%', '79.6000%', '79.7333%', '79.6667%', '79.6000%', '79.5333%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1001, 0.0999, 0.0996, 0.0997, 0.0999,
        0.1000])
Federated model performance: Loss: 0.443778. Accuracy: 78.8449%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['62.866%', '67.936%', '71.829%', '72.214%', '73.925%', '74.567%', '76.000%', '76.150%', '76.064%', '76.834%']
Workers federated accuracies:  ['77.283%', '77.583%', '77.968%', '78.011%', '78.075%', '78.032%', '78.652%', '78.246%', '78.631%', '78.802%']
Workers improved  accuracies:  ['19.251%', '18.930%', '18.866%', '18.417%', '17.668%', '17.048%', '17.005%', '16.278%', '16.021%', '15.743%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 13:
Federated model validation accuracy : 79.6667%
Leave-one-out validation accuracies :  ['79.6667%', '79.6667%', '79.6000%', '79.6667%', '79.6667%', '79.5333%', '79.3333%', '79.4667%', '79.5333%', '79.6000%']
Computed and normalized credits:  tensor([0.0998, 0.0998, 0.1000, 0.0998, 0.0998, 0.1001, 0.1004, 0.1002, 0.1001,
        0.0999])
Federated model performance: Loss: 0.441760. Accuracy: 78.9946%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['63.273%', '68.107%', '72.535%', '72.684%', '74.610%', '74.781%', '76.171%', '76.278%', '76.385%', '77.155%']
Workers federated accuracies:  ['77.433%', '77.733%', '77.882%', '77.968%', '78.182%', '78.182%', '78.845%', '78.460%', '78.802%', '79.080%']
Workers improved  accuracies:  ['19.401%', '19.080%', '18.781%', '18.374%', '17.775%', '17.198%', '17.198%', '16.492%', '16.193%', '16.021%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 14:
Federated model validation accuracy : 79.4667%
Leave-one-out validation accuracies :  ['79.4667%', '79.4000%', '79.3333%', '79.4667%', '79.5333%', '79.4667%', '79.6000%', '79.6000%', '79.3333%', '79.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1001, 0.1002, 0.1000, 0.0998, 0.1000, 0.0998, 0.0998, 0.1003,
        0.1001])
Federated model performance: Loss: 0.440023. Accuracy: 79.1016%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['63.679%', '68.684%', '72.963%', '73.134%', '74.695%', '75.037%', '76.342%', '76.471%', '76.727%', '77.262%']
Workers federated accuracies:  ['77.583%', '77.882%', '77.861%', '78.139%', '78.332%', '78.353%', '78.973%', '78.631%', '78.888%', '79.251%']
Workers improved  accuracies:  ['19.551%', '19.230%', '18.759%', '18.545%', '17.925%', '17.369%', '17.326%', '16.663%', '16.278%', '16.193%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 15:
Federated model validation accuracy : 79.5333%
Leave-one-out validation accuracies :  ['79.5333%', '79.5333%', '79.6667%', '79.6667%', '79.6000%', '79.6000%', '79.6667%', '79.6667%', '79.8667%', '80.0000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1001, 0.1000, 0.1001, 0.1002, 0.1000, 0.1000, 0.0997,
        0.0994])
Federated model performance: Loss: 0.438656. Accuracy: 79.3369%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['64.235%', '69.091%', '73.348%', '73.583%', '74.930%', '75.187%', '76.471%', '76.727%', '76.834%', '77.455%']
Workers federated accuracies:  ['77.497%', '77.947%', '77.968%', '78.246%', '78.439%', '78.545%', '79.080%', '78.652%', '79.016%', '79.465%']
Workers improved  accuracies:  ['19.465%', '19.294%', '18.866%', '18.652%', '18.032%', '17.562%', '17.433%', '16.684%', '16.406%', '16.406%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 16:
Federated model validation accuracy : 79.5333%
Leave-one-out validation accuracies :  ['79.5333%', '79.5333%', '79.6000%', '79.6667%', '79.7333%', '80.0000%', '80.0000%', '80.0667%', '80.1333%', '80.0000%']
Computed and normalized credits:  tensor([0.1006, 0.1006, 0.1005, 0.1003, 0.1002, 0.0997, 0.0997, 0.0995, 0.0993,
        0.0996])
Federated model performance: Loss: 0.437256. Accuracy: 79.3583%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['64.749%', '69.882%', '73.561%', '73.818%', '75.144%', '75.422%', '76.513%', '76.856%', '77.134%', '77.690%']
Workers federated accuracies:  ['77.497%', '77.840%', '77.968%', '78.246%', '78.545%', '78.717%', '79.102%', '78.738%', '79.144%', '79.465%']
Workers improved  accuracies:  ['19.465%', '19.187%', '18.866%', '18.652%', '18.139%', '17.733%', '17.455%', '16.770%', '16.535%', '16.406%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 17:
Federated model validation accuracy : 79.8667%
Leave-one-out validation accuracies :  ['79.8667%', '79.8667%', '80.0667%', '80.0000%', '80.0667%', '80.0000%', '79.9333%', '79.9333%', '80.1333%', '80.1333%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.0999, 0.1001, 0.0999, 0.0999, 0.1001, 0.1001, 0.0996,
        0.0997])
Federated model performance: Loss: 0.436259. Accuracy: 79.4438%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['64.984%', '70.439%', '73.818%', '74.032%', '75.294%', '75.529%', '76.684%', '77.198%', '77.262%', '77.797%']
Workers federated accuracies:  ['77.519%', '77.947%', '78.182%', '78.267%', '78.503%', '78.652%', '79.230%', '78.866%', '79.209%', '79.551%']
Workers improved  accuracies:  ['19.487%', '19.294%', '19.080%', '18.674%', '18.096%', '17.668%', '17.583%', '16.898%', '16.599%', '16.492%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 18:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0000%', '80.1333%', '80.2667%', '80.1333%', '80.0667%', '80.0667%', '80.0667%', '80.0667%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1001, 0.0999, 0.0996, 0.0999, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 0.435442. Accuracy: 79.5080%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['65.326%', '70.824%', '74.139%', '74.353%', '75.422%', '75.786%', '76.749%', '77.305%', '77.326%', '77.968%']
Workers federated accuracies:  ['77.561%', '77.925%', '78.439%', '78.267%', '78.545%', '78.674%', '79.401%', '79.037%', '79.380%', '79.636%']
Workers improved  accuracies:  ['19.529%', '19.273%', '19.337%', '18.674%', '18.139%', '17.690%', '17.754%', '17.070%', '16.770%', '16.578%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 19:
Federated model validation accuracy : 80.0667%
Leave-one-out validation accuracies :  ['80.0667%', '80.0667%', '80.0667%', '79.8667%', '79.9333%', '79.9333%', '80.0667%', '80.1333%', '80.0667%', '80.0667%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.0999, 0.1003, 0.1001, 0.1002, 0.0999, 0.0998, 0.0999,
        0.0999])
Federated model performance: Loss: 0.434863. Accuracy: 79.6791%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['65.604%', '71.294%', '74.267%', '74.524%', '75.636%', '76.000%', '77.091%', '77.283%', '77.476%', '78.053%']
Workers federated accuracies:  ['77.583%', '78.011%', '78.439%', '78.310%', '78.631%', '78.717%', '79.444%', '79.251%', '79.422%', '79.701%']
Workers improved  accuracies:  ['19.551%', '19.358%', '19.337%', '18.717%', '18.225%', '17.733%', '17.797%', '17.283%', '16.813%', '16.642%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 20:
Federated model validation accuracy : 80.0667%
Leave-one-out validation accuracies :  ['80.0667%', '80.0667%', '80.1333%', '80.0667%', '80.1333%', '80.0000%', '80.1333%', '80.2667%', '80.1333%', '80.2000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1000, 0.1002, 0.1000, 0.1003, 0.1000, 0.0997, 0.1000,
        0.0998])
Federated model performance: Loss: 0.434471. Accuracy: 79.7861%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['65.925%', '71.529%', '74.524%', '74.759%', '75.594%', '76.107%', '77.176%', '77.305%', '77.733%', '78.203%']
Workers federated accuracies:  ['77.583%', '78.053%', '78.396%', '78.374%', '78.695%', '78.824%', '79.551%', '79.422%', '79.572%', '79.701%']
Workers improved  accuracies:  ['19.551%', '19.401%', '19.294%', '18.781%', '18.289%', '17.840%', '17.904%', '17.455%', '16.963%', '16.642%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.434471. Accuracy: 79.7861%.
Workers before    accuracies:  ['58.032%', '58.652%', '59.102%', '59.594%', '60.406%', '60.984%', '61.647%', '61.968%', '62.610%', '63.059%']
Workers standlone accuracies:  ['65.925%', '71.529%', '74.524%', '74.759%', '75.594%', '76.107%', '77.176%', '77.305%', '77.733%', '78.203%']
Workers federated accuracies:  ['77.583%', '78.053%', '78.396%', '78.374%', '78.695%', '78.824%', '79.551%', '79.422%', '79.572%', '79.701%']
Workers improved  accuracies:  ['19.551%', '19.401%', '19.294%', '18.781%', '18.289%', '17.840%', '17.904%', '17.455%', '16.963%', '16.642%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]
Workers sharing_contributions :  tensor([ 16.0000,  43.2000,  70.4000,  96.0000, 123.2000, 148.8000, 176.0000,
        201.6000, 228.8000, 254.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.5556779017821672, 0.09536359529339264)
Correlation between stand alone test acc & collaborative final model acc:  (0.9058893305976723, 0.00030593115734809143)
Correlation between test_acc & sharing contributions:  (0.9729167389791633, 2.2782262530092398e-06)
Correlation between test_acc improvements & sharing_contributions:  (-0.989117692847235, 6.055908204866507e-08)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.691306. Accuracy: 58.3102%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 74.4667%
Leave-one-out validation accuracies :  ['74.5333%', '74.6000%', '74.7333%', '75.5333%', '75.8667%', '76.3333%', '76.3333%', '76.8000%', '76.8667%', '76.6667%']
Computed and normalized credits:  tensor([0.1028, 0.1026, 0.1023, 0.1006, 0.0999, 0.0989, 0.0989, 0.0979, 0.0978,
        0.0982])
Federated model performance: Loss: 0.558442. Accuracy: 74.2246%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['55.080%', '56.856%', '58.674%', '59.957%', '62.053%', '63.765%', '65.155%', '66.139%', '67.380%', '68.471%']
Workers federated accuracies:  ['70.096%', '70.738%', '71.144%', '71.636%', '71.957%', '72.214%', '72.963%', '72.941%', '73.262%', '73.476%']
Workers improved  accuracies:  ['15.765%', '15.273%', '14.717%', '14.438%', '14.032%', '13.198%', '13.048%', '12.428%', '11.829%', '11.144%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 2:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.4000%', '76.4000%', '76.5333%', '76.6000%', '76.6667%', '76.9333%', '77.0667%', '77.1333%', '77.1333%', '76.9333%']
Computed and normalized credits:  tensor([0.1012, 0.1012, 0.1009, 0.1005, 0.1002, 0.0995, 0.0992, 0.0989, 0.0989,
        0.0994])
Federated model performance: Loss: 0.510328. Accuracy: 75.3583%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['55.829%', '57.925%', '61.112%', '62.930%', '65.754%', '67.422%', '68.599%', '69.733%', '70.503%', '71.701%']
Workers federated accuracies:  ['73.583%', '73.989%', '74.182%', '74.503%', '74.417%', '74.738%', '74.866%', '75.123%', '74.845%', '75.123%']
Workers improved  accuracies:  ['19.251%', '18.524%', '17.754%', '17.305%', '16.492%', '15.722%', '14.952%', '14.610%', '13.412%', '12.791%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 3:
Federated model validation accuracy : 77.0000%
Leave-one-out validation accuracies :  ['76.8667%', '76.8667%', '76.8000%', '76.8667%', '76.7333%', '76.7333%', '76.8000%', '76.8667%', '77.1333%', '77.4000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1004, 0.1002, 0.1004, 0.1003, 0.1001, 0.0999, 0.0994,
        0.0989])
Federated model performance: Loss: 0.489831. Accuracy: 76.1497%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['56.406%', '59.358%', '63.401%', '65.882%', '67.872%', '69.198%', '70.717%', '71.957%', '72.834%', '73.690%']
Workers federated accuracies:  ['74.374%', '74.610%', '75.080%', '74.973%', '75.273%', '75.358%', '75.465%', '75.465%', '75.444%', '75.572%']
Workers improved  accuracies:  ['20.043%', '19.144%', '18.652%', '17.775%', '17.348%', '16.342%', '15.551%', '14.952%', '14.011%', '13.241%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 4:
Federated model validation accuracy : 77.2667%
Leave-one-out validation accuracies :  ['77.2667%', '77.2667%', '77.2000%', '77.2000%', '77.2000%', '77.2667%', '77.4667%', '77.5333%', '77.8667%', '78.1333%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1005, 0.1005, 0.1006, 0.1004, 0.1000, 0.0998, 0.0990,
        0.0984])
Federated model performance: Loss: 0.477729. Accuracy: 76.8128%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['56.898%', '60.620%', '65.733%', '67.529%', '69.733%', '71.059%', '72.449%', '73.497%', '74.053%', '74.460%']
Workers federated accuracies:  ['75.102%', '75.316%', '75.337%', '75.572%', '75.551%', '75.658%', '75.743%', '75.850%', '75.786%', '75.850%']
Workers improved  accuracies:  ['20.770%', '19.850%', '18.909%', '18.374%', '17.626%', '16.642%', '15.829%', '15.337%', '14.353%', '13.519%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 5:
Federated model validation accuracy : 77.4667%
Leave-one-out validation accuracies :  ['77.4667%', '77.5333%', '77.6000%', '77.7333%', '77.6667%', '77.6667%', '77.8667%', '78.2000%', '78.1333%', '78.4667%']
Computed and normalized credits:  tensor([0.1008, 0.1007, 0.1006, 0.1003, 0.1004, 0.1004, 0.0999, 0.0992, 0.0992,
        0.0985])
Federated model performance: Loss: 0.469548. Accuracy: 77.3904%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['57.604%', '61.733%', '67.358%', '69.348%', '71.209%', '72.556%', '73.626%', '74.396%', '74.631%', '75.123%']
Workers federated accuracies:  ['75.444%', '75.572%', '75.701%', '75.829%', '75.936%', '76.086%', '76.128%', '76.428%', '76.171%', '76.406%']
Workers improved  accuracies:  ['21.112%', '20.107%', '19.273%', '18.631%', '18.011%', '17.070%', '16.214%', '15.914%', '14.738%', '14.075%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 6:
Federated model validation accuracy : 77.9333%
Leave-one-out validation accuracies :  ['77.9333%', '77.9333%', '77.9333%', '78.2000%', '78.3333%', '78.3333%', '78.4000%', '78.4667%', '78.4667%', '78.5333%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1007, 0.1002, 0.0999, 0.0999, 0.0997, 0.0994, 0.0994,
        0.0992])
Federated model performance: Loss: 0.463232. Accuracy: 77.7968%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['57.840%', '63.230%', '68.791%', '70.267%', '72.235%', '73.348%', '74.353%', '74.717%', '75.316%', '75.636%']
Workers federated accuracies:  ['75.743%', '75.893%', '76.064%', '76.299%', '76.257%', '76.599%', '76.578%', '76.663%', '76.706%', '76.877%']
Workers improved  accuracies:  ['21.412%', '20.428%', '19.636%', '19.102%', '18.332%', '17.583%', '16.663%', '16.150%', '15.273%', '14.545%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 7:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.6667%', '78.6000%', '78.6000%', '78.4667%', '78.5333%', '78.5333%', '78.4667%', '78.2667%', '78.4667%']
Computed and normalized credits:  tensor([0.0999, 0.0998, 0.1000, 0.0999, 0.1001, 0.1000, 0.0999, 0.1000, 0.1004,
        0.1000])
Federated model performance: Loss: 0.458539. Accuracy: 78.1390%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['58.610%', '64.642%', '69.690%', '71.209%', '73.540%', '73.861%', '74.952%', '75.230%', '75.636%', '75.893%']
Workers federated accuracies:  ['76.107%', '76.171%', '76.449%', '76.620%', '76.663%', '76.984%', '77.005%', '77.091%', '77.262%', '77.497%']
Workers improved  accuracies:  ['21.775%', '20.706%', '20.021%', '19.422%', '18.738%', '17.968%', '17.091%', '16.578%', '15.829%', '15.166%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 8:
Federated model validation accuracy : 78.4667%
Leave-one-out validation accuracies :  ['78.4667%', '78.4667%', '78.4667%', '78.4667%', '78.5333%', '78.5333%', '78.6000%', '78.6667%', '78.6667%', '78.7333%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1002, 0.1001, 0.1000, 0.0999, 0.0998, 0.0999,
        0.0997])
Federated model performance: Loss: 0.454831. Accuracy: 78.4385%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['59.209%', '65.733%', '70.203%', '72.214%', '73.925%', '74.460%', '75.230%', '75.636%', '75.979%', '76.128%']
Workers federated accuracies:  ['76.299%', '76.321%', '76.791%', '77.027%', '76.984%', '77.305%', '77.112%', '77.369%', '77.626%', '77.861%']
Workers improved  accuracies:  ['21.968%', '20.856%', '20.364%', '19.829%', '19.059%', '18.289%', '17.198%', '16.856%', '16.193%', '15.529%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 9:
Federated model validation accuracy : 78.5333%
Leave-one-out validation accuracies :  ['78.5333%', '78.6000%', '78.5333%', '78.6000%', '78.8667%', '79.0000%', '79.0000%', '79.0000%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.1006, 0.1005, 0.1006, 0.1005, 0.0999, 0.0996, 0.0996, 0.0996, 0.0996,
        0.0996])
Federated model performance: Loss: 0.451763. Accuracy: 78.5882%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['59.594%', '66.909%', '71.059%', '72.663%', '74.225%', '75.016%', '75.615%', '75.850%', '76.150%', '76.299%']
Workers federated accuracies:  ['76.364%', '76.535%', '77.048%', '77.155%', '77.155%', '77.540%', '77.519%', '77.561%', '77.775%', '78.118%']
Workers improved  accuracies:  ['22.032%', '21.070%', '20.620%', '19.957%', '19.230%', '18.524%', '17.604%', '17.048%', '16.342%', '15.786%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 10:
Federated model validation accuracy : 78.7333%
Leave-one-out validation accuracies :  ['78.7333%', '78.7333%', '78.7333%', '78.8667%', '79.0000%', '79.1333%', '79.1333%', '79.0000%', '79.0000%', '79.2000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1005, 0.1002, 0.0999, 0.0996, 0.0996, 0.0998, 0.0998,
        0.0994])
Federated model performance: Loss: 0.449136. Accuracy: 78.7807%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['60.428%', '67.615%', '71.807%', '73.070%', '74.631%', '75.230%', '75.807%', '76.128%', '76.235%', '76.684%']
Workers federated accuracies:  ['76.513%', '76.684%', '77.176%', '77.198%', '77.455%', '77.840%', '77.818%', '77.840%', '77.968%', '78.267%']
Workers improved  accuracies:  ['22.182%', '21.219%', '20.749%', '20.000%', '19.529%', '18.824%', '17.904%', '17.326%', '16.535%', '15.936%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 11:
Federated model validation accuracy : 78.9333%
Leave-one-out validation accuracies :  ['78.9333%', '78.9333%', '79.1333%', '79.0667%', '79.0000%', '79.0000%', '79.0000%', '79.1333%', '79.0667%', '79.0000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.0998, 0.0999,
        0.1000])
Federated model performance: Loss: 0.447559. Accuracy: 78.7807%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['60.920%', '68.299%', '72.578%', '73.626%', '74.995%', '75.487%', '75.957%', '76.299%', '76.406%', '76.791%']
Workers federated accuracies:  ['76.642%', '77.005%', '77.326%', '77.348%', '77.690%', '77.947%', '78.032%', '77.947%', '78.160%', '78.503%']
Workers improved  accuracies:  ['22.310%', '21.540%', '20.898%', '20.150%', '19.765%', '18.930%', '18.118%', '17.433%', '16.727%', '16.171%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 12:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2667%', '79.2667%', '79.2667%', '79.2000%', '79.2667%', '79.0667%', '79.1333%', '79.2667%', '79.5333%', '79.4000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1004, 0.1003, 0.1000, 0.0995,
        0.0997])
Federated model performance: Loss: 0.446531. Accuracy: 79.0802%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['61.348%', '68.920%', '73.283%', '73.904%', '75.123%', '75.765%', '76.128%', '76.471%', '76.513%', '77.070%']
Workers federated accuracies:  ['76.941%', '77.262%', '77.647%', '77.561%', '77.882%', '78.118%', '78.353%', '78.160%', '78.289%', '78.674%']
Workers improved  accuracies:  ['22.610%', '21.797%', '21.219%', '20.364%', '19.957%', '19.102%', '18.439%', '17.647%', '16.856%', '16.342%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 13:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.4667%', '79.5333%', '79.4000%', '79.2667%', '79.4667%', '79.3333%', '79.4000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.0998, 0.0996, 0.1000, 0.1002, 0.0998, 0.0999,
        0.0998])
Federated model performance: Loss: 0.445770. Accuracy: 78.9946%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['61.925%', '69.219%', '73.818%', '74.417%', '75.273%', '75.957%', '76.321%', '76.556%', '76.770%', '77.241%']
Workers federated accuracies:  ['77.027%', '77.540%', '77.733%', '77.947%', '78.075%', '78.374%', '78.439%', '78.396%', '78.396%', '78.802%']
Workers improved  accuracies:  ['22.695%', '22.075%', '21.305%', '20.749%', '20.150%', '19.358%', '18.524%', '17.882%', '16.963%', '16.471%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 14:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2000%', '79.3333%', '79.4667%', '79.3333%', '79.4000%', '79.4667%', '79.4667%', '79.4000%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1000, 0.0997, 0.1000, 0.0999, 0.0997, 0.0998,
        0.0999])
Federated model performance: Loss: 0.445568. Accuracy: 79.2727%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['62.503%', '69.647%', '74.203%', '74.717%', '75.465%', '76.043%', '76.428%', '76.642%', '76.984%', '77.455%']
Workers federated accuracies:  ['77.091%', '77.604%', '77.925%', '78.032%', '78.246%', '78.524%', '78.652%', '78.567%', '78.631%', '79.080%']
Workers improved  accuracies:  ['22.759%', '22.139%', '21.497%', '20.834%', '20.321%', '19.508%', '18.738%', '18.053%', '17.198%', '16.749%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 15:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4000%', '79.4667%', '79.4667%', '79.5333%', '79.4667%', '79.7333%', '79.7333%', '79.8667%']
Computed and normalized credits:  tensor([0.1003, 0.1003, 0.1003, 0.1002, 0.1001, 0.1000, 0.1001, 0.0996, 0.0996,
        0.0993])
Federated model performance: Loss: 0.445727. Accuracy: 79.4225%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['63.123%', '69.989%', '74.588%', '74.952%', '75.786%', '76.193%', '76.535%', '76.727%', '76.963%', '77.561%']
Workers federated accuracies:  ['77.326%', '77.733%', '78.053%', '78.118%', '78.310%', '78.717%', '78.738%', '78.652%', '78.802%', '79.102%']
Workers improved  accuracies:  ['22.995%', '22.267%', '21.626%', '20.920%', '20.385%', '19.701%', '18.824%', '18.139%', '17.369%', '16.770%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 16:
Federated model validation accuracy : 79.5333%
Leave-one-out validation accuracies :  ['79.5333%', '79.4667%', '79.4667%', '79.5333%', '79.6667%', '79.6667%', '79.7333%', '79.8000%', '79.8667%', '79.7333%']
Computed and normalized credits:  tensor([0.1003, 0.1004, 0.1004, 0.1002, 0.1000, 0.1000, 0.0999, 0.0996, 0.0995,
        0.0997])
Federated model performance: Loss: 0.446019. Accuracy: 79.5294%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['63.444%', '70.588%', '75.016%', '75.209%', '75.979%', '76.299%', '76.706%', '76.684%', '77.155%', '77.626%']
Workers federated accuracies:  ['77.433%', '77.754%', '78.182%', '78.289%', '78.374%', '78.802%', '78.824%', '78.631%', '78.930%', '79.187%']
Workers improved  accuracies:  ['23.102%', '22.289%', '21.754%', '21.091%', '20.449%', '19.786%', '18.909%', '18.118%', '17.497%', '16.856%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 17:
Federated model validation accuracy : 79.9333%
Leave-one-out validation accuracies :  ['80.0000%', '80.0000%', '80.0667%', '80.0000%', '79.8000%', '79.8000%', '79.7333%', '79.5333%', '79.4000%', '79.6000%']
Computed and normalized credits:  tensor([0.0996, 0.0997, 0.0995, 0.0996, 0.1000, 0.1000, 0.1001, 0.1004, 0.1007,
        0.1003])
Federated model performance: Loss: 0.446438. Accuracy: 79.5508%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['63.872%', '71.123%', '75.144%', '75.529%', '76.043%', '76.449%', '76.791%', '76.684%', '77.305%', '77.818%']
Workers federated accuracies:  ['77.690%', '78.139%', '78.118%', '78.396%', '78.717%', '78.652%', '79.080%', '78.460%', '79.016%', '79.230%']
Workers improved  accuracies:  ['23.358%', '22.674%', '21.690%', '21.198%', '20.791%', '19.636%', '19.166%', '17.947%', '17.583%', '16.898%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 18:
Federated model validation accuracy : 79.7333%
Leave-one-out validation accuracies :  ['79.7333%', '79.8667%', '79.7333%', '79.6000%', '79.5333%', '79.6000%', '79.5333%', '79.5333%', '79.4667%', '79.4667%']
Computed and normalized credits:  tensor([0.0997, 0.0994, 0.0997, 0.1000, 0.1001, 0.1000, 0.1002, 0.1002, 0.1004,
        0.1003])
Federated model performance: Loss: 0.445731. Accuracy: 79.4866%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['64.385%', '71.572%', '75.380%', '75.615%', '76.021%', '76.684%', '76.920%', '76.898%', '77.262%', '77.882%']
Workers federated accuracies:  ['77.711%', '78.203%', '78.246%', '78.610%', '78.866%', '78.738%', '79.123%', '78.545%', '79.166%', '79.316%']
Workers improved  accuracies:  ['23.380%', '22.738%', '21.818%', '21.412%', '20.941%', '19.722%', '19.209%', '18.032%', '17.733%', '16.984%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 19:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.5333%', '79.4667%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.4000%', '79.3333%', '79.2000%', '79.3333%']
Computed and normalized credits:  tensor([0.0997, 0.0997, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1004,
        0.1002])
Federated model performance: Loss: 0.445072. Accuracy: 79.5936%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['64.920%', '72.086%', '75.529%', '75.594%', '76.086%', '76.749%', '77.005%', '77.005%', '77.455%', '78.203%']
Workers federated accuracies:  ['77.925%', '78.503%', '78.738%', '78.652%', '78.995%', '78.866%', '79.230%', '78.717%', '79.380%', '79.594%']
Workers improved  accuracies:  ['23.594%', '23.037%', '22.310%', '21.455%', '21.070%', '19.850%', '19.316%', '18.203%', '17.947%', '17.262%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 20:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.3333%', '79.3333%', '79.3333%', '79.4000%', '79.3333%', '79.3333%', '79.3333%', '79.3333%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.0999, 0.1000, 0.1001, 0.1001,
        0.1001])
Federated model performance: Loss: 0.444673. Accuracy: 79.6364%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['65.112%', '72.385%', '75.786%', '75.679%', '76.342%', '76.813%', '77.155%', '77.048%', '77.647%', '78.289%']
Workers federated accuracies:  ['78.032%', '78.524%', '78.781%', '78.781%', '79.059%', '79.016%', '79.465%', '78.866%', '79.337%', '79.658%']
Workers improved  accuracies:  ['23.701%', '23.059%', '22.353%', '21.583%', '21.134%', '20.000%', '19.551%', '18.353%', '17.904%', '17.326%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.444673. Accuracy: 79.6364%.
Workers before    accuracies:  ['54.332%', '55.465%', '56.428%', '57.198%', '57.925%', '59.016%', '59.914%', '60.513%', '61.433%', '62.332%']
Workers standlone accuracies:  ['65.112%', '72.385%', '75.786%', '75.679%', '76.342%', '76.813%', '77.155%', '77.048%', '77.647%', '78.289%']
Workers federated accuracies:  ['78.032%', '78.524%', '78.781%', '78.781%', '79.059%', '79.016%', '79.465%', '78.866%', '79.337%', '79.658%']
Workers improved  accuracies:  ['23.701%', '23.059%', '22.353%', '21.583%', '21.134%', '20.000%', '19.551%', '18.353%', '17.904%', '17.326%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]
Workers sharing_contributions :  tensor([ 16.0000,  43.2000,  70.4000,  96.0000, 123.2000, 148.8000, 176.0000,
        201.6000, 228.8000, 254.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.41483055186725337, 0.233252084357897)
Correlation between stand alone test acc & collaborative final model acc:  (0.871405205503078, 0.0010214782345774854)
Correlation between test_acc & sharing contributions:  (0.8833841461254426, 0.0007012953419631017)
Correlation between test_acc improvements & sharing_contributions:  (-0.9970504812425003, 3.299474100018527e-10)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.753039. Accuracy: 45.1765%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.6000%
Leave-one-out validation accuracies :  ['72.2000%', '72.4667%', '73.0000%', '73.9333%', '74.5333%', '75.1333%', '75.4000%', '75.6000%', '75.6667%', '75.9333%']
Computed and normalized credits:  tensor([0.1049, 0.1043, 0.1031, 0.1010, 0.0996, 0.0983, 0.0977, 0.0973, 0.0972,
        0.0966])
Federated model performance: Loss: 0.577760. Accuracy: 71.3797%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['40.406%', '43.016%', '45.989%', '48.449%', '51.444%', '54.567%', '56.471%', '58.353%', '60.770%', '62.267%']
Workers federated accuracies:  ['62.952%', '64.021%', '65.027%', '65.861%', '66.374%', '67.102%', '67.529%', '67.957%', '68.856%', '69.134%']
Workers improved  accuracies:  ['23.380%', '23.123%', '22.759%', '22.545%', '21.668%', '20.684%', '19.872%', '18.781%', '18.053%', '17.433%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 2:
Federated model validation accuracy : 75.2667%
Leave-one-out validation accuracies :  ['75.3333%', '75.4000%', '75.6000%', '75.8000%', '76.2000%', '76.3333%', '76.6000%', '76.4667%', '76.8667%', '76.8000%']
Computed and normalized credits:  tensor([0.1025, 0.1023, 0.1017, 0.1009, 0.0998, 0.0993, 0.0987, 0.0989, 0.0980,
        0.0980])
Federated model performance: Loss: 0.516725. Accuracy: 74.7380%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['41.326%', '45.176%', '49.989%', '53.070%', '57.497%', '60.834%', '62.524%', '64.107%', '66.096%', '67.615%']
Workers federated accuracies:  ['69.540%', '70.439%', '70.759%', '71.166%', '71.765%', '72.257%', '72.749%', '73.134%', '73.305%', '73.775%']
Workers improved  accuracies:  ['29.968%', '29.540%', '28.492%', '27.850%', '27.059%', '25.840%', '25.091%', '23.957%', '22.503%', '22.075%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 3:
Federated model validation accuracy : 76.6000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6667%', '76.8667%', '76.9333%', '76.7333%', '76.7333%', '76.8000%', '77.0667%', '77.0000%']
Computed and normalized credits:  tensor([0.1008, 0.1008, 0.1005, 0.1000, 0.0997, 0.1000, 0.0999, 0.0998, 0.0991,
        0.0993])
Federated model performance: Loss: 0.491138. Accuracy: 75.9572%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['42.225%', '47.914%', '53.775%', '57.690%', '61.775%', '64.941%', '66.396%', '68.086%', '69.840%', '71.294%']
Workers federated accuracies:  ['71.957%', '72.663%', '73.326%', '73.540%', '73.690%', '74.203%', '74.631%', '75.059%', '75.080%', '75.187%']
Workers improved  accuracies:  ['32.385%', '31.765%', '31.059%', '30.225%', '28.984%', '27.786%', '26.973%', '25.882%', '24.278%', '23.487%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 4:
Federated model validation accuracy : 77.3333%
Leave-one-out validation accuracies :  ['77.3333%', '77.3333%', '77.2667%', '77.1333%', '77.1333%', '77.2000%', '77.1333%', '77.0667%', '77.1333%', '77.4667%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.1000, 0.1002, 0.1001, 0.1000, 0.1002, 0.1003, 0.1000,
        0.0994])
Federated model performance: Loss: 0.476121. Accuracy: 76.5348%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['42.952%', '50.139%', '57.369%', '60.663%', '64.385%', '67.979%', '69.540%', '71.016%', '72.107%', '73.134%']
Workers federated accuracies:  ['73.091%', '73.497%', '74.267%', '74.845%', '74.824%', '75.273%', '75.380%', '75.508%', '75.743%', '75.872%']
Workers improved  accuracies:  ['33.519%', '32.599%', '32.000%', '31.529%', '30.118%', '28.856%', '27.722%', '26.332%', '24.941%', '24.171%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 5:
Federated model validation accuracy : 77.2667%
Leave-one-out validation accuracies :  ['77.2667%', '77.2667%', '77.2667%', '77.2000%', '77.2000%', '77.2667%', '77.2667%', '77.6000%', '77.6000%', '77.8000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.1004, 0.1004, 0.1002, 0.1002, 0.0996, 0.0995,
        0.0990])
Federated model performance: Loss: 0.466637. Accuracy: 77.1765%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['43.807%', '52.235%', '60.385%', '63.465%', '66.973%', '70.011%', '71.658%', '72.813%', '73.668%', '74.610%']
Workers federated accuracies:  ['73.882%', '74.374%', '74.995%', '75.273%', '75.316%', '75.701%', '75.957%', '76.299%', '76.299%', '76.727%']
Workers improved  accuracies:  ['34.310%', '33.476%', '32.727%', '31.957%', '30.610%', '29.283%', '28.299%', '27.123%', '25.497%', '25.027%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 6:
Federated model validation accuracy : 77.5333%
Leave-one-out validation accuracies :  ['77.5333%', '77.4667%', '77.5333%', '77.5333%', '77.7333%', '77.9333%', '77.9333%', '78.2667%', '78.0667%', '78.0667%']
Computed and normalized credits:  tensor([0.1006, 0.1007, 0.1006, 0.1006, 0.1002, 0.0998, 0.0998, 0.0990, 0.0994,
        0.0993])
Federated model performance: Loss: 0.460311. Accuracy: 77.5187%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['44.770%', '54.332%', '62.802%', '65.583%', '69.241%', '71.722%', '72.984%', '73.947%', '74.759%', '75.316%']
Workers federated accuracies:  ['74.439%', '75.016%', '75.636%', '75.872%', '76.128%', '76.278%', '76.620%', '76.684%', '76.813%', '77.155%']
Workers improved  accuracies:  ['34.866%', '34.118%', '33.369%', '32.556%', '31.422%', '29.861%', '28.963%', '27.508%', '26.011%', '25.455%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 7:
Federated model validation accuracy : 77.8667%
Leave-one-out validation accuracies :  ['77.8667%', '77.8667%', '77.9333%', '78.0000%', '78.0667%', '78.2000%', '78.2000%', '78.3333%', '78.5333%', '78.7333%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1006, 0.1005, 0.1002, 0.0999, 0.0999, 0.0995, 0.0992,
        0.0988])
Federated model performance: Loss: 0.456422. Accuracy: 78.1390%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['45.775%', '56.556%', '64.471%', '67.401%', '70.930%', '72.599%', '73.882%', '74.824%', '75.273%', '76.021%']
Workers federated accuracies:  ['74.952%', '75.465%', '75.957%', '76.428%', '76.642%', '76.578%', '76.877%', '77.091%', '76.941%', '77.583%']
Workers improved  accuracies:  ['35.380%', '34.567%', '33.690%', '33.112%', '31.936%', '30.160%', '29.219%', '27.914%', '26.139%', '25.882%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 8:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4667%', '78.4000%', '78.4667%', '78.4000%', '78.4667%', '78.6000%', '78.6667%', '78.9333%', '79.0000%', '79.0667%']
Computed and normalized credits:  tensor([0.1005, 0.1006, 0.1005, 0.1006, 0.1004, 0.1001, 0.0999, 0.0993, 0.0992,
        0.0990])
Federated model performance: Loss: 0.453587. Accuracy: 78.5882%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['46.781%', '58.759%', '66.160%', '68.791%', '71.850%', '73.626%', '74.717%', '75.230%', '75.594%', '76.513%']
Workers federated accuracies:  ['76.021%', '76.385%', '76.706%', '77.219%', '77.348%', '77.326%', '77.647%', '77.775%', '77.754%', '78.225%']
Workers improved  accuracies:  ['36.449%', '35.487%', '34.439%', '33.904%', '32.642%', '30.909%', '29.989%', '28.599%', '26.952%', '26.524%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 9:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.6000%', '78.8667%', '79.2000%', '79.0000%', '79.0667%', '79.1333%', '78.9333%', '79.0000%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1007, 0.1002, 0.0995, 0.0998, 0.0997, 0.0994, 0.0998,
        0.0996])
Federated model performance: Loss: 0.450568. Accuracy: 78.6738%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['47.829%', '60.214%', '67.551%', '69.797%', '72.877%', '74.246%', '75.273%', '75.658%', '76.000%', '77.070%']
Workers federated accuracies:  ['76.278%', '76.578%', '77.005%', '77.433%', '77.433%', '77.561%', '77.840%', '77.989%', '77.882%', '78.439%']
Workers improved  accuracies:  ['36.706%', '35.679%', '34.738%', '34.118%', '32.727%', '31.144%', '30.182%', '28.813%', '27.080%', '26.738%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 10:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.2667%', '79.0000%', '79.0667%', '79.0667%', '79.1333%', '79.0667%', '79.2000%', '79.1333%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.0998, 0.1003, 0.1000, 0.1001, 0.0999, 0.1000, 0.0998,
        0.0999])
Federated model performance: Loss: 0.448146. Accuracy: 79.0160%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['48.749%', '61.733%', '68.556%', '71.144%', '73.476%', '74.695%', '75.679%', '75.829%', '76.449%', '77.326%']
Workers federated accuracies:  ['76.535%', '76.984%', '77.262%', '77.604%', '77.540%', '77.797%', '78.118%', '78.118%', '78.225%', '78.588%']
Workers improved  accuracies:  ['36.963%', '36.086%', '34.995%', '34.289%', '32.834%', '31.380%', '30.460%', '28.941%', '27.422%', '26.888%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 11:
Federated model validation accuracy : 79.0667%
Leave-one-out validation accuracies :  ['79.1333%', '79.1333%', '79.2000%', '79.2667%', '79.2000%', '79.1333%', '79.2000%', '79.1333%', '79.0667%', '79.3333%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.0999, 0.0999, 0.1000, 0.1001, 0.1000, 0.1001, 0.1002,
        0.0997])
Federated model performance: Loss: 0.446311. Accuracy: 79.1872%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['49.690%', '63.059%', '69.561%', '72.000%', '73.882%', '75.037%', '75.979%', '76.171%', '76.599%', '77.540%']
Workers federated accuracies:  ['76.856%', '77.198%', '77.519%', '77.840%', '77.668%', '78.011%', '78.289%', '78.460%', '78.374%', '78.866%']
Workers improved  accuracies:  ['37.283%', '36.299%', '35.251%', '34.524%', '32.963%', '31.594%', '30.631%', '29.283%', '27.572%', '27.166%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 12:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '79.2000%', '79.1333%', '79.2000%', '79.2000%', '79.1333%', '79.4000%', '79.3333%', '79.4000%', '79.4000%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1002, 0.1001, 0.1001, 0.1003, 0.0997, 0.0999, 0.0998,
        0.0997])
Federated model performance: Loss: 0.444789. Accuracy: 79.3583%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['50.610%', '64.128%', '70.610%', '72.342%', '74.374%', '75.337%', '76.171%', '76.449%', '76.898%', '77.604%']
Workers federated accuracies:  ['77.070%', '77.198%', '77.733%', '77.797%', '77.818%', '78.096%', '78.374%', '78.460%', '78.524%', '78.930%']
Workers improved  accuracies:  ['37.497%', '36.299%', '35.465%', '34.481%', '33.112%', '31.679%', '30.717%', '29.283%', '27.722%', '27.230%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 13:
Federated model validation accuracy : 79.2667%
Leave-one-out validation accuracies :  ['79.2667%', '79.2667%', '79.2667%', '79.4000%', '79.4000%', '79.3333%', '79.3333%', '79.4000%', '79.5333%', '79.4000%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1002, 0.0999, 0.0999, 0.1001, 0.1000, 0.0999, 0.0996,
        0.0999])
Federated model performance: Loss: 0.443610. Accuracy: 79.4652%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['51.380%', '64.898%', '71.936%', '72.963%', '74.802%', '75.636%', '76.257%', '76.856%', '77.134%', '77.797%']
Workers federated accuracies:  ['77.134%', '77.326%', '77.861%', '77.968%', '78.011%', '78.225%', '78.588%', '78.781%', '78.781%', '79.123%']
Workers improved  accuracies:  ['37.562%', '36.428%', '35.594%', '34.652%', '33.305%', '31.807%', '30.930%', '29.604%', '27.979%', '27.422%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 14:
Federated model validation accuracy : 79.2667%
Leave-one-out validation accuracies :  ['79.3333%', '79.4000%', '79.4000%', '79.5333%', '79.4667%', '79.6000%', '79.4667%', '79.4000%', '79.3333%', '79.3333%']
Computed and normalized credits:  tensor([0.1002, 0.1001, 0.1001, 0.0998, 0.0999, 0.0997, 0.0999, 0.1000, 0.1001,
        0.1002])
Federated model performance: Loss: 0.442988. Accuracy: 79.4225%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['51.936%', '66.096%', '72.642%', '73.561%', '74.995%', '75.807%', '76.513%', '77.027%', '77.155%', '77.861%']
Workers federated accuracies:  ['77.241%', '77.540%', '77.840%', '78.139%', '78.096%', '78.332%', '78.888%', '78.824%', '78.888%', '79.230%']
Workers improved  accuracies:  ['37.668%', '36.642%', '35.572%', '34.824%', '33.390%', '31.914%', '31.230%', '29.647%', '28.086%', '27.529%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 15:
Federated model validation accuracy : 79.4667%
Leave-one-out validation accuracies :  ['79.5333%', '79.5333%', '79.5333%', '79.5333%', '79.4667%', '79.4667%', '79.6000%', '79.6667%', '79.6667%', '79.7333%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1001, 0.1000, 0.1002, 0.1002, 0.0999, 0.0998, 0.0998,
        0.0997])
Federated model performance: Loss: 0.442707. Accuracy: 79.5080%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['52.941%', '66.588%', '73.155%', '74.289%', '75.209%', '75.872%', '76.834%', '77.027%', '77.561%', '78.118%']
Workers federated accuracies:  ['77.283%', '77.818%', '77.968%', '78.225%', '78.225%', '78.503%', '79.059%', '78.973%', '79.059%', '79.294%']
Workers improved  accuracies:  ['37.711%', '36.920%', '35.701%', '34.909%', '33.519%', '32.086%', '31.401%', '29.797%', '28.257%', '27.594%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 16:
Federated model validation accuracy : 79.5333%
Leave-one-out validation accuracies :  ['79.5333%', '79.6667%', '79.6000%', '79.8000%', '79.7333%', '79.7333%', '79.8000%', '79.8000%', '79.7333%', '79.8667%']
Computed and normalized credits:  tensor([0.1004, 0.1001, 0.1003, 0.0999, 0.1000, 0.1000, 0.0998, 0.0998, 0.1000,
        0.0997])
Federated model performance: Loss: 0.442353. Accuracy: 79.5508%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['53.390%', '67.316%', '73.647%', '74.588%', '75.529%', '76.171%', '77.005%', '77.198%', '77.583%', '78.139%']
Workers federated accuracies:  ['77.433%', '77.818%', '78.053%', '78.353%', '78.332%', '78.545%', '79.037%', '79.166%', '79.209%', '79.337%']
Workers improved  accuracies:  ['37.861%', '36.920%', '35.786%', '35.037%', '33.626%', '32.128%', '31.380%', '29.989%', '28.406%', '27.636%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 17:
Federated model validation accuracy : 79.9333%
Leave-one-out validation accuracies :  ['79.8667%', '79.8000%', '79.8000%', '79.8000%', '79.7333%', '79.8667%', '79.8667%', '79.8000%', '79.9333%', '80.1333%']
Computed and normalized credits:  tensor([0.1001, 0.1001, 0.1002, 0.1001, 0.1003, 0.1000, 0.1000, 0.1001, 0.0998,
        0.0994])
Federated model performance: Loss: 0.442416. Accuracy: 79.4866%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['54.524%', '68.000%', '74.096%', '74.888%', '75.658%', '76.321%', '77.198%', '77.326%', '77.583%', '78.139%']
Workers federated accuracies:  ['77.647%', '77.925%', '78.182%', '78.374%', '78.439%', '78.674%', '79.187%', '79.123%', '79.358%', '79.380%']
Workers improved  accuracies:  ['38.075%', '37.027%', '35.914%', '35.059%', '33.733%', '32.257%', '31.529%', '29.947%', '28.556%', '27.679%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 18:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['79.9333%', '79.9333%', '79.8667%', '79.8667%', '79.9333%', '79.8667%', '80.0000%', '80.0667%', '80.4667%', '80.5333%']
Computed and normalized credits:  tensor([0.1002, 0.1002, 0.1004, 0.1004, 0.1003, 0.1003, 0.1001, 0.1000, 0.0992,
        0.0990])
Federated model performance: Loss: 0.442512. Accuracy: 79.4652%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['55.209%', '68.620%', '74.460%', '75.166%', '75.743%', '76.556%', '77.390%', '77.519%', '77.797%', '78.460%']
Workers federated accuracies:  ['77.604%', '77.968%', '78.203%', '78.524%', '78.588%', '78.738%', '79.316%', '79.209%', '79.444%', '79.444%']
Workers improved  accuracies:  ['38.032%', '37.070%', '35.936%', '35.209%', '33.882%', '32.321%', '31.658%', '30.032%', '28.642%', '27.743%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 19:
Federated model validation accuracy : 80.2667%
Leave-one-out validation accuracies :  ['80.2667%', '80.2000%', '80.2000%', '80.2667%', '80.3333%', '80.3333%', '80.3333%', '80.4000%', '80.4000%', '80.4667%']
Computed and normalized credits:  tensor([0.1001, 0.1003, 0.1003, 0.1002, 0.1000, 0.1000, 0.1000, 0.0998, 0.0997,
        0.0995])
Federated model performance: Loss: 0.442743. Accuracy: 79.5294%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['56.107%', '69.176%', '74.738%', '75.508%', '75.957%', '76.684%', '77.561%', '77.604%', '78.032%', '78.610%']
Workers federated accuracies:  ['77.604%', '78.075%', '78.417%', '78.781%', '78.717%', '78.802%', '79.337%', '79.273%', '79.508%', '79.551%']
Workers improved  accuracies:  ['38.032%', '37.176%', '36.150%', '35.465%', '34.011%', '32.385%', '31.679%', '30.096%', '28.706%', '27.850%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Epoch 20:
Federated model validation accuracy : 80.5333%
Leave-one-out validation accuracies :  ['80.5333%', '80.5333%', '80.3333%', '80.4000%', '80.3333%', '80.4000%', '80.4000%', '80.4000%', '80.4667%', '80.4667%']
Computed and normalized credits:  tensor([0.0998, 0.0998, 0.1002, 0.1001, 0.1002, 0.1001, 0.1000, 0.1000, 0.0999,
        0.0998])
Federated model performance: Loss: 0.443258. Accuracy: 79.5936%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['56.684%', '69.754%', '75.080%', '75.893%', '76.171%', '76.856%', '77.733%', '77.818%', '78.118%', '78.695%']
Workers federated accuracies:  ['77.775%', '78.203%', '78.460%', '78.781%', '78.845%', '79.059%', '79.444%', '79.209%', '79.551%', '79.636%']
Workers improved  accuracies:  ['38.203%', '37.305%', '36.193%', '35.465%', '34.139%', '32.642%', '31.786%', '30.032%', '28.749%', '27.936%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.443258. Accuracy: 79.5936%.
Workers before    accuracies:  ['39.572%', '40.898%', '42.267%', '43.316%', '44.706%', '46.417%', '47.658%', '49.176%', '50.802%', '51.701%']
Workers standlone accuracies:  ['56.684%', '69.754%', '75.080%', '75.893%', '76.171%', '76.856%', '77.733%', '77.818%', '78.118%', '78.695%']
Workers federated accuracies:  ['77.775%', '78.203%', '78.460%', '78.781%', '78.845%', '79.059%', '79.444%', '79.209%', '79.551%', '79.636%']
Workers improved  accuracies:  ['38.203%', '37.305%', '36.193%', '35.465%', '34.139%', '32.642%', '31.786%', '30.032%', '28.749%', '27.936%']
Workers shard sizes:  [160, 432, 704, 960, 1232, 1488, 1760, 2016, 2288, 2544]
Workers sharing_contributions :  tensor([ 16.0000,  43.2000,  70.4000,  96.0000, 123.2000, 148.8000, 176.0000,
        201.6000, 228.8000, 254.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.39040996288119334, 0.2646758709700715)
Correlation between stand alone test acc & collaborative final model acc:  (0.8568733187367494, 0.0015390409572419396)
Correlation between test_acc & sharing contributions:  (0.9683182852584526, 4.242337165210902e-06)
Correlation between test_acc improvements & sharing_contributions:  (-0.9966886376409565, 5.239358457792294e-10)
standalone_vs_final_corr [[0.8735747749271434], [0.9001091765319406], [0.9058893305976723], [0.871405205503078], [0.8568733187367494]]
standalone_vs_final_corr_mean [0.8815703612593166]
standalone_vs_final_corr_std [0.018505694491683773]
sharingcontribution_vs_final_corr [[0.8600237632976422], [0.9280558201718163], [0.9729167389791633], [0.8833841461254426], [0.9683182852584526]]
sharingcontribution_vs_final_corr_mean [0.9225397507665034]
sharingcontribution_vs_final_corr_std [0.044956317125198694]
standalone_vs_federated_perturbed_corr [[0.7158208426905426], [0.1261028586432133], [0.5556779017821672], [0.41483055186725337], [-0.39040996288119334]]
standalone_vs_federated_perturbed_corr_mean [0.28440443842039664]
standalone_vs_federated_perturbed_corr_std [0.3891411680175973]
federated_final_performance [0.8049197793006897, 0.7910160422325134, 0.7978609800338745, 0.7963636517524719, 0.7959358096122742]
federated_final_performance_mean 0.7972192525863647
federated_final_performance_std 0.004484841650353965
CFFL_best_worker [0.7950801849365234, 0.7942246198654175, 0.7970053553581238, 0.796577513217926, 0.7963636517524719]
CFFL_best_worker_mean 0.7958502650260926
CFFL_best_worker_std 0.0010356094892648145
standalone_best_worker [0.7824599146842957, 0.7828876972198486, 0.7820320725440979, 0.7828876972198486, 0.7869518995285034]
standalone_best_worker_mean 0.7834438562393189
standalone_best_worker_std 0.0017824852097261404
