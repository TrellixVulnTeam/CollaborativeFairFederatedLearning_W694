Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 15000, 'n_workers': 5, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 20, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.692498. Accuracy: 60.7273%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['74.2000%', '74.7333%', '75.8000%', '75.5333%', '74.7333%']
Computed and normalized credits:  tensor([0.2029, 0.2010, 0.1971, 0.1981, 0.2010])
Federated model performance: Loss: 0.589038. Accuracy: 73.7112%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['50.567%', '61.968%', '68.364%', '71.957%', '73.968%']
Workers federated accuracies:  ['68.257%', '71.187%', '72.449%', '74.075%', '74.759%']
Workers improved  accuracies:  ['19.209%', '15.957%', '11.679%', '9.091%', '6.503%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 2:
Federated model validation accuracy : 76.3333%
Leave-one-out validation accuracies :  ['76.3333%', '76.2667%', '76.2000%', '76.2000%', '76.5333%']
Computed and normalized credits:  tensor([0.2007, 0.2004, 0.1995, 0.1998, 0.1995])
Federated model performance: Loss: 0.551980. Accuracy: 75.8075%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['51.872%', '66.802%', '71.936%', '74.631%', '75.807%']
Workers federated accuracies:  ['72.235%', '73.775%', '75.144%', '76.021%', '76.449%']
Workers improved  accuracies:  ['23.187%', '18.545%', '14.374%', '11.037%', '8.193%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 3:
Federated model validation accuracy : 76.3333%
Leave-one-out validation accuracies :  ['76.2667%', '76.2667%', '76.6667%', '77.1333%', '77.2000%']
Computed and normalized credits:  tensor([0.2018, 0.2017, 0.2000, 0.1984, 0.1981])
Federated model performance: Loss: 0.535476. Accuracy: 76.2995%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['53.947%', '69.668%', '74.053%', '76.086%', '77.027%']
Workers federated accuracies:  ['73.476%', '75.337%', '76.193%', '76.791%', '77.198%']
Workers improved  accuracies:  ['24.428%', '20.107%', '15.422%', '11.807%', '8.941%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 4:
Federated model validation accuracy : 77.3333%
Leave-one-out validation accuracies :  ['77.2667%', '77.4000%', '77.3333%', '77.2667%', '77.3333%']
Computed and normalized credits:  tensor([0.2007, 0.2002, 0.2000, 0.1997, 0.1994])
Federated model performance: Loss: 0.526278. Accuracy: 77.0909%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['55.594%', '71.529%', '74.995%', '77.369%', '77.604%']
Workers federated accuracies:  ['74.930%', '76.150%', '76.984%', '77.369%', '77.561%']
Workers improved  accuracies:  ['25.882%', '20.920%', '16.214%', '12.385%', '9.305%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 5:
Federated model validation accuracy : 77.5333%
Leave-one-out validation accuracies :  ['77.5333%', '77.5333%', '77.3333%', '77.4667%', '77.5333%']
Computed and normalized credits:  tensor([0.2000, 0.1999, 0.2005, 0.2000, 0.1996])
Federated model performance: Loss: 0.520241. Accuracy: 77.6043%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['56.877%', '72.813%', '76.171%', '77.583%', '77.925%']
Workers federated accuracies:  ['75.679%', '77.027%', '77.583%', '78.118%', '78.032%']
Workers improved  accuracies:  ['26.631%', '21.797%', '16.813%', '13.134%', '9.775%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 6:
Federated model validation accuracy : 77.6667%
Leave-one-out validation accuracies :  ['77.6000%', '77.7333%', '77.8000%', '78.0000%', '77.8667%']
Computed and normalized credits:  tensor([0.2007, 0.2002, 0.2001, 0.1993, 0.1997])
Federated model performance: Loss: 0.514923. Accuracy: 77.8396%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['58.203%', '73.882%', '76.791%', '77.968%', '78.225%']
Workers federated accuracies:  ['76.278%', '77.497%', '78.011%', '78.203%', '78.738%']
Workers improved  accuracies:  ['27.230%', '22.267%', '17.241%', '13.219%', '10.481%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 7:
Federated model validation accuracy : 77.7333%
Leave-one-out validation accuracies :  ['77.7333%', '77.7333%', '77.9333%', '77.7333%', '78.0667%']
Computed and normalized credits:  tensor([0.2006, 0.2004, 0.1997, 0.2002, 0.1991])
Federated model performance: Loss: 0.511038. Accuracy: 78.3102%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['59.807%', '74.695%', '77.070%', '78.118%', '78.545%']
Workers federated accuracies:  ['76.877%', '78.118%', '78.289%', '78.567%', '79.016%']
Workers improved  accuracies:  ['27.829%', '22.888%', '17.519%', '13.583%', '10.759%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 8:
Federated model validation accuracy : 77.8667%
Leave-one-out validation accuracies :  ['77.9333%', '77.8000%', '77.8667%', '77.9333%', '78.0000%']
Computed and normalized credits:  tensor([0.2001, 0.2005, 0.2001, 0.2000, 0.1994])
Federated model performance: Loss: 0.508256. Accuracy: 78.3957%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['61.155%', '75.230%', '77.112%', '78.203%', '78.674%']
Workers federated accuracies:  ['77.412%', '78.439%', '78.610%', '78.888%', '79.123%']
Workers improved  accuracies:  ['28.364%', '23.209%', '17.840%', '13.904%', '10.866%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 9:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.0667%', '78.0000%', '78.0000%', '78.0667%', '78.3333%']
Computed and normalized credits:  tensor([0.2001, 0.2005, 0.2003, 0.2001, 0.1990])
Federated model performance: Loss: 0.506352. Accuracy: 78.7166%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['62.203%', '75.765%', '77.433%', '78.481%', '78.909%']
Workers federated accuracies:  ['77.690%', '78.439%', '78.888%', '78.973%', '79.123%']
Workers improved  accuracies:  ['28.642%', '23.209%', '18.118%', '13.989%', '10.866%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 10:
Federated model validation accuracy : 78.1333%
Leave-one-out validation accuracies :  ['78.0667%', '78.0000%', '78.0667%', '78.4000%', '78.4667%']
Computed and normalized credits:  tensor([0.2005, 0.2008, 0.2006, 0.1993, 0.1988])
Federated model performance: Loss: 0.504969. Accuracy: 78.8449%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['63.209%', '76.086%', '77.626%', '78.588%', '79.123%']
Workers federated accuracies:  ['77.668%', '78.610%', '78.952%', '78.888%', '79.209%']
Workers improved  accuracies:  ['28.620%', '23.380%', '18.182%', '13.904%', '10.952%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 11:
Federated model validation accuracy : 78.4667%
Leave-one-out validation accuracies :  ['78.5333%', '78.5333%', '78.4000%', '78.4667%', '78.9333%']
Computed and normalized credits:  tensor([0.2003, 0.2004, 0.2008, 0.2002, 0.1984])
Federated model performance: Loss: 0.503684. Accuracy: 79.0802%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['64.128%', '76.449%', '77.797%', '78.781%', '79.230%']
Workers federated accuracies:  ['77.989%', '78.674%', '78.995%', '79.102%', '79.487%']
Workers improved  accuracies:  ['28.941%', '23.444%', '18.225%', '14.118%', '11.230%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 12:
Federated model validation accuracy : 78.3333%
Leave-one-out validation accuracies :  ['78.4000%', '78.4667%', '78.4667%', '78.6000%', '78.7333%']
Computed and normalized credits:  tensor([0.2005, 0.2003, 0.2004, 0.1998, 0.1989])
Federated model performance: Loss: 0.502737. Accuracy: 79.2513%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['64.877%', '76.813%', '78.011%', '78.824%', '79.444%']
Workers federated accuracies:  ['78.246%', '78.888%', '79.123%', '79.166%', '79.786%']
Workers improved  accuracies:  ['29.198%', '23.658%', '18.353%', '14.182%', '11.529%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 13:
Federated model validation accuracy : 78.7333%
Leave-one-out validation accuracies :  ['78.8000%', '78.6000%', '78.6667%', '78.8667%', '78.6667%']
Computed and normalized credits:  tensor([0.1999, 0.2005, 0.2003, 0.1995, 0.1999])
Federated model performance: Loss: 0.501809. Accuracy: 79.4438%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['65.989%', '77.219%', '78.182%', '79.059%', '79.615%']
Workers federated accuracies:  ['78.417%', '79.102%', '79.337%', '79.465%', '80.064%']
Workers improved  accuracies:  ['29.369%', '23.872%', '18.567%', '14.481%', '11.807%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 14:
Federated model validation accuracy : 78.8667%
Leave-one-out validation accuracies :  ['78.8000%', '78.8000%', '78.7333%', '78.6000%', '78.8000%']
Computed and normalized credits:  tensor([0.1998, 0.2000, 0.2001, 0.2003, 0.1998])
Federated model performance: Loss: 0.501313. Accuracy: 79.4866%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['66.952%', '77.348%', '78.417%', '79.187%', '79.765%']
Workers federated accuracies:  ['78.524%', '79.187%', '79.508%', '79.679%', '80.257%']
Workers improved  accuracies:  ['29.476%', '23.957%', '18.738%', '14.695%', '12.000%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 15:
Federated model validation accuracy : 78.7333%
Leave-one-out validation accuracies :  ['78.7333%', '78.6000%', '78.7333%', '78.9333%', '79.0000%']
Computed and normalized credits:  tensor([0.2002, 0.2007, 0.2003, 0.1996, 0.1993])
Federated model performance: Loss: 0.500648. Accuracy: 79.7005%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['67.444%', '77.455%', '78.652%', '79.316%', '79.829%']
Workers federated accuracies:  ['78.503%', '79.422%', '79.636%', '79.914%', '80.449%']
Workers improved  accuracies:  ['29.455%', '24.193%', '18.866%', '14.930%', '12.193%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 16:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8000%', '78.8667%', '78.8667%', '78.9333%', '78.9333%']
Computed and normalized credits:  tensor([0.2003, 0.2002, 0.2001, 0.1997, 0.1996])
Federated model performance: Loss: 0.500003. Accuracy: 79.8075%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['68.214%', '77.476%', '78.717%', '79.422%', '80.064%']
Workers federated accuracies:  ['78.631%', '79.551%', '79.807%', '80.193%', '80.578%']
Workers improved  accuracies:  ['29.583%', '24.321%', '19.037%', '15.209%', '12.321%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 17:
Federated model validation accuracy : 78.8667%
Leave-one-out validation accuracies :  ['78.8000%', '78.9333%', '78.8667%', '79.0667%', '79.0000%']
Computed and normalized credits:  tensor([0.2005, 0.2001, 0.2003, 0.1995, 0.1997])
Federated model performance: Loss: 0.499599. Accuracy: 79.9144%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['68.791%', '77.626%', '78.930%', '79.679%', '80.150%']
Workers federated accuracies:  ['78.738%', '79.636%', '79.893%', '80.278%', '80.706%']
Workers improved  accuracies:  ['29.690%', '24.406%', '19.123%', '15.294%', '12.449%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 18:
Federated model validation accuracy : 78.9333%
Leave-one-out validation accuracies :  ['78.9333%', '79.0000%', '79.0000%', '79.0667%', '78.9333%']
Computed and normalized credits:  tensor([0.2003, 0.2000, 0.2000, 0.1996, 0.2001])
Federated model performance: Loss: 0.499098. Accuracy: 80.0214%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['69.412%', '77.797%', '79.037%', '79.722%', '80.299%']
Workers federated accuracies:  ['78.866%', '79.722%', '79.872%', '80.342%', '80.834%']
Workers improved  accuracies:  ['29.818%', '24.492%', '19.102%', '15.358%', '12.578%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 19:
Federated model validation accuracy : 79.0667%
Leave-one-out validation accuracies :  ['79.1333%', '79.0667%', '79.0667%', '79.0000%', '79.0000%']
Computed and normalized credits:  tensor([0.1998, 0.1999, 0.2000, 0.2001, 0.2002])
Federated model performance: Loss: 0.498204. Accuracy: 80.0428%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['69.775%', '77.882%', '79.187%', '79.722%', '80.257%']
Workers federated accuracies:  ['78.909%', '79.829%', '79.979%', '80.342%', '80.920%']
Workers improved  accuracies:  ['29.861%', '24.599%', '19.209%', '15.358%', '12.663%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 20:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '78.9333%', '79.0000%', '79.0667%', '79.1333%']
Computed and normalized credits:  tensor([0.2000, 0.2003, 0.2001, 0.1999, 0.1997])
Federated model performance: Loss: 0.497393. Accuracy: 80.1069%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['69.968%', '78.011%', '79.230%', '79.829%', '80.321%']
Workers federated accuracies:  ['78.973%', '79.786%', '80.193%', '80.364%', '80.877%']
Workers improved  accuracies:  ['29.925%', '24.556%', '19.422%', '15.380%', '12.620%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.497393. Accuracy: 80.1069%.
Workers before    accuracies:  ['49.048%', '55.230%', '60.770%', '64.984%', '68.257%']
Workers standlone accuracies:  ['69.968%', '78.011%', '79.230%', '79.829%', '80.321%']
Workers federated accuracies:  ['78.973%', '79.786%', '80.193%', '80.364%', '80.877%']
Workers improved  accuracies:  ['29.925%', '24.556%', '19.422%', '15.380%', '12.620%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]
Workers sharing_contributions :  tensor([  64.0000,  304.0000,  540.8000,  780.8000, 1017.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.3915063230721219, 0.5145630909652693)
Correlation between stand alone test acc & collaborative final model acc:  (0.924389453057368, 0.02467286349386216)
Correlation between test_acc & sharing contributions:  (0.9731242093088766, 0.005267652924677909)
Correlation between test_acc improvements & sharing_contributions:  (-0.9924908953097131, 0.0007802365974555885)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.757052. Accuracy: 48.1283%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 70.6000%
Leave-one-out validation accuracies :  ['70.9333%', '71.4667%', '73.0000%', '73.7333%', '74.3333%']
Computed and normalized credits:  tensor([0.2068, 0.2047, 0.1988, 0.1960, 0.1938])
Federated model performance: Loss: 0.578313. Accuracy: 70.9519%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['40.984%', '49.947%', '59.743%', '64.963%', '69.070%']
Workers federated accuracies:  ['60.406%', '64.963%', '68.299%', '70.182%', '71.872%']
Workers improved  accuracies:  ['20.492%', '21.390%', '19.422%', '16.706%', '13.754%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 2:
Federated model validation accuracy : 73.9333%
Leave-one-out validation accuracies :  ['73.8667%', '73.6667%', '73.9333%', '74.4667%', '74.9333%']
Computed and normalized credits:  tensor([0.2031, 0.2032, 0.2005, 0.1978, 0.1955])
Federated model performance: Loss: 0.522840. Accuracy: 73.9679%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['41.968%', '56.043%', '66.160%', '70.396%', '73.326%']
Workers federated accuracies:  ['66.460%', '70.952%', '72.727%', '74.225%', '75.037%']
Workers improved  accuracies:  ['26.545%', '27.380%', '23.850%', '20.749%', '16.920%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 3:
Federated model validation accuracy : 74.7333%
Leave-one-out validation accuracies :  ['74.7333%', '75.0000%', '75.2000%', '75.4000%', '76.0667%']
Computed and normalized credits:  tensor([0.2028, 0.2019, 0.2004, 0.1989, 0.1959])
Federated model performance: Loss: 0.496980. Accuracy: 75.4866%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['42.909%', '60.791%', '69.989%', '73.604%', '75.765%']
Workers federated accuracies:  ['70.267%', '73.540%', '75.230%', '75.957%', '76.257%']
Workers improved  accuracies:  ['30.353%', '29.968%', '26.353%', '22.481%', '18.139%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 4:
Federated model validation accuracy : 75.9333%
Leave-one-out validation accuracies :  ['75.8667%', '75.8000%', '75.9333%', '76.6000%', '76.6667%']
Computed and normalized credits:  tensor([0.2019, 0.2019, 0.2010, 0.1982, 0.1971])
Federated model performance: Loss: 0.481907. Accuracy: 76.3209%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['43.551%', '64.727%', '72.492%', '75.658%', '76.791%']
Workers federated accuracies:  ['72.235%', '74.866%', '75.872%', '76.364%', '76.513%']
Workers improved  accuracies:  ['32.321%', '31.294%', '26.995%', '22.888%', '18.396%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 5:
Federated model validation accuracy : 76.4667%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.6000%', '76.6000%', '76.9333%']
Computed and normalized credits:  tensor([0.2008, 0.2008, 0.2005, 0.1997, 0.1982])
Federated model performance: Loss: 0.472372. Accuracy: 76.8770%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['44.856%', '67.936%', '73.947%', '76.620%', '77.283%']
Workers federated accuracies:  ['73.198%', '75.957%', '76.428%', '76.684%', '77.005%']
Workers improved  accuracies:  ['33.283%', '32.385%', '27.551%', '23.209%', '18.888%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 6:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8667%', '76.7333%', '76.7333%', '76.6667%', '76.8667%']
Computed and normalized credits:  tensor([0.1999, 0.2004, 0.2003, 0.2003, 0.1992])
Federated model performance: Loss: 0.465915. Accuracy: 77.1337%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['46.267%', '69.754%', '74.909%', '77.155%', '77.390%']
Workers federated accuracies:  ['74.075%', '76.385%', '76.642%', '77.241%', '77.369%']
Workers improved  accuracies:  ['34.160%', '32.813%', '27.765%', '23.765%', '19.251%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 7:
Federated model validation accuracy : 76.8667%
Leave-one-out validation accuracies :  ['76.9333%', '76.8667%', '77.0000%', '77.0000%', '76.9333%']
Computed and normalized credits:  tensor([0.2000, 0.2004, 0.1999, 0.1999, 0.1998])
Federated model performance: Loss: 0.461112. Accuracy: 77.2406%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['47.893%', '71.594%', '75.658%', '77.497%', '77.583%']
Workers federated accuracies:  ['74.781%', '76.770%', '76.791%', '77.604%', '77.711%']
Workers improved  accuracies:  ['34.866%', '33.198%', '27.914%', '24.128%', '19.594%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 8:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.1333%', '77.1333%', '77.2000%', '77.2000%', '77.3333%']
Computed and normalized credits:  tensor([0.2002, 0.2003, 0.2000, 0.2000, 0.1995])
Federated model performance: Loss: 0.457003. Accuracy: 77.4759%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['49.668%', '72.684%', '76.021%', '77.690%', '77.840%']
Workers federated accuracies:  ['75.187%', '77.112%', '77.134%', '77.925%', '77.925%']
Workers improved  accuracies:  ['35.273%', '33.540%', '28.257%', '24.449%', '19.807%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 9:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.2000%', '77.2000%', '77.2000%', '77.4000%', '77.4667%']
Computed and normalized credits:  tensor([0.2004, 0.2004, 0.2003, 0.1996, 0.1993])
Federated model performance: Loss: 0.453355. Accuracy: 77.7326%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['50.802%', '73.455%', '76.342%', '78.075%', '78.118%']
Workers federated accuracies:  ['75.551%', '77.348%', '77.561%', '78.225%', '78.118%']
Workers improved  accuracies:  ['35.636%', '33.775%', '28.684%', '24.749%', '20.000%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 10:
Federated model validation accuracy : 77.4667%
Leave-one-out validation accuracies :  ['77.4667%', '77.3333%', '77.4000%', '77.4667%', '77.6000%']
Computed and normalized credits:  tensor([0.2001, 0.2005, 0.2003, 0.1998, 0.1993])
Federated model performance: Loss: 0.450450. Accuracy: 77.9251%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['52.406%', '74.332%', '76.578%', '78.225%', '78.182%']
Workers federated accuracies:  ['75.829%', '77.519%', '77.797%', '78.396%', '78.289%']
Workers improved  accuracies:  ['35.914%', '33.947%', '28.920%', '24.920%', '20.171%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 11:
Federated model validation accuracy : 77.6667%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.7333%']
Computed and normalized credits:  tensor([0.2001, 0.2002, 0.2002, 0.2000, 0.1994])
Federated model performance: Loss: 0.448107. Accuracy: 78.2032%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['53.690%', '74.866%', '76.856%', '78.203%', '78.417%']
Workers federated accuracies:  ['76.128%', '77.690%', '77.818%', '78.674%', '78.417%']
Workers improved  accuracies:  ['36.214%', '34.118%', '28.941%', '25.198%', '20.299%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 12:
Federated model validation accuracy : 77.7333%
Leave-one-out validation accuracies :  ['77.7333%', '77.8000%', '77.6000%', '77.8000%', '78.1333%']
Computed and normalized credits:  tensor([0.2003, 0.2001, 0.2008, 0.2001, 0.1987])
Federated model performance: Loss: 0.446202. Accuracy: 78.3315%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['54.524%', '75.380%', '76.920%', '78.353%', '78.439%']
Workers federated accuracies:  ['76.620%', '78.011%', '78.011%', '78.845%', '78.759%']
Workers improved  accuracies:  ['36.706%', '34.439%', '29.134%', '25.369%', '20.642%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 13:
Federated model validation accuracy : 77.8667%
Leave-one-out validation accuracies :  ['77.8667%', '77.8000%', '77.9333%', '78.1333%', '78.2667%']
Computed and normalized credits:  tensor([0.2005, 0.2007, 0.2005, 0.1996, 0.1987])
Federated model performance: Loss: 0.444801. Accuracy: 78.6096%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['55.829%', '75.786%', '77.070%', '78.396%', '78.481%']
Workers federated accuracies:  ['76.984%', '78.139%', '78.096%', '79.016%', '78.759%']
Workers improved  accuracies:  ['37.070%', '34.567%', '29.219%', '25.540%', '20.642%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 14:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.2000%', '78.1333%', '78.2000%', '78.4000%', '78.5333%']
Computed and normalized credits:  tensor([0.2005, 0.2008, 0.2005, 0.1995, 0.1988])
Federated model performance: Loss: 0.443882. Accuracy: 78.7594%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['57.027%', '76.150%', '77.305%', '78.439%', '78.524%']
Workers federated accuracies:  ['77.198%', '78.332%', '78.267%', '79.230%', '79.102%']
Workers improved  accuracies:  ['37.283%', '34.759%', '29.390%', '25.754%', '20.984%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 15:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.3333%', '78.3333%', '78.4667%', '78.6667%']
Computed and normalized credits:  tensor([0.2003, 0.2006, 0.2005, 0.1998, 0.1989])
Federated model performance: Loss: 0.443179. Accuracy: 78.9946%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['58.053%', '76.428%', '77.348%', '78.588%', '78.631%']
Workers federated accuracies:  ['77.262%', '78.567%', '78.524%', '79.422%', '79.273%']
Workers improved  accuracies:  ['37.348%', '34.995%', '29.647%', '25.947%', '21.155%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 16:
Federated model validation accuracy : 78.5333%
Leave-one-out validation accuracies :  ['78.5333%', '78.5333%', '78.5333%', '78.8000%', '78.9333%']
Computed and normalized credits:  tensor([0.2005, 0.2006, 0.2006, 0.1995, 0.1988])
Federated model performance: Loss: 0.442727. Accuracy: 79.0802%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['59.401%', '76.727%', '77.348%', '78.759%', '78.845%']
Workers federated accuracies:  ['77.305%', '78.888%', '78.738%', '79.444%', '79.358%']
Workers improved  accuracies:  ['37.390%', '35.316%', '29.861%', '25.968%', '21.241%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 17:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.6000%', '78.8000%', '78.8000%', '78.9333%']
Computed and normalized credits:  tensor([0.2005, 0.2007, 0.2000, 0.1997, 0.1991])
Federated model performance: Loss: 0.442410. Accuracy: 79.1444%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['60.107%', '77.091%', '77.326%', '78.845%', '78.909%']
Workers federated accuracies:  ['77.604%', '79.016%', '78.930%', '79.487%', '79.636%']
Workers improved  accuracies:  ['37.690%', '35.444%', '30.053%', '26.011%', '21.519%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 18:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '78.8667%', '78.8000%', '78.9333%', '79.2667%']
Computed and normalized credits:  tensor([0.2000, 0.2006, 0.2006, 0.2001, 0.1987])
Federated model performance: Loss: 0.442288. Accuracy: 79.1658%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['61.305%', '77.241%', '77.583%', '78.909%', '79.059%']
Workers federated accuracies:  ['77.540%', '79.059%', '79.102%', '79.465%', '79.722%']
Workers improved  accuracies:  ['37.626%', '35.487%', '30.225%', '25.989%', '21.604%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 19:
Federated model validation accuracy : 79.0667%
Leave-one-out validation accuracies :  ['79.0000%', '78.9333%', '79.2667%', '79.3333%', '79.6000%']
Computed and normalized credits:  tensor([0.2008, 0.2012, 0.2000, 0.1997, 0.1984])
Federated model performance: Loss: 0.442254. Accuracy: 79.2299%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['62.203%', '77.348%', '77.754%', '79.080%', '79.080%']
Workers federated accuracies:  ['77.604%', '79.251%', '79.187%', '79.508%', '79.765%']
Workers improved  accuracies:  ['37.690%', '35.679%', '30.310%', '26.032%', '21.647%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 20:
Federated model validation accuracy : 79.2667%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.4667%', '79.6000%', '79.6000%']
Computed and normalized credits:  tensor([0.2005, 0.2006, 0.2001, 0.1995, 0.1992])
Federated model performance: Loss: 0.442226. Accuracy: 79.4652%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['62.866%', '77.540%', '77.840%', '79.080%', '78.952%']
Workers federated accuracies:  ['77.797%', '79.187%', '79.273%', '79.529%', '79.786%']
Workers improved  accuracies:  ['37.882%', '35.615%', '30.396%', '26.053%', '21.668%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.442226. Accuracy: 79.4652%.
Workers before    accuracies:  ['39.914%', '43.572%', '48.877%', '53.476%', '58.118%']
Workers standlone accuracies:  ['62.866%', '77.540%', '77.840%', '79.080%', '78.952%']
Workers federated accuracies:  ['77.797%', '79.187%', '79.273%', '79.529%', '79.786%']
Workers improved  accuracies:  ['37.882%', '35.615%', '30.396%', '26.053%', '21.668%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]
Workers sharing_contributions :  tensor([  64.0000,  304.0000,  540.8000,  780.8000, 1017.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.586685535157956, 0.2984026556868771)
Correlation between stand alone test acc & collaborative final model acc:  (0.9746770714833809, 0.004818903240941697)
Correlation between test_acc & sharing contributions:  (0.8845262724774687, 0.04627959246038499)
Correlation between test_acc improvements & sharing_contributions:  (-0.9942832926911217, 0.0005184179529660037)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.680849. Accuracy: 61.3262%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.6667%
Leave-one-out validation accuracies :  ['71.6667%', '72.4667%', '73.9333%', '74.8000%', '75.9333%']
Computed and normalized credits:  tensor([0.2079, 0.2048, 0.1993, 0.1960, 0.1919])
Federated model performance: Loss: 0.559529. Accuracy: 73.3476%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['53.583%', '62.310%', '66.845%', '70.824%', '73.219%']
Workers federated accuracies:  ['68.000%', '70.545%', '72.342%', '73.198%', '73.711%']
Workers improved  accuracies:  ['16.513%', '12.578%', '10.738%', '9.134%', '7.230%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 2:
Federated model validation accuracy : 74.2667%
Leave-one-out validation accuracies :  ['74.3333%', '75.0000%', '75.6000%', '76.0667%', '76.0667%']
Computed and normalized credits:  tensor([0.2062, 0.2029, 0.1991, 0.1965, 0.1953])
Federated model performance: Loss: 0.518087. Accuracy: 75.4652%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['56.128%', '65.283%', '70.610%', '74.481%', '75.273%']
Workers federated accuracies:  ['72.406%', '74.096%', '74.695%', '75.551%', '76.150%']
Workers improved  accuracies:  ['20.920%', '16.128%', '13.091%', '11.487%', '9.668%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 3:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.9333%', '76.2000%', '76.3333%', '76.7333%', '76.7333%']
Computed and normalized credits:  tensor([0.2034, 0.2015, 0.1999, 0.1978, 0.1974])
Federated model performance: Loss: 0.500167. Accuracy: 76.5134%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['57.583%', '67.872%', '72.706%', '75.807%', '76.578%']
Workers federated accuracies:  ['73.840%', '75.166%', '76.193%', '77.070%', '77.455%']
Workers improved  accuracies:  ['22.353%', '17.198%', '14.588%', '13.005%', '10.973%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 4:
Federated model validation accuracy : 76.3333%
Leave-one-out validation accuracies :  ['76.3333%', '76.4667%', '76.6667%', '76.8667%', '77.1333%']
Computed and normalized credits:  tensor([0.2022, 0.2012, 0.2001, 0.1987, 0.1977])
Federated model performance: Loss: 0.489697. Accuracy: 76.9412%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['58.674%', '70.481%', '74.118%', '76.920%', '77.604%']
Workers federated accuracies:  ['75.037%', '75.786%', '76.856%', '77.519%', '77.882%']
Workers improved  accuracies:  ['23.551%', '17.818%', '15.251%', '13.455%', '11.401%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 5:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '76.9333%', '76.9333%', '77.4667%', '77.5333%']
Computed and normalized credits:  tensor([0.2018, 0.2010, 0.2007, 0.1985, 0.1979])
Federated model performance: Loss: 0.480165. Accuracy: 77.5187%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['59.572%', '72.535%', '75.080%', '77.369%', '78.096%']
Workers federated accuracies:  ['75.615%', '76.791%', '77.433%', '78.396%', '78.439%']
Workers improved  accuracies:  ['24.128%', '18.824%', '15.829%', '14.332%', '11.957%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 6:
Federated model validation accuracy : 77.3333%
Leave-one-out validation accuracies :  ['77.3333%', '77.5333%', '77.6667%', '77.6667%', '77.8000%']
Computed and normalized credits:  tensor([0.2014, 0.2005, 0.2000, 0.1993, 0.1987])
Federated model performance: Loss: 0.473313. Accuracy: 77.9893%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['60.578%', '73.497%', '75.957%', '77.989%', '78.503%']
Workers federated accuracies:  ['75.914%', '77.326%', '77.840%', '78.524%', '78.631%']
Workers improved  accuracies:  ['24.428%', '19.358%', '16.235%', '14.460%', '12.150%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 7:
Federated model validation accuracy : 77.7333%
Leave-one-out validation accuracies :  ['77.7333%', '77.6667%', '77.6000%', '77.8000%', '77.7333%']
Computed and normalized credits:  tensor([0.2003, 0.2003, 0.2004, 0.1995, 0.1995])
Federated model performance: Loss: 0.468030. Accuracy: 78.0963%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['61.540%', '74.503%', '76.556%', '78.310%', '78.631%']
Workers federated accuracies:  ['76.406%', '77.818%', '78.246%', '78.652%', '78.695%']
Workers improved  accuracies:  ['24.920%', '19.850%', '16.642%', '14.588%', '12.214%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 8:
Federated model validation accuracy : 77.7333%
Leave-one-out validation accuracies :  ['77.7333%', '77.7333%', '77.9333%', '77.9333%', '78.2000%']
Computed and normalized credits:  tensor([0.2007, 0.2007, 0.2000, 0.1998, 0.1989])
Federated model performance: Loss: 0.463870. Accuracy: 78.2246%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['62.289%', '74.930%', '76.856%', '78.610%', '78.738%']
Workers federated accuracies:  ['76.877%', '78.246%', '78.460%', '78.717%', '78.888%']
Workers improved  accuracies:  ['25.390%', '20.278%', '16.856%', '14.652%', '12.406%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 9:
Federated model validation accuracy : 77.8667%
Leave-one-out validation accuracies :  ['77.9333%', '77.9333%', '78.0667%', '78.1333%', '78.2000%']
Computed and normalized credits:  tensor([0.2006, 0.2006, 0.2000, 0.1997, 0.1992])
Federated model performance: Loss: 0.460583. Accuracy: 78.2246%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['62.802%', '75.743%', '77.455%', '78.738%', '78.845%']
Workers federated accuracies:  ['77.112%', '78.439%', '78.567%', '78.695%', '79.016%']
Workers improved  accuracies:  ['25.626%', '20.471%', '16.963%', '14.631%', '12.535%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 10:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.0667%', '78.1333%', '78.2000%', '78.3333%', '78.4000%']
Computed and normalized credits:  tensor([0.2007, 0.2005, 0.2001, 0.1995, 0.1992])
Federated model performance: Loss: 0.457179. Accuracy: 78.5241%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['63.551%', '76.193%', '77.540%', '78.930%', '79.080%']
Workers federated accuracies:  ['77.412%', '78.588%', '78.717%', '78.973%', '79.273%']
Workers improved  accuracies:  ['25.925%', '20.620%', '17.112%', '14.909%', '12.791%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 11:
Federated model validation accuracy : 78.3333%
Leave-one-out validation accuracies :  ['78.3333%', '78.3333%', '78.3333%', '78.4667%', '78.4667%']
Computed and normalized credits:  tensor([0.2004, 0.2003, 0.2002, 0.1996, 0.1995])
Federated model performance: Loss: 0.454221. Accuracy: 78.6310%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['64.107%', '76.663%', '77.754%', '79.080%', '79.209%']
Workers federated accuracies:  ['77.818%', '78.952%', '78.759%', '79.080%', '79.465%']
Workers improved  accuracies:  ['26.332%', '20.984%', '17.155%', '15.016%', '12.984%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 12:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4000%', '78.5333%', '78.6000%', '78.5333%']
Computed and normalized credits:  tensor([0.2004, 0.2004, 0.1999, 0.1995, 0.1997])
Federated model performance: Loss: 0.451324. Accuracy: 78.8021%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['64.770%', '76.941%', '77.968%', '79.316%', '79.316%']
Workers federated accuracies:  ['78.182%', '78.888%', '78.952%', '79.273%', '79.636%']
Workers improved  accuracies:  ['26.695%', '20.920%', '17.348%', '15.209%', '13.155%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 13:
Federated model validation accuracy : 78.4667%
Leave-one-out validation accuracies :  ['78.5333%', '78.5333%', '78.6000%', '78.6667%', '78.7333%']
Computed and normalized credits:  tensor([0.2004, 0.2004, 0.2000, 0.1997, 0.1995])
Federated model performance: Loss: 0.449070. Accuracy: 78.9091%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['65.369%', '77.283%', '78.011%', '79.316%', '79.422%']
Workers federated accuracies:  ['78.396%', '79.080%', '79.144%', '79.551%', '79.765%']
Workers improved  accuracies:  ['26.909%', '21.112%', '17.540%', '15.487%', '13.283%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 14:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.6667%', '78.6667%', '78.8000%', '78.6000%']
Computed and normalized credits:  tensor([0.2002, 0.2002, 0.2001, 0.1995, 0.2001])
Federated model performance: Loss: 0.446884. Accuracy: 79.0374%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['65.840%', '77.604%', '78.118%', '79.187%', '79.529%']
Workers federated accuracies:  ['78.374%', '79.380%', '79.273%', '79.936%', '79.786%']
Workers improved  accuracies:  ['26.888%', '21.412%', '17.668%', '15.872%', '13.305%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 15:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.7333%', '78.6000%', '78.6000%', '78.4000%']
Computed and normalized credits:  tensor([0.1998, 0.1996, 0.2000, 0.1999, 0.2007])
Federated model performance: Loss: 0.444600. Accuracy: 79.1444%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['66.545%', '77.925%', '78.203%', '79.251%', '79.572%']
Workers federated accuracies:  ['78.353%', '79.444%', '79.294%', '79.979%', '79.979%']
Workers improved  accuracies:  ['26.866%', '21.476%', '17.690%', '15.914%', '13.497%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 16:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.6667%', '78.6000%', '78.2667%']
Computed and normalized credits:  tensor([0.1998, 0.1997, 0.1996, 0.1998, 0.2012])
Federated model performance: Loss: 0.442565. Accuracy: 79.1444%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['67.102%', '77.989%', '78.267%', '79.230%', '79.743%']
Workers federated accuracies:  ['78.460%', '79.594%', '79.508%', '80.107%', '80.086%']
Workers improved  accuracies:  ['26.973%', '21.626%', '17.904%', '16.043%', '13.604%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 17:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4667%', '78.4667%', '78.4000%', '78.4000%', '78.6000%']
Computed and normalized credits:  tensor([0.1999, 0.1999, 0.2001, 0.2002, 0.1999])
Federated model performance: Loss: 0.440820. Accuracy: 79.4225%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['67.465%', '78.182%', '78.439%', '79.316%', '79.679%']
Workers federated accuracies:  ['78.545%', '79.594%', '79.722%', '80.193%', '80.128%']
Workers improved  accuracies:  ['27.059%', '21.626%', '18.118%', '16.128%', '13.647%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 18:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2667%', '78.2667%', '78.4000%', '78.6000%', '78.6667%']
Computed and normalized credits:  tensor([0.2006, 0.2006, 0.2002, 0.1995, 0.1992])
Federated model performance: Loss: 0.439320. Accuracy: 79.5080%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['68.128%', '78.139%', '78.396%', '79.422%', '79.829%']
Workers federated accuracies:  ['78.545%', '79.572%', '79.765%', '80.128%', '80.171%']
Workers improved  accuracies:  ['27.059%', '21.604%', '18.160%', '16.064%', '13.690%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 19:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.5333%', '78.6000%', '78.6667%']
Computed and normalized credits:  tensor([0.2002, 0.2002, 0.2003, 0.1999, 0.1995])
Federated model performance: Loss: 0.437885. Accuracy: 79.6150%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['68.898%', '78.289%', '78.503%', '79.572%', '79.914%']
Workers federated accuracies:  ['78.588%', '79.529%', '79.850%', '80.257%', '80.107%']
Workers improved  accuracies:  ['27.102%', '21.561%', '18.246%', '16.193%', '13.626%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 20:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6667%', '78.6000%', '78.6667%', '78.7333%', '78.6667%']
Computed and normalized credits:  tensor([0.2000, 0.2003, 0.2001, 0.1997, 0.1999])
Federated model performance: Loss: 0.436568. Accuracy: 79.6578%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['69.604%', '78.289%', '78.524%', '79.636%', '79.936%']
Workers federated accuracies:  ['78.717%', '79.508%', '79.914%', '80.128%', '80.193%']
Workers improved  accuracies:  ['27.230%', '21.540%', '18.310%', '16.064%', '13.711%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.436568. Accuracy: 79.6578%.
Workers before    accuracies:  ['51.487%', '57.968%', '61.604%', '64.064%', '66.481%']
Workers standlone accuracies:  ['69.604%', '78.289%', '78.524%', '79.636%', '79.936%']
Workers federated accuracies:  ['78.717%', '79.508%', '79.914%', '80.128%', '80.193%']
Workers improved  accuracies:  ['27.230%', '21.540%', '18.310%', '16.064%', '13.711%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]
Workers sharing_contributions :  tensor([  64.0000,  304.0000,  540.8000,  780.8000, 1017.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.21329515225239626, 0.7304976791286778)
Correlation between stand alone test acc & collaborative final model acc:  (0.9504406137342152, 0.013145213307342104)
Correlation between test_acc & sharing contributions:  (0.9303425450097365, 0.021837086623483142)
Correlation between test_acc improvements & sharing_contributions:  (-0.978049249754494, 0.003891103325252782)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.647977. Accuracy: 68.8342%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 74.1333%
Leave-one-out validation accuracies :  ['74.2000%', '74.7333%', '75.0000%', '75.6667%', '76.5333%']
Computed and normalized credits:  tensor([0.2037, 0.2018, 0.2008, 0.1984, 0.1953])
Federated model performance: Loss: 0.573952. Accuracy: 73.1765%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['65.455%', '69.476%', '71.230%', '72.920%', '73.711%']
Workers federated accuracies:  ['70.374%', '71.872%', '72.749%', '73.754%', '74.310%']
Workers improved  accuracies:  ['5.412%', '4.749%', '3.957%', '3.444%', '2.973%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 2:
Federated model validation accuracy : 76.1333%
Leave-one-out validation accuracies :  ['76.0667%', '76.2000%', '76.2667%', '77.0000%', '77.5333%']
Computed and normalized credits:  tensor([0.2030, 0.2020, 0.2014, 0.1982, 0.1954])
Federated model performance: Loss: 0.535382. Accuracy: 74.6096%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['65.968%', '71.080%', '72.578%', '74.160%', '74.930%']
Workers federated accuracies:  ['72.406%', '73.561%', '74.353%', '74.888%', '75.187%']
Workers improved  accuracies:  ['7.444%', '6.438%', '5.562%', '4.578%', '3.850%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 3:
Federated model validation accuracy : 77.1333%
Leave-one-out validation accuracies :  ['77.1333%', '77.2000%', '77.4000%', '77.7333%', '77.8667%']
Computed and normalized credits:  tensor([0.2020, 0.2015, 0.2006, 0.1985, 0.1973])
Federated model performance: Loss: 0.512335. Accuracy: 75.5294%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['66.652%', '72.171%', '73.561%', '75.080%', '75.658%']
Workers federated accuracies:  ['73.326%', '74.374%', '74.930%', '75.679%', '75.850%']
Workers improved  accuracies:  ['8.364%', '7.251%', '6.139%', '5.369%', '4.513%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 4:
Federated model validation accuracy : 77.6667%
Leave-one-out validation accuracies :  ['77.6000%', '77.3333%', '77.8000%', '78.0000%', '78.2667%']
Computed and normalized credits:  tensor([0.2013, 0.2020, 0.2002, 0.1989, 0.1976])
Federated model performance: Loss: 0.497603. Accuracy: 76.6845%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['67.166%', '72.877%', '74.160%', '75.743%', '76.235%']
Workers federated accuracies:  ['74.139%', '75.059%', '75.658%', '76.299%', '76.684%']
Workers improved  accuracies:  ['9.176%', '7.936%', '6.866%', '5.989%', '5.348%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 5:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.2667%', '78.1333%', '78.5333%', '79.1333%']
Computed and normalized credits:  tensor([0.2018, 0.2011, 0.2010, 0.1993, 0.1968])
Federated model performance: Loss: 0.488167. Accuracy: 77.1337%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['67.572%', '73.390%', '74.824%', '76.235%', '76.535%']
Workers federated accuracies:  ['74.503%', '75.658%', '76.193%', '77.048%', '77.348%']
Workers improved  accuracies:  ['9.540%', '8.535%', '7.401%', '6.738%', '6.011%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 6:
Federated model validation accuracy : 78.6667%
Leave-one-out validation accuracies :  ['78.6000%', '78.8000%', '78.7333%', '79.2000%', '79.1333%']
Computed and normalized credits:  tensor([0.2015, 0.2006, 0.2008, 0.1987, 0.1983])
Federated model performance: Loss: 0.481506. Accuracy: 77.4759%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['68.021%', '74.096%', '75.209%', '76.578%', '76.706%']
Workers federated accuracies:  ['75.294%', '76.214%', '76.471%', '77.561%', '77.840%']
Workers improved  accuracies:  ['10.332%', '9.091%', '7.679%', '7.251%', '6.503%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 7:
Federated model validation accuracy : 79.1333%
Leave-one-out validation accuracies :  ['79.1333%', '79.4000%', '79.2000%', '79.0667%', '79.2667%']
Computed and normalized credits:  tensor([0.2007, 0.1995, 0.2003, 0.2001, 0.1993])
Federated model performance: Loss: 0.476745. Accuracy: 78.0963%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['68.513%', '74.353%', '75.273%', '76.791%', '77.048%']
Workers federated accuracies:  ['75.722%', '76.877%', '77.091%', '78.118%', '78.353%']
Workers improved  accuracies:  ['10.759%', '9.754%', '8.299%', '7.807%', '7.016%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 8:
Federated model validation accuracy : 79.2667%
Leave-one-out validation accuracies :  ['79.2667%', '79.2000%', '79.2667%', '79.1333%', '79.4667%']
Computed and normalized credits:  tensor([0.2002, 0.2001, 0.2001, 0.2005, 0.1991])
Federated model performance: Loss: 0.472661. Accuracy: 78.4813%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['69.027%', '74.738%', '75.508%', '76.963%', '77.348%']
Workers federated accuracies:  ['76.150%', '77.262%', '77.604%', '78.545%', '78.888%']
Workers improved  accuracies:  ['11.187%', '10.139%', '8.813%', '8.235%', '7.551%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 9:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['79.2667%', '79.2667%', '79.3333%', '79.4000%', '79.6667%']
Computed and normalized credits:  tensor([0.2005, 0.2004, 0.2002, 0.2001, 0.1988])
Federated model performance: Loss: 0.469805. Accuracy: 78.7380%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['69.455%', '74.995%', '75.679%', '77.155%', '77.797%']
Workers federated accuracies:  ['76.449%', '77.711%', '78.032%', '78.909%', '79.080%']
Workers improved  accuracies:  ['11.487%', '10.588%', '9.241%', '8.599%', '7.743%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 10:
Federated model validation accuracy : 79.4667%
Leave-one-out validation accuracies :  ['79.4667%', '79.4667%', '79.7333%', '79.8667%', '80.0000%']
Computed and normalized credits:  tensor([0.2009, 0.2009, 0.2000, 0.1995, 0.1987])
Federated model performance: Loss: 0.467467. Accuracy: 78.8877%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['69.797%', '75.187%', '75.893%', '77.433%', '77.968%']
Workers federated accuracies:  ['76.791%', '78.011%', '78.460%', '79.059%', '79.316%']
Workers improved  accuracies:  ['11.829%', '10.888%', '9.668%', '8.749%', '7.979%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 11:
Federated model validation accuracy : 79.7333%
Leave-one-out validation accuracies :  ['79.7333%', '79.7333%', '79.9333%', '80.3333%', '80.2000%']
Computed and normalized credits:  tensor([0.2011, 0.2011, 0.2002, 0.1987, 0.1989])
Federated model performance: Loss: 0.465360. Accuracy: 79.0588%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['70.118%', '75.465%', '76.021%', '77.754%', '78.310%']
Workers federated accuracies:  ['77.155%', '78.289%', '78.717%', '79.123%', '79.294%']
Workers improved  accuracies:  ['12.193%', '11.166%', '9.925%', '8.813%', '7.957%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 12:
Federated model validation accuracy : 79.9333%
Leave-one-out validation accuracies :  ['79.9333%', '80.2000%', '80.2667%', '80.2000%', '80.4667%']
Computed and normalized credits:  tensor([0.2013, 0.2004, 0.1999, 0.1997, 0.1988])
Federated model performance: Loss: 0.463370. Accuracy: 79.1872%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['70.524%', '75.850%', '76.107%', '78.032%', '78.439%']
Workers federated accuracies:  ['77.369%', '78.481%', '78.824%', '79.380%', '79.551%']
Workers improved  accuracies:  ['12.406%', '11.358%', '10.032%', '9.070%', '8.214%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 13:
Federated model validation accuracy : 80.2667%
Leave-one-out validation accuracies :  ['80.2000%', '80.2667%', '80.4667%', '80.4667%', '80.6000%']
Computed and normalized credits:  tensor([0.2010, 0.2005, 0.1997, 0.1997, 0.1990])
Federated model performance: Loss: 0.461610. Accuracy: 79.2299%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['70.695%', '76.107%', '76.235%', '78.267%', '78.781%']
Workers federated accuracies:  ['77.604%', '78.588%', '78.824%', '79.529%', '79.829%']
Workers improved  accuracies:  ['12.642%', '11.465%', '10.032%', '9.219%', '8.492%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 14:
Federated model validation accuracy : 80.6000%
Leave-one-out validation accuracies :  ['80.6000%', '80.4667%', '80.5333%', '80.6000%', '80.5333%']
Computed and normalized credits:  tensor([0.2001, 0.2004, 0.2000, 0.1997, 0.1998])
Federated model performance: Loss: 0.460113. Accuracy: 79.2299%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['71.037%', '76.043%', '76.364%', '78.374%', '78.888%']
Workers federated accuracies:  ['77.626%', '78.824%', '78.930%', '79.679%', '80.021%']
Workers improved  accuracies:  ['12.663%', '11.701%', '10.139%', '9.369%', '8.684%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 15:
Federated model validation accuracy : 80.3333%
Leave-one-out validation accuracies :  ['80.4667%', '80.5333%', '80.6000%', '80.6000%', '80.4667%']
Computed and normalized credits:  tensor([0.2003, 0.2001, 0.1998, 0.1997, 0.2002])
Federated model performance: Loss: 0.458973. Accuracy: 79.1872%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['71.251%', '76.214%', '76.556%', '78.310%', '79.144%']
Workers federated accuracies:  ['77.840%', '78.888%', '79.016%', '79.765%', '80.171%']
Workers improved  accuracies:  ['12.877%', '11.765%', '10.225%', '9.455%', '8.834%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 16:
Federated model validation accuracy : 80.5333%
Leave-one-out validation accuracies :  ['80.5333%', '80.4667%', '80.5333%', '80.6667%', '80.6667%']
Computed and normalized credits:  tensor([0.2002, 0.2004, 0.2001, 0.1996, 0.1997])
Federated model performance: Loss: 0.457911. Accuracy: 79.1658%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['71.508%', '76.278%', '76.770%', '78.417%', '79.294%']
Workers federated accuracies:  ['77.989%', '78.952%', '79.059%', '79.701%', '80.299%']
Workers improved  accuracies:  ['13.027%', '11.829%', '10.267%', '9.390%', '8.963%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 17:
Federated model validation accuracy : 80.4000%
Leave-one-out validation accuracies :  ['80.4000%', '80.5333%', '80.6000%', '80.6667%', '80.5333%']
Computed and normalized credits:  tensor([0.2005, 0.2002, 0.1998, 0.1995, 0.2000])
Federated model performance: Loss: 0.456923. Accuracy: 79.2727%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['71.679%', '76.428%', '76.834%', '78.759%', '79.251%']
Workers federated accuracies:  ['78.053%', '79.059%', '79.144%', '79.914%', '80.385%']
Workers improved  accuracies:  ['13.091%', '11.936%', '10.353%', '9.604%', '9.048%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 18:
Federated model validation accuracy : 80.7333%
Leave-one-out validation accuracies :  ['80.7333%', '80.7333%', '80.6000%', '80.6000%', '80.8667%']
Computed and normalized credits:  tensor([0.2001, 0.2000, 0.2003, 0.2002, 0.1995])
Federated model performance: Loss: 0.455956. Accuracy: 79.3155%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['71.786%', '76.535%', '77.219%', '78.995%', '79.337%']
Workers federated accuracies:  ['78.032%', '79.102%', '79.316%', '79.936%', '80.428%']
Workers improved  accuracies:  ['13.070%', '11.979%', '10.524%', '9.626%', '9.091%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 19:
Federated model validation accuracy : 80.6667%
Leave-one-out validation accuracies :  ['80.6667%', '80.6667%', '80.7333%', '80.8000%', '80.7333%']
Computed and normalized credits:  tensor([0.2002, 0.2002, 0.2000, 0.1998, 0.1998])
Federated model performance: Loss: 0.455140. Accuracy: 79.2727%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['72.064%', '76.727%', '77.305%', '78.952%', '79.444%']
Workers federated accuracies:  ['78.182%', '79.080%', '79.401%', '80.000%', '80.364%']
Workers improved  accuracies:  ['13.219%', '11.957%', '10.610%', '9.690%', '9.027%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 20:
Federated model validation accuracy : 80.8000%
Leave-one-out validation accuracies :  ['80.8000%', '80.7333%', '80.8667%', '80.7333%', '80.8667%']
Computed and normalized credits:  tensor([0.2001, 0.2003, 0.1998, 0.2002, 0.1997])
Federated model performance: Loss: 0.454385. Accuracy: 79.3797%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['72.299%', '76.706%', '77.540%', '79.187%', '79.572%']
Workers federated accuracies:  ['78.267%', '79.102%', '79.422%', '80.086%', '80.406%']
Workers improved  accuracies:  ['13.305%', '11.979%', '10.631%', '9.775%', '9.070%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.454385. Accuracy: 79.3797%.
Workers before    accuracies:  ['64.963%', '67.123%', '68.791%', '70.310%', '71.337%']
Workers standlone accuracies:  ['72.299%', '76.706%', '77.540%', '79.187%', '79.572%']
Workers federated accuracies:  ['78.267%', '79.102%', '79.422%', '80.086%', '80.406%']
Workers improved  accuracies:  ['13.305%', '11.979%', '10.631%', '9.775%', '9.070%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]
Workers sharing_contributions :  tensor([  64.0000,  304.0000,  540.8000,  780.8000, 1017.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.13637363042994682, 0.826903420268794)
Correlation between stand alone test acc & collaborative final model acc:  (0.9684461116001976, 0.00669648497263045)
Correlation between test_acc & sharing contributions:  (0.9878877282588745, 0.0015972821839258032)
Correlation between test_acc improvements & sharing_contributions:  (-0.9902403050075781, 0.0011557167737459787)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.723482. Accuracy: 53.9465%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.4000%
Leave-one-out validation accuracies :  ['71.4667%', '72.3333%', '74.4000%', '75.7333%', '76.3333%']
Computed and normalized credits:  tensor([0.2099, 0.2065, 0.1986, 0.1936, 0.1914])
Federated model performance: Loss: 0.585370. Accuracy: 71.8717%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['45.754%', '55.465%', '63.294%', '67.358%', '70.995%']
Workers federated accuracies:  ['63.080%', '67.230%', '69.989%', '71.743%', '73.005%']
Workers improved  accuracies:  ['18.524%', '17.840%', '15.658%', '13.176%', '10.930%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 2:
Federated model validation accuracy : 74.6000%
Leave-one-out validation accuracies :  ['74.8000%', '75.3333%', '76.1333%', '76.9333%', '76.8000%']
Computed and normalized credits:  tensor([0.2072, 0.2043, 0.1991, 0.1948, 0.1946])
Federated model performance: Loss: 0.532483. Accuracy: 74.5455%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['47.016%', '60.749%', '68.235%', '72.299%', '74.417%']
Workers federated accuracies:  ['69.155%', '72.128%', '73.561%', '74.866%', '75.358%']
Workers improved  accuracies:  ['24.599%', '22.738%', '19.230%', '16.299%', '13.283%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 3:
Federated model validation accuracy : 76.3333%
Leave-one-out validation accuracies :  ['76.4000%', '76.5333%', '76.6667%', '77.2667%', '77.5333%']
Computed and normalized credits:  tensor([0.2038, 0.2025, 0.2005, 0.1971, 0.1962])
Federated model performance: Loss: 0.507602. Accuracy: 75.7433%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['48.043%', '64.663%', '71.594%', '74.503%', '75.529%']
Workers federated accuracies:  ['71.701%', '73.989%', '75.316%', '76.043%', '76.214%']
Workers improved  accuracies:  ['27.144%', '24.599%', '20.984%', '17.476%', '14.139%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 4:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.8000%', '77.0000%', '77.1333%', '77.6000%', '77.4667%']
Computed and normalized credits:  tensor([0.2025, 0.2014, 0.2004, 0.1978, 0.1980])
Federated model performance: Loss: 0.492243. Accuracy: 76.3850%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['49.775%', '67.529%', '73.283%', '75.551%', '76.235%']
Workers federated accuracies:  ['73.326%', '75.209%', '75.936%', '76.471%', '76.749%']
Workers improved  accuracies:  ['28.770%', '25.818%', '21.604%', '17.904%', '14.674%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 5:
Federated model validation accuracy : 77.3333%
Leave-one-out validation accuracies :  ['77.3333%', '77.3333%', '77.3333%', '77.6000%', '77.9333%']
Computed and normalized credits:  tensor([0.2013, 0.2010, 0.2007, 0.1990, 0.1979])
Federated model performance: Loss: 0.480788. Accuracy: 76.9840%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['51.016%', '69.711%', '74.289%', '76.086%', '76.556%']
Workers federated accuracies:  ['73.989%', '75.957%', '76.556%', '76.620%', '77.027%']
Workers improved  accuracies:  ['29.433%', '26.567%', '22.225%', '18.053%', '14.952%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 6:
Federated model validation accuracy : 77.6667%
Leave-one-out validation accuracies :  ['77.6000%', '77.6667%', '78.0000%', '77.9333%', '78.2667%']
Computed and normalized credits:  tensor([0.2014, 0.2011, 0.1998, 0.1996, 0.1981])
Federated model performance: Loss: 0.472296. Accuracy: 77.4973%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['52.342%', '71.465%', '75.016%', '76.235%', '76.963%']
Workers federated accuracies:  ['74.588%', '76.706%', '76.727%', '76.877%', '77.455%']
Workers improved  accuracies:  ['30.032%', '27.316%', '22.396%', '18.310%', '15.380%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 7:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.0667%', '78.2000%', '78.0667%', '78.2667%', '78.3333%']
Computed and normalized credits:  tensor([0.2008, 0.2003, 0.2004, 0.1996, 0.1990])
Federated model performance: Loss: 0.466115. Accuracy: 78.0107%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['53.626%', '72.834%', '75.658%', '76.556%', '77.262%']
Workers federated accuracies:  ['75.144%', '76.984%', '77.048%', '77.390%', '77.754%']
Workers improved  accuracies:  ['30.588%', '27.594%', '22.717%', '18.824%', '15.679%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 8:
Federated model validation accuracy : 78.2667%
Leave-one-out validation accuracies :  ['78.3333%', '78.2000%', '78.1333%', '78.2667%', '78.3333%']
Computed and normalized credits:  tensor([0.2000, 0.2003, 0.2005, 0.1998, 0.1994])
Federated model performance: Loss: 0.461178. Accuracy: 78.3315%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['55.059%', '73.647%', '75.829%', '76.834%', '77.412%']
Workers federated accuracies:  ['75.615%', '77.283%', '77.412%', '77.775%', '78.203%']
Workers improved  accuracies:  ['31.059%', '27.893%', '23.080%', '19.209%', '16.128%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 9:
Federated model validation accuracy : 78.2667%
Leave-one-out validation accuracies :  ['78.2667%', '78.2667%', '78.2667%', '78.3333%', '78.1333%']
Computed and normalized credits:  tensor([0.1999, 0.2000, 0.2001, 0.1997, 0.2002])
Federated model performance: Loss: 0.457042. Accuracy: 78.8449%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['56.193%', '74.481%', '76.150%', '76.877%', '77.690%']
Workers federated accuracies:  ['75.936%', '77.561%', '77.818%', '78.118%', '78.481%']
Workers improved  accuracies:  ['31.380%', '28.171%', '23.487%', '19.551%', '16.406%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 10:
Federated model validation accuracy : 78.2667%
Leave-one-out validation accuracies :  ['78.2000%', '78.2667%', '78.3333%', '78.3333%', '78.1333%']
Computed and normalized credits:  tensor([0.2002, 0.2000, 0.1998, 0.1996, 0.2005])
Federated model performance: Loss: 0.453615. Accuracy: 78.9946%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['57.647%', '74.888%', '76.364%', '77.091%', '77.882%']
Workers federated accuracies:  ['76.128%', '77.647%', '78.182%', '78.310%', '78.781%']
Workers improved  accuracies:  ['31.572%', '28.257%', '23.850%', '19.743%', '16.706%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 11:
Federated model validation accuracy : 78.0667%
Leave-one-out validation accuracies :  ['78.1333%', '78.2000%', '78.2000%', '78.1333%', '78.0667%']
Computed and normalized credits:  tensor([0.2001, 0.1998, 0.1997, 0.1999, 0.2004])
Federated model performance: Loss: 0.450878. Accuracy: 79.1872%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['58.460%', '75.316%', '76.535%', '77.326%', '78.011%']
Workers federated accuracies:  ['76.321%', '77.840%', '78.332%', '78.460%', '78.802%']
Workers improved  accuracies:  ['31.765%', '28.449%', '24.000%', '19.893%', '16.727%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 12:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.2000%', '78.2667%', '78.2000%', '77.8667%', '78.1333%']
Computed and normalized credits:  tensor([0.1998, 0.1995, 0.1997, 0.2009, 0.2001])
Federated model performance: Loss: 0.448679. Accuracy: 79.1230%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['59.594%', '75.636%', '76.663%', '77.497%', '78.118%']
Workers federated accuracies:  ['76.578%', '78.053%', '78.588%', '78.631%', '78.909%']
Workers improved  accuracies:  ['32.021%', '28.663%', '24.257%', '20.064%', '16.834%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 13:
Federated model validation accuracy : 78.0000%
Leave-one-out validation accuracies :  ['78.0000%', '78.0667%', '78.0000%', '78.1333%', '78.2667%']
Computed and normalized credits:  tensor([0.2003, 0.1999, 0.2002, 0.2001, 0.1994])
Federated model performance: Loss: 0.446885. Accuracy: 79.2513%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['60.663%', '75.893%', '76.877%', '77.754%', '78.225%']
Workers federated accuracies:  ['76.727%', '78.139%', '78.674%', '78.866%', '79.080%']
Workers improved  accuracies:  ['32.171%', '28.749%', '24.342%', '20.299%', '17.005%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 14:
Federated model validation accuracy : 78.2000%
Leave-one-out validation accuracies :  ['78.1333%', '78.2000%', '78.2667%', '78.2667%', '78.4000%']
Computed and normalized credits:  tensor([0.2005, 0.2002, 0.2000, 0.2000, 0.1993])
Federated model performance: Loss: 0.445412. Accuracy: 79.2727%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['61.626%', '76.043%', '77.070%', '77.904%', '78.310%']
Workers federated accuracies:  ['76.856%', '78.353%', '78.738%', '79.037%', '79.487%']
Workers improved  accuracies:  ['32.299%', '28.963%', '24.406%', '20.471%', '17.412%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 15:
Federated model validation accuracy : 78.2667%
Leave-one-out validation accuracies :  ['78.2667%', '78.3333%', '78.2667%', '78.4667%', '78.6000%']
Computed and normalized credits:  tensor([0.2006, 0.2002, 0.2004, 0.1997, 0.1991])
Federated model performance: Loss: 0.444080. Accuracy: 79.3583%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['62.225%', '76.107%', '77.219%', '77.989%', '78.503%']
Workers federated accuracies:  ['77.155%', '78.503%', '79.080%', '79.251%', '79.722%']
Workers improved  accuracies:  ['32.599%', '29.112%', '24.749%', '20.684%', '17.647%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 16:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.3333%', '78.5333%', '78.6000%', '78.6667%']
Computed and normalized credits:  tensor([0.2005, 0.2007, 0.2000, 0.1996, 0.1992])
Federated model performance: Loss: 0.442938. Accuracy: 79.4866%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['63.059%', '76.321%', '77.219%', '78.139%', '78.545%']
Workers federated accuracies:  ['77.412%', '78.567%', '79.209%', '79.529%', '79.829%']
Workers improved  accuracies:  ['32.856%', '29.176%', '24.877%', '20.963%', '17.754%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 17:
Federated model validation accuracy : 78.5333%
Leave-one-out validation accuracies :  ['78.5333%', '78.6000%', '78.5333%', '78.8667%', '78.8667%']
Computed and normalized credits:  tensor([0.2007, 0.2005, 0.2005, 0.1992, 0.1991])
Federated model performance: Loss: 0.441932. Accuracy: 79.7433%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['64.021%', '76.321%', '77.433%', '78.460%', '78.652%']
Workers federated accuracies:  ['77.583%', '78.674%', '79.337%', '79.636%', '79.936%']
Workers improved  accuracies:  ['33.027%', '29.283%', '25.005%', '21.070%', '17.861%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 18:
Federated model validation accuracy : 78.7333%
Leave-one-out validation accuracies :  ['78.6000%', '78.8000%', '78.9333%', '78.9333%', '79.0000%']
Computed and normalized credits:  tensor([0.2010, 0.2003, 0.1999, 0.1995, 0.1993])
Federated model performance: Loss: 0.441117. Accuracy: 79.8503%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['64.727%', '76.428%', '77.561%', '78.588%', '78.802%']
Workers federated accuracies:  ['77.561%', '78.824%', '79.380%', '79.679%', '80.043%']
Workers improved  accuracies:  ['33.005%', '29.433%', '25.048%', '21.112%', '17.968%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 19:
Federated model validation accuracy : 78.8000%
Leave-one-out validation accuracies :  ['78.8667%', '78.9333%', '78.8000%', '79.0000%', '78.9333%']
Computed and normalized credits:  tensor([0.2004, 0.2000, 0.2003, 0.1995, 0.1997])
Federated model performance: Loss: 0.440390. Accuracy: 79.8289%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['65.241%', '76.599%', '77.690%', '78.738%', '78.909%']
Workers federated accuracies:  ['77.647%', '78.995%', '79.551%', '79.765%', '80.064%']
Workers improved  accuracies:  ['33.091%', '29.604%', '25.219%', '21.198%', '17.989%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Epoch 20:
Federated model validation accuracy : 78.9333%
Leave-one-out validation accuracies :  ['79.0000%', '78.9333%', '78.8667%', '79.0667%', '79.2000%']
Computed and normalized credits:  tensor([0.2002, 0.2003, 0.2006, 0.1997, 0.1993])
Federated model performance: Loss: 0.439847. Accuracy: 79.9144%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['66.118%', '76.620%', '77.690%', '78.802%', '79.080%']
Workers federated accuracies:  ['77.775%', '79.016%', '79.722%', '80.021%', '80.000%']
Workers improved  accuracies:  ['33.219%', '29.626%', '25.390%', '21.455%', '17.925%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.439847. Accuracy: 79.9144%.
Workers before    accuracies:  ['44.556%', '49.390%', '54.332%', '58.567%', '62.075%']
Workers standlone accuracies:  ['66.118%', '76.620%', '77.690%', '78.802%', '79.080%']
Workers federated accuracies:  ['77.775%', '79.016%', '79.722%', '80.021%', '80.000%']
Workers improved  accuracies:  ['33.219%', '29.626%', '25.390%', '21.455%', '17.925%']
Workers shard sizes:  [320, 1520, 2704, 3904, 5088]
Workers sharing_contributions :  tensor([  64.0000,  304.0000,  540.8000,  780.8000, 1017.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.17092348439455546, 0.7834378073371051)
Correlation between stand alone test acc & collaborative final model acc:  (0.9625709713054862, 0.008643572612446263)
Correlation between test_acc & sharing contributions:  (0.9104202653533569, 0.0317486453842317)
Correlation between test_acc improvements & sharing_contributions:  (-0.9995494392883144, 1.1479804245721421e-05)
standalone_vs_final_corr [[0.924389453057368], [0.9746770714833809], [0.9504406137342152], [0.9684461116001976], [0.9625709713054862]]
standalone_vs_final_corr_mean [0.9561048442361295]
standalone_vs_final_corr_std [0.017759475494240853]
sharingcontribution_vs_final_corr [[0.9731242093088766], [0.8845262724774687], [0.9303425450097365], [0.9878877282588745], [0.9104202653533569]]
sharingcontribution_vs_final_corr_mean [0.9372602040816627]
sharingcontribution_vs_final_corr_std [0.03846680890238287]
standalone_vs_federated_perturbed_corr [[0.3915063230721219], [0.586685535157956], [-0.21329515225239626], [-0.13637363042994682], [0.17092348439455546]]
standalone_vs_federated_perturbed_corr_mean [0.15988931198845807]
standalone_vs_federated_perturbed_corr_std [0.3042898566488571]
federated_final_performance [0.8010694980621338, 0.7946524024009705, 0.796577513217926, 0.7937967777252197, 0.7991443872451782]
federated_final_performance_mean 0.7970481157302857
federated_final_performance_std 0.0027238934644047332
CFFL_best_worker [0.8087700605392456, 0.7978609800338745, 0.8019251227378845, 0.804064154624939, 0.8002139329910278]
CFFL_best_worker_mean 0.8025668501853943
CFFL_best_worker_std 0.0037098513879185477
standalone_best_worker [0.8032085299491882, 0.7908021211624146, 0.7993583083152771, 0.7957219481468201, 0.7908021211624146]
standalone_best_worker_mean 0.7959786057472229
standalone_best_worker_std 0.0048446269588491055
