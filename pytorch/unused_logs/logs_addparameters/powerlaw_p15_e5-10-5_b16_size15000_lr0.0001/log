Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 15000, 'n_workers': 15, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.725225. Accuracy: 52.9412%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 72.0667%
Leave-one-out validation accuracies :  ['72.0667%', '72.2000%', '72.1333%', '72.2000%', '72.6667%', '72.7333%', '73.0000%', '73.1333%', '73.1333%', '73.4667%', '73.4667%', '73.6000%', '73.5333%', '73.7333%', '73.6667%']
Computed and normalized credits:  tensor([0.0681, 0.0679, 0.0680, 0.0679, 0.0672, 0.0670, 0.0666, 0.0664, 0.0664,
        0.0659, 0.0659, 0.0657, 0.0658, 0.0655, 0.0656])
Federated model performance: Loss: 0.592833. Accuracy: 72.6203%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['50.353%', '51.358%', '52.064%', '52.920%', '54.053%', '55.144%', '55.444%', '56.150%', '57.305%', '56.941%', '58.310%', '58.310%', '59.037%', '60.321%', '59.765%']
Workers federated accuracies:  ['50.353%', '51.358%', '52.064%', '52.920%', '54.053%', '55.144%', '55.444%', '56.150%', '57.305%', '56.941%', '58.310%', '58.310%', '59.037%', '60.321%', '59.765%']
Workers improved  accuracies:  ['0.578%', '1.005%', '1.241%', '1.647%', '2.289%', '2.631%', '2.824%', '3.123%', '3.829%', '3.294%', '3.872%', '3.914%', '4.321%', '5.176%', '4.684%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 2:
Federated model validation accuracy : 73.8000%
Leave-one-out validation accuracies :  ['73.7333%', '73.7333%', '73.6667%', '73.6667%', '73.8667%', '73.8667%', '74.0667%', '74.0667%', '74.0000%', '73.9333%', '73.8667%', '74.0000%', '74.4000%', '74.5333%', '74.7333%']
Computed and normalized credits:  tensor([0.0672, 0.0672, 0.0673, 0.0673, 0.0669, 0.0669, 0.0666, 0.0666, 0.0667,
        0.0667, 0.0668, 0.0666, 0.0660, 0.0657, 0.0655])
Federated model performance: Loss: 0.566426. Accuracy: 74.7808%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['50.674%', '52.364%', '53.561%', '54.738%', '55.872%', '57.369%', '57.797%', '58.909%', '60.749%', '60.385%', '62.289%', '62.567%', '63.251%', '64.449%', '64.620%']
Workers federated accuracies:  ['50.674%', '52.364%', '53.561%', '54.738%', '55.872%', '57.369%', '57.797%', '58.909%', '60.749%', '60.385%', '62.289%', '62.567%', '63.251%', '64.449%', '64.620%']
Workers improved  accuracies:  ['0.898%', '2.011%', '2.738%', '3.465%', '4.107%', '4.856%', '5.176%', '5.882%', '7.273%', '6.738%', '7.850%', '8.171%', '8.535%', '9.305%', '9.540%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 3:
Federated model validation accuracy : 74.5333%
Leave-one-out validation accuracies :  ['74.5333%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6000%', '74.6667%', '74.8667%', '74.7333%', '74.7333%', '74.8000%', '74.8667%', '74.9333%', '74.9333%', '75.0667%']
Computed and normalized credits:  tensor([0.0670, 0.0669, 0.0670, 0.0670, 0.0669, 0.0669, 0.0668, 0.0665, 0.0667,
        0.0667, 0.0666, 0.0665, 0.0663, 0.0663, 0.0660])
Federated model performance: Loss: 0.590305. Accuracy: 75.3369%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['51.380%', '53.134%', '54.781%', '55.872%', '57.519%', '60.128%', '60.535%', '61.775%', '64.257%', '63.529%', '65.198%', '65.390%', '66.652%', '67.551%', '67.551%']
Workers federated accuracies:  ['51.380%', '53.134%', '54.781%', '55.872%', '57.519%', '60.128%', '60.535%', '61.775%', '64.257%', '63.529%', '65.198%', '65.390%', '66.652%', '67.551%', '67.551%']
Workers improved  accuracies:  ['1.604%', '2.781%', '3.957%', '4.599%', '5.754%', '7.615%', '7.914%', '8.749%', '10.781%', '9.882%', '10.759%', '10.995%', '11.936%', '12.406%', '12.471%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 4:
Federated model validation accuracy : 74.9333%
Leave-one-out validation accuracies :  ['74.9333%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '74.9333%', '74.9333%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '74.9333%', '74.9333%']
Computed and normalized credits:  tensor([0.0668, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0667,
        0.0666, 0.0666, 0.0666, 0.0666, 0.0667, 0.0667])
Federated model performance: Loss: 0.634716. Accuracy: 75.8503%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['51.765%', '53.647%', '55.957%', '57.433%', '59.658%', '62.118%', '62.824%', '64.321%', '66.631%', '66.481%', '67.807%', '68.128%', '68.920%', '70.246%', '70.289%']
Workers federated accuracies:  ['51.765%', '53.647%', '55.957%', '57.433%', '59.658%', '62.118%', '62.824%', '64.321%', '66.631%', '66.481%', '67.807%', '68.128%', '68.920%', '70.246%', '70.289%']
Workers improved  accuracies:  ['1.989%', '3.294%', '5.134%', '6.160%', '7.893%', '9.604%', '10.203%', '11.294%', '13.155%', '12.834%', '13.369%', '13.733%', '14.203%', '15.102%', '15.209%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 5:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '74.9333%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '74.8667%', '75.0000%', '74.9333%', '74.9333%', '74.9333%']
Computed and normalized credits:  tensor([0.0666, 0.0667, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666,
        0.0666, 0.0668, 0.0666, 0.0667, 0.0667, 0.0667])
Federated model performance: Loss: 0.689304. Accuracy: 76.0000%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['52.150%', '54.652%', '56.727%', '58.610%', '61.241%', '64.107%', '64.856%', '65.947%', '68.513%', '68.385%', '69.989%', '70.332%', '70.888%', '71.957%', '72.086%']
Workers federated accuracies:  ['52.150%', '54.652%', '56.727%', '58.610%', '61.241%', '64.107%', '64.856%', '65.947%', '68.513%', '68.385%', '69.989%', '70.332%', '70.888%', '71.957%', '72.086%']
Workers improved  accuracies:  ['2.374%', '4.299%', '5.904%', '7.337%', '9.476%', '11.594%', '12.235%', '12.920%', '15.037%', '14.738%', '15.551%', '15.936%', '16.171%', '16.813%', '17.005%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 6:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0000%', '74.9333%', '74.9333%', '74.9333%', '74.8667%', '74.9333%', '74.8667%', '74.9333%', '74.9333%', '74.9333%', '75.1333%', '75.0667%', '75.0000%', '75.0000%']
Computed and normalized credits:  tensor([0.0666, 0.0666, 0.0667, 0.0667, 0.0667, 0.0668, 0.0667, 0.0668, 0.0667,
        0.0667, 0.0667, 0.0664, 0.0665, 0.0666, 0.0666])
Federated model performance: Loss: 0.745583. Accuracy: 76.2567%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['52.684%', '55.380%', '57.840%', '60.064%', '63.380%', '65.412%', '66.481%', '67.765%', '69.904%', '69.947%', '71.529%', '71.914%', '72.385%', '73.390%', '73.369%']
Workers federated accuracies:  ['52.684%', '55.380%', '57.840%', '60.064%', '63.380%', '65.412%', '66.481%', '67.765%', '69.904%', '69.947%', '71.529%', '71.914%', '72.385%', '73.390%', '73.369%']
Workers improved  accuracies:  ['2.909%', '5.027%', '7.016%', '8.791%', '11.615%', '12.898%', '13.861%', '14.738%', '16.428%', '16.299%', '17.091%', '17.519%', '17.668%', '18.246%', '18.289%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 7:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '74.9333%', '74.9333%', '74.9333%', '75.0000%', '75.0000%', '75.0000%', '74.9333%', '74.9333%', '75.0000%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%']
Computed and normalized credits:  tensor([0.0667, 0.0668, 0.0668, 0.0668, 0.0667, 0.0667, 0.0667, 0.0668, 0.0668,
        0.0667, 0.0666, 0.0665, 0.0666, 0.0666, 0.0666])
Federated model performance: Loss: 0.801147. Accuracy: 76.3422%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['52.941%', '56.107%', '59.251%', '61.519%', '64.620%', '67.102%', '68.086%', '69.219%', '70.952%', '71.508%', '72.749%', '72.791%', '73.626%', '74.310%', '74.503%']
Workers federated accuracies:  ['52.941%', '56.107%', '59.251%', '61.519%', '64.620%', '67.102%', '68.086%', '69.219%', '70.952%', '71.508%', '72.749%', '72.791%', '73.626%', '74.310%', '74.503%']
Workers improved  accuracies:  ['3.166%', '5.754%', '8.428%', '10.246%', '12.856%', '14.588%', '15.465%', '16.193%', '17.476%', '17.861%', '18.310%', '18.396%', '18.909%', '19.166%', '19.422%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 8:
Federated model validation accuracy : 74.9333%
Leave-one-out validation accuracies :  ['74.9333%', '75.0000%', '75.0000%', '75.0667%', '75.0667%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.0000%', '75.1333%', '75.2000%', '75.2667%', '75.2000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0667, 0.0667, 0.0668, 0.0668, 0.0668, 0.0668,
        0.0668, 0.0667, 0.0665, 0.0664, 0.0663, 0.0664])
Federated model performance: Loss: 0.856302. Accuracy: 76.4278%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['53.219%', '56.791%', '60.214%', '63.123%', '66.225%', '68.449%', '69.433%', '70.545%', '72.064%', '72.684%', '73.497%', '73.626%', '74.567%', '75.230%', '75.144%']
Workers federated accuracies:  ['53.219%', '56.791%', '60.214%', '63.123%', '66.225%', '68.449%', '69.433%', '70.545%', '72.064%', '72.684%', '73.497%', '73.626%', '74.567%', '75.230%', '75.144%']
Workers improved  accuracies:  ['3.444%', '6.438%', '9.390%', '11.850%', '14.460%', '15.936%', '16.813%', '17.519%', '18.588%', '19.037%', '19.059%', '19.230%', '19.850%', '20.086%', '20.064%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 9:
Federated model validation accuracy : 75.0667%
Leave-one-out validation accuracies :  ['75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.0667%', '75.1333%', '75.2000%', '75.2000%', '75.2000%', '75.2000%', '75.3333%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668,
        0.0667, 0.0666, 0.0665, 0.0665, 0.0665, 0.0663])
Federated model performance: Loss: 0.909811. Accuracy: 76.4278%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['53.647%', '57.348%', '61.241%', '64.342%', '67.380%', '69.626%', '70.567%', '71.529%', '72.706%', '73.583%', '74.139%', '74.481%', '75.037%', '75.936%', '76.064%']
Workers federated accuracies:  ['53.647%', '57.348%', '61.241%', '64.342%', '67.380%', '69.626%', '70.567%', '71.529%', '72.706%', '73.583%', '74.139%', '74.481%', '75.037%', '75.936%', '76.064%']
Workers improved  accuracies:  ['3.872%', '6.995%', '10.417%', '13.070%', '15.615%', '17.112%', '17.947%', '18.503%', '19.230%', '19.936%', '19.701%', '20.086%', '20.321%', '20.791%', '20.984%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 10:
Federated model validation accuracy : 75.2667%
Leave-one-out validation accuracies :  ['75.2667%', '75.2667%', '75.2667%', '75.2667%', '75.2000%', '75.1333%', '75.2000%', '75.2667%', '75.2667%', '75.4000%', '75.3333%', '75.3333%', '75.4000%', '75.4000%', '75.4667%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0667, 0.0668, 0.0669, 0.0668, 0.0667, 0.0667,
        0.0665, 0.0666, 0.0666, 0.0665, 0.0665, 0.0664])
Federated model performance: Loss: 0.958532. Accuracy: 76.4064%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['53.989%', '57.947%', '62.460%', '65.497%', '68.834%', '70.610%', '71.551%', '72.578%', '73.348%', '74.203%', '74.738%', '74.930%', '75.529%', '76.128%', '76.235%']
Workers federated accuracies:  ['53.989%', '57.947%', '62.460%', '65.497%', '68.834%', '70.610%', '71.551%', '72.578%', '73.348%', '74.203%', '74.738%', '74.930%', '75.529%', '76.128%', '76.235%']
Workers improved  accuracies:  ['4.214%', '7.594%', '11.636%', '14.225%', '17.070%', '18.096%', '18.930%', '19.551%', '19.872%', '20.556%', '20.299%', '20.535%', '20.813%', '20.984%', '21.155%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.958532. Accuracy: 76.4064%.
Workers before    accuracies:  ['49.775%', '50.353%', '50.824%', '51.273%', '51.765%', '52.513%', '52.620%', '53.027%', '53.476%', '53.647%', '54.439%', '54.396%', '54.717%', '55.144%', '55.080%']
Workers standlone accuracies:  ['53.989%', '57.947%', '62.460%', '65.497%', '68.834%', '70.610%', '71.551%', '72.578%', '73.348%', '74.203%', '74.738%', '74.930%', '75.529%', '76.128%', '76.235%']
Workers federated accuracies:  ['53.989%', '57.947%', '62.460%', '65.497%', '68.834%', '70.610%', '71.551%', '72.578%', '73.348%', '74.203%', '74.738%', '74.930%', '75.529%', '76.128%', '76.235%']
Workers improved  accuracies:  ['4.214%', '7.594%', '11.636%', '14.225%', '17.070%', '18.096%', '18.930%', '19.551%', '19.872%', '20.556%', '20.299%', '20.535%', '20.813%', '20.984%', '21.155%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]
Workers sharing_contributions :  tensor([  7.4667,  14.9333,  22.4000,  29.8667,  37.3333,  45.8667,  53.3333,
         60.8000,  68.2667,  75.7333,  83.2000,  90.6667,  98.1333, 105.6000,
        113.0667])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.585762288000638, 0.02176308642186076)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9114094700963692, 2.280288117089273e-06)
Correlation between test_acc improvements & sharing_contributions:  (0.8643532739868458, 3.233442811011155e-05)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.797560. Accuracy: 47.7861%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 69.2667%
Leave-one-out validation accuracies :  ['69.3333%', '69.4667%', '69.8000%', '69.7333%', '70.1333%', '71.0000%', '71.5333%', '71.8000%', '72.4000%', '72.9333%', '73.5333%', '74.0000%', '74.2667%', '74.9333%', '75.2667%']
Computed and normalized credits:  tensor([0.0711, 0.0708, 0.0703, 0.0704, 0.0697, 0.0683, 0.0674, 0.0669, 0.0660,
        0.0651, 0.0642, 0.0634, 0.0630, 0.0620, 0.0615])
Federated model performance: Loss: 0.597811. Accuracy: 70.1390%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['44.278%', '45.497%', '46.995%', '47.722%', '48.299%', '50.845%', '50.995%', '51.829%', '53.262%', '54.267%', '54.353%', '56.107%', '56.385%', '57.540%', '57.797%']
Workers federated accuracies:  ['44.278%', '45.497%', '46.995%', '47.722%', '48.299%', '50.845%', '50.995%', '51.829%', '53.262%', '54.267%', '54.353%', '56.107%', '56.385%', '57.540%', '57.797%']
Workers improved  accuracies:  ['0.706%', '1.283%', '2.011%', '2.225%', '2.246%', '3.786%', '3.508%', '4.043%', '4.492%', '5.433%', '5.369%', '6.225%', '5.882%', '6.310%', '6.588%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 2:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.4667%', '73.4667%', '73.5333%', '73.8667%', '74.0667%', '74.3333%', '74.4000%', '74.8000%', '75.2000%', '75.4667%', '76.0000%', '76.2000%', '76.2667%', '76.3333%', '76.6000%']
Computed and normalized credits:  tensor([0.0694, 0.0694, 0.0692, 0.0687, 0.0683, 0.0678, 0.0676, 0.0669, 0.0662,
        0.0657, 0.0647, 0.0644, 0.0642, 0.0640, 0.0635])
Federated model performance: Loss: 0.520052. Accuracy: 74.1818%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['45.005%', '46.567%', '48.749%', '49.711%', '50.909%', '54.139%', '54.225%', '55.679%', '57.519%', '58.652%', '58.802%', '60.193%', '60.642%', '61.754%', '62.417%']
Workers federated accuracies:  ['45.005%', '46.567%', '48.749%', '49.711%', '50.909%', '54.139%', '54.225%', '55.679%', '57.519%', '58.652%', '58.802%', '60.193%', '60.642%', '61.754%', '62.417%']
Workers improved  accuracies:  ['1.433%', '2.353%', '3.765%', '4.214%', '4.856%', '7.080%', '6.738%', '7.893%', '8.749%', '9.818%', '9.818%', '10.310%', '10.139%', '10.524%', '11.209%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 3:
Federated model validation accuracy : 75.6667%
Leave-one-out validation accuracies :  ['75.7333%', '75.8000%', '75.7333%', '76.0667%', '76.0667%', '76.3333%', '76.4667%', '76.4000%', '76.5333%', '76.6667%', '76.9333%', '77.0667%', '77.0667%', '77.1333%', '77.2000%']
Computed and normalized credits:  tensor([0.0681, 0.0680, 0.0681, 0.0675, 0.0675, 0.0670, 0.0668, 0.0668, 0.0665,
        0.0663, 0.0658, 0.0655, 0.0655, 0.0654, 0.0652])
Federated model performance: Loss: 0.505002. Accuracy: 75.3797%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['45.775%', '47.615%', '50.460%', '51.701%', '52.963%', '56.920%', '57.326%', '58.439%', '60.342%', '61.583%', '61.861%', '63.743%', '64.021%', '64.663%', '65.176%']
Workers federated accuracies:  ['45.775%', '47.615%', '50.460%', '51.701%', '52.963%', '56.920%', '57.326%', '58.439%', '60.342%', '61.583%', '61.861%', '63.743%', '64.021%', '64.663%', '65.176%']
Workers improved  accuracies:  ['2.203%', '3.401%', '5.476%', '6.203%', '6.909%', '9.861%', '9.840%', '10.652%', '11.572%', '12.749%', '12.877%', '13.861%', '13.519%', '13.433%', '13.968%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 4:
Federated model validation accuracy : 76.7333%
Leave-one-out validation accuracies :  ['76.7333%', '76.7333%', '76.7333%', '76.8000%', '76.8667%', '76.9333%', '77.0000%', '77.0667%', '77.1333%', '77.1333%', '77.2000%', '77.2000%', '77.3333%', '77.4000%', '77.4667%']
Computed and normalized credits:  tensor([0.0673, 0.0673, 0.0673, 0.0671, 0.0670, 0.0669, 0.0668, 0.0667, 0.0665,
        0.0665, 0.0663, 0.0663, 0.0661, 0.0660, 0.0659])
Federated model performance: Loss: 0.520611. Accuracy: 76.2139%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['46.396%', '48.492%', '52.064%', '53.326%', '55.144%', '59.316%', '59.316%', '60.642%', '62.717%', '64.235%', '64.064%', '65.711%', '65.626%', '67.059%', '67.337%']
Workers federated accuracies:  ['46.396%', '48.492%', '52.064%', '53.326%', '55.144%', '59.316%', '59.316%', '60.642%', '62.717%', '64.235%', '64.064%', '65.711%', '65.626%', '67.059%', '67.337%']
Workers improved  accuracies:  ['2.824%', '4.278%', '7.080%', '7.829%', '9.091%', '12.257%', '11.829%', '12.856%', '13.947%', '15.401%', '15.080%', '15.829%', '15.123%', '15.829%', '16.128%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 5:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.3333%', '77.4000%', '77.4000%', '77.5333%', '77.5333%', '77.5333%', '77.4667%', '77.4000%', '77.4000%', '77.4000%', '77.2000%', '77.3333%', '77.3333%', '77.4667%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0667, 0.0665, 0.0665, 0.0665, 0.0666, 0.0667,
        0.0667, 0.0666, 0.0669, 0.0667, 0.0667, 0.0665])
Federated model performance: Loss: 0.551001. Accuracy: 76.8556%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['46.952%', '49.305%', '53.690%', '55.422%', '56.834%', '60.856%', '61.027%', '62.353%', '64.620%', '66.032%', '65.604%', '67.487%', '67.743%', '68.770%', '69.455%']
Workers federated accuracies:  ['46.952%', '49.305%', '53.690%', '55.422%', '56.834%', '60.856%', '61.027%', '62.353%', '64.620%', '66.032%', '65.604%', '67.487%', '67.743%', '68.770%', '69.455%']
Workers improved  accuracies:  ['3.380%', '5.091%', '8.706%', '9.925%', '10.781%', '13.797%', '13.540%', '14.567%', '15.850%', '17.198%', '16.620%', '17.604%', '17.241%', '17.540%', '18.246%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 6:
Federated model validation accuracy : 77.2667%
Leave-one-out validation accuracies :  ['77.2667%', '77.2667%', '77.2667%', '77.2667%', '77.2667%', '77.4000%', '77.4000%', '77.4667%', '77.4000%', '77.4667%', '77.5333%', '77.4667%', '77.4667%', '77.4000%', '77.4000%']
Computed and normalized credits:  tensor([0.0668, 0.0669, 0.0668, 0.0668, 0.0668, 0.0666, 0.0666, 0.0665, 0.0666,
        0.0665, 0.0664, 0.0666, 0.0666, 0.0666, 0.0666])
Federated model performance: Loss: 0.588829. Accuracy: 77.1765%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['47.722%', '50.588%', '55.037%', '56.920%', '58.225%', '62.995%', '62.930%', '64.107%', '65.989%', '67.358%', '66.888%', '68.727%', '69.326%', '70.053%', '71.037%']
Workers federated accuracies:  ['47.722%', '50.588%', '55.037%', '56.920%', '58.225%', '62.995%', '62.930%', '64.107%', '65.989%', '67.358%', '66.888%', '68.727%', '69.326%', '70.053%', '71.037%']
Workers improved  accuracies:  ['4.150%', '6.374%', '10.053%', '11.422%', '12.171%', '15.936%', '15.444%', '16.321%', '17.219%', '18.524%', '17.904%', '18.845%', '18.824%', '18.824%', '19.829%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 7:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6000%', '77.6000%', '77.6000%', '77.4667%', '77.4667%', '77.5333%', '77.5333%', '77.5333%', '77.5333%', '77.4667%', '77.5333%', '77.5333%', '77.4000%', '77.5333%', '77.6000%']
Computed and normalized credits:  tensor([0.0666, 0.0666, 0.0666, 0.0668, 0.0668, 0.0667, 0.0667, 0.0666, 0.0667,
        0.0667, 0.0666, 0.0666, 0.0668, 0.0667, 0.0666])
Federated model performance: Loss: 0.629863. Accuracy: 77.1123%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['48.299%', '51.487%', '56.620%', '58.203%', '59.636%', '64.278%', '64.278%', '65.455%', '67.273%', '68.770%', '68.578%', '70.118%', '70.652%', '71.658%', '72.428%']
Workers federated accuracies:  ['48.299%', '51.487%', '56.620%', '58.203%', '59.636%', '64.278%', '64.278%', '65.455%', '67.273%', '68.770%', '68.578%', '70.118%', '70.652%', '71.658%', '72.428%']
Workers improved  accuracies:  ['4.727%', '7.273%', '11.636%', '12.706%', '13.583%', '17.219%', '16.791%', '17.668%', '18.503%', '19.936%', '19.594%', '20.235%', '20.150%', '20.428%', '21.219%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 8:
Federated model validation accuracy : 77.5333%
Leave-one-out validation accuracies :  ['77.5333%', '77.5333%', '77.5333%', '77.4667%', '77.5333%', '77.6000%', '77.5333%', '77.6000%', '77.6000%', '77.6667%', '77.6667%', '77.6667%', '77.6667%', '77.6667%', '77.7333%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0669, 0.0668, 0.0667, 0.0668, 0.0667, 0.0667,
        0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0665])
Federated model performance: Loss: 0.672000. Accuracy: 77.3048%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['48.684%', '52.535%', '57.497%', '59.166%', '61.390%', '65.647%', '65.647%', '66.781%', '68.471%', '69.775%', '70.182%', '71.529%', '72.043%', '72.663%', '73.455%']
Workers federated accuracies:  ['48.684%', '52.535%', '57.497%', '59.166%', '61.390%', '65.647%', '65.647%', '66.781%', '68.471%', '69.775%', '70.182%', '71.529%', '72.043%', '72.663%', '73.455%']
Workers improved  accuracies:  ['5.112%', '8.321%', '12.513%', '13.668%', '15.337%', '18.588%', '18.160%', '18.995%', '19.701%', '20.941%', '21.198%', '21.647%', '21.540%', '21.433%', '22.246%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 9:
Federated model validation accuracy : 77.6000%
Leave-one-out validation accuracies :  ['77.6667%', '77.6667%', '77.6667%', '77.6667%', '77.6667%', '77.6667%', '77.7333%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6667%', '77.6667%', '77.6667%', '77.6000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666, 0.0666, 0.0667, 0.0667,
        0.0667, 0.0667, 0.0666, 0.0666, 0.0666, 0.0667])
Federated model performance: Loss: 0.713402. Accuracy: 77.3690%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['49.091%', '53.305%', '58.545%', '60.064%', '62.438%', '66.674%', '66.824%', '67.893%', '69.604%', '71.016%', '70.952%', '72.321%', '72.599%', '73.433%', '74.118%']
Workers federated accuracies:  ['49.091%', '53.305%', '58.545%', '60.064%', '62.438%', '66.674%', '66.824%', '67.893%', '69.604%', '71.016%', '70.952%', '72.321%', '72.599%', '73.433%', '74.118%']
Workers improved  accuracies:  ['5.519%', '9.091%', '13.561%', '14.567%', '16.385%', '19.615%', '19.337%', '20.107%', '20.834%', '22.182%', '21.968%', '22.439%', '22.096%', '22.203%', '22.909%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 10:
Federated model validation accuracy : 77.7333%
Leave-one-out validation accuracies :  ['77.6667%', '77.6667%', '77.7333%', '77.7333%', '77.7333%', '77.6667%', '77.6667%', '77.6667%', '77.6667%', '77.6667%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0666, 0.0666, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667,
        0.0667, 0.0668, 0.0667, 0.0667, 0.0667, 0.0668])
Federated model performance: Loss: 0.754119. Accuracy: 77.3690%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['49.904%', '54.267%', '59.465%', '61.091%', '63.551%', '67.380%', '67.679%', '69.241%', '70.866%', '71.807%', '71.893%', '73.262%', '73.433%', '74.096%', '74.417%']
Workers federated accuracies:  ['49.904%', '54.267%', '59.465%', '61.091%', '63.551%', '67.380%', '67.679%', '69.241%', '70.866%', '71.807%', '71.893%', '73.262%', '73.433%', '74.096%', '74.417%']
Workers improved  accuracies:  ['6.332%', '10.053%', '14.481%', '15.594%', '17.497%', '20.321%', '20.193%', '21.455%', '22.096%', '22.973%', '22.909%', '23.380%', '22.930%', '22.866%', '23.209%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.754119. Accuracy: 77.3690%.
Workers before    accuracies:  ['43.572%', '44.214%', '44.984%', '45.497%', '46.053%', '47.059%', '47.487%', '47.786%', '48.770%', '48.834%', '48.984%', '49.882%', '50.503%', '51.230%', '51.209%']
Workers standlone accuracies:  ['49.904%', '54.267%', '59.465%', '61.091%', '63.551%', '67.380%', '67.679%', '69.241%', '70.866%', '71.807%', '71.893%', '73.262%', '73.433%', '74.096%', '74.417%']
Workers federated accuracies:  ['49.904%', '54.267%', '59.465%', '61.091%', '63.551%', '67.380%', '67.679%', '69.241%', '70.866%', '71.807%', '71.893%', '73.262%', '73.433%', '74.096%', '74.417%']
Workers improved  accuracies:  ['6.332%', '10.053%', '14.481%', '15.594%', '17.497%', '20.321%', '20.193%', '21.455%', '22.096%', '22.973%', '22.909%', '23.380%', '22.930%', '22.866%', '23.209%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]
Workers sharing_contributions :  tensor([  7.4667,  14.9333,  22.4000,  29.8667,  37.3333,  45.8667,  53.3333,
         60.8000,  68.2667,  75.7333,  83.2000,  90.6667,  98.1333, 105.6000,
        113.0667])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.21367477278359903, 0.44447327655192714)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9379431222161329, 2.4066688571542036e-07)
Correlation between test_acc improvements & sharing_contributions:  (0.8833782585630882, 1.2699795938017753e-05)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.726717. Accuracy: 59.1230%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.0000%
Leave-one-out validation accuracies :  ['71.0000%', '71.0000%', '71.0667%', '71.5333%', '71.8000%', '71.8667%', '72.6667%', '73.2667%', '73.3333%', '73.6667%', '74.2000%', '74.4000%', '74.7333%', '75.0000%', '75.3333%']
Computed and normalized credits:  tensor([0.0698, 0.0698, 0.0697, 0.0690, 0.0685, 0.0684, 0.0672, 0.0662, 0.0661,
        0.0656, 0.0647, 0.0644, 0.0639, 0.0635, 0.0630])
Federated model performance: Loss: 0.602782. Accuracy: 71.9144%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['56.385%', '57.070%', '58.524%', '58.802%', '59.765%', '60.428%', '61.070%', '61.647%', '62.973%', '63.358%', '63.358%', '64.107%', '64.278%', '65.241%', '65.497%']
Workers federated accuracies:  ['56.385%', '57.070%', '58.524%', '58.802%', '59.765%', '60.428%', '61.070%', '61.647%', '62.973%', '63.358%', '63.358%', '64.107%', '64.278%', '65.241%', '65.497%']
Workers improved  accuracies:  ['0.299%', '0.599%', '1.561%', '1.668%', '2.011%', '2.011%', '2.374%', '2.610%', '3.465%', '3.551%', '3.529%', '3.872%', '3.786%', '4.449%', '4.556%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 2:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2000%', '74.3333%', '74.6667%', '74.8000%', '74.9333%', '74.9333%', '75.0000%', '75.1333%', '75.3333%', '75.4667%', '75.6667%', '75.6667%', '75.8000%', '75.8000%']
Computed and normalized credits:  tensor([0.0683, 0.0683, 0.0681, 0.0675, 0.0673, 0.0671, 0.0669, 0.0667, 0.0665,
        0.0661, 0.0658, 0.0655, 0.0654, 0.0652, 0.0651])
Federated model performance: Loss: 0.545480. Accuracy: 74.0749%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['56.663%', '58.118%', '59.551%', '59.829%', '61.176%', '62.759%', '63.572%', '64.150%', '65.348%', '65.647%', '65.882%', '66.866%', '66.909%', '67.615%', '68.278%']
Workers federated accuracies:  ['56.663%', '58.118%', '59.551%', '59.829%', '61.176%', '62.759%', '63.572%', '64.150%', '65.348%', '65.647%', '65.882%', '66.866%', '66.909%', '67.615%', '68.278%']
Workers improved  accuracies:  ['0.578%', '1.647%', '2.588%', '2.695%', '3.422%', '4.342%', '4.877%', '5.112%', '5.840%', '5.840%', '6.053%', '6.631%', '6.417%', '6.824%', '7.337%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 3:
Federated model validation accuracy : 75.6667%
Leave-one-out validation accuracies :  ['75.6667%', '75.7333%', '75.6667%', '75.6667%', '75.7333%', '75.7333%', '75.6667%', '75.8000%', '75.8667%', '75.8667%', '76.0000%', '76.0000%', '76.0667%', '76.0000%', '76.0667%']
Computed and normalized credits:  tensor([0.0671, 0.0670, 0.0671, 0.0670, 0.0669, 0.0669, 0.0669, 0.0667, 0.0666,
        0.0666, 0.0663, 0.0663, 0.0662, 0.0663, 0.0661])
Federated model performance: Loss: 0.527217. Accuracy: 74.7380%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['57.155%', '58.973%', '60.706%', '61.348%', '63.059%', '64.727%', '65.540%', '65.989%', '67.187%', '67.508%', '67.658%', '68.877%', '68.898%', '69.540%', '69.861%']
Workers federated accuracies:  ['57.155%', '58.973%', '60.706%', '61.348%', '63.059%', '64.727%', '65.540%', '65.989%', '67.187%', '67.508%', '67.658%', '68.877%', '68.898%', '69.540%', '69.861%']
Workers improved  accuracies:  ['1.070%', '2.503%', '3.743%', '4.214%', '5.305%', '6.310%', '6.845%', '6.952%', '7.679%', '7.701%', '7.829%', '8.642%', '8.406%', '8.749%', '8.920%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 4:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '76.0000%', '76.0000%', '76.0667%', '76.0000%', '76.0667%', '76.0667%', '76.0667%', '76.2000%', '76.2667%', '76.4667%', '76.4667%', '76.5333%', '76.7333%']
Computed and normalized credits:  tensor([0.0670, 0.0670, 0.0670, 0.0670, 0.0669, 0.0670, 0.0669, 0.0669, 0.0668,
        0.0666, 0.0665, 0.0662, 0.0662, 0.0661, 0.0658])
Federated model performance: Loss: 0.529676. Accuracy: 75.2941%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['57.519%', '59.551%', '62.032%', '62.909%', '64.770%', '65.947%', '66.631%', '67.187%', '68.706%', '68.984%', '69.219%', '70.267%', '70.011%', '70.781%', '71.209%']
Workers federated accuracies:  ['57.519%', '59.551%', '62.032%', '62.909%', '64.770%', '65.947%', '66.631%', '67.187%', '68.706%', '68.984%', '69.219%', '70.267%', '70.011%', '70.781%', '71.209%']
Workers improved  accuracies:  ['1.433%', '3.080%', '5.070%', '5.775%', '7.016%', '7.529%', '7.936%', '8.150%', '9.198%', '9.176%', '9.390%', '10.032%', '9.519%', '9.989%', '10.267%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 5:
Federated model validation accuracy : 76.3333%
Leave-one-out validation accuracies :  ['76.3333%', '76.4000%', '76.4667%', '76.4000%', '76.6000%', '76.6667%', '76.6667%', '76.5333%', '76.6667%', '76.6000%', '76.6667%', '76.7333%', '76.6667%', '76.8000%', '76.9333%']
Computed and normalized credits:  tensor([0.0671, 0.0670, 0.0669, 0.0670, 0.0667, 0.0666, 0.0666, 0.0668, 0.0666,
        0.0667, 0.0666, 0.0664, 0.0665, 0.0663, 0.0661])
Federated model performance: Loss: 0.542401. Accuracy: 75.7219%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['58.118%', '60.150%', '63.187%', '64.021%', '65.797%', '67.166%', '67.765%', '68.620%', '69.519%', '70.160%', '70.246%', '71.316%', '71.294%', '71.829%', '72.578%']
Workers federated accuracies:  ['58.118%', '60.150%', '63.187%', '64.021%', '65.797%', '67.166%', '67.765%', '68.620%', '69.519%', '70.160%', '70.246%', '71.316%', '71.294%', '71.829%', '72.578%']
Workers improved  accuracies:  ['2.032%', '3.679%', '6.225%', '6.888%', '8.043%', '8.749%', '9.070%', '9.583%', '10.011%', '10.353%', '10.417%', '11.080%', '10.802%', '11.037%', '11.636%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 6:
Federated model validation accuracy : 76.8667%
Leave-one-out validation accuracies :  ['76.8667%', '76.8667%', '76.8667%', '76.8667%', '76.8667%', '77.0000%', '77.0000%', '76.8667%', '76.8667%', '76.9333%', '76.9333%', '77.1333%', '77.1333%', '77.1333%', '77.2000%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0668, 0.0669, 0.0668, 0.0666, 0.0666, 0.0668, 0.0668,
        0.0667, 0.0667, 0.0664, 0.0664, 0.0664, 0.0663])
Federated model performance: Loss: 0.560760. Accuracy: 76.2139%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['58.652%', '60.834%', '64.257%', '64.941%', '66.674%', '68.299%', '68.663%', '69.583%', '70.524%', '71.251%', '71.316%', '72.064%', '72.150%', '72.684%', '72.984%']
Workers federated accuracies:  ['58.652%', '60.834%', '64.257%', '64.941%', '66.674%', '68.299%', '68.663%', '69.583%', '70.524%', '71.251%', '71.316%', '72.064%', '72.150%', '72.684%', '72.984%']
Workers improved  accuracies:  ['2.567%', '4.364%', '7.294%', '7.807%', '8.920%', '9.882%', '9.968%', '10.545%', '11.016%', '11.444%', '11.487%', '11.829%', '11.658%', '11.893%', '12.043%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 7:
Federated model validation accuracy : 77.0667%
Leave-one-out validation accuracies :  ['77.0667%', '77.1333%', '77.1333%', '77.1333%', '77.1333%', '77.1333%', '77.0667%', '77.1333%', '77.2667%', '77.2667%', '77.2667%', '77.3333%', '77.3333%', '77.4000%', '77.4000%']
Computed and normalized credits:  tensor([0.0669, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0669, 0.0668, 0.0666,
        0.0666, 0.0666, 0.0665, 0.0665, 0.0664, 0.0664])
Federated model performance: Loss: 0.580934. Accuracy: 76.3636%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['58.845%', '61.754%', '65.219%', '65.818%', '67.615%', '68.791%', '69.412%', '70.417%', '71.123%', '72.000%', '71.957%', '72.813%', '72.620%', '73.112%', '73.690%']
Workers federated accuracies:  ['58.845%', '61.754%', '65.219%', '65.818%', '67.615%', '68.791%', '69.412%', '70.417%', '71.123%', '72.000%', '71.957%', '72.813%', '72.620%', '73.112%', '73.690%']
Workers improved  accuracies:  ['2.759%', '5.283%', '8.257%', '8.684%', '9.861%', '10.374%', '10.717%', '11.380%', '11.615%', '12.193%', '12.128%', '12.578%', '12.128%', '12.321%', '12.749%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 8:
Federated model validation accuracy : 77.3333%
Leave-one-out validation accuracies :  ['77.3333%', '77.3333%', '77.3333%', '77.3333%', '77.3333%', '77.3333%', '77.4000%', '77.4000%', '77.4000%', '77.4667%', '77.4667%', '77.4667%', '77.4000%', '77.4667%', '77.5333%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0667, 0.0667, 0.0667,
        0.0666, 0.0666, 0.0665, 0.0666, 0.0665, 0.0664])
Federated model performance: Loss: 0.601261. Accuracy: 76.4706%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['59.230%', '62.374%', '65.754%', '66.888%', '68.578%', '69.455%', '70.353%', '71.037%', '71.850%', '72.513%', '72.706%', '73.283%', '73.241%', '73.668%', '74.011%']
Workers federated accuracies:  ['59.230%', '62.374%', '65.754%', '66.888%', '68.578%', '69.455%', '70.353%', '71.037%', '71.850%', '72.513%', '72.706%', '73.283%', '73.241%', '73.668%', '74.011%']
Workers improved  accuracies:  ['3.144%', '5.904%', '8.791%', '9.754%', '10.824%', '11.037%', '11.658%', '12.000%', '12.342%', '12.706%', '12.877%', '13.048%', '12.749%', '12.877%', '13.070%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 9:
Federated model validation accuracy : 77.5333%
Leave-one-out validation accuracies :  ['77.5333%', '77.5333%', '77.5333%', '77.5333%', '77.6000%', '77.6667%', '77.6000%', '77.5333%', '77.4667%', '77.4667%', '77.4667%', '77.5333%', '77.6000%', '77.6667%', '77.6000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0667, 0.0666, 0.0665, 0.0666, 0.0667, 0.0668,
        0.0668, 0.0668, 0.0667, 0.0666, 0.0665, 0.0666])
Federated model performance: Loss: 0.621811. Accuracy: 76.5134%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['59.444%', '62.952%', '66.374%', '67.444%', '69.070%', '70.267%', '70.909%', '71.465%', '72.556%', '72.963%', '73.070%', '73.882%', '73.626%', '73.989%', '74.289%']
Workers federated accuracies:  ['59.444%', '62.952%', '66.374%', '67.444%', '69.070%', '70.267%', '70.909%', '71.465%', '72.556%', '72.963%', '73.070%', '73.882%', '73.626%', '73.989%', '74.289%']
Workers improved  accuracies:  ['3.358%', '6.481%', '9.412%', '10.310%', '11.316%', '11.850%', '12.214%', '12.428%', '13.048%', '13.155%', '13.241%', '13.647%', '13.134%', '13.198%', '13.348%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 10:
Federated model validation accuracy : 77.5333%
Leave-one-out validation accuracies :  ['77.5333%', '77.5333%', '77.5333%', '77.5333%', '77.5333%', '77.5333%', '77.6000%', '77.6000%', '77.5333%', '77.4000%', '77.4000%', '77.4667%', '77.4667%', '77.3333%', '77.3333%']
Computed and normalized credits:  tensor([0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0666, 0.0665, 0.0665, 0.0666,
        0.0668, 0.0668, 0.0667, 0.0667, 0.0669, 0.0669])
Federated model performance: Loss: 0.641360. Accuracy: 76.8128%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['59.743%', '63.743%', '67.166%', '67.850%', '69.583%', '70.888%', '71.422%', '71.979%', '72.791%', '73.540%', '73.412%', '74.139%', '74.139%', '74.417%', '74.588%']
Workers federated accuracies:  ['59.743%', '63.743%', '67.166%', '67.850%', '69.583%', '70.888%', '71.422%', '71.979%', '72.791%', '73.540%', '73.412%', '74.139%', '74.139%', '74.417%', '74.588%']
Workers improved  accuracies:  ['3.658%', '7.273%', '10.203%', '10.717%', '11.829%', '12.471%', '12.727%', '12.941%', '13.283%', '13.733%', '13.583%', '13.904%', '13.647%', '13.626%', '13.647%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.641360. Accuracy: 76.8128%.
Workers before    accuracies:  ['56.086%', '56.471%', '56.963%', '57.134%', '57.754%', '58.417%', '58.695%', '59.037%', '59.508%', '59.807%', '59.829%', '60.235%', '60.492%', '60.791%', '60.941%']
Workers standlone accuracies:  ['59.743%', '63.743%', '67.166%', '67.850%', '69.583%', '70.888%', '71.422%', '71.979%', '72.791%', '73.540%', '73.412%', '74.139%', '74.139%', '74.417%', '74.588%']
Workers federated accuracies:  ['59.743%', '63.743%', '67.166%', '67.850%', '69.583%', '70.888%', '71.422%', '71.979%', '72.791%', '73.540%', '73.412%', '74.139%', '74.139%', '74.417%', '74.588%']
Workers improved  accuracies:  ['3.658%', '7.273%', '10.203%', '10.717%', '11.829%', '12.471%', '12.727%', '12.941%', '13.283%', '13.733%', '13.583%', '13.904%', '13.647%', '13.626%', '13.647%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]
Workers sharing_contributions :  tensor([  7.4667,  14.9333,  22.4000,  29.8667,  37.3333,  45.8667,  53.3333,
         60.8000,  68.2667,  75.7333,  83.2000,  90.6667,  98.1333, 105.6000,
        113.0667])
Correlation between stand alone test acc & perturbed federated test acc:  (0.1131748744331443, 0.6879840092610707)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.9055036422217351, 3.418435305915696e-06)
Correlation between test_acc improvements & sharing_contributions:  (0.8109997566314362, 0.00024378548773009017)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.666186. Accuracy: 61.5187%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 72.5333%
Leave-one-out validation accuracies :  ['72.6667%', '72.8000%', '72.8667%', '73.4667%', '73.6000%', '73.8000%', '74.3333%', '74.6000%', '74.8000%', '75.0000%', '75.0000%', '75.0667%', '74.8667%', '75.2667%', '75.4000%']
Computed and normalized credits:  tensor([0.0691, 0.0689, 0.0688, 0.0678, 0.0676, 0.0673, 0.0665, 0.0661, 0.0658,
        0.0655, 0.0655, 0.0654, 0.0657, 0.0651, 0.0649])
Federated model performance: Loss: 0.547648. Accuracy: 72.6845%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['59.123%', '59.786%', '61.176%', '61.497%', '62.417%', '63.765%', '64.620%', '64.706%', '66.011%', '66.439%', '66.652%', '67.380%', '67.936%', '68.321%', '68.791%']
Workers federated accuracies:  ['59.123%', '59.786%', '61.176%', '61.497%', '62.417%', '63.765%', '64.620%', '64.706%', '66.011%', '66.439%', '66.652%', '67.380%', '67.936%', '68.321%', '68.791%']
Workers improved  accuracies:  ['0.321%', '0.770%', '1.519%', '1.476%', '2.139%', '2.631%', '3.209%', '3.273%', '3.679%', '3.957%', '3.979%', '3.936%', '4.193%', '4.107%', '4.257%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 2:
Federated model validation accuracy : 75.0000%
Leave-one-out validation accuracies :  ['75.0000%', '75.0667%', '75.1333%', '75.1333%', '75.0667%', '75.2667%', '75.5333%', '75.6667%', '75.6667%', '75.5333%', '75.6000%', '75.4667%', '75.6000%', '75.6667%', '75.8000%']
Computed and normalized credits:  tensor([0.0676, 0.0674, 0.0673, 0.0672, 0.0673, 0.0670, 0.0665, 0.0662, 0.0662,
        0.0663, 0.0663, 0.0664, 0.0663, 0.0661, 0.0659])
Federated model performance: Loss: 0.495424. Accuracy: 74.7594%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['59.487%', '60.599%', '62.567%', '63.102%', '64.214%', '65.882%', '66.824%', '67.037%', '68.684%', '69.027%', '69.155%', '69.904%', '70.246%', '70.610%', '71.230%']
Workers federated accuracies:  ['59.487%', '60.599%', '62.567%', '63.102%', '64.214%', '65.882%', '66.824%', '67.037%', '68.684%', '69.027%', '69.155%', '69.904%', '70.246%', '70.610%', '71.230%']
Workers improved  accuracies:  ['0.684%', '1.583%', '2.909%', '3.080%', '3.936%', '4.749%', '5.412%', '5.604%', '6.353%', '6.545%', '6.481%', '6.460%', '6.503%', '6.396%', '6.695%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 3:
Federated model validation accuracy : 75.6667%
Leave-one-out validation accuracies :  ['75.6667%', '75.7333%', '75.8000%', '75.9333%', '76.0000%', '76.0667%', '76.0000%', '75.9333%', '75.9333%', '75.9333%', '75.8667%', '75.8000%', '75.8667%', '76.0667%', '75.9333%']
Computed and normalized credits:  tensor([0.0671, 0.0670, 0.0669, 0.0667, 0.0666, 0.0665, 0.0665, 0.0666, 0.0666,
        0.0666, 0.0667, 0.0668, 0.0667, 0.0664, 0.0665])
Federated model performance: Loss: 0.480488. Accuracy: 75.2727%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['60.000%', '61.433%', '64.021%', '64.556%', '65.668%', '67.701%', '68.984%', '69.155%', '70.182%', '70.802%', '70.866%', '71.615%', '71.572%', '72.150%', '72.385%']
Workers federated accuracies:  ['60.000%', '61.433%', '64.021%', '64.556%', '65.668%', '67.701%', '68.984%', '69.155%', '70.182%', '70.802%', '70.866%', '71.615%', '71.572%', '72.150%', '72.385%']
Workers improved  accuracies:  ['1.198%', '2.417%', '4.364%', '4.535%', '5.390%', '6.567%', '7.572%', '7.722%', '7.850%', '8.321%', '8.193%', '8.171%', '7.829%', '7.936%', '7.850%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 4:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '76.0000%', '75.9333%', '76.1333%', '76.1333%', '76.1333%', '76.2000%', '76.2000%', '75.9333%', '76.0000%', '76.0667%', '76.0667%', '76.3333%', '76.4667%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0668, 0.0669, 0.0666, 0.0666, 0.0666, 0.0665, 0.0665,
        0.0669, 0.0668, 0.0667, 0.0667, 0.0663, 0.0661])
Federated model performance: Loss: 0.486069. Accuracy: 76.0214%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['60.471%', '61.904%', '65.198%', '65.797%', '67.294%', '69.091%', '70.289%', '70.545%', '71.401%', '72.150%', '72.021%', '72.492%', '72.492%', '72.706%', '73.176%']
Workers federated accuracies:  ['60.471%', '61.904%', '65.198%', '65.797%', '67.294%', '69.091%', '70.289%', '70.545%', '71.401%', '72.150%', '72.021%', '72.492%', '72.492%', '72.706%', '73.176%']
Workers improved  accuracies:  ['1.668%', '2.888%', '5.540%', '5.775%', '7.016%', '7.957%', '8.877%', '9.112%', '9.070%', '9.668%', '9.348%', '9.048%', '8.749%', '8.492%', '8.642%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 5:
Federated model validation accuracy : 76.3333%
Leave-one-out validation accuracies :  ['76.3333%', '76.3333%', '76.3333%', '76.3333%', '76.4667%', '76.4667%', '76.4000%', '76.4667%', '76.4667%', '76.6000%', '76.7333%', '76.8667%', '76.8000%', '76.9333%', '76.9333%']
Computed and normalized credits:  tensor([0.0670, 0.0670, 0.0670, 0.0670, 0.0668, 0.0668, 0.0669, 0.0668, 0.0668,
        0.0666, 0.0664, 0.0662, 0.0663, 0.0661, 0.0661])
Federated model performance: Loss: 0.502627. Accuracy: 76.5134%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['60.877%', '62.824%', '65.989%', '66.824%', '68.620%', '70.139%', '71.401%', '71.701%', '71.914%', '72.556%', '72.941%', '72.898%', '73.283%', '73.455%', '73.840%']
Workers federated accuracies:  ['60.877%', '62.824%', '65.989%', '66.824%', '68.620%', '70.139%', '71.401%', '71.701%', '71.914%', '72.556%', '72.941%', '72.898%', '73.283%', '73.455%', '73.840%']
Workers improved  accuracies:  ['2.075%', '3.807%', '6.332%', '6.802%', '8.342%', '9.005%', '9.989%', '10.267%', '9.583%', '10.075%', '10.267%', '9.455%', '9.540%', '9.241%', '9.305%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 6:
Federated model validation accuracy : 76.9333%
Leave-one-out validation accuracies :  ['76.9333%', '76.9333%', '76.9333%', '76.9333%', '77.0000%', '76.9333%', '76.8667%', '76.9333%', '76.9333%', '76.8667%', '76.8667%', '76.9333%', '77.0000%', '77.2000%', '77.2000%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0666, 0.0667, 0.0668, 0.0667, 0.0667,
        0.0668, 0.0668, 0.0667, 0.0666, 0.0663, 0.0663])
Federated model performance: Loss: 0.524704. Accuracy: 76.6417%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['61.326%', '63.529%', '67.273%', '67.979%', '69.840%', '71.080%', '72.021%', '72.235%', '72.642%', '73.283%', '73.390%', '73.561%', '73.690%', '73.904%', '74.374%']
Workers federated accuracies:  ['61.326%', '63.529%', '67.273%', '67.979%', '69.840%', '71.080%', '72.021%', '72.235%', '72.642%', '73.283%', '73.390%', '73.561%', '73.690%', '73.904%', '74.374%']
Workers improved  accuracies:  ['2.524%', '4.513%', '7.615%', '7.957%', '9.561%', '9.947%', '10.610%', '10.802%', '10.310%', '10.802%', '10.717%', '10.118%', '9.947%', '9.690%', '9.840%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 7:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.2000%', '77.2000%', '77.2000%', '77.2000%', '77.2667%', '77.2000%', '77.1333%', '77.1333%', '77.2000%', '77.2000%', '77.2667%', '77.2667%', '77.2667%', '77.3333%', '77.2667%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0667, 0.0666, 0.0667, 0.0668, 0.0668, 0.0667,
        0.0667, 0.0666, 0.0666, 0.0666, 0.0665, 0.0666])
Federated model performance: Loss: 0.548639. Accuracy: 76.8984%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['61.754%', '64.257%', '68.385%', '68.963%', '70.695%', '71.979%', '72.471%', '72.663%', '72.920%', '73.690%', '73.882%', '73.947%', '74.053%', '74.353%', '74.802%']
Workers federated accuracies:  ['61.754%', '64.257%', '68.385%', '68.963%', '70.695%', '71.979%', '72.471%', '72.663%', '72.920%', '73.690%', '73.882%', '73.947%', '74.053%', '74.353%', '74.802%']
Workers improved  accuracies:  ['2.952%', '5.241%', '8.727%', '8.941%', '10.417%', '10.845%', '11.059%', '11.230%', '10.588%', '11.209%', '11.209%', '10.503%', '10.310%', '10.139%', '10.267%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 8:
Federated model validation accuracy : 77.2000%
Leave-one-out validation accuracies :  ['77.2000%', '77.2000%', '77.2000%', '77.2667%', '77.2667%', '77.2667%', '77.2667%', '77.2667%', '77.3333%', '77.2667%', '77.1333%', '77.2000%', '77.4667%', '77.5333%', '77.4667%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0666,
        0.0667, 0.0669, 0.0668, 0.0664, 0.0663, 0.0664])
Federated model performance: Loss: 0.573282. Accuracy: 77.3048%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['62.139%', '65.048%', '68.963%', '69.840%', '71.251%', '72.299%', '72.791%', '72.963%', '73.647%', '74.353%', '74.417%', '74.567%', '74.267%', '74.824%', '75.294%']
Workers federated accuracies:  ['62.139%', '65.048%', '68.963%', '69.840%', '71.251%', '72.299%', '72.791%', '72.963%', '73.647%', '74.353%', '74.417%', '74.567%', '74.267%', '74.824%', '75.294%']
Workers improved  accuracies:  ['3.337%', '6.032%', '9.305%', '9.818%', '10.973%', '11.166%', '11.380%', '11.529%', '11.316%', '11.872%', '11.743%', '11.123%', '10.524%', '10.610%', '10.759%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 9:
Federated model validation accuracy : 77.0667%
Leave-one-out validation accuracies :  ['77.0667%', '77.0667%', '77.0667%', '77.1333%', '77.3333%', '77.4000%', '77.4667%', '77.4667%', '77.5333%', '77.5333%', '77.4667%', '77.4667%', '77.5333%', '77.5333%', '77.5333%']
Computed and normalized credits:  tensor([0.0671, 0.0671, 0.0671, 0.0670, 0.0667, 0.0666, 0.0665, 0.0665, 0.0664,
        0.0664, 0.0666, 0.0665, 0.0664, 0.0664, 0.0664])
Federated model performance: Loss: 0.598389. Accuracy: 77.3476%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['62.588%', '65.540%', '69.668%', '70.545%', '71.829%', '72.749%', '73.091%', '73.433%', '73.947%', '74.588%', '74.738%', '74.952%', '74.952%', '75.209%', '75.658%']
Workers federated accuracies:  ['62.588%', '65.540%', '69.668%', '70.545%', '71.829%', '72.749%', '73.091%', '73.433%', '73.947%', '74.588%', '74.738%', '74.952%', '74.952%', '75.209%', '75.658%']
Workers improved  accuracies:  ['3.786%', '6.524%', '10.011%', '10.524%', '11.551%', '11.615%', '11.679%', '12.000%', '11.615%', '12.107%', '12.064%', '11.508%', '11.209%', '10.995%', '11.123%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 10:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.4000%', '77.4000%', '77.4000%', '77.4667%', '77.5333%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6000%', '77.6667%', '77.7333%', '77.8000%', '77.8000%']
Computed and normalized credits:  tensor([0.0670, 0.0670, 0.0670, 0.0669, 0.0667, 0.0666, 0.0666, 0.0666, 0.0666,
        0.0666, 0.0666, 0.0665, 0.0664, 0.0663, 0.0663])
Federated model performance: Loss: 0.623391. Accuracy: 77.4332%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['62.909%', '66.289%', '70.182%', '71.508%', '72.428%', '73.091%', '73.348%', '73.925%', '74.396%', '74.930%', '75.144%', '75.209%', '75.422%', '75.572%', '76.086%']
Workers federated accuracies:  ['62.909%', '66.289%', '70.182%', '71.508%', '72.428%', '73.091%', '73.348%', '73.925%', '74.396%', '74.930%', '75.144%', '75.209%', '75.422%', '75.572%', '76.086%']
Workers improved  accuracies:  ['4.107%', '7.273%', '10.524%', '11.487%', '12.150%', '11.957%', '11.936%', '12.492%', '12.064%', '12.449%', '12.471%', '11.765%', '11.679%', '11.358%', '11.551%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.623391. Accuracy: 77.4332%.
Workers before    accuracies:  ['58.802%', '59.016%', '59.658%', '60.021%', '60.278%', '61.134%', '61.412%', '61.433%', '62.332%', '62.481%', '62.674%', '63.444%', '63.743%', '64.214%', '64.535%']
Workers standlone accuracies:  ['62.909%', '66.289%', '70.182%', '71.508%', '72.428%', '73.091%', '73.348%', '73.925%', '74.396%', '74.930%', '75.144%', '75.209%', '75.422%', '75.572%', '76.086%']
Workers federated accuracies:  ['62.909%', '66.289%', '70.182%', '71.508%', '72.428%', '73.091%', '73.348%', '73.925%', '74.396%', '74.930%', '75.144%', '75.209%', '75.422%', '75.572%', '76.086%']
Workers improved  accuracies:  ['4.107%', '7.273%', '10.524%', '11.487%', '12.150%', '11.957%', '11.936%', '12.492%', '12.064%', '12.449%', '12.471%', '11.765%', '11.679%', '11.358%', '11.551%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]
Workers sharing_contributions :  tensor([  7.4667,  14.9333,  22.4000,  29.8667,  37.3333,  45.8667,  53.3333,
         60.8000,  68.2667,  75.7333,  83.2000,  90.6667,  98.1333, 105.6000,
        113.0667])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.19046338555598052, 0.49654730710056527)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.8669289926745296, 2.87317753619929e-05)
Correlation between test_acc improvements & sharing_contributions:  (0.5960837104222851, 0.01901879255252293)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.750629. Accuracy: 48.4492%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 73.8667%
Leave-one-out validation accuracies :  ['73.8667%', '73.7333%', '74.1333%', '74.2667%', '74.6667%', '74.7333%', '74.8667%', '74.8667%', '75.4000%', '75.4667%', '75.4667%', '75.6000%', '75.6667%', '75.8667%', '75.7333%']
Computed and normalized credits:  tensor([0.0683, 0.0685, 0.0679, 0.0677, 0.0671, 0.0670, 0.0668, 0.0668, 0.0660,
        0.0659, 0.0659, 0.0657, 0.0656, 0.0653, 0.0655])
Federated model performance: Loss: 0.559196. Accuracy: 74.2674%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['44.856%', '45.968%', '47.465%', '48.171%', '49.155%', '51.273%', '52.556%', '53.754%', '55.658%', '56.107%', '56.770%', '57.604%', '58.995%', '59.914%', '60.791%']
Workers federated accuracies:  ['44.856%', '45.968%', '47.465%', '48.171%', '49.155%', '51.273%', '52.556%', '53.754%', '55.658%', '56.107%', '56.770%', '57.604%', '58.995%', '59.914%', '60.791%']
Workers improved  accuracies:  ['0.706%', '1.176%', '1.925%', '2.139%', '2.674%', '3.829%', '4.556%', '5.155%', '6.225%', '6.417%', '6.695%', '6.674%', '7.572%', '7.487%', '7.829%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 2:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.6667%', '75.6667%', '75.6667%', '75.7333%', '75.8667%', '76.0000%', '75.6000%', '75.8000%', '75.9333%', '75.6667%', '75.6667%', '75.6667%', '75.5333%', '75.7333%', '75.7333%']
Computed and normalized credits:  tensor([0.0670, 0.0670, 0.0669, 0.0668, 0.0665, 0.0663, 0.0669, 0.0666, 0.0663,
        0.0667, 0.0667, 0.0666, 0.0668, 0.0665, 0.0665])
Federated model performance: Loss: 0.498542. Accuracy: 75.7433%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['45.412%', '47.166%', '49.326%', '50.610%', '52.171%', '55.273%', '57.048%', '57.754%', '59.701%', '61.048%', '61.369%', '62.695%', '64.791%', '65.326%', '66.053%']
Workers federated accuracies:  ['45.412%', '47.166%', '49.326%', '50.610%', '52.171%', '55.273%', '57.048%', '57.754%', '59.701%', '61.048%', '61.369%', '62.695%', '64.791%', '65.326%', '66.053%']
Workers improved  accuracies:  ['1.262%', '2.374%', '3.786%', '4.578%', '5.690%', '7.829%', '9.048%', '9.155%', '10.267%', '11.358%', '11.294%', '11.765%', '13.369%', '12.898%', '13.091%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 3:
Federated model validation accuracy : 75.9333%
Leave-one-out validation accuracies :  ['76.0000%', '76.0000%', '75.9333%', '75.8667%', '76.0000%', '75.8000%', '75.8667%', '75.8667%', '75.6667%', '75.6667%', '75.7333%', '75.8000%', '75.8000%', '75.8667%', '75.9333%']
Computed and normalized credits:  tensor([0.0665, 0.0665, 0.0666, 0.0667, 0.0664, 0.0667, 0.0667, 0.0666, 0.0669,
        0.0669, 0.0668, 0.0667, 0.0668, 0.0666, 0.0665])
Federated model performance: Loss: 0.505822. Accuracy: 76.0428%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['46.225%', '48.171%', '51.401%', '53.390%', '55.016%', '58.396%', '60.064%', '61.091%', '63.765%', '64.492%', '65.455%', '67.230%', '68.898%', '69.305%', '69.775%']
Workers federated accuracies:  ['46.225%', '48.171%', '51.401%', '53.390%', '55.016%', '58.396%', '60.064%', '61.091%', '63.765%', '64.492%', '65.455%', '67.230%', '68.898%', '69.305%', '69.775%']
Workers improved  accuracies:  ['2.075%', '3.380%', '5.861%', '7.358%', '8.535%', '10.952%', '12.064%', '12.492%', '14.332%', '14.802%', '15.380%', '16.299%', '17.476%', '16.877%', '16.813%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 4:
Federated model validation accuracy : 75.8667%
Leave-one-out validation accuracies :  ['75.8000%', '75.8000%', '75.8667%', '75.8000%', '75.8000%', '75.8000%', '75.8000%', '75.6667%', '75.5333%', '75.8000%', '75.8667%', '76.0000%', '76.0000%', '75.7333%', '75.8000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0666, 0.0667, 0.0666, 0.0667, 0.0667, 0.0669, 0.0671,
        0.0667, 0.0666, 0.0664, 0.0664, 0.0668, 0.0667])
Federated model performance: Loss: 0.543888. Accuracy: 76.0428%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['46.717%', '49.412%', '53.348%', '55.679%', '57.476%', '61.241%', '63.123%', '64.257%', '66.888%', '67.615%', '68.492%', '69.797%', '70.824%', '71.251%', '71.722%']
Workers federated accuracies:  ['46.717%', '49.412%', '53.348%', '55.679%', '57.476%', '61.241%', '63.123%', '64.257%', '66.888%', '67.615%', '68.492%', '69.797%', '70.824%', '71.251%', '71.722%']
Workers improved  accuracies:  ['2.567%', '4.620%', '7.807%', '9.647%', '10.995%', '13.797%', '15.123%', '15.658%', '17.455%', '17.925%', '18.417%', '18.866%', '19.401%', '18.824%', '18.759%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 5:
Federated model validation accuracy : 75.7333%
Leave-one-out validation accuracies :  ['75.7333%', '75.8000%', '75.8667%', '75.8667%', '75.8667%', '75.9333%', '75.9333%', '75.8667%', '75.8667%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.8000%', '75.7333%']
Computed and normalized credits:  tensor([0.0668, 0.0667, 0.0666, 0.0666, 0.0666, 0.0665, 0.0665, 0.0666, 0.0666,
        0.0668, 0.0668, 0.0668, 0.0668, 0.0667, 0.0668])
Federated model performance: Loss: 0.594538. Accuracy: 76.0214%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['47.508%', '50.610%', '55.230%', '57.433%', '59.594%', '63.850%', '65.861%', '66.652%', '68.920%', '69.711%', '70.139%', '70.973%', '72.064%', '72.299%', '73.241%']
Workers federated accuracies:  ['47.508%', '50.610%', '55.230%', '57.433%', '59.594%', '63.850%', '65.861%', '66.652%', '68.920%', '69.711%', '70.139%', '70.973%', '72.064%', '72.299%', '73.241%']
Workers improved  accuracies:  ['3.358%', '5.818%', '9.690%', '11.401%', '13.112%', '16.406%', '17.861%', '18.053%', '19.487%', '20.021%', '20.064%', '20.043%', '20.642%', '19.872%', '20.278%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 6:
Federated model validation accuracy : 75.7333%
Leave-one-out validation accuracies :  ['75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.7333%', '75.8000%', '75.8000%', '75.8667%', '75.8000%', '75.8667%', '75.8667%', '75.9333%', '75.9333%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0668, 0.0668, 0.0668, 0.0667, 0.0667, 0.0667, 0.0667,
        0.0666, 0.0667, 0.0666, 0.0666, 0.0665, 0.0665])
Federated model performance: Loss: 0.649995. Accuracy: 76.1497%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['48.128%', '52.021%', '56.941%', '59.337%', '61.861%', '65.840%', '67.872%', '68.856%', '70.417%', '70.995%', '71.337%', '72.214%', '72.898%', '73.241%', '74.075%']
Workers federated accuracies:  ['48.128%', '52.021%', '56.941%', '59.337%', '61.861%', '65.840%', '67.872%', '68.856%', '70.417%', '70.995%', '71.337%', '72.214%', '72.898%', '73.241%', '74.075%']
Workers improved  accuracies:  ['3.979%', '7.230%', '11.401%', '13.305%', '15.380%', '18.396%', '19.872%', '20.257%', '20.984%', '21.305%', '21.262%', '21.283%', '21.476%', '20.813%', '21.112%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 7:
Federated model validation accuracy : 75.8667%
Leave-one-out validation accuracies :  ['75.8667%', '75.8667%', '75.9333%', '75.8667%', '75.8000%', '75.8667%', '75.8667%', '75.9333%', '76.0000%', '76.0000%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%']
Computed and normalized credits:  tensor([0.0668, 0.0668, 0.0667, 0.0668, 0.0669, 0.0668, 0.0668, 0.0667, 0.0666,
        0.0666, 0.0665, 0.0665, 0.0665, 0.0665, 0.0665])
Federated model performance: Loss: 0.706274. Accuracy: 76.2353%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['48.749%', '53.283%', '58.096%', '61.005%', '63.594%', '67.615%', '69.412%', '70.011%', '71.380%', '72.000%', '72.214%', '73.048%', '74.053%', '74.203%', '75.166%']
Workers federated accuracies:  ['48.749%', '53.283%', '58.096%', '61.005%', '63.594%', '67.615%', '69.412%', '70.011%', '71.380%', '72.000%', '72.214%', '73.048%', '74.053%', '74.203%', '75.166%']
Workers improved  accuracies:  ['4.599%', '8.492%', '12.556%', '14.973%', '17.112%', '20.171%', '21.412%', '21.412%', '21.947%', '22.310%', '22.139%', '22.118%', '22.631%', '21.775%', '22.203%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 8:
Federated model validation accuracy : 76.0000%
Leave-one-out validation accuracies :  ['76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.1333%', '76.2000%']
Computed and normalized credits:  tensor([0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667, 0.0667,
        0.0667, 0.0667, 0.0667, 0.0667, 0.0666, 0.0665])
Federated model performance: Loss: 0.762203. Accuracy: 76.2353%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['49.455%', '54.096%', '59.594%', '62.759%', '65.305%', '68.877%', '70.738%', '71.016%', '71.914%', '72.898%', '73.112%', '73.818%', '74.845%', '75.166%', '75.979%']
Workers federated accuracies:  ['49.455%', '54.096%', '59.594%', '62.759%', '65.305%', '68.877%', '70.738%', '71.016%', '71.914%', '72.898%', '73.112%', '73.818%', '74.845%', '75.166%', '75.979%']
Workers improved  accuracies:  ['5.305%', '9.305%', '14.053%', '16.727%', '18.824%', '21.433%', '22.738%', '22.417%', '22.481%', '23.209%', '23.037%', '22.888%', '23.422%', '22.738%', '23.016%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 9:
Federated model validation accuracy : 76.0667%
Leave-one-out validation accuracies :  ['76.0667%', '76.0667%', '76.0667%', '76.0667%', '76.1333%', '76.1333%', '76.1333%', '76.1333%', '76.2000%', '76.2000%', '76.2000%', '76.2667%', '76.3333%', '76.4667%', '76.4667%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0669, 0.0669, 0.0668, 0.0668, 0.0668, 0.0668, 0.0667,
        0.0667, 0.0667, 0.0666, 0.0665, 0.0663, 0.0663])
Federated model performance: Loss: 0.814002. Accuracy: 76.3209%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['50.075%', '55.251%', '61.005%', '64.107%', '66.503%', '69.925%', '71.465%', '71.914%', '72.663%', '73.840%', '73.754%', '74.588%', '75.273%', '75.508%', '76.449%']
Workers federated accuracies:  ['50.075%', '55.251%', '61.005%', '64.107%', '66.503%', '69.925%', '71.465%', '71.914%', '72.663%', '73.840%', '73.754%', '74.588%', '75.273%', '75.508%', '76.449%']
Workers improved  accuracies:  ['5.925%', '10.460%', '15.465%', '18.075%', '20.021%', '22.481%', '23.465%', '23.316%', '23.230%', '24.150%', '23.679%', '23.658%', '23.850%', '23.080%', '23.487%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Epoch 10:
Federated model validation accuracy : 76.2667%
Leave-one-out validation accuracies :  ['76.2667%', '76.2667%', '76.2667%', '76.2667%', '76.2667%', '76.4000%', '76.4667%', '76.4667%', '76.4000%', '76.4000%', '76.4667%', '76.4667%', '76.4667%', '76.4000%', '76.5333%']
Computed and normalized credits:  tensor([0.0669, 0.0669, 0.0669, 0.0669, 0.0669, 0.0667, 0.0666, 0.0666, 0.0666,
        0.0666, 0.0666, 0.0665, 0.0665, 0.0666, 0.0664])
Federated model performance: Loss: 0.864019. Accuracy: 76.2995%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['50.738%', '56.791%', '62.246%', '65.455%', '67.444%', '71.102%', '72.064%', '72.599%', '72.984%', '74.225%', '74.503%', '75.251%', '75.701%', '76.021%', '76.749%']
Workers federated accuracies:  ['50.738%', '56.791%', '62.246%', '65.455%', '67.444%', '71.102%', '72.064%', '72.599%', '72.984%', '74.225%', '74.503%', '75.251%', '75.701%', '76.021%', '76.749%']
Workers improved  accuracies:  ['6.588%', '12.000%', '16.706%', '19.422%', '20.963%', '23.658%', '24.064%', '24.000%', '23.551%', '24.535%', '24.428%', '24.321%', '24.278%', '23.594%', '23.786%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.864019. Accuracy: 76.2995%.
Workers before    accuracies:  ['44.150%', '44.791%', '45.540%', '46.032%', '46.481%', '47.444%', '48.000%', '48.599%', '49.433%', '49.690%', '50.075%', '50.930%', '51.422%', '52.428%', '52.963%']
Workers standlone accuracies:  ['50.738%', '56.791%', '62.246%', '65.455%', '67.444%', '71.102%', '72.064%', '72.599%', '72.984%', '74.225%', '74.503%', '75.251%', '75.701%', '76.021%', '76.749%']
Workers federated accuracies:  ['50.738%', '56.791%', '62.246%', '65.455%', '67.444%', '71.102%', '72.064%', '72.599%', '72.984%', '74.225%', '74.503%', '75.251%', '75.701%', '76.021%', '76.749%']
Workers improved  accuracies:  ['6.588%', '12.000%', '16.706%', '19.422%', '20.963%', '23.658%', '24.064%', '24.000%', '23.551%', '24.535%', '24.428%', '24.321%', '24.278%', '23.594%', '23.786%']
Workers shard sizes:  [112, 224, 336, 448, 560, 688, 800, 912, 1024, 1136, 1248, 1360, 1472, 1584, 1696]
Workers sharing_contributions :  tensor([  7.4667,  14.9333,  22.4000,  29.8667,  37.3333,  45.8667,  53.3333,
         60.8000,  68.2667,  75.7333,  83.2000,  90.6667,  98.1333, 105.6000,
        113.0667])
Correlation between stand alone test acc & perturbed federated test acc:  (0.341176067198185, 0.21331714229141088)
Correlation between stand alone test acc & collaborative final model acc:  (1.0, 0.0)
Correlation between test_acc & sharing contributions:  (0.8977971522090435, 5.582632520544075e-06)
Correlation between test_acc improvements & sharing_contributions:  (0.7747525648258533, 0.0006941408243379053)
standalone_vs_final_corr [[1.0], [1.0], [1.0], [1.0], [1.0]]
standalone_vs_final_corr_mean [1.0]
standalone_vs_final_corr_std [0.0]
sharingcontribution_vs_final_corr [[0.9114094700963692], [0.9379431222161329], [0.9055036422217351], [0.8669289926745296], [0.8977971522090435]]
sharingcontribution_vs_final_corr_mean [0.9039164758835619]
sharingcontribution_vs_final_corr_std [0.022899767493457325]
standalone_vs_federated_perturbed_corr [[-0.585762288000638], [-0.21367477278359903], [0.1131748744331443], [-0.19046338555598052], [0.341176067198185]]
standalone_vs_federated_perturbed_corr_mean [-0.10710990094177766]
standalone_vs_federated_perturbed_corr_std [0.31524519804060536]
federated_final_performance [0.7640641927719116, 0.773689866065979, 0.7681283354759216, 0.7743315696716309, 0.762994647026062]
federated_final_performance_mean 0.768641722202301
federated_final_performance_std 0.004710943012935464
CFFL_best_worker [0.7623529434204102, 0.744171142578125, 0.7458823323249817, 0.7608556151390076, 0.7674866318702698]
CFFL_best_worker_mean 0.7561497330665589
CFFL_best_worker_std 0.009360091530933248
standalone_best_worker [0.7623529434204102, 0.744171142578125, 0.7458823323249817, 0.7608556151390076, 0.7674866318702698]
standalone_best_worker_mean 0.7561497330665589
standalone_best_worker_std 0.009360091530933248
