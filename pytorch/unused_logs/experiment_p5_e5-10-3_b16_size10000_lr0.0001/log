Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'power_law', 'sharing_lambda': 0.1, 'batch_size': 16, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 5, 'fl_epochs': 10, 'fl_individual_epochs': 3}
Experiment : No.1/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.796072. Accuracy: 46.1604%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 64.2000%
Leave-one-out validation accuracies :  ['64.3000%', '66.4000%', '67.7000%', '68.4000%', '70.5000%']
Computed and normalized credits:  tensor([0.2135, 0.2043, 0.1988, 0.1959, 0.1874])
Federated model performance: Loss: 0.714299. Accuracy: 61.0267%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['40.834%', '45.561%', '51.187%', '56.107%', '60.599%']
Workers federated accuracies:  ['49.775%', '53.112%', '56.770%', '59.294%', '62.332%']
Workers improved  accuracies:  ['9.198%', '10.203%', '10.353%', '9.412%', '8.749%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 2:
Federated model validation accuracy : 68.6000%
Leave-one-out validation accuracies :  ['68.7000%', '68.4000%', '69.1000%', '70.6000%', '72.2000%']
Computed and normalized credits:  tensor([0.2082, 0.2068, 0.2023, 0.1956, 0.1870])
Federated model performance: Loss: 0.661066. Accuracy: 68.3209%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['41.455%', '47.829%', '55.465%', '60.877%', '65.668%']
Workers federated accuracies:  ['56.193%', '60.471%', '64.021%', '66.139%', '68.235%']
Workers improved  accuracies:  ['15.615%', '17.561%', '17.604%', '16.257%', '14.652%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 3:
Federated model validation accuracy : 70.5000%
Leave-one-out validation accuracies :  ['70.4000%', '70.8000%', '71.1000%', '72.9000%', '73.5000%']
Computed and normalized credits:  tensor([0.2075, 0.2055, 0.2031, 0.1943, 0.1895])
Federated model performance: Loss: 0.625173. Accuracy: 71.0588%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['41.968%', '50.888%', '59.187%', '65.134%', '69.134%']
Workers federated accuracies:  ['61.326%', '65.283%', '68.257%', '69.497%', '70.930%']
Workers improved  accuracies:  ['20.749%', '22.374%', '21.840%', '19.615%', '17.348%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 4:
Federated model validation accuracy : 72.6000%
Leave-one-out validation accuracies :  ['72.7000%', '73.1000%', '73.3000%', '73.8000%', '74.8000%']
Computed and normalized credits:  tensor([0.2053, 0.2032, 0.2018, 0.1974, 0.1923])
Federated model performance: Loss: 0.599862. Accuracy: 72.4064%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['42.353%', '53.390%', '62.973%', '67.722%', '70.845%']
Workers federated accuracies:  ['64.834%', '68.406%', '70.396%', '71.679%', '72.556%']
Workers improved  accuracies:  ['24.257%', '25.497%', '23.979%', '21.797%', '18.973%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 5:
Federated model validation accuracy : 74.5000%
Leave-one-out validation accuracies :  ['74.6000%', '74.4000%', '74.8000%', '75.2000%', '75.4000%']
Computed and normalized credits:  tensor([0.2025, 0.2027, 0.2008, 0.1981, 0.1959])
Federated model performance: Loss: 0.582135. Accuracy: 73.5829%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['42.866%', '55.636%', '65.476%', '69.882%', '72.021%']
Workers federated accuracies:  ['67.465%', '69.818%', '71.893%', '72.856%', '73.540%']
Workers improved  accuracies:  ['26.888%', '26.909%', '25.476%', '22.973%', '19.957%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 6:
Federated model validation accuracy : 75.1000%
Leave-one-out validation accuracies :  ['75.1000%', '75.4000%', '75.3000%', '75.4000%', '75.9000%']
Computed and normalized credits:  tensor([0.2019, 0.2008, 0.2007, 0.1995, 0.1971])
Federated model performance: Loss: 0.569250. Accuracy: 74.5027%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['43.294%', '57.647%', '67.251%', '71.380%', '73.134%']
Workers federated accuracies:  ['69.155%', '71.337%', '73.348%', '73.904%', '74.674%']
Workers improved  accuracies:  ['28.578%', '28.428%', '26.930%', '24.021%', '21.091%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 7:
Federated model validation accuracy : 75.5000%
Leave-one-out validation accuracies :  ['75.5000%', '75.5000%', '75.6000%', '75.9000%', '76.3000%']
Computed and normalized credits:  tensor([0.2015, 0.2012, 0.2008, 0.1994, 0.1973])
Federated model performance: Loss: 0.559202. Accuracy: 75.6150%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['43.850%', '59.594%', '68.984%', '72.278%', '73.882%']
Workers federated accuracies:  ['70.203%', '72.449%', '74.011%', '74.610%', '75.251%']
Workers improved  accuracies:  ['29.626%', '29.540%', '27.594%', '24.727%', '21.668%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 8:
Federated model validation accuracy : 76.3000%
Leave-one-out validation accuracies :  ['76.3000%', '76.1000%', '76.0000%', '76.3000%', '76.6000%']
Computed and normalized credits:  tensor([0.2003, 0.2009, 0.2011, 0.1997, 0.1980])
Federated model performance: Loss: 0.550999. Accuracy: 76.4064%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['44.471%', '61.497%', '70.160%', '73.241%', '74.610%']
Workers federated accuracies:  ['71.358%', '73.305%', '74.460%', '75.230%', '75.615%']
Workers improved  accuracies:  ['30.781%', '30.396%', '28.043%', '25.348%', '22.032%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 9:
Federated model validation accuracy : 76.5000%
Leave-one-out validation accuracies :  ['76.5000%', '76.4000%', '76.5000%', '76.6000%', '76.9000%']
Computed and normalized credits:  tensor([0.2004, 0.2009, 0.2006, 0.1998, 0.1983])
Federated model performance: Loss: 0.544093. Accuracy: 76.7059%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['45.005%', '63.187%', '71.294%', '73.947%', '75.209%']
Workers federated accuracies:  ['72.107%', '73.775%', '74.995%', '75.893%', '76.385%']
Workers improved  accuracies:  ['31.529%', '30.866%', '28.578%', '26.011%', '22.802%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 10:
Federated model validation accuracy : 76.7000%
Leave-one-out validation accuracies :  ['76.6000%', '76.6000%', '76.7000%', '76.9000%', '76.9000%']
Computed and normalized credits:  tensor([0.2006, 0.2007, 0.2003, 0.1994, 0.1990])
Federated model performance: Loss: 0.538536. Accuracy: 77.0053%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['45.433%', '64.963%', '72.235%', '74.460%', '75.679%']
Workers federated accuracies:  ['72.877%', '74.225%', '75.444%', '76.278%', '76.663%']
Workers improved  accuracies:  ['32.299%', '31.316%', '29.027%', '26.396%', '23.080%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.538536. Accuracy: 77.0053%.
Workers before    accuracies:  ['40.578%', '42.909%', '46.417%', '49.882%', '53.583%']
Workers standlone accuracies:  ['45.433%', '64.963%', '72.235%', '74.460%', '75.679%']
Workers federated accuracies:  ['72.877%', '74.225%', '75.444%', '76.278%', '76.663%']
Workers improved  accuracies:  ['32.299%', '31.316%', '29.027%', '26.396%', '23.080%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]
Workers sharing_contributions :  tensor([ 44.8000, 201.6000, 361.6000, 521.6000, 678.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.005483122112586086, 0.9930187070796395)
Correlation between stand alone test acc & collaborative final model acc:  (0.9496216310593179, 0.013470715653709211)
Correlation between test_acc & sharing contributions:  (0.9796166612897448, 0.0034826875685324706)
Correlation between test_acc improvements & sharing_contributions:  (-0.9835427534886049, 0.0025281021361337045)
Experiment : No.2/2
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.736289. Accuracy: 52.5348%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 64.7000%
Leave-one-out validation accuracies :  ['64.7000%', '65.8000%', '67.0000%', '67.9000%', '68.7000%']
Computed and normalized credits:  tensor([0.2089, 0.2042, 0.1992, 0.1955, 0.1922])
Federated model performance: Loss: 0.658687. Accuracy: 65.0267%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['45.305%', '52.257%', '57.326%', '61.968%', '64.321%']
Workers federated accuracies:  ['57.112%', '60.364%', '62.802%', '64.321%', '65.198%']
Workers improved  accuracies:  ['12.663%', '10.952%', '9.690%', '8.428%', '6.439%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 2:
Federated model validation accuracy : 67.7000%
Leave-one-out validation accuracies :  ['67.7000%', '67.8000%', '68.7000%', '68.7000%', '71.2000%']
Computed and normalized credits:  tensor([0.2070, 0.2053, 0.2002, 0.1991, 0.1884])
Federated model performance: Loss: 0.608750. Accuracy: 69.0909%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['45.775%', '54.845%', '61.134%', '64.941%', '66.610%']
Workers federated accuracies:  ['62.866%', '64.920%', '66.866%', '68.107%', '69.091%']
Workers improved  accuracies:  ['18.417%', '15.508%', '13.754%', '12.214%', '10.332%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 3:
Federated model validation accuracy : 69.8000%
Leave-one-out validation accuracies :  ['69.8000%', '69.7000%', '70.3000%', '71.7000%', '72.6000%']
Computed and normalized credits:  tensor([0.2060, 0.2058, 0.2020, 0.1963, 0.1898])
Federated model performance: Loss: 0.576828. Accuracy: 70.8663%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['46.225%', '57.540%', '63.872%', '66.759%', '68.663%']
Workers federated accuracies:  ['66.096%', '67.872%', '69.412%', '70.417%', '70.973%']
Workers improved  accuracies:  ['21.647%', '18.460%', '16.299%', '14.524%', '12.214%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 4:
Federated model validation accuracy : 71.0000%
Leave-one-out validation accuracies :  ['71.2000%', '71.8000%', '72.3000%', '72.9000%', '73.3000%']
Computed and normalized credits:  tensor([0.2059, 0.2036, 0.2006, 0.1966, 0.1932])
Federated model performance: Loss: 0.555975. Accuracy: 72.4278%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['47.187%', '59.979%', '65.198%', '68.406%', '70.225%']
Workers federated accuracies:  ['67.979%', '69.497%', '70.460%', '71.636%', '72.299%']
Workers improved  accuracies:  ['23.529%', '20.086%', '17.348%', '15.743%', '13.540%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 5:
Federated model validation accuracy : 72.8000%
Leave-one-out validation accuracies :  ['72.9000%', '72.9000%', '73.5000%', '73.5000%', '73.7000%']
Computed and normalized credits:  tensor([0.2032, 0.2025, 0.1994, 0.1983, 0.1966])
Federated model performance: Loss: 0.541110. Accuracy: 73.4545%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['47.893%', '61.797%', '66.695%', '69.882%', '71.594%']
Workers federated accuracies:  ['69.219%', '70.759%', '71.444%', '73.005%', '73.947%']
Workers improved  accuracies:  ['24.770%', '21.348%', '18.332%', '17.112%', '15.187%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 6:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.4000%', '73.7000%', '73.7000%', '73.8000%']
Computed and normalized credits:  tensor([0.2011, 0.2016, 0.1996, 0.1993, 0.1984])
Federated model performance: Loss: 0.530524. Accuracy: 74.1390%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['48.620%', '63.422%', '67.465%', '70.973%', '73.155%']
Workers federated accuracies:  ['70.567%', '71.701%', '72.706%', '73.818%', '74.695%']
Workers improved  accuracies:  ['26.118%', '22.289%', '19.594%', '17.925%', '15.936%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 7:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['73.6000%', '73.8000%', '73.7000%', '73.9000%', '74.0000%']
Computed and normalized credits:  tensor([0.2010, 0.2005, 0.2003, 0.1994, 0.1988])
Federated model performance: Loss: 0.522174. Accuracy: 74.9305%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['49.283%', '64.043%', '68.770%', '72.278%', '74.118%']
Workers federated accuracies:  ['71.444%', '72.385%', '73.604%', '74.310%', '74.930%']
Workers improved  accuracies:  ['26.995%', '22.973%', '20.492%', '18.417%', '16.171%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 8:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.0000%', '73.9000%', '74.1000%', '74.2000%']
Computed and normalized credits:  tensor([0.1999, 0.2004, 0.2007, 0.1998, 0.1992])
Federated model performance: Loss: 0.516051. Accuracy: 75.3369%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['49.818%', '65.027%', '69.497%', '72.941%', '74.738%']
Workers federated accuracies:  ['72.043%', '73.005%', '74.267%', '74.802%', '75.401%']
Workers improved  accuracies:  ['27.594%', '23.594%', '21.155%', '18.909%', '16.642%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 9:
Federated model validation accuracy : 74.2000%
Leave-one-out validation accuracies :  ['74.2000%', '74.4000%', '74.2000%', '74.5000%', '74.5000%']
Computed and normalized credits:  tensor([0.2005, 0.2000, 0.2008, 0.1994, 0.1993])
Federated model performance: Loss: 0.511169. Accuracy: 75.5508%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['50.225%', '65.818%', '70.032%', '73.947%', '75.166%']
Workers federated accuracies:  ['72.449%', '73.326%', '74.738%', '75.401%', '75.850%']
Workers improved  accuracies:  ['28.000%', '23.914%', '21.626%', '19.508%', '17.091%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Epoch 10:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.4000%', '74.4000%', '74.4000%', '74.6000%', '74.8000%']
Computed and normalized credits:  tensor([0.2006, 0.2004, 0.2007, 0.1995, 0.1988])
Federated model performance: Loss: 0.506844. Accuracy: 75.9144%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['50.717%', '66.503%', '70.759%', '74.545%', '75.273%']
Workers federated accuracies:  ['72.727%', '73.861%', '75.080%', '75.807%', '76.150%']
Workers improved  accuracies:  ['28.278%', '24.449%', '21.968%', '19.914%', '17.390%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.506844. Accuracy: 75.9144%.
Workers before    accuracies:  ['44.449%', '49.412%', '53.112%', '55.893%', '58.759%']
Workers standlone accuracies:  ['50.717%', '66.503%', '70.759%', '74.545%', '75.273%']
Workers federated accuracies:  ['72.727%', '73.861%', '75.080%', '75.807%', '76.150%']
Workers improved  accuracies:  ['28.278%', '24.449%', '21.968%', '19.914%', '17.390%']
Workers shard sizes:  [224, 1008, 1808, 2608, 3392]
Workers sharing_contributions :  tensor([ 44.8000, 201.6000, 361.6000, 521.6000, 678.4000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.6963072455408638, 0.1914866134189045)
Correlation between stand alone test acc & collaborative final model acc:  (0.9511432786878793, 0.01286802110216074)
Correlation between test_acc & sharing contributions:  (0.9791298949308138, 0.0036079171878252957)
Correlation between test_acc improvements & sharing_contributions:  (-0.9926430953911403, 0.000756652907274922)
standalone_vs_final_corr [[0.9496216310593179], [0.9511432786878793]]
standalone_vs_final_corr_mean [0.9503824548735986]
standalone_vs_final_corr_std [0.00076082381428072]
sharingcontribution_vs_final_corr [[0.9796166612897448], [0.9791298949308138]]
sharingcontribution_vs_final_corr_mean [0.9793732781102793]
sharingcontribution_vs_final_corr_std [0.00024338317946548393]
standalone_vs_federated_perturbed_corr [[0.005483122112586086], [-0.6963072455408638]]
standalone_vs_federated_perturbed_corr_mean [-0.34541206171413885]
standalone_vs_federated_perturbed_corr_std [0.3508951838267249]
federated_final_performance [0.7700534462928772, 0.7591443657875061]
federated_final_performance_mean 0.7645989060401917
federated_final_performance_std 0.005454540252685547
CFFL_best_worker [0.766631007194519, 0.7614973187446594]
CFFL_best_worker_mean 0.7640641629695892
CFFL_best_worker_std 0.0025668442249298096
standalone_best_worker [0.7567914724349976, 0.7527272701263428]
standalone_best_worker_mean 0.7547593712806702
standalone_best_worker_std 0.0020321011543273926
