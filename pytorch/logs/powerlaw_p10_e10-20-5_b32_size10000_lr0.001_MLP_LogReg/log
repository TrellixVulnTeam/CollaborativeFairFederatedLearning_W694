Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 10, 'split': 'powerlaw', 'sharing_lambda': 0.1, 'batch_size': 32, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.MLP_LogReg'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.001, 'pretrain_epochs': 10, 'fl_epochs': 20, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.693923. Accuracy: 49.0909%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['75.3000%', '74.7000%', '70.6000%', '66.8000%', '66.7000%', '67.5000%', '70.0000%', '71.3000%', '73.9000%', '76.0000%']
Computed and normalized credits:  tensor([0.0919, 0.0930, 0.1013, 0.1092, 0.1094, 0.1077, 0.1025, 0.0999, 0.0946,
        0.0905])
Federated model performance: Loss: 0.660356. Accuracy: 72.4064%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['48.642%', '46.267%', '54.246%', '52.941%', '50.674%', '60.620%', '54.396%', '52.193%', '64.471%', '66.310%']
Workers federated accuracies:  ['61.112%', '71.422%', '67.743%', '70.588%', '72.920%', '70.267%', '73.348%', '73.690%', '72.556%', '69.797%']
Workers improved  accuracies:  ['12.877%', '26.567%', '19.401%', '21.690%', '25.070%', '16.599%', '22.930%', '23.658%', '17.369%', '7.508%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 2:
Federated model validation accuracy : 51.1000%
Leave-one-out validation accuracies :  ['51.0000%', '50.4000%', '50.5000%', '50.2000%', '50.0000%', '50.0000%', '50.0000%', '50.0000%', '49.9000%', '49.9000%']
Computed and normalized credits:  tensor([0.0962, 0.0982, 0.0993, 0.1015, 0.1021, 0.1018, 0.1010, 0.1005, 0.1000,
        0.0993])
Federated model performance: Loss: 0.647704. Accuracy: 51.0374%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['48.834%', '47.765%', '55.636%', '58.374%', '53.818%', '64.000%', '58.182%', '55.594%', '68.941%', '68.770%']
Workers federated accuracies:  ['50.011%', '50.567%', '51.765%', '51.209%', '50.695%', '52.086%', '51.102%', '50.866%', '52.107%', '54.824%']
Workers improved  accuracies:  ['1.775%', '5.711%', '3.422%', '2.310%', '2.845%', '-1.583%', '0.684%', '0.834%', '-3.080%', '-7.465%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 3:
Federated model validation accuracy : 50.1000%
Leave-one-out validation accuracies :  ['50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%']
Computed and normalized credits:  tensor([0.0994, 0.0997, 0.0999, 0.1002, 0.1003, 0.1003, 0.1002, 0.1001, 0.1000,
        0.0999])
Federated model performance: Loss: 0.983842. Accuracy: 50.0321%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.070%', '49.754%', '56.471%', '61.497%', '56.278%', '66.289%', '61.904%', '58.374%', '71.872%', '70.738%']
Workers federated accuracies:  ['50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%']
Workers improved  accuracies:  ['1.797%', '5.176%', '1.690%', '1.134%', '2.182%', '-3.636%', '-0.385%', '0.000%', '-5.155%', '-12.257%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 4:
Federated model validation accuracy : 49.9000%
Leave-one-out validation accuracies :  ['49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%']
Computed and normalized credits:  tensor([0.0999, 0.1000, 0.1000, 0.1000, 0.1001, 0.1001, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.636869. Accuracy: 49.9679%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.283%', '52.150%', '57.262%', '63.893%', '59.380%', '68.749%', '66.545%', '64.727%', '73.369%', '72.620%']
Workers federated accuracies:  ['49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%']
Workers improved  accuracies:  ['1.733%', '5.112%', '1.626%', '1.070%', '2.118%', '-3.701%', '-0.449%', '-0.064%', '-5.219%', '-12.321%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 5:
Federated model validation accuracy : 50.1000%
Leave-one-out validation accuracies :  ['50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 6.977740. Accuracy: 50.0321%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.369%', '53.433%', '57.048%', '65.604%', '66.011%', '70.353%', '71.230%', '67.765%', '74.160%', '73.690%']
Workers federated accuracies:  ['50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%']
Workers improved  accuracies:  ['1.797%', '5.176%', '1.690%', '1.134%', '2.182%', '-3.636%', '-0.385%', '0.000%', '-5.155%', '-12.257%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 6:
Federated model validation accuracy : 49.9000%
Leave-one-out validation accuracies :  ['49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.456299. Accuracy: 49.9679%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.369%', '54.588%', '59.893%', '66.866%', '67.914%', '71.701%', '73.112%', '71.102%', '74.652%', '74.717%']
Workers federated accuracies:  ['49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%']
Workers improved  accuracies:  ['1.733%', '5.112%', '1.626%', '1.070%', '2.118%', '-3.701%', '-0.449%', '-0.064%', '-5.219%', '-12.321%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 7:
Federated model validation accuracy : 50.1000%
Leave-one-out validation accuracies :  ['50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.903100. Accuracy: 50.0321%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.326%', '55.701%', '61.176%', '68.663%', '68.877%', '72.513%', '74.160%', '73.711%', '75.380%', '75.465%']
Workers federated accuracies:  ['50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%']
Workers improved  accuracies:  ['1.797%', '5.176%', '1.690%', '1.134%', '2.182%', '-3.636%', '-0.385%', '0.000%', '-5.155%', '-12.257%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 8:
Federated model validation accuracy : 49.9000%
Leave-one-out validation accuracies :  ['49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 3.911058. Accuracy: 49.9679%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.433%', '56.727%', '60.834%', '70.139%', '71.722%', '73.155%', '74.567%', '74.396%', '75.936%', '75.743%']
Workers federated accuracies:  ['49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%']
Workers improved  accuracies:  ['1.733%', '5.112%', '1.626%', '1.070%', '2.118%', '-3.701%', '-0.449%', '-0.064%', '-5.219%', '-12.321%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 9:
Federated model validation accuracy : 50.1000%
Leave-one-out validation accuracies :  ['50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.547462. Accuracy: 50.0321%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.455%', '57.733%', '61.647%', '71.401%', '72.663%', '73.840%', '75.123%', '75.037%', '76.513%', '76.214%']
Workers federated accuracies:  ['50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%', '50.032%']
Workers improved  accuracies:  ['1.797%', '5.176%', '1.690%', '1.134%', '2.182%', '-3.636%', '-0.385%', '0.000%', '-5.155%', '-12.257%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 10:
Federated model validation accuracy : 50.3000%
Leave-one-out validation accuracies :  ['50.1000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%']
Computed and normalized credits:  tensor([0.0994, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001,
        0.1001])
Federated model performance: Loss: 2.853069. Accuracy: 50.5241%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.369%', '58.481%', '63.102%', '72.021%', '73.219%', '74.524%', '75.380%', '75.358%', '76.984%', '76.064%']
Workers federated accuracies:  ['49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '49.968%', '50.011%', '49.968%', '50.011%', '50.011%']
Workers improved  accuracies:  ['1.733%', '5.112%', '1.626%', '1.070%', '2.118%', '-3.701%', '-0.406%', '-0.064%', '-5.176%', '-12.278%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 11:
Federated model validation accuracy : 72.0000%
Leave-one-out validation accuracies :  ['70.7000%', '67.0000%', '58.2000%', '50.3000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%', '50.1000%']
Computed and normalized credits:  tensor([0.0741, 0.0801, 0.0948, 0.1070, 0.1073, 0.1073, 0.1073, 0.1073, 0.1073,
        0.1073])
Federated model performance: Loss: 2.609195. Accuracy: 70.5668%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.476%', '59.572%', '64.791%', '72.428%', '73.775%', '74.545%', '75.765%', '75.508%', '77.070%', '76.406%']
Workers federated accuracies:  ['62.011%', '61.540%', '61.626%', '62.353%', '63.016%', '63.251%', '63.701%', '64.321%', '64.278%', '64.299%']
Workers improved  accuracies:  ['13.775%', '16.684%', '13.283%', '13.455%', '15.166%', '9.583%', '13.283%', '14.289%', '9.091%', '2.011%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 12:
Federated model validation accuracy : 78.3000%
Leave-one-out validation accuracies :  ['78.2000%', '78.7000%', '75.2000%', '69.9000%', '59.9000%', '51.1000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%']
Computed and normalized credits:  tensor([0.0714, 0.0714, 0.0785, 0.0883, 0.1040, 0.1161, 0.1176, 0.1176, 0.1176,
        0.1176])
Federated model performance: Loss: 1.220652. Accuracy: 75.6578%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.540%', '60.578%', '65.840%', '72.941%', '74.011%', '75.016%', '75.722%', '75.893%', '77.176%', '76.556%']
Workers federated accuracies:  ['74.631%', '74.909%', '75.273%', '75.316%', '75.465%', '75.380%', '75.551%', '75.422%', '75.594%', '75.572%']
Workers improved  accuracies:  ['26.396%', '30.053%', '26.930%', '26.417%', '27.615%', '21.711%', '25.134%', '25.390%', '20.406%', '13.283%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 13:
Federated model validation accuracy : 80.1000%
Leave-one-out validation accuracies :  ['80.3000%', '80.3000%', '80.5000%', '80.3000%', '80.5000%', '80.9000%', '81.0000%', '80.9000%', '80.7000%', '81.0000%']
Computed and normalized credits:  tensor([0.0958, 0.0958, 0.0966, 0.0987, 0.1009, 0.1022, 0.1023, 0.1025, 0.1028,
        0.1023])
Federated model performance: Loss: 0.920115. Accuracy: 77.3690%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.497%', '60.963%', '65.925%', '73.390%', '74.246%', '75.337%', '76.064%', '76.086%', '77.091%', '76.770%']
Workers federated accuracies:  ['76.834%', '76.813%', '77.070%', '77.134%', '77.241%', '77.176%', '77.198%', '77.262%', '77.305%', '77.283%']
Workers improved  accuracies:  ['28.599%', '31.957%', '28.727%', '28.235%', '29.390%', '23.508%', '26.781%', '27.230%', '22.118%', '14.995%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 14:
Federated model validation accuracy : 81.8000%
Leave-one-out validation accuracies :  ['81.8000%', '81.8000%', '81.6000%', '81.8000%', '81.7000%', '81.4000%', '81.3000%', '80.1000%', '78.6000%', '77.4000%']
Computed and normalized credits:  tensor([0.0973, 0.0973, 0.0978, 0.0978, 0.0983, 0.0991, 0.0993, 0.1016, 0.1046,
        0.1068])
Federated model performance: Loss: 0.724779. Accuracy: 78.1604%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.561%', '62.075%', '67.209%', '73.626%', '74.588%', '75.615%', '76.299%', '76.043%', '77.155%', '76.920%']
Workers federated accuracies:  ['76.898%', '77.412%', '77.497%', '77.540%', '77.818%', '77.583%', '77.882%', '77.818%', '77.818%', '77.818%']
Workers improved  accuracies:  ['28.663%', '32.556%', '29.155%', '28.642%', '29.968%', '23.914%', '27.465%', '27.786%', '22.631%', '15.529%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 15:
Federated model validation accuracy : 82.0000%
Leave-one-out validation accuracies :  ['82.1000%', '81.9000%', '81.8000%', '82.0000%', '81.8000%', '81.6000%', '81.5000%', '81.5000%', '81.0000%', '81.6000%']
Computed and normalized credits:  tensor([0.0988, 0.0991, 0.0994, 0.0990, 0.0995, 0.1000, 0.1002, 0.1006, 0.1021,
        0.1013])
Federated model performance: Loss: 0.616771. Accuracy: 78.9091%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.497%', '63.166%', '67.551%', '73.989%', '74.588%', '75.850%', '76.471%', '76.043%', '77.198%', '77.005%']
Workers federated accuracies:  ['78.353%', '78.610%', '78.695%', '78.759%', '78.717%', '78.759%', '78.909%', '78.888%', '78.909%', '78.909%']
Workers improved  accuracies:  ['30.118%', '33.754%', '30.353%', '29.861%', '30.866%', '25.091%', '28.492%', '28.856%', '23.722%', '16.620%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 16:
Federated model validation accuracy : 81.5000%
Leave-one-out validation accuracies :  ['81.4000%', '81.4000%', '80.8000%', '80.0000%', '78.7000%', '78.0000%', '77.0000%', '76.2000%', '76.0000%', '74.5000%']
Computed and normalized credits:  tensor([0.0942, 0.0943, 0.0954, 0.0968, 0.0993, 0.1007, 0.1026, 0.1042, 0.1048,
        0.1075])
Federated model performance: Loss: 0.555222. Accuracy: 78.3529%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.647%', '63.979%', '68.749%', '74.160%', '74.695%', '76.043%', '76.556%', '76.299%', '77.134%', '76.856%']
Workers federated accuracies:  ['77.112%', '77.455%', '77.947%', '77.947%', '77.904%', '77.626%', '77.925%', '77.904%', '78.182%', '78.075%']
Workers improved  accuracies:  ['28.877%', '32.599%', '29.604%', '29.048%', '30.053%', '23.957%', '27.508%', '27.872%', '22.995%', '15.786%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 17:
Federated model validation accuracy : 82.1000%
Leave-one-out validation accuracies :  ['82.0000%', '82.2000%', '81.6000%', '81.3000%', '81.0000%', '81.2000%', '81.2000%', '80.6000%', '78.3000%', '76.1000%']
Computed and normalized credits:  tensor([0.0963, 0.0960, 0.0973, 0.0981, 0.0990, 0.0989, 0.0992, 0.1006, 0.1050,
        0.1097])
Federated model performance: Loss: 0.529171. Accuracy: 79.4011%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.626%', '64.877%', '69.754%', '74.717%', '75.123%', '75.979%', '76.599%', '76.299%', '77.241%', '76.920%']
Workers federated accuracies:  ['79.380%', '79.316%', '79.572%', '79.658%', '79.572%', '79.380%', '79.572%', '79.786%', '79.658%', '79.551%']
Workers improved  accuracies:  ['31.144%', '34.460%', '31.230%', '30.759%', '31.722%', '25.711%', '29.155%', '29.754%', '24.471%', '17.262%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 18:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.4000%', '76.0000%', '75.3000%', '74.1000%', '72.1000%', '69.2000%', '65.4000%', '61.7000%', '55.9000%', '52.4000%']
Computed and normalized credits:  tensor([0.0843, 0.0849, 0.0863, 0.0886, 0.0923, 0.0975, 0.1045, 0.1114, 0.1220,
        0.1282])
Federated model performance: Loss: 0.580017. Accuracy: 75.7005%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.733%', '65.711%', '70.075%', '75.144%', '75.551%', '76.193%', '76.578%', '76.342%', '77.155%', '76.898%']
Workers federated accuracies:  ['72.535%', '73.390%', '74.246%', '74.439%', '74.182%', '74.717%', '74.631%', '74.930%', '74.866%', '75.230%']
Workers improved  accuracies:  ['24.299%', '28.535%', '25.904%', '25.540%', '26.332%', '21.048%', '24.214%', '24.898%', '19.679%', '12.941%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 19:
Federated model validation accuracy : 79.5000%
Leave-one-out validation accuracies :  ['79.1000%', '78.0000%', '76.2000%', '73.7000%', '71.0000%', '66.0000%', '61.5000%', '57.1000%', '52.3000%', '50.2000%']
Computed and normalized credits:  tensor([0.0778, 0.0796, 0.0827, 0.0871, 0.0920, 0.1010, 0.1093, 0.1169, 0.1250,
        0.1285])
Federated model performance: Loss: 0.751186. Accuracy: 76.1711%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.690%', '66.160%', '70.481%', '75.316%', '75.551%', '76.299%', '76.556%', '76.449%', '77.048%', '76.941%']
Workers federated accuracies:  ['74.460%', '74.332%', '74.545%', '75.059%', '74.888%', '75.144%', '75.444%', '75.380%', '75.230%', '75.166%']
Workers improved  accuracies:  ['26.225%', '29.476%', '26.203%', '26.160%', '27.037%', '21.476%', '25.027%', '25.348%', '20.043%', '12.877%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 20:
Federated model validation accuracy : 60.8000%
Leave-one-out validation accuracies :  ['60.0000%', '56.4000%', '52.7000%', '51.0000%', '50.3000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%', '49.9000%']
Computed and normalized credits:  tensor([0.0795, 0.0875, 0.0961, 0.1004, 0.1026, 0.1047, 0.1058, 0.1069, 0.1080,
        0.1084])
Federated model performance: Loss: 1.285552. Accuracy: 60.3636%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.775%', '66.439%', '70.888%', '75.594%', '75.914%', '76.385%', '76.492%', '76.513%', '76.941%', '77.005%']
Workers federated accuracies:  ['52.214%', '52.749%', '55.273%', '55.380%', '54.930%', '55.829%', '55.765%', '55.658%', '56.385%', '56.749%']
Workers improved  accuracies:  ['3.979%', '7.893%', '6.930%', '6.481%', '7.080%', '2.160%', '5.348%', '5.626%', '1.198%', '-5.540%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 1.285552. Accuracy: 60.3636%.
Workers before    accuracies:  ['48.235%', '44.856%', '48.342%', '48.898%', '47.850%', '53.668%', '50.417%', '50.032%', '55.187%', '62.289%']
Workers standlone accuracies:  ['49.775%', '66.439%', '70.888%', '75.594%', '75.914%', '76.385%', '76.492%', '76.513%', '76.941%', '77.005%']
Workers federated accuracies:  ['52.214%', '52.749%', '55.273%', '55.380%', '54.930%', '55.829%', '55.765%', '55.658%', '56.385%', '56.749%']
Workers improved  accuracies:  ['3.979%', '7.893%', '6.930%', '6.481%', '7.080%', '2.160%', '5.348%', '5.626%', '1.198%', '-5.540%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]
Workers sharing_contributions :  tensor([ 12.8000,  28.8000,  48.0000,  64.0000,  83.2000,  99.2000, 118.4000,
        134.4000, 153.6000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.022775795781869043, 0.9502037832203925)
Correlation between stand alone test acc & collaborative final model acc:  (0.882006777276328, 0.0007337513586531878)
Correlation between test_acc & sharing contributions:  (0.8726440098487785, 0.0009842156491242893)
Correlation between test_acc improvements & sharing_contributions:  (-0.6700049377079018, 0.03402805814588377)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.697824. Accuracy: 49.9465%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 51.2000%
Leave-one-out validation accuracies :  ['50.9000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1003, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 0.677498. Accuracy: 49.8396%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.118%', '49.947%', '50.011%', '57.283%', '55.123%', '60.920%', '63.123%', '62.396%', '64.727%', '65.733%']
Workers federated accuracies:  ['68.043%', '50.995%', '50.481%', '49.840%', '49.840%', '49.797%', '49.797%', '49.840%', '49.797%', '49.818%']
Workers improved  accuracies:  ['17.925%', '0.963%', '0.321%', '-0.021%', '-0.150%', '-7.358%', '-9.005%', '-6.075%', '-10.503%', '-10.545%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 2:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 1.484256. Accuracy: 50.2246%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.182%', '49.797%', '50.075%', '58.460%', '60.064%', '63.850%', '66.524%', '65.540%', '67.508%', '69.861%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.107%', '0.193%', '0.064%', '0.364%', '0.235%', '-6.930%', '-8.578%', '-5.690%', '-10.075%', '-10.139%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 3:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 6.042129. Accuracy: 49.7754%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.968%', '53.433%', '50.781%', '61.283%', '63.230%', '66.695%', '70.096%', '68.642%', '70.524%', '72.321%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.342%', '-0.257%', '-0.385%', '-0.086%', '-0.214%', '-7.380%', '-9.027%', '-6.139%', '-10.524%', '-10.588%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 4:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.700084. Accuracy: 50.2246%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.690%', '56.706%', '52.770%', '63.016%', '65.754%', '69.433%', '71.807%', '70.674%', '72.578%', '73.476%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.107%', '0.193%', '0.064%', '0.364%', '0.235%', '-6.930%', '-8.578%', '-5.690%', '-10.075%', '-10.139%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 5:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.357382. Accuracy: 49.7754%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.289%', '56.984%', '55.251%', '64.578%', '67.465%', '71.037%', '72.620%', '72.171%', '73.604%', '74.203%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.342%', '-0.257%', '-0.385%', '-0.086%', '-0.214%', '-7.380%', '-9.027%', '-6.139%', '-10.524%', '-10.588%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 6:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.042871. Accuracy: 50.2246%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.610%', '58.118%', '56.235%', '66.267%', '69.241%', '72.471%', '73.754%', '73.348%', '74.374%', '74.973%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.107%', '0.193%', '0.064%', '0.364%', '0.235%', '-6.930%', '-8.578%', '-5.690%', '-10.075%', '-10.139%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 7:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.404452. Accuracy: 49.7754%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['52.620%', '58.032%', '57.476%', '67.807%', '70.032%', '73.326%', '74.545%', '74.332%', '75.059%', '75.144%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.342%', '-0.257%', '-0.385%', '-0.086%', '-0.214%', '-7.380%', '-9.027%', '-6.139%', '-10.524%', '-10.588%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 8:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.064490. Accuracy: 50.2246%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.888%', '58.139%', '58.909%', '69.390%', '70.717%', '73.668%', '74.930%', '74.738%', '75.422%', '75.465%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.107%', '0.193%', '0.064%', '0.364%', '0.235%', '-6.930%', '-8.578%', '-5.690%', '-10.075%', '-10.139%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 9:
Federated model validation accuracy : 51.3000%
Leave-one-out validation accuracies :  ['51.1000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0997, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 2.914933. Accuracy: 49.8610%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.631%', '59.187%', '60.428%', '70.781%', '71.380%', '74.246%', '75.316%', '74.995%', '75.551%', '75.615%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.342%', '-0.257%', '-0.385%', '-0.086%', '-0.214%', '-7.380%', '-9.027%', '-6.139%', '-10.524%', '-10.588%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 10:
Federated model validation accuracy : 68.4000%
Leave-one-out validation accuracies :  ['67.6000%', '63.0000%', '56.3000%', '49.3000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0746, 0.0826, 0.0946, 0.1065, 0.1069, 0.1069, 0.1069, 0.1069, 0.1069,
        0.1069])
Federated model performance: Loss: 2.911848. Accuracy: 69.3904%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.738%', '59.722%', '60.449%', '71.722%', '72.257%', '74.439%', '75.358%', '75.444%', '75.594%', '75.786%']
Workers federated accuracies:  ['60.834%', '62.332%', '62.674%', '64.406%', '64.770%', '65.326%', '65.968%', '65.647%', '66.652%', '66.545%']
Workers improved  accuracies:  ['10.717%', '12.299%', '12.513%', '14.545%', '14.781%', '8.171%', '7.166%', '9.733%', '6.353%', '6.182%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 11:
Federated model validation accuracy : 74.1000%
Leave-one-out validation accuracies :  ['74.2000%', '74.2000%', '74.8000%', '73.8000%', '68.7000%', '58.1000%', '51.6000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0768, 0.0779, 0.0784, 0.0817, 0.0907, 0.1097, 0.1205, 0.1214, 0.1214,
        0.1214])
Federated model performance: Loss: 1.296751. Accuracy: 75.2299%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.439%', '60.749%', '62.160%', '72.813%', '73.005%', '74.631%', '75.615%', '75.615%', '75.508%', '75.979%']
Workers federated accuracies:  ['75.102%', '74.973%', '75.059%', '75.123%', '75.166%', '75.123%', '75.273%', '75.337%', '75.529%', '75.401%']
Workers improved  accuracies:  ['24.984%', '24.941%', '24.898%', '25.262%', '25.176%', '17.968%', '16.471%', '19.422%', '15.230%', '15.037%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 12:
Federated model validation accuracy : 75.6000%
Leave-one-out validation accuracies :  ['75.5000%', '75.7000%', '76.2000%', '76.5000%', '76.7000%', '76.8000%', '77.6000%', '78.5000%', '78.3000%', '78.4000%']
Computed and normalized credits:  tensor([0.0992, 0.0990, 0.0980, 0.0979, 0.0991, 0.1021, 0.1023, 0.1006, 0.1010,
        0.1008])
Federated model performance: Loss: 0.958334. Accuracy: 77.5401%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.861%', '61.797%', '63.209%', '73.797%', '73.947%', '74.802%', '75.701%', '75.722%', '75.850%', '76.086%']
Workers federated accuracies:  ['76.791%', '76.727%', '76.984%', '77.027%', '77.048%', '77.112%', '77.091%', '77.070%', '77.305%', '77.283%']
Workers improved  accuracies:  ['26.674%', '26.695%', '26.824%', '27.166%', '27.059%', '19.957%', '18.289%', '21.155%', '17.005%', '16.920%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 13:
Federated model validation accuracy : 77.1000%
Leave-one-out validation accuracies :  ['77.2000%', '77.4000%', '77.3000%', '77.9000%', '78.3000%', '77.8000%', '77.9000%', '79.1000%', '79.4000%', '79.0000%']
Computed and normalized credits:  tensor([0.1018, 0.1013, 0.1014, 0.1001, 0.0995, 0.1010, 0.1009, 0.0981, 0.0976,
        0.0984])
Federated model performance: Loss: 0.763324. Accuracy: 78.7594%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['50.053%', '62.588%', '64.385%', '74.096%', '74.075%', '74.909%', '75.850%', '75.936%', '75.786%', '76.171%']
Workers federated accuracies:  ['78.011%', '78.182%', '78.310%', '78.353%', '78.481%', '78.524%', '78.567%', '78.503%', '78.695%', '78.610%']
Workers improved  accuracies:  ['27.893%', '28.150%', '28.150%', '28.492%', '28.492%', '21.369%', '19.765%', '22.588%', '18.396%', '18.246%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 14:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.8000%', '78.4000%', '78.2000%', '78.6000%', '78.7000%', '78.8000%', '79.1000%', '79.1000%', '78.9000%', '77.6000%']
Computed and normalized credits:  tensor([0.0999, 0.1007, 0.1011, 0.1001, 0.0998, 0.0998, 0.0992, 0.0987, 0.0990,
        0.1018])
Federated model performance: Loss: 0.640244. Accuracy: 79.4438%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.797%', '63.487%', '65.497%', '74.374%', '74.374%', '75.059%', '75.914%', '76.342%', '75.872%', '76.235%']
Workers federated accuracies:  ['79.080%', '79.123%', '78.952%', '79.037%', '78.973%', '79.037%', '78.973%', '79.123%', '79.144%', '78.973%']
Workers improved  accuracies:  ['28.963%', '29.091%', '28.791%', '29.176%', '28.984%', '21.882%', '20.171%', '23.209%', '18.845%', '18.610%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 15:
Federated model validation accuracy : 79.4000%
Leave-one-out validation accuracies :  ['78.9000%', '79.0000%', '79.0000%', '79.1000%', '79.6000%', '79.4000%', '79.2000%', '79.0000%', '79.1000%', '78.8000%']
Computed and normalized credits:  tensor([0.1004, 0.1003, 0.1004, 0.1000, 0.0990, 0.0994, 0.0997, 0.1000, 0.0999,
        0.1009])
Federated model performance: Loss: 0.577162. Accuracy: 79.6791%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.818%', '64.428%', '65.947%', '74.588%', '74.930%', '75.059%', '76.043%', '76.513%', '76.064%', '76.385%']
Workers federated accuracies:  ['79.636%', '79.508%', '79.422%', '79.401%', '79.337%', '79.380%', '79.422%', '79.529%', '79.551%', '79.273%']
Workers improved  accuracies:  ['29.519%', '29.476%', '29.262%', '29.540%', '29.348%', '22.225%', '20.620%', '23.615%', '19.251%', '18.909%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 16:
Federated model validation accuracy : 79.1000%
Leave-one-out validation accuracies :  ['79.2000%', '79.0000%', '78.8000%', '78.9000%', '78.6000%', '78.5000%', '78.5000%', '78.5000%', '79.0000%', '78.7000%']
Computed and normalized credits:  tensor([0.0992, 0.0996, 0.1000, 0.0997, 0.1002, 0.1004, 0.1005, 0.1005, 0.0995,
        0.1003])
Federated model performance: Loss: 0.533450. Accuracy: 79.4866%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.797%', '64.834%', '66.845%', '74.930%', '74.952%', '75.059%', '76.150%', '76.578%', '76.278%', '76.321%']
Workers federated accuracies:  ['79.979%', '79.722%', '79.636%', '79.594%', '79.358%', '79.508%', '79.273%', '79.529%', '79.144%', '79.422%']
Workers improved  accuracies:  ['29.861%', '29.690%', '29.476%', '29.733%', '29.369%', '22.353%', '20.471%', '23.615%', '18.845%', '19.059%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 17:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.1000%', '79.1000%', '79.0000%', '79.6000%', '79.6000%', '79.6000%', '78.8000%', '78.4000%', '78.3000%', '78.0000%']
Computed and normalized credits:  tensor([0.0996, 0.0996, 0.0999, 0.0987, 0.0987, 0.0988, 0.1004, 0.1012, 0.1012,
        0.1019])
Federated model performance: Loss: 0.520214. Accuracy: 80.3422%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.818%', '65.455%', '67.957%', '75.016%', '75.037%', '75.187%', '76.193%', '76.599%', '76.193%', '76.492%']
Workers federated accuracies:  ['79.936%', '80.064%', '80.021%', '80.064%', '80.000%', '80.064%', '80.342%', '80.449%', '80.299%', '80.000%']
Workers improved  accuracies:  ['29.818%', '30.032%', '29.861%', '30.203%', '30.011%', '22.909%', '21.540%', '24.535%', '20.000%', '19.636%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 18:
Federated model validation accuracy : 78.1000%
Leave-one-out validation accuracies :  ['78.3000%', '78.6000%', '78.9000%', '78.9000%', '79.1000%', '78.8000%', '79.0000%', '78.3000%', '77.2000%', '76.2000%']
Computed and normalized credits:  tensor([0.1000, 0.0994, 0.0988, 0.0986, 0.0982, 0.0988, 0.0987, 0.1002, 0.1025,
        0.1046])
Federated model performance: Loss: 0.496123. Accuracy: 79.6578%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.775%', '65.840%', '68.663%', '75.144%', '75.080%', '75.316%', '76.214%', '76.620%', '76.235%', '76.406%']
Workers federated accuracies:  ['79.872%', '79.444%', '79.508%', '79.209%', '79.080%', '79.016%', '78.909%', '79.123%', '79.251%', '79.294%']
Workers improved  accuracies:  ['29.754%', '29.412%', '29.348%', '29.348%', '29.091%', '21.861%', '20.107%', '23.209%', '18.952%', '18.930%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 19:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.4000%', '77.9000%', '77.9000%', '77.5000%', '77.2000%', '75.5000%', '74.3000%', '72.1000%', '70.4000%']
Computed and normalized credits:  tensor([0.0952, 0.0951, 0.0960, 0.0960, 0.0967, 0.0973, 0.1006, 0.1032, 0.1080,
        0.1118])
Federated model performance: Loss: 0.527467. Accuracy: 80.3209%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.754%', '66.139%', '68.963%', '75.273%', '75.187%', '75.294%', '76.150%', '76.642%', '76.364%', '76.449%']
Workers federated accuracies:  ['78.203%', '78.888%', '79.080%', '79.551%', '79.957%', '80.107%', '80.021%', '80.193%', '80.278%', '80.171%']
Workers improved  accuracies:  ['28.086%', '28.856%', '28.920%', '29.690%', '29.968%', '22.952%', '21.219%', '24.278%', '19.979%', '19.807%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 20:
Federated model validation accuracy : 76.8000%
Leave-one-out validation accuracies :  ['76.3000%', '75.5000%', '74.6000%', '73.5000%', '70.7000%', '68.1000%', '64.7000%', '60.2000%', '55.8000%', '53.2000%']
Computed and normalized credits:  tensor([0.0834, 0.0848, 0.0865, 0.0884, 0.0934, 0.0982, 0.1048, 0.1132, 0.1213,
        0.1259])
Federated model performance: Loss: 0.540915. Accuracy: 75.5722%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.775%', '66.374%', '69.112%', '75.444%', '75.422%', '75.337%', '76.299%', '76.684%', '76.449%', '76.535%']
Workers federated accuracies:  ['75.615%', '74.930%', '74.995%', '74.439%', '74.717%', '74.332%', '74.503%', '74.759%', '74.353%', '74.802%']
Workers improved  accuracies:  ['25.497%', '24.898%', '24.834%', '24.578%', '24.727%', '17.176%', '15.701%', '18.845%', '14.053%', '14.438%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.540915. Accuracy: 75.5722%.
Workers before    accuracies:  ['50.118%', '50.032%', '50.160%', '49.861%', '49.989%', '57.155%', '58.802%', '55.914%', '60.299%', '60.364%']
Workers standlone accuracies:  ['49.775%', '66.374%', '69.112%', '75.444%', '75.422%', '75.337%', '76.299%', '76.684%', '76.449%', '76.535%']
Workers federated accuracies:  ['75.615%', '74.930%', '74.995%', '74.439%', '74.717%', '74.332%', '74.503%', '74.759%', '74.353%', '74.802%']
Workers improved  accuracies:  ['25.497%', '24.898%', '24.834%', '24.578%', '24.727%', '17.176%', '15.701%', '18.845%', '14.053%', '14.438%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]
Workers sharing_contributions :  tensor([ 12.8000,  28.8000,  48.0000,  64.0000,  83.2000,  99.2000, 118.4000,
        134.4000, 153.6000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.08028584357520423, 0.8255023940899233)
Correlation between stand alone test acc & collaborative final model acc:  (-0.8865740811058347, 0.0006301661005009394)
Correlation between test_acc & sharing contributions:  (-0.6039386596721121, 0.0644543656178707)
Correlation between test_acc improvements & sharing_contributions:  (-0.9049446998374477, 0.00031802678896029196)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.690419. Accuracy: 52.0856%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 51.1000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 0.672183. Accuracy: 49.8182%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.246%', '50.652%', '50.631%', '57.647%', '57.561%', '63.123%', '64.107%', '63.102%', '67.016%', '67.701%']
Workers federated accuracies:  ['69.027%', '52.364%', '52.064%', '49.797%', '49.797%', '49.797%', '49.797%', '49.797%', '49.797%', '49.797%']
Workers improved  accuracies:  ['18.802%', '2.118%', '1.818%', '-2.332%', '-2.674%', '-8.299%', '-9.690%', '-8.086%', '-11.979%', '-13.690%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 2:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 1.426936. Accuracy: 50.2246%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.289%', '52.513%', '51.679%', '62.118%', '62.160%', '65.840%', '67.016%', '65.797%', '69.305%', '70.802%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.000%', '-0.021%', '-0.021%', '-1.904%', '-2.246%', '-7.872%', '-9.262%', '-7.658%', '-11.551%', '-13.262%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 3:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.911932. Accuracy: 49.7754%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.674%', '54.781%', '52.620%', '63.743%', '64.171%', '68.492%', '69.797%', '68.471%', '72.449%', '73.176%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.449%', '-0.471%', '-0.471%', '-2.353%', '-2.695%', '-8.321%', '-9.711%', '-8.107%', '-12.000%', '-13.711%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 4:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.893496. Accuracy: 50.2246%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['51.829%', '59.487%', '53.840%', '65.412%', '65.433%', '70.267%', '71.701%', '70.353%', '73.561%', '74.631%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.000%', '-0.021%', '-0.021%', '-1.904%', '-2.246%', '-7.872%', '-9.262%', '-7.658%', '-11.551%', '-13.262%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 5:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.223058. Accuracy: 49.7754%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['52.684%', '59.059%', '55.294%', '66.930%', '66.995%', '71.829%', '72.663%', '71.979%', '74.995%', '75.401%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.449%', '-0.471%', '-0.471%', '-2.353%', '-2.695%', '-8.321%', '-9.711%', '-8.107%', '-12.000%', '-13.711%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 6:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.225587. Accuracy: 50.2246%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['56.257%', '58.588%', '56.599%', '68.684%', '69.070%', '72.898%', '73.882%', '73.647%', '75.529%', '76.342%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.000%', '-0.021%', '-0.021%', '-1.904%', '-2.246%', '-7.872%', '-9.262%', '-7.658%', '-11.551%', '-13.262%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 7:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.259470. Accuracy: 49.7754%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['56.000%', '59.123%', '57.690%', '70.310%', '69.754%', '73.733%', '74.567%', '74.567%', '76.000%', '76.706%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.449%', '-0.471%', '-0.471%', '-2.353%', '-2.695%', '-8.321%', '-9.711%', '-8.107%', '-12.000%', '-13.711%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 8:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.201658. Accuracy: 50.2246%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['53.904%', '59.487%', '58.652%', '71.016%', '70.545%', '74.460%', '75.144%', '75.465%', '76.278%', '77.155%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.000%', '-0.021%', '-0.021%', '-1.904%', '-2.246%', '-7.872%', '-9.262%', '-7.658%', '-11.551%', '-13.262%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 9:
Federated model validation accuracy : 51.6000%
Leave-one-out validation accuracies :  ['51.3000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0992, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001, 0.1001,
        0.1001])
Federated model performance: Loss: 2.727177. Accuracy: 50.1818%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['52.556%', '59.936%', '60.214%', '72.193%', '71.807%', '74.995%', '75.615%', '76.086%', '76.727%', '77.155%']
Workers federated accuracies:  ['49.818%', '49.775%', '49.818%', '49.775%', '49.818%', '49.818%', '49.818%', '49.818%', '49.818%', '49.818%']
Workers improved  accuracies:  ['-0.406%', '-0.471%', '-0.428%', '-2.353%', '-2.652%', '-8.278%', '-9.668%', '-8.064%', '-11.957%', '-13.668%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 10:
Federated model validation accuracy : 70.2000%
Leave-one-out validation accuracies :  ['69.8000%', '65.6000%', '59.6000%', '52.1000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0736, 0.0807, 0.0911, 0.1037, 0.1085, 0.1085, 0.1085, 0.1085, 0.1085,
        0.1085])
Federated model performance: Loss: 2.829120. Accuracy: 71.1016%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['51.765%', '60.813%', '62.160%', '73.091%', '73.433%', '75.294%', '76.107%', '76.599%', '76.813%', '77.219%']
Workers federated accuracies:  ['63.594%', '64.706%', '65.219%', '67.144%', '67.401%', '68.064%', '68.620%', '68.684%', '69.390%', '69.305%']
Workers improved  accuracies:  ['13.369%', '14.460%', '14.973%', '15.016%', '14.930%', '9.968%', '9.134%', '10.802%', '7.615%', '5.818%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 11:
Federated model validation accuracy : 74.4000%
Leave-one-out validation accuracies :  ['74.6000%', '74.2000%', '74.7000%', '74.4000%', '70.7000%', '61.6000%', '52.1000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0771, 0.0787, 0.0793, 0.0815, 0.0886, 0.1050, 0.1212, 0.1229, 0.1229,
        0.1229])
Federated model performance: Loss: 1.262144. Accuracy: 75.4652%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['51.102%', '61.455%', '62.139%', '73.818%', '73.754%', '75.572%', '76.364%', '76.941%', '76.856%', '77.091%']
Workers federated accuracies:  ['74.802%', '74.824%', '74.930%', '75.144%', '75.230%', '75.230%', '75.273%', '75.422%', '75.444%', '75.294%']
Workers improved  accuracies:  ['24.578%', '24.578%', '24.684%', '23.016%', '22.759%', '17.134%', '15.786%', '17.540%', '13.668%', '11.807%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 12:
Federated model validation accuracy : 76.4000%
Leave-one-out validation accuracies :  ['76.3000%', '76.3000%', '76.5000%', '77.6000%', '78.3000%', '78.2000%', '78.3000%', '78.8000%', '78.4000%', '77.8000%']
Computed and normalized credits:  tensor([0.0989, 0.0992, 0.0988, 0.0969, 0.0967, 0.0997, 0.1023, 0.1016, 0.1024,
        0.1036])
Federated model performance: Loss: 0.909219. Accuracy: 77.6898%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.396%', '62.160%', '63.658%', '74.225%', '74.225%', '75.957%', '76.428%', '77.262%', '76.920%', '77.112%']
Workers federated accuracies:  ['76.791%', '76.749%', '76.834%', '76.920%', '77.241%', '77.262%', '77.348%', '77.326%', '77.540%', '77.583%']
Workers improved  accuracies:  ['26.567%', '26.503%', '26.588%', '24.791%', '24.770%', '19.166%', '17.861%', '19.444%', '15.765%', '14.096%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 13:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.8000%', '78.7000%', '78.1000%', '78.2000%', '78.8000%', '79.4000%', '78.9000%', '78.2000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.0995, 0.0993, 0.1005, 0.1008, 0.1000, 0.0987, 0.0999,
        0.1015])
Federated model performance: Loss: 0.732856. Accuracy: 78.8021%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.439%', '62.503%', '65.326%', '74.695%', '74.909%', '75.893%', '76.599%', '77.305%', '76.770%', '77.305%']
Workers federated accuracies:  ['78.096%', '77.989%', '78.075%', '78.053%', '78.524%', '78.631%', '78.524%', '78.652%', '78.695%', '78.695%']
Workers improved  accuracies:  ['27.872%', '27.743%', '27.829%', '25.925%', '26.053%', '20.535%', '19.037%', '20.770%', '16.920%', '15.209%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 14:
Federated model validation accuracy : 79.1000%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '78.8000%', '79.1000%', '79.0000%', '79.5000%', '79.7000%', '79.7000%', '79.7000%', '79.2000%']
Computed and normalized credits:  tensor([0.1005, 0.1005, 0.1008, 0.1002, 0.1006, 0.0997, 0.0992, 0.0989, 0.0991,
        0.1004])
Federated model performance: Loss: 0.611755. Accuracy: 79.3155%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.460%', '63.016%', '66.032%', '75.059%', '75.273%', '76.000%', '76.727%', '77.455%', '77.005%', '77.155%']
Workers federated accuracies:  ['79.059%', '79.037%', '79.080%', '78.930%', '79.166%', '79.123%', '79.273%', '79.401%', '79.358%', '79.273%']
Workers improved  accuracies:  ['28.834%', '28.791%', '28.834%', '26.802%', '26.695%', '21.027%', '19.786%', '21.519%', '17.583%', '15.786%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 15:
Federated model validation accuracy : 80.0000%
Leave-one-out validation accuracies :  ['79.8000%', '79.9000%', '80.3000%', '80.0000%', '79.6000%', '79.1000%', '79.2000%', '79.1000%', '78.9000%', '78.0000%']
Computed and normalized credits:  tensor([0.0993, 0.0991, 0.0984, 0.0989, 0.0997, 0.1005, 0.1002, 0.1004, 0.1008,
        0.1028])
Federated model performance: Loss: 0.563940. Accuracy: 80.2353%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.481%', '63.936%', '66.717%', '75.380%', '75.658%', '76.150%', '76.706%', '77.604%', '77.005%', '77.048%']
Workers federated accuracies:  ['79.636%', '79.765%', '79.658%', '79.914%', '80.086%', '80.128%', '79.936%', '80.150%', '80.000%', '79.914%']
Workers improved  accuracies:  ['29.412%', '29.519%', '29.412%', '27.786%', '27.615%', '22.032%', '20.449%', '22.267%', '18.225%', '16.428%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 16:
Federated model validation accuracy : 79.3000%
Leave-one-out validation accuracies :  ['79.4000%', '79.4000%', '79.6000%', '79.6000%', '79.9000%', '79.7000%', '78.8000%', '78.2000%', '77.1000%', '76.0000%']
Computed and normalized credits:  tensor([0.0986, 0.0986, 0.0981, 0.0982, 0.0977, 0.0983, 0.1000, 0.1012, 0.1034,
        0.1060])
Federated model performance: Loss: 0.521077. Accuracy: 79.3155%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.246%', '64.684%', '67.037%', '75.658%', '76.086%', '76.299%', '76.813%', '77.540%', '76.963%', '77.176%']
Workers federated accuracies:  ['79.722%', '79.251%', '79.209%', '78.995%', '78.930%', '78.952%', '79.144%', '79.230%', '78.866%', '79.037%']
Workers improved  accuracies:  ['29.497%', '29.005%', '28.963%', '26.866%', '26.460%', '20.856%', '19.658%', '21.348%', '17.091%', '15.551%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 17:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['78.9000%', '79.0000%', '78.8000%', '78.7000%', '78.5000%', '77.8000%', '77.0000%', '75.8000%', '74.1000%', '72.0000%']
Computed and normalized credits:  tensor([0.0962, 0.0960, 0.0963, 0.0965, 0.0968, 0.0982, 0.1001, 0.1026, 0.1063,
        0.1110])
Federated model performance: Loss: 0.536191. Accuracy: 80.4492%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['49.989%', '65.048%', '68.021%', '75.765%', '76.214%', '76.364%', '76.813%', '77.690%', '77.048%', '77.262%']
Workers federated accuracies:  ['79.209%', '79.294%', '79.422%', '79.551%', '80.150%', '80.150%', '80.342%', '80.064%', '80.449%', '80.556%']
Workers improved  accuracies:  ['28.984%', '29.048%', '29.176%', '27.422%', '27.679%', '22.053%', '20.856%', '22.182%', '18.674%', '17.070%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 18:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['77.5000%', '76.7000%', '76.1000%', '75.4000%', '74.0000%', '71.0000%', '68.0000%', '63.7000%', '59.6000%', '56.3000%']
Computed and normalized credits:  tensor([0.0859, 0.0873, 0.0883, 0.0896, 0.0921, 0.0977, 0.1033, 0.1114, 0.1191,
        0.1252])
Federated model performance: Loss: 0.535417. Accuracy: 76.9198%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['49.925%', '66.118%', '68.128%', '75.743%', '76.449%', '76.385%', '76.749%', '77.754%', '77.305%', '77.219%']
Workers federated accuracies:  ['76.663%', '76.214%', '76.150%', '75.636%', '75.872%', '75.551%', '75.487%', '75.615%', '75.615%', '75.850%']
Workers improved  accuracies:  ['26.439%', '25.968%', '25.904%', '23.508%', '23.401%', '17.455%', '16.000%', '17.733%', '13.840%', '12.364%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 19:
Federated model validation accuracy : 73.5000%
Leave-one-out validation accuracies :  ['73.5000%', '72.7000%', '71.3000%', '69.7000%', '67.4000%', '63.6000%', '59.0000%', '56.5000%', '53.1000%', '49.4000%']
Computed and normalized credits:  tensor([0.0802, 0.0818, 0.0844, 0.0875, 0.0921, 0.0999, 0.1092, 0.1148, 0.1217,
        0.1284])
Federated model performance: Loss: 0.770906. Accuracy: 75.1016%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['50.075%', '66.567%', '68.749%', '75.957%', '76.471%', '76.406%', '76.791%', '77.733%', '77.112%', '77.241%']
Workers federated accuracies:  ['71.080%', '72.449%', '72.920%', '73.947%', '74.203%', '74.503%', '74.674%', '74.759%', '75.337%', '75.465%']
Workers improved  accuracies:  ['20.856%', '22.203%', '22.674%', '21.818%', '21.733%', '16.406%', '15.187%', '16.877%', '13.561%', '11.979%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 20:
Federated model validation accuracy : 62.2000%
Leave-one-out validation accuracies :  ['60.8000%', '58.3000%', '54.9000%', '52.7000%', '51.7000%', '51.3000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0813, 0.0868, 0.0945, 0.0998, 0.1025, 0.1045, 0.1064, 0.1071, 0.1081,
        0.1090])
Federated model performance: Loss: 1.133339. Accuracy: 60.8342%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['49.882%', '67.444%', '69.626%', '76.043%', '76.428%', '76.471%', '76.663%', '77.711%', '77.241%', '77.176%']
Workers federated accuracies:  ['57.262%', '56.513%', '56.706%', '56.920%', '57.840%', '57.091%', '57.198%', '57.861%', '57.561%', '57.968%']
Workers improved  accuracies:  ['7.037%', '6.267%', '6.460%', '4.791%', '5.369%', '-1.005%', '-2.289%', '-0.021%', '-4.214%', '-5.519%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 1.133339. Accuracy: 60.8342%.
Workers before    accuracies:  ['50.225%', '50.246%', '50.246%', '52.128%', '52.471%', '58.096%', '59.487%', '57.882%', '61.775%', '63.487%']
Workers standlone accuracies:  ['49.882%', '67.444%', '69.626%', '76.043%', '76.428%', '76.471%', '76.663%', '77.711%', '77.241%', '77.176%']
Workers federated accuracies:  ['57.262%', '56.513%', '56.706%', '56.920%', '57.840%', '57.091%', '57.198%', '57.861%', '57.561%', '57.968%']
Workers improved  accuracies:  ['7.037%', '6.267%', '6.460%', '4.791%', '5.369%', '-1.005%', '-2.289%', '-0.021%', '-4.214%', '-5.519%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]
Workers sharing_contributions :  tensor([ 12.8000,  28.8000,  48.0000,  64.0000,  83.2000,  99.2000, 118.4000,
        134.4000, 153.6000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.1508144959649017, 0.6774951732931189)
Correlation between stand alone test acc & collaborative final model acc:  (0.3385609248271219, 0.33860944600874)
Correlation between test_acc & sharing contributions:  (0.7135369200368682, 0.020493191732096815)
Correlation between test_acc improvements & sharing_contributions:  (-0.9395453146014526, 5.430476734266214e-05)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.688717. Accuracy: 56.1711%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 71.1000%
Leave-one-out validation accuracies :  ['71.3000%', '71.0000%', '66.8000%', '63.3000%', '61.4000%', '61.4000%', '63.3000%', '65.5000%', '67.8000%', '70.1000%']
Computed and normalized credits:  tensor([0.0895, 0.0901, 0.0986, 0.1060, 0.1100, 0.1100, 0.1060, 0.1013, 0.0966,
        0.0919])
Federated model performance: Loss: 0.659838. Accuracy: 72.1283%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.690%', '49.262%', '54.695%', '56.920%', '59.872%', '65.947%', '66.246%', '62.503%', '68.706%', '68.535%']
Workers federated accuracies:  ['62.952%', '72.834%', '64.578%', '72.727%', '65.647%', '70.652%', '69.497%', '65.561%', '73.348%', '71.059%']
Workers improved  accuracies:  ['13.283%', '23.380%', '7.059%', '22.353%', '5.989%', '11.422%', '6.781%', '5.283%', '11.508%', '5.283%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 2:
Federated model validation accuracy : 52.6000%
Leave-one-out validation accuracies :  ['52.4000%', '52.0000%', '51.9000%', '51.8000%', '51.6000%', '51.5000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0957, 0.0970, 0.0987, 0.1001, 0.1014, 0.1017, 0.1025, 0.1017, 0.1010,
        0.1002])
Federated model performance: Loss: 0.653966. Accuracy: 50.9519%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.690%', '49.412%', '52.920%', '60.235%', '61.369%', '67.850%', '67.872%', '66.374%', '71.508%', '71.016%']
Workers federated accuracies:  ['49.882%', '50.203%', '51.529%', '50.738%', '51.765%', '51.273%', '51.572%', '52.513%', '51.422%', '51.914%']
Workers improved  accuracies:  ['0.214%', '0.749%', '-5.989%', '0.364%', '-7.893%', '-7.957%', '-11.144%', '-7.765%', '-10.417%', '-13.861%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 3:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0993, 0.0995, 0.0998, 0.1000, 0.1002, 0.1003, 0.1004, 0.1003, 0.1002,
        0.1000])
Federated model performance: Loss: 1.305881. Accuracy: 50.2246%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.711%', '49.968%', '52.620%', '63.401%', '62.888%', '70.246%', '70.118%', '68.813%', '72.471%', '72.984%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.556%', '0.770%', '-7.294%', '-0.150%', '-9.433%', '-9.005%', '-12.492%', '-10.053%', '-11.615%', '-15.551%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 4:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0999, 0.0999, 0.1000, 0.1000, 0.1000, 0.1000, 0.1001, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.727358. Accuracy: 49.7754%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.733%', '50.374%', '53.626%', '66.439%', '66.053%', '71.316%', '71.679%', '71.102%', '72.984%', '74.481%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['0.107%', '0.321%', '-7.743%', '-0.599%', '-9.882%', '-9.455%', '-12.941%', '-10.503%', '-12.064%', '-16.000%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 5:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.933717. Accuracy: 50.2246%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.754%', '51.273%', '54.439%', '68.877%', '66.439%', '72.385%', '73.027%', '72.920%', '74.053%', '75.380%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.556%', '0.770%', '-7.294%', '-0.150%', '-9.433%', '-9.005%', '-12.492%', '-10.053%', '-11.615%', '-15.551%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 6:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.048686. Accuracy: 49.7754%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.711%', '52.235%', '54.610%', '69.947%', '68.150%', '73.134%', '74.011%', '74.439%', '74.524%', '75.957%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['0.107%', '0.321%', '-7.743%', '-0.599%', '-9.882%', '-9.455%', '-12.941%', '-10.503%', '-12.064%', '-16.000%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 7:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 5.310067. Accuracy: 50.2246%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.754%', '53.027%', '56.385%', '70.781%', '69.497%', '73.968%', '74.610%', '75.016%', '75.337%', '76.193%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.556%', '0.770%', '-7.294%', '-0.150%', '-9.433%', '-9.005%', '-12.492%', '-10.053%', '-11.615%', '-15.551%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 8:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.018944. Accuracy: 49.7754%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.775%', '53.947%', '57.797%', '71.551%', '71.444%', '74.717%', '75.059%', '75.786%', '75.850%', '76.770%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['0.107%', '0.321%', '-7.743%', '-0.599%', '-9.882%', '-9.455%', '-12.941%', '-10.503%', '-12.064%', '-16.000%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 9:
Federated model validation accuracy : 49.2000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.198827. Accuracy: 50.3102%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.775%', '55.016%', '58.888%', '72.235%', '71.807%', '74.952%', '75.679%', '76.193%', '76.299%', '77.091%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.556%', '0.770%', '-7.294%', '-0.150%', '-9.433%', '-9.005%', '-12.492%', '-10.053%', '-11.615%', '-15.551%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 10:
Federated model validation accuracy : 60.1000%
Leave-one-out validation accuracies :  ['58.4000%', '54.0000%', '51.7000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0858, 0.0957, 0.1009, 0.1025, 0.1025, 0.1025, 0.1025, 0.1025, 0.1025,
        0.1025])
Federated model performance: Loss: 2.096385. Accuracy: 59.3797%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.797%', '56.342%', '60.492%', '72.749%', '72.856%', '75.230%', '75.979%', '76.535%', '76.471%', '77.112%']
Workers federated accuracies:  ['51.209%', '51.572%', '52.428%', '52.342%', '53.241%', '53.262%', '53.647%', '54.267%', '54.267%', '54.738%']
Workers improved  accuracies:  ['1.540%', '2.118%', '-5.091%', '1.968%', '-6.417%', '-5.968%', '-9.070%', '-6.011%', '-7.572%', '-11.037%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 11:
Federated model validation accuracy : 74.6000%
Leave-one-out validation accuracies :  ['74.7000%', '74.6000%', '73.4000%', '68.8000%', '59.2000%', '50.9000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0740, 0.0754, 0.0780, 0.0858, 0.1020, 0.1149, 0.1175, 0.1175, 0.1175,
        0.1175])
Federated model performance: Loss: 2.409621. Accuracy: 76.2353%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.797%', '57.262%', '62.524%', '73.283%', '74.267%', '75.615%', '76.406%', '76.834%', '76.513%', '77.390%']
Workers federated accuracies:  ['75.444%', '75.444%', '75.209%', '75.658%', '75.444%', '75.615%', '75.743%', '75.701%', '75.850%', '75.850%']
Workers improved  accuracies:  ['25.775%', '25.989%', '17.690%', '25.283%', '15.786%', '16.385%', '13.027%', '15.422%', '14.011%', '10.075%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 12:
Federated model validation accuracy : 75.4000%
Leave-one-out validation accuracies :  ['75.3000%', '75.4000%', '75.4000%', '75.8000%', '76.3000%', '72.8000%', '66.4000%', '55.3000%', '51.5000%', '51.0000%']
Computed and normalized credits:  tensor([0.0821, 0.0821, 0.0825, 0.0829, 0.0843, 0.0924, 0.1048, 0.1252, 0.1315,
        0.1323])
Federated model performance: Loss: 1.222246. Accuracy: 76.5134%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.818%', '58.439%', '63.209%', '73.733%', '74.781%', '76.021%', '76.620%', '77.070%', '76.749%', '77.305%']
Workers federated accuracies:  ['76.086%', '76.171%', '76.235%', '76.257%', '76.471%', '76.492%', '76.642%', '76.513%', '76.599%', '76.535%']
Workers improved  accuracies:  ['26.417%', '26.717%', '18.717%', '25.882%', '16.813%', '17.262%', '13.925%', '16.235%', '14.759%', '10.759%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 13:
Federated model validation accuracy : 77.3000%
Leave-one-out validation accuracies :  ['77.4000%', '77.2000%', '77.1000%', '76.4000%', '76.5000%', '76.6000%', '74.1000%', '72.9000%', '68.6000%', '64.2000%']
Computed and normalized credits:  tensor([0.0907, 0.0911, 0.0913, 0.0927, 0.0928, 0.0939, 0.1006, 0.1062, 0.1158,
        0.1248])
Federated model performance: Loss: 0.842362. Accuracy: 77.9465%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.904%', '59.529%', '63.572%', '74.053%', '75.037%', '76.364%', '76.620%', '77.198%', '76.856%', '77.390%']
Workers federated accuracies:  ['76.364%', '76.620%', '76.856%', '76.877%', '77.668%', '77.583%', '77.412%', '77.690%', '77.754%', '77.497%']
Workers improved  accuracies:  ['26.695%', '27.166%', '19.337%', '26.503%', '18.011%', '18.353%', '14.695%', '17.412%', '15.914%', '11.722%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 14:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.4000%', '78.3000%', '78.3000%', '78.3000%', '78.8000%', '77.5000%', '77.2000%', '76.1000%', '74.5000%', '71.6000%']
Computed and normalized credits:  tensor([0.0955, 0.0958, 0.0958, 0.0960, 0.0951, 0.0978, 0.0995, 0.1025, 0.1073,
        0.1147])
Federated model performance: Loss: 0.725972. Accuracy: 78.8235%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.818%', '60.813%', '64.813%', '74.481%', '75.487%', '76.599%', '76.727%', '77.326%', '76.834%', '77.455%']
Workers federated accuracies:  ['78.610%', '78.503%', '78.460%', '78.503%', '78.610%', '78.567%', '78.845%', '78.781%', '79.123%', '78.866%']
Workers improved  accuracies:  ['28.941%', '29.048%', '20.941%', '28.128%', '18.952%', '19.337%', '16.128%', '18.503%', '17.283%', '13.091%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 15:
Federated model validation accuracy : 77.9000%
Leave-one-out validation accuracies :  ['78.0000%', '77.9000%', '78.0000%', '77.6000%', '77.2000%', '75.9000%', '74.9000%', '73.1000%', '67.9000%', '64.3000%']
Computed and normalized credits:  tensor([0.0925, 0.0927, 0.0925, 0.0933, 0.0939, 0.0968, 0.0990, 0.1030, 0.1141,
        0.1224])
Federated model performance: Loss: 0.596795. Accuracy: 78.3529%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.989%', '62.203%', '65.369%', '74.888%', '75.679%', '76.770%', '76.984%', '77.583%', '76.877%', '77.476%']
Workers federated accuracies:  ['76.342%', '76.834%', '77.262%', '77.369%', '77.947%', '78.203%', '77.968%', '78.032%', '78.203%', '78.267%']
Workers improved  accuracies:  ['26.674%', '27.380%', '19.743%', '26.995%', '18.289%', '18.973%', '15.251%', '17.754%', '16.364%', '12.492%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 16:
Federated model validation accuracy : 78.4000%
Leave-one-out validation accuracies :  ['78.5000%', '77.9000%', '77.4000%', '76.7000%', '74.7000%', '72.4000%', '70.3000%', '67.9000%', '65.7000%', '61.2000%']
Computed and normalized credits:  tensor([0.0874, 0.0885, 0.0894, 0.0907, 0.0945, 0.0992, 0.1034, 0.1086, 0.1144,
        0.1239])
Federated model performance: Loss: 0.657932. Accuracy: 79.4438%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['49.968%', '62.759%', '65.925%', '75.102%', '75.765%', '76.834%', '76.920%', '77.455%', '76.984%', '77.433%']
Workers federated accuracies:  ['79.316%', '79.230%', '79.187%', '79.166%', '78.973%', '79.187%', '78.909%', '78.824%', '78.973%', '79.037%']
Workers improved  accuracies:  ['29.647%', '29.775%', '21.668%', '28.791%', '19.316%', '19.957%', '16.193%', '18.545%', '17.134%', '13.262%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 17:
Federated model validation accuracy : 73.6000%
Leave-one-out validation accuracies :  ['72.9000%', '72.4000%', '69.6000%', '67.4000%', '63.8000%', '58.9000%', '54.2000%', '51.7000%', '51.7000%', '51.0000%']
Computed and normalized credits:  tensor([0.0783, 0.0793, 0.0843, 0.0883, 0.0952, 0.1045, 0.1131, 0.1177, 0.1185,
        0.1208])
Federated model performance: Loss: 0.710457. Accuracy: 72.1925%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['50.182%', '63.209%', '66.652%', '75.316%', '76.000%', '76.813%', '76.877%', '77.519%', '76.984%', '77.497%']
Workers federated accuracies:  ['66.930%', '67.979%', '69.326%', '68.749%', '70.759%', '70.545%', '71.016%', '71.059%', '70.802%', '70.695%']
Workers improved  accuracies:  ['17.262%', '18.524%', '11.807%', '18.374%', '11.102%', '11.316%', '8.299%', '10.781%', '8.963%', '4.920%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 18:
Federated model validation accuracy : 67.8000%
Leave-one-out validation accuracies :  ['67.2000%', '66.4000%', '63.2000%', '58.7000%', '56.2000%', '51.5000%', '49.2000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0761, 0.0777, 0.0843, 0.0934, 0.0991, 0.1091, 0.1142, 0.1152, 0.1153,
        0.1156])
Federated model performance: Loss: 1.355604. Accuracy: 69.3690%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['50.160%', '63.701%', '68.342%', '75.422%', '76.150%', '76.984%', '77.112%', '77.283%', '76.984%', '77.497%']
Workers federated accuracies:  ['67.401%', '67.380%', '66.674%', '67.422%', '67.294%', '67.465%', '67.487%', '66.995%', '67.636%', '67.743%']
Workers improved  accuracies:  ['17.733%', '17.925%', '9.155%', '17.048%', '7.636%', '8.235%', '4.770%', '6.717%', '5.797%', '1.968%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 19:
Federated model validation accuracy : 55.0000%
Leave-one-out validation accuracies :  ['54.4000%', '52.9000%', '51.6000%', '51.7000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0890, 0.0933, 0.0978, 0.0989, 0.1016, 0.1032, 0.1039, 0.1041, 0.1041,
        0.1041])
Federated model performance: Loss: 1.773868. Accuracy: 53.8824%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['50.289%', '64.278%', '69.112%', '75.465%', '76.278%', '77.027%', '77.112%', '77.455%', '77.091%', '77.604%']
Workers federated accuracies:  ['50.610%', '50.631%', '50.930%', '50.930%', '51.551%', '51.508%', '51.658%', '51.722%', '51.807%', '51.979%']
Workers improved  accuracies:  ['0.941%', '1.176%', '-6.588%', '0.556%', '-8.107%', '-7.722%', '-11.059%', '-8.556%', '-10.032%', '-13.797%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 20:
Federated model validation accuracy : 57.6000%
Leave-one-out validation accuracies :  ['57.1000%', '55.4000%', '51.1000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0831, 0.0877, 0.0986, 0.1038, 0.1042, 0.1044, 0.1045, 0.1045, 0.1045,
        0.1046])
Federated model performance: Loss: 2.888309. Accuracy: 59.2299%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['50.332%', '65.433%', '70.118%', '75.615%', '76.406%', '77.070%', '77.112%', '77.433%', '77.134%', '77.626%']
Workers federated accuracies:  ['53.455%', '53.497%', '53.369%', '53.947%', '54.075%', '54.225%', '54.139%', '53.882%', '54.674%', '54.738%']
Workers improved  accuracies:  ['3.786%', '4.043%', '-4.150%', '3.572%', '-5.583%', '-5.005%', '-8.578%', '-6.396%', '-7.166%', '-11.037%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 2.888309. Accuracy: 59.2299%.
Workers before    accuracies:  ['49.668%', '49.455%', '57.519%', '50.374%', '59.658%', '59.230%', '62.717%', '60.278%', '61.840%', '65.775%']
Workers standlone accuracies:  ['50.332%', '65.433%', '70.118%', '75.615%', '76.406%', '77.070%', '77.112%', '77.433%', '77.134%', '77.626%']
Workers federated accuracies:  ['53.455%', '53.497%', '53.369%', '53.947%', '54.075%', '54.225%', '54.139%', '53.882%', '54.674%', '54.738%']
Workers improved  accuracies:  ['3.786%', '4.043%', '-4.150%', '3.572%', '-5.583%', '-5.005%', '-8.578%', '-6.396%', '-7.166%', '-11.037%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]
Workers sharing_contributions :  tensor([ 12.8000,  28.8000,  48.0000,  64.0000,  83.2000,  99.2000, 118.4000,
        134.4000, 153.6000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.46380593229356504, 0.176949068403902)
Correlation between stand alone test acc & collaborative final model acc:  (0.6754357712191734, 0.03207886418831414)
Correlation between test_acc & sharing contributions:  (0.8900687268268851, 0.0005584566137577829)
Correlation between test_acc improvements & sharing_contributions:  (-0.8700302385198125, 0.0010640274830583485)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.678365. Accuracy: 53.4118%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 58.5000%
Leave-one-out validation accuracies :  ['53.6000%', '49.4000%', '49.2000%', '49.1000%', '49.1000%', '49.1000%', '49.0000%', '49.0000%', '49.1000%', '49.1000%']
Computed and normalized credits:  tensor([0.0908, 0.1004, 0.1008, 0.1011, 0.1011, 0.1011, 0.1013, 0.1013, 0.1011,
        0.1011])
Federated model performance: Loss: 0.658472. Accuracy: 59.4866%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['49.818%', '50.717%', '62.310%', '56.492%', '66.160%', '65.711%', '67.316%', '69.797%', '68.834%', '70.439%']
Workers federated accuracies:  ['70.053%', '72.556%', '55.893%', '59.872%', '52.963%', '55.722%', '55.144%', '52.471%', '56.535%', '54.310%']
Workers improved  accuracies:  ['20.257%', '22.439%', '1.775%', '7.102%', '-8.856%', '-2.845%', '-6.674%', '-14.289%', '-8.193%', '-12.791%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 2:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0985, 0.1001, 0.1001, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002, 0.1002,
        0.1002])
Federated model performance: Loss: 0.956728. Accuracy: 49.7754%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['49.797%', '52.064%', '63.679%', '62.160%', '68.513%', '68.535%', '69.797%', '71.358%', '71.294%', '72.406%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.021%', '-0.342%', '-4.342%', '-2.995%', '-12.043%', '-8.791%', '-12.043%', '-16.984%', '-14.952%', '-17.326%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 3:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0997, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.397092. Accuracy: 50.2246%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['49.882%', '52.706%', '61.326%', '65.433%', '69.797%', '69.882%', '71.080%', '72.856%', '72.257%', '73.754%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.428%', '0.107%', '-3.893%', '-2.545%', '-11.594%', '-8.342%', '-11.594%', '-16.535%', '-14.503%', '-16.877%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 4:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 7.262305. Accuracy: 49.7754%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['49.968%', '53.305%', '61.583%', '67.465%', '70.610%', '71.465%', '72.299%', '73.797%', '72.877%', '74.631%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.021%', '-0.342%', '-4.342%', '-2.995%', '-12.043%', '-8.791%', '-12.043%', '-16.984%', '-14.952%', '-17.326%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 5:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.128802. Accuracy: 50.2246%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['49.989%', '55.850%', '62.203%', '69.027%', '71.465%', '72.342%', '73.647%', '74.717%', '74.075%', '74.909%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.428%', '0.107%', '-3.893%', '-2.545%', '-11.594%', '-8.342%', '-11.594%', '-16.535%', '-14.503%', '-16.877%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 6:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 6.266235. Accuracy: 49.7754%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.053%', '56.449%', '63.016%', '70.374%', '72.235%', '73.241%', '74.545%', '74.845%', '74.866%', '75.316%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.021%', '-0.342%', '-4.342%', '-2.995%', '-12.043%', '-8.791%', '-12.043%', '-16.984%', '-14.952%', '-17.326%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 7:
Federated model validation accuracy : 49.0000%
Leave-one-out validation accuracies :  ['49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 3.422132. Accuracy: 50.2246%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.139%', '57.540%', '64.727%', '71.358%', '73.005%', '73.797%', '74.738%', '75.316%', '75.273%', '75.829%']
Workers federated accuracies:  ['50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%', '50.225%']
Workers improved  accuracies:  ['0.428%', '0.107%', '-3.893%', '-2.545%', '-11.594%', '-8.342%', '-11.594%', '-16.535%', '-14.503%', '-16.877%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 8:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000, 0.1000,
        0.1000])
Federated model performance: Loss: 4.546501. Accuracy: 49.7754%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.225%', '59.123%', '65.390%', '72.086%', '73.647%', '74.139%', '75.037%', '75.636%', '75.658%', '75.936%']
Workers federated accuracies:  ['49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%', '49.775%']
Workers improved  accuracies:  ['-0.021%', '-0.342%', '-4.342%', '-2.995%', '-12.043%', '-8.791%', '-12.043%', '-16.984%', '-14.952%', '-17.326%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 9:
Federated model validation accuracy : 56.5000%
Leave-one-out validation accuracies :  ['55.5000%', '51.4000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0863, 0.0962, 0.1022, 0.1022, 0.1022, 0.1022, 0.1022, 0.1022, 0.1022,
        0.1022])
Federated model performance: Loss: 2.966865. Accuracy: 57.7112%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.289%', '60.150%', '66.610%', '72.535%', '74.032%', '74.610%', '75.487%', '75.701%', '75.957%', '76.150%']
Workers federated accuracies:  ['55.636%', '54.909%', '53.989%', '54.524%', '54.118%', '54.695%', '54.695%', '54.481%', '55.016%', '54.995%']
Workers improved  accuracies:  ['5.840%', '4.791%', '-0.128%', '1.754%', '-7.701%', '-3.872%', '-7.123%', '-12.278%', '-9.711%', '-12.107%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 10:
Federated model validation accuracy : 72.4000%
Leave-one-out validation accuracies :  ['71.7000%', '68.8000%', '64.5000%', '56.1000%', '51.9000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0736, 0.0796, 0.0876, 0.1018, 0.1084, 0.1098, 0.1098, 0.1098, 0.1098,
        0.1098])
Federated model performance: Loss: 1.485813. Accuracy: 71.7219%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.396%', '61.476%', '68.043%', '73.112%', '74.481%', '74.909%', '75.615%', '75.765%', '76.128%', '76.257%']
Workers federated accuracies:  ['63.059%', '64.385%', '66.139%', '65.797%', '66.738%', '66.973%', '67.316%', '67.850%', '67.936%', '68.364%']
Workers improved  accuracies:  ['13.262%', '14.267%', '12.021%', '13.027%', '4.920%', '8.406%', '5.497%', '1.091%', '3.209%', '1.262%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 11:
Federated model validation accuracy : 75.3000%
Leave-one-out validation accuracies :  ['75.0000%', '75.4000%', '74.9000%', '74.1000%', '70.2000%', '60.5000%', '49.9000%', '49.0000%', '49.0000%', '49.0000%']
Computed and normalized credits:  tensor([0.0760, 0.0762, 0.0780, 0.0812, 0.0887, 0.1058, 0.1226, 0.1238, 0.1238,
        0.1238])
Federated model performance: Loss: 1.601325. Accuracy: 76.8984%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.396%', '63.016%', '68.513%', '73.604%', '74.695%', '75.230%', '75.957%', '76.086%', '76.043%', '76.342%']
Workers federated accuracies:  ['76.898%', '76.920%', '76.920%', '76.941%', '76.684%', '76.727%', '76.877%', '76.941%', '76.770%', '76.834%']
Workers improved  accuracies:  ['27.102%', '26.802%', '22.802%', '24.171%', '14.866%', '18.160%', '15.059%', '10.182%', '12.043%', '9.733%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 12:
Federated model validation accuracy : 76.3000%
Leave-one-out validation accuracies :  ['76.3000%', '75.7000%', '76.4000%', '76.9000%', '76.0000%', '74.3000%', '70.1000%', '64.4000%', '55.8000%', '51.9000%']
Computed and normalized credits:  tensor([0.0844, 0.0855, 0.0845, 0.0840, 0.0868, 0.0924, 0.1027, 0.1138, 0.1297,
        0.1362])
Federated model performance: Loss: 0.893139. Accuracy: 77.3904%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.460%', '64.492%', '70.118%', '74.053%', '75.059%', '75.444%', '76.171%', '76.171%', '76.128%', '76.513%']
Workers federated accuracies:  ['77.027%', '77.048%', '77.070%', '77.283%', '77.476%', '77.476%', '77.433%', '77.626%', '77.690%', '77.797%']
Workers improved  accuracies:  ['27.230%', '26.930%', '22.952%', '24.513%', '15.658%', '18.909%', '15.615%', '10.866%', '12.963%', '10.695%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 13:
Federated model validation accuracy : 77.4000%
Leave-one-out validation accuracies :  ['77.3000%', '77.3000%', '77.6000%', '78.1000%', '77.7000%', '78.1000%', '78.4000%', '78.0000%', '78.5000%', '78.4000%']
Computed and normalized credits:  tensor([0.0987, 0.0989, 0.0981, 0.0970, 0.0983, 0.0984, 0.0995, 0.1022, 0.1039,
        0.1052])
Federated model performance: Loss: 0.714486. Accuracy: 78.8021%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.503%', '65.497%', '69.775%', '74.417%', '75.144%', '75.487%', '76.299%', '76.235%', '76.257%', '76.599%']
Workers federated accuracies:  ['78.053%', '78.246%', '78.524%', '78.545%', '78.781%', '78.802%', '78.759%', '78.717%', '78.738%', '79.102%']
Workers improved  accuracies:  ['28.257%', '28.128%', '24.406%', '25.775%', '16.963%', '20.235%', '16.941%', '11.957%', '14.011%', '12.000%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 14:
Federated model validation accuracy : 78.6000%
Leave-one-out validation accuracies :  ['78.6000%', '78.6000%', '78.9000%', '79.5000%', '79.6000%', '79.3000%', '78.8000%', '79.1000%', '79.0000%', '78.9000%']
Computed and normalized credits:  tensor([0.1006, 0.1007, 0.0999, 0.0986, 0.0986, 0.0992, 0.1004, 0.1002, 0.1007,
        0.1011])
Federated model performance: Loss: 0.601547. Accuracy: 79.7005%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.588%', '65.989%', '70.439%', '74.824%', '75.380%', '75.594%', '76.492%', '76.257%', '76.385%', '76.556%']
Workers federated accuracies:  ['78.075%', '78.460%', '78.930%', '79.080%', '79.187%', '79.337%', '79.166%', '79.529%', '79.337%', '79.358%']
Workers improved  accuracies:  ['28.278%', '28.342%', '24.813%', '26.310%', '17.369%', '20.770%', '17.348%', '12.770%', '14.610%', '12.257%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 15:
Federated model validation accuracy : 79.6000%
Leave-one-out validation accuracies :  ['79.6000%', '79.4000%', '79.3000%', '78.7000%', '78.7000%', '78.6000%', '78.3000%', '78.6000%', '78.8000%', '79.0000%']
Computed and normalized credits:  tensor([0.0987, 0.0991, 0.0992, 0.1002, 0.1002, 0.1005, 0.1012, 0.1006, 0.1003,
        0.1000])
Federated model performance: Loss: 0.552599. Accuracy: 80.2139%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.631%', '66.802%', '71.380%', '75.123%', '75.401%', '75.572%', '76.556%', '76.428%', '76.471%', '76.642%']
Workers federated accuracies:  ['78.545%', '79.080%', '79.465%', '79.615%', '79.701%', '79.850%', '79.508%', '79.893%', '79.872%', '79.829%']
Workers improved  accuracies:  ['28.749%', '28.963%', '25.348%', '26.845%', '17.882%', '21.283%', '17.690%', '13.134%', '15.144%', '12.727%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 16:
Federated model validation accuracy : 79.7000%
Leave-one-out validation accuracies :  ['79.9000%', '79.6000%', '79.5000%', '79.4000%', '79.5000%', '79.6000%', '79.6000%', '79.3000%', '78.7000%', '79.7000%']
Computed and normalized credits:  tensor([0.0990, 0.0996, 0.0998, 0.1002, 0.1000, 0.0998, 0.1000, 0.1005, 0.1016,
        0.0996])
Federated model performance: Loss: 0.510244. Accuracy: 79.9144%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.738%', '67.508%', '71.615%', '75.401%', '75.337%', '75.508%', '76.449%', '76.471%', '76.599%', '76.749%']
Workers federated accuracies:  ['77.711%', '78.460%', '78.909%', '78.781%', '79.487%', '79.337%', '79.422%', '79.701%', '79.615%', '79.786%']
Workers improved  accuracies:  ['27.914%', '28.342%', '24.791%', '26.011%', '17.668%', '20.770%', '17.604%', '12.941%', '14.888%', '12.684%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 17:
Federated model validation accuracy : 79.2000%
Leave-one-out validation accuracies :  ['79.2000%', '78.7000%', '78.2000%', '78.2000%', '77.9000%', '77.7000%', '77.3000%', '77.1000%', '76.4000%', '75.6000%']
Computed and normalized credits:  tensor([0.0968, 0.0979, 0.0989, 0.0989, 0.0995, 0.0998, 0.1006, 0.1011, 0.1027,
        0.1039])
Federated model performance: Loss: 0.515675. Accuracy: 80.5775%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['50.973%', '68.128%', '72.385%', '75.465%', '75.380%', '75.615%', '76.428%', '76.620%', '76.556%', '76.834%']
Workers federated accuracies:  ['79.487%', '79.850%', '80.128%', '80.406%', '80.278%', '80.556%', '80.385%', '80.535%', '80.599%', '80.578%']
Workers improved  accuracies:  ['29.690%', '29.733%', '26.011%', '27.636%', '18.460%', '21.989%', '18.567%', '13.775%', '15.872%', '13.476%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 18:
Federated model validation accuracy : 79.0000%
Leave-one-out validation accuracies :  ['79.0000%', '79.0000%', '78.9000%', '79.3000%', '79.6000%', '78.4000%', '77.0000%', '75.9000%', '73.8000%', '70.7000%']
Computed and normalized credits:  tensor([0.0959, 0.0960, 0.0964, 0.0956, 0.0952, 0.0975, 0.1003, 0.1026, 0.1070,
        0.1135])
Federated model performance: Loss: 0.482649. Accuracy: 78.9733%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['51.209%', '68.321%', '72.706%', '75.722%', '75.358%', '75.679%', '76.406%', '76.727%', '76.620%', '76.834%']
Workers federated accuracies:  ['75.037%', '76.385%', '77.455%', '77.134%', '78.225%', '78.075%', '78.374%', '78.652%', '78.396%', '78.353%']
Workers improved  accuracies:  ['25.241%', '26.267%', '23.337%', '24.364%', '16.406%', '19.508%', '16.556%', '11.893%', '13.668%', '11.251%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 19:
Federated model validation accuracy : 75.8000%
Leave-one-out validation accuracies :  ['75.6000%', '74.8000%', '72.9000%', '70.6000%', '69.1000%', '66.0000%', '62.4000%', '59.0000%', '56.9000%', '53.3000%']
Computed and normalized credits:  tensor([0.0825, 0.0839, 0.0873, 0.0912, 0.0939, 0.0998, 0.1068, 0.1131, 0.1174,
        0.1241])
Federated model performance: Loss: 0.639382. Accuracy: 76.6631%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['51.187%', '68.727%', '72.963%', '75.872%', '75.358%', '75.701%', '76.535%', '76.791%', '76.663%', '76.877%']
Workers federated accuracies:  ['78.225%', '77.711%', '77.048%', '77.070%', '76.856%', '77.091%', '77.176%', '76.963%', '77.455%', '77.070%']
Workers improved  accuracies:  ['28.428%', '27.594%', '22.930%', '24.299%', '15.037%', '18.524%', '15.358%', '10.203%', '12.727%', '9.968%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Epoch 20:
Federated model validation accuracy : 68.7000%
Leave-one-out validation accuracies :  ['68.5000%', '66.2000%', '63.1000%', '59.3000%', '55.2000%', '52.7000%', '51.8000%', '51.6000%', '51.0000%', '51.0000%']
Computed and normalized credits:  tensor([0.0764, 0.0807, 0.0870, 0.0947, 0.1028, 0.1081, 0.1107, 0.1118, 0.1135,
        0.1143])
Federated model performance: Loss: 0.830183. Accuracy: 67.2513%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['51.401%', '68.877%', '73.390%', '75.957%', '75.337%', '75.701%', '76.471%', '76.791%', '76.749%', '76.963%']
Workers federated accuracies:  ['56.749%', '58.332%', '60.471%', '60.428%', '62.417%', '62.310%', '62.481%', '63.230%', '63.273%', '63.658%']
Workers improved  accuracies:  ['6.952%', '8.214%', '6.353%', '7.658%', '0.599%', '3.743%', '0.663%', '-3.529%', '-1.455%', '-3.444%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.830183. Accuracy: 67.2513%.
Workers before    accuracies:  ['49.797%', '50.118%', '54.118%', '52.770%', '61.818%', '58.567%', '61.818%', '66.759%', '64.727%', '67.102%']
Workers standlone accuracies:  ['51.401%', '68.877%', '73.390%', '75.957%', '75.337%', '75.701%', '76.471%', '76.791%', '76.749%', '76.963%']
Workers federated accuracies:  ['56.749%', '58.332%', '60.471%', '60.428%', '62.417%', '62.310%', '62.481%', '63.230%', '63.273%', '63.658%']
Workers improved  accuracies:  ['6.952%', '8.214%', '6.353%', '7.658%', '0.599%', '3.743%', '0.663%', '-3.529%', '-1.455%', '-3.444%']
Workers shard sizes:  [128, 288, 480, 640, 832, 992, 1184, 1344, 1536, 1696]
Workers sharing_contributions :  tensor([ 12.8000,  28.8000,  48.0000,  64.0000,  83.2000,  99.2000, 118.4000,
        134.4000, 153.6000, 169.6000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.32763676672637365, 0.3554013601336376)
Correlation between stand alone test acc & collaborative final model acc:  (0.8625067174977433, 0.0013200418627894496)
Correlation between test_acc & sharing contributions:  (0.9291142357121146, 0.00010134078802115434)
Correlation between test_acc improvements & sharing_contributions:  (-0.9154353884613106, 0.000201820668173007)
standalone_vs_final_corr [[0.882006777276328], [-0.8865740811058347], [0.3385609248271219], [0.6754357712191734], [0.8625067174977433]]
standalone_vs_final_corr_mean [0.3743872219429064]
standalone_vs_final_corr_std [0.6599811232558643]
sharingcontribution_vs_final_corr [[0.8726440098487785], [-0.6039386596721121], [0.7135369200368682], [0.8900687268268851], [0.9291142357121146]]
sharingcontribution_vs_final_corr_mean [0.5602850465505068]
sharingcontribution_vs_final_corr_std [0.5867304906624204]
standalone_vs_federated_perturbed_corr [[0.022775795781869043], [-0.08028584357520423], [0.1508144959649017], [0.46380593229356504], [-0.32763676672637365]]
standalone_vs_federated_perturbed_corr_mean [0.045894722747751596]
standalone_vs_federated_perturbed_corr_std [0.26139614825256213]
federated_final_performance [0.6036363840103149, 0.755721926689148, 0.6083422303199768, 0.5922994613647461, 0.6725133657455444]
federated_final_performance_mean 0.646502673625946
federated_final_performance_std 0.06137935773918823
CFFL_best_worker [0.5674866437911987, 0.7561497092247009, 0.5796791315078735, 0.5473796725273132, 0.6365775465965271]
CFFL_best_worker_mean 0.6174545407295227
CFFL_best_worker_std 0.07541392250394408
standalone_best_worker [0.7700534462928772, 0.7668449282646179, 0.7771123051643372, 0.7762566804885864, 0.7696256637573242]
standalone_best_worker_mean 0.7719786047935486
standalone_best_worker_std 0.004006345282819687
