Experimental settings are:  {'device': device(type='cpu'), 'dataset': 'adult', 'sample_size_cap': 10000, 'n_workers': 10, 'split': 'powerlaw', 'sharing_lambda': 0.1, 'batch_size': 64, 'train_val_split_ratio': 0.9, 'model_fn': <class 'utils.models.LogisticRegression'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': CrossEntropyLoss(), 'lr': 0.0001, 'pretrain_epochs': 10, 'fl_epochs': 10, 'fl_individual_epochs': 5}
Experiment : No.1/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.781637. Accuracy: 44.7487%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 58.6000%
Leave-one-out validation accuracies :  ['58.6000%', '58.8000%', '59.3000%', '59.9000%', '60.9000%', '62.2000%', '64.4000%', '65.9000%', '67.1000%', '67.8000%']
Computed and normalized credits:  tensor([0.1107, 0.1101, 0.1086, 0.1069, 0.1040, 0.1004, 0.0945, 0.0907, 0.0878,
        0.0861])
Federated model performance: Loss: 0.738774. Accuracy: 57.0909%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['41.690%', '42.738%', '43.914%', '45.155%', '46.096%', '48.064%', '48.364%', '49.861%', '50.588%', '51.957%']
Workers federated accuracies:  ['55.080%', '55.701%', '56.321%', '56.920%', '57.241%', '57.647%', '58.203%', '58.503%', '58.631%', '59.209%']
Workers improved  accuracies:  ['13.519%', '13.540%', '13.348%', '13.155%', '13.005%', '12.278%', '12.364%', '11.893%', '11.337%', '11.016%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 2:
Federated model validation accuracy : 64.4000%
Leave-one-out validation accuracies :  ['64.2000%', '64.4000%', '64.4000%', '65.0000%', '66.0000%', '66.7000%', '67.8000%', '68.5000%', '69.2000%', '70.4000%']
Computed and normalized credits:  tensor([0.1080, 0.1074, 0.1071, 0.1053, 0.1022, 0.0999, 0.0962, 0.0938, 0.0916,
        0.0886])
Federated model performance: Loss: 0.704193. Accuracy: 61.8824%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['41.925%', '43.294%', '44.749%', '46.439%', '47.786%', '50.053%', '51.102%', '52.920%', '53.476%', '55.251%']
Workers federated accuracies:  ['60.449%', '60.727%', '61.433%', '61.925%', '62.096%', '62.781%', '62.909%', '63.209%', '63.508%', '64.021%']
Workers improved  accuracies:  ['18.888%', '18.567%', '18.460%', '18.160%', '17.861%', '17.412%', '17.070%', '16.599%', '16.214%', '15.829%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 3:
Federated model validation accuracy : 67.7000%
Leave-one-out validation accuracies :  ['67.8000%', '67.8000%', '68.0000%', '68.5000%', '68.9000%', '69.3000%', '69.8000%', '70.5000%', '71.0000%', '71.7000%']
Computed and normalized credits:  tensor([0.1050, 0.1049, 0.1043, 0.1028, 0.1014, 0.1000, 0.0982, 0.0962, 0.0947,
        0.0926])
Federated model performance: Loss: 0.676633. Accuracy: 66.0963%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['42.267%', '43.786%', '45.989%', '47.893%', '49.690%', '52.620%', '53.604%', '55.444%', '56.043%', '57.561%']
Workers federated accuracies:  ['64.834%', '65.134%', '65.626%', '66.032%', '66.353%', '66.802%', '66.995%', '67.422%', '67.594%', '67.936%']
Workers improved  accuracies:  ['23.273%', '22.973%', '22.652%', '22.267%', '22.118%', '21.433%', '21.155%', '20.813%', '20.299%', '19.743%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 4:
Federated model validation accuracy : 69.9000%
Leave-one-out validation accuracies :  ['70.0000%', '70.0000%', '70.3000%', '70.4000%', '70.6000%', '70.9000%', '71.3000%', '71.6000%', '72.2000%', '72.6000%']
Computed and normalized credits:  tensor([0.1031, 0.1031, 0.1023, 0.1018, 0.1011, 0.1002, 0.0990, 0.0980, 0.0964,
        0.0951])
Federated model performance: Loss: 0.653889. Accuracy: 68.5134%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['42.481%', '44.257%', '46.909%', '49.433%', '51.465%', '54.952%', '55.316%', '57.241%', '57.968%', '59.209%']
Workers federated accuracies:  ['67.786%', '68.150%', '68.278%', '68.556%', '68.834%', '69.241%', '69.326%', '69.690%', '69.818%', '70.032%']
Workers improved  accuracies:  ['26.225%', '25.989%', '25.305%', '24.791%', '24.599%', '23.872%', '23.487%', '23.080%', '22.524%', '21.840%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 5:
Federated model validation accuracy : 71.4000%
Leave-one-out validation accuracies :  ['71.4000%', '71.4000%', '71.4000%', '71.6000%', '71.6000%', '72.2000%', '72.5000%', '72.8000%', '73.1000%', '73.1000%']
Computed and normalized credits:  tensor([0.1021, 0.1021, 0.1019, 0.1014, 0.1013, 0.0998, 0.0990, 0.0981, 0.0972,
        0.0970])
Federated model performance: Loss: 0.635178. Accuracy: 70.1176%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['42.631%', '44.642%', '47.872%', '51.016%', '52.877%', '56.428%', '57.198%', '58.781%', '59.487%', '60.535%']
Workers federated accuracies:  ['69.604%', '69.840%', '69.925%', '70.289%', '70.545%', '70.781%', '70.995%', '71.337%', '71.422%', '71.701%']
Workers improved  accuracies:  ['28.043%', '27.679%', '26.952%', '26.524%', '26.310%', '25.412%', '25.155%', '24.727%', '24.128%', '23.508%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 6:
Federated model validation accuracy : 72.5000%
Leave-one-out validation accuracies :  ['72.6000%', '72.6000%', '72.8000%', '73.0000%', '73.1000%', '73.1000%', '73.0000%', '73.4000%', '73.6000%', '74.0000%']
Computed and normalized credits:  tensor([0.1015, 0.1015, 0.1010, 0.1005, 0.1003, 0.1000, 0.1001, 0.0991, 0.0985,
        0.0976])
Federated model performance: Loss: 0.619345. Accuracy: 71.2513%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['42.952%', '45.219%', '48.898%', '52.364%', '54.267%', '57.690%', '58.567%', '60.064%', '60.513%', '61.775%']
Workers federated accuracies:  ['70.695%', '71.059%', '71.230%', '71.380%', '71.679%', '71.979%', '72.171%', '72.193%', '72.193%', '72.364%']
Workers improved  accuracies:  ['29.134%', '28.898%', '28.257%', '27.615%', '27.444%', '26.610%', '26.332%', '25.583%', '24.898%', '24.171%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 7:
Federated model validation accuracy : 73.2000%
Leave-one-out validation accuracies :  ['73.2000%', '73.2000%', '73.2000%', '73.4000%', '73.6000%', '73.8000%', '74.0000%', '74.1000%', '73.9000%', '74.0000%']
Computed and normalized credits:  tensor([0.1012, 0.1012, 0.1011, 0.1006, 0.1001, 0.0997, 0.0992, 0.0989, 0.0992,
        0.0988])
Federated model performance: Loss: 0.605650. Accuracy: 72.0856%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['43.230%', '45.840%', '50.246%', '53.626%', '55.765%', '59.016%', '59.743%', '60.963%', '61.690%', '62.524%']
Workers federated accuracies:  ['71.658%', '71.893%', '72.150%', '72.150%', '72.406%', '72.471%', '72.620%', '72.599%', '72.642%', '72.684%']
Workers improved  accuracies:  ['30.096%', '29.733%', '29.176%', '28.385%', '28.171%', '27.102%', '26.781%', '25.989%', '25.348%', '24.492%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 8:
Federated model validation accuracy : 74.1000%
Leave-one-out validation accuracies :  ['74.1000%', '74.1000%', '74.1000%', '74.3000%', '74.3000%', '74.2000%', '74.0000%', '74.2000%', '74.7000%', '74.8000%']
Computed and normalized credits:  tensor([0.1006, 0.1006, 0.1006, 0.1001, 0.1000, 0.1001, 0.1005, 0.1000, 0.0990,
        0.0987])
Federated model performance: Loss: 0.593868. Accuracy: 72.5348%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['43.401%', '46.417%', '51.230%', '54.802%', '56.727%', '59.872%', '60.770%', '61.733%', '62.353%', '63.508%']
Workers federated accuracies:  ['72.214%', '72.449%', '72.492%', '72.620%', '72.663%', '72.856%', '72.963%', '73.048%', '73.027%', '73.155%']
Workers improved  accuracies:  ['30.652%', '30.289%', '29.519%', '28.856%', '28.428%', '27.487%', '27.123%', '26.439%', '25.733%', '24.963%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 9:
Federated model validation accuracy : 74.0000%
Leave-one-out validation accuracies :  ['74.1000%', '74.2000%', '74.4000%', '74.7000%', '74.6000%', '74.7000%', '74.8000%', '74.8000%', '74.9000%', '74.9000%']
Computed and normalized credits:  tensor([0.1012, 0.1010, 0.1005, 0.0998, 0.1000, 0.0998, 0.0997, 0.0996, 0.0992,
        0.0992])
Federated model performance: Loss: 0.583355. Accuracy: 72.8770%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['43.508%', '46.930%', '52.364%', '55.914%', '57.326%', '60.877%', '61.540%', '62.438%', '63.209%', '64.150%']
Workers federated accuracies:  ['72.449%', '72.599%', '72.834%', '73.005%', '73.027%', '73.219%', '73.176%', '73.369%', '73.476%', '73.433%']
Workers improved  accuracies:  ['30.888%', '30.439%', '29.861%', '29.241%', '28.791%', '27.850%', '27.337%', '26.759%', '26.182%', '25.241%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 10:
Federated model validation accuracy : 74.7000%
Leave-one-out validation accuracies :  ['74.7000%', '74.8000%', '74.7000%', '74.8000%', '74.9000%', '74.9000%', '74.9000%', '74.8000%', '74.8000%', '74.9000%']
Computed and normalized credits:  tensor([0.1004, 0.1002, 0.1003, 0.1000, 0.0998, 0.0998, 0.0998, 0.1000, 0.0999,
        0.0997])
Federated model performance: Loss: 0.574323. Accuracy: 73.1123%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['43.658%', '47.636%', '53.198%', '56.898%', '58.225%', '61.540%', '62.139%', '63.059%', '64.257%', '65.176%']
Workers federated accuracies:  ['72.770%', '72.920%', '73.070%', '73.134%', '73.198%', '73.455%', '73.561%', '73.711%', '73.882%', '73.818%']
Workers improved  accuracies:  ['31.209%', '30.759%', '30.096%', '29.369%', '28.963%', '28.086%', '27.722%', '27.102%', '26.588%', '25.626%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.574323. Accuracy: 73.1123%.
Workers before    accuracies:  ['41.561%', '42.160%', '42.973%', '43.765%', '44.235%', '45.369%', '45.840%', '46.610%', '47.294%', '48.193%']
Workers standlone accuracies:  ['43.658%', '47.636%', '53.198%', '56.898%', '58.225%', '61.540%', '62.139%', '63.059%', '64.257%', '65.176%']
Workers federated accuracies:  ['72.770%', '72.920%', '73.070%', '73.134%', '73.198%', '73.455%', '73.561%', '73.711%', '73.882%', '73.818%']
Workers improved  accuracies:  ['31.209%', '30.759%', '30.096%', '29.369%', '28.963%', '28.086%', '27.722%', '27.102%', '26.588%', '25.626%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]
Workers sharing_contributions :  tensor([ 12.8000,  32.0000,  51.2000,  64.0000,  83.2000, 102.4000, 121.6000,
        134.4000, 153.6000, 172.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.27228164253425324, 0.4466117191637449)
Correlation between stand alone test acc & collaborative final model acc:  (0.9421145210587669, 4.578942436265823e-05)
Correlation between test_acc & sharing contributions:  (0.9877734872297459, 9.633903052674675e-08)
Correlation between test_acc improvements & sharing_contributions:  (-0.9973324834040543, 2.208084616571243e-10)
Experiment : No.2/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.815893. Accuracy: 42.9519%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 48.9000%
Leave-one-out validation accuracies :  ['49.0000%', '49.4000%', '50.0000%', '50.8000%', '51.6000%', '53.0000%', '54.2000%', '56.4000%', '59.3000%', '61.4000%']
Computed and normalized credits:  tensor([0.1148, 0.1134, 0.1112, 0.1084, 0.1056, 0.1008, 0.0969, 0.0902, 0.0820,
        0.0767])
Federated model performance: Loss: 0.766678. Accuracy: 49.6043%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['41.690%', '42.246%', '42.888%', '43.080%', '43.594%', '44.257%', '44.770%', '45.070%', '45.348%', '45.668%']
Workers federated accuracies:  ['48.321%', '48.727%', '49.027%', '49.241%', '49.754%', '50.139%', '50.652%', '51.016%', '51.166%', '51.679%']
Workers improved  accuracies:  ['6.888%', '6.802%', '6.631%', '6.738%', '6.866%', '6.866%', '7.166%', '7.401%', '7.209%', '7.487%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 2:
Federated model validation accuracy : 53.7000%
Leave-one-out validation accuracies :  ['53.6000%', '54.4000%', '55.1000%', '56.2000%', '57.3000%', '58.8000%', '60.7000%', '62.2000%', '64.4000%', '65.6000%']
Computed and normalized credits:  tensor([0.1188, 0.1159, 0.1131, 0.1090, 0.1050, 0.0996, 0.0933, 0.0879, 0.0806,
        0.0767])
Federated model performance: Loss: 0.729380. Accuracy: 55.3583%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['41.818%', '42.610%', '43.358%', '43.529%', '44.449%', '45.155%', '45.647%', '46.289%', '46.930%', '47.230%']
Workers federated accuracies:  ['53.818%', '54.246%', '54.802%', '55.102%', '55.807%', '56.193%', '56.813%', '57.027%', '57.241%', '57.818%']
Workers improved  accuracies:  ['12.385%', '12.321%', '12.406%', '12.599%', '12.920%', '12.920%', '13.326%', '13.412%', '13.283%', '13.626%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 3:
Federated model validation accuracy : 60.4000%
Leave-one-out validation accuracies :  ['60.4000%', '60.9000%', '61.5000%', '61.8000%', '62.9000%', '64.0000%', '65.4000%', '65.7000%', '66.9000%', '67.7000%']
Computed and normalized credits:  tensor([0.1123, 0.1104, 0.1082, 0.1066, 0.1029, 0.0990, 0.0943, 0.0925, 0.0882,
        0.0856])
Federated model performance: Loss: 0.700689. Accuracy: 60.7701%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['41.968%', '42.781%', '43.829%', '44.107%', '45.176%', '46.225%', '47.144%', '47.444%', '48.278%', '48.770%']
Workers federated accuracies:  ['59.273%', '59.722%', '60.449%', '60.834%', '61.326%', '61.583%', '62.353%', '62.374%', '62.888%', '63.273%']
Workers improved  accuracies:  ['17.840%', '17.797%', '18.053%', '18.332%', '18.439%', '18.310%', '18.866%', '18.759%', '18.930%', '19.080%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 4:
Federated model validation accuracy : 65.1000%
Leave-one-out validation accuracies :  ['65.1000%', '65.5000%', '65.6000%', '66.0000%', '66.2000%', '66.7000%', '67.6000%', '68.5000%', '69.1000%', '69.6000%']
Computed and normalized credits:  tensor([0.1068, 0.1054, 0.1048, 0.1035, 0.1024, 0.1005, 0.0975, 0.0950, 0.0929,
        0.0912])
Federated model performance: Loss: 0.678182. Accuracy: 65.1123%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['42.139%', '43.059%', '44.471%', '44.920%', '46.011%', '47.166%', '48.043%', '48.578%', '49.818%', '50.246%']
Workers federated accuracies:  ['63.294%', '63.957%', '64.684%', '65.176%', '65.668%', '66.096%', '66.225%', '66.481%', '66.909%', '66.930%']
Workers improved  accuracies:  ['21.861%', '22.032%', '22.289%', '22.674%', '22.781%', '22.824%', '22.738%', '22.866%', '22.952%', '22.738%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 5:
Federated model validation accuracy : 67.6000%
Leave-one-out validation accuracies :  ['67.6000%', '67.9000%', '68.3000%', '68.8000%', '69.0000%', '69.5000%', '69.5000%', '69.5000%', '70.2000%', '70.9000%']
Computed and normalized credits:  tensor([0.1047, 0.1038, 0.1027, 0.1013, 0.1007, 0.0992, 0.0987, 0.0982, 0.0962,
        0.0944])
Federated model performance: Loss: 0.660066. Accuracy: 67.4866%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['42.182%', '43.465%', '44.920%', '45.348%', '46.888%', '48.193%', '49.027%', '49.947%', '50.802%', '51.893%']
Workers federated accuracies:  ['66.545%', '66.717%', '67.230%', '67.615%', '68.107%', '68.299%', '68.706%', '68.941%', '69.112%', '69.369%']
Workers improved  accuracies:  ['25.112%', '24.791%', '24.834%', '25.112%', '25.219%', '25.027%', '25.219%', '25.326%', '25.155%', '25.176%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 6:
Federated model validation accuracy : 69.7000%
Leave-one-out validation accuracies :  ['69.8000%', '69.8000%', '69.6000%', '69.6000%', '69.9000%', '70.3000%', '70.6000%', '71.1000%', '71.2000%', '71.1000%']
Computed and normalized credits:  tensor([0.1019, 0.1018, 0.1020, 0.1018, 0.1010, 0.0999, 0.0991, 0.0979, 0.0973,
        0.0973])
Federated model performance: Loss: 0.645146. Accuracy: 69.1337%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['42.289%', '43.594%', '45.283%', '45.989%', '47.572%', '49.134%', '50.160%', '51.080%', '52.364%', '53.647%']
Workers federated accuracies:  ['68.171%', '68.406%', '68.920%', '69.219%', '69.604%', '69.840%', '70.267%', '70.396%', '70.524%', '70.888%']
Workers improved  accuracies:  ['26.738%', '26.481%', '26.524%', '26.717%', '26.717%', '26.567%', '26.781%', '26.781%', '26.567%', '26.695%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 7:
Federated model validation accuracy : 70.7000%
Leave-one-out validation accuracies :  ['70.7000%', '70.6000%', '70.7000%', '70.8000%', '71.4000%', '71.3000%', '71.4000%', '71.7000%', '71.8000%', '72.3000%']
Computed and normalized credits:  tensor([0.1016, 0.1018, 0.1016, 0.1013, 0.0999, 0.0999, 0.0996, 0.0987, 0.0984,
        0.0973])
Federated model performance: Loss: 0.632817. Accuracy: 70.3315%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['42.353%', '43.979%', '45.840%', '46.738%', '48.449%', '50.032%', '51.251%', '52.791%', '53.668%', '54.802%']
Workers federated accuracies:  ['69.369%', '69.754%', '70.246%', '70.567%', '70.781%', '71.144%', '71.487%', '71.422%', '71.743%', '71.979%']
Workers improved  accuracies:  ['27.936%', '27.829%', '27.850%', '28.064%', '27.893%', '27.872%', '28.000%', '27.807%', '27.786%', '27.786%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 8:
Federated model validation accuracy : 71.3000%
Leave-one-out validation accuracies :  ['71.3000%', '71.4000%', '71.5000%', '71.8000%', '71.8000%', '71.9000%', '72.1000%', '72.5000%', '72.9000%', '73.2000%']
Computed and normalized credits:  tensor([0.1019, 0.1017, 0.1015, 0.1008, 0.1005, 0.1003, 0.0998, 0.0988, 0.0978,
        0.0970])
Federated model performance: Loss: 0.622534. Accuracy: 71.4438%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['42.503%', '44.406%', '46.246%', '47.294%', '49.048%', '51.144%', '52.599%', '53.840%', '55.037%', '56.086%']
Workers federated accuracies:  ['70.503%', '70.631%', '70.952%', '71.401%', '71.829%', '71.872%', '72.193%', '72.214%', '72.471%', '72.556%']
Workers improved  accuracies:  ['29.070%', '28.706%', '28.556%', '28.898%', '28.941%', '28.599%', '28.706%', '28.599%', '28.513%', '28.364%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 9:
Federated model validation accuracy : 72.0000%
Leave-one-out validation accuracies :  ['72.0000%', '72.0000%', '72.0000%', '72.2000%', '72.8000%', '73.0000%', '73.3000%', '73.5000%', '73.6000%', '73.7000%']
Computed and normalized credits:  tensor([0.1021, 0.1021, 0.1020, 0.1015, 0.1001, 0.0996, 0.0989, 0.0983, 0.0979,
        0.0976])
Federated model performance: Loss: 0.613756. Accuracy: 72.1283%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['42.567%', '44.663%', '46.695%', '47.936%', '50.011%', '52.214%', '53.647%', '54.909%', '56.214%', '57.540%']
Workers federated accuracies:  ['70.995%', '71.337%', '71.636%', '72.128%', '72.278%', '72.471%', '72.749%', '72.770%', '72.941%', '73.005%']
Workers improved  accuracies:  ['29.561%', '29.412%', '29.241%', '29.626%', '29.390%', '29.198%', '29.262%', '29.155%', '28.984%', '28.813%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 10:
Federated model validation accuracy : 73.0000%
Leave-one-out validation accuracies :  ['73.0000%', '73.1000%', '73.1000%', '73.2000%', '73.6000%', '73.6000%', '73.7000%', '73.7000%', '73.8000%', '73.8000%']
Computed and normalized credits:  tensor([0.1013, 0.1011, 0.1011, 0.1008, 0.0997, 0.0996, 0.0993, 0.0992, 0.0989,
        0.0989])
Federated model performance: Loss: 0.606084. Accuracy: 72.8984%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['42.695%', '44.963%', '47.358%', '48.513%', '50.888%', '53.241%', '54.524%', '56.235%', '57.369%', '59.059%']
Workers federated accuracies:  ['71.765%', '71.979%', '72.193%', '72.706%', '73.005%', '72.963%', '73.176%', '73.070%', '73.583%', '73.604%']
Workers improved  accuracies:  ['30.332%', '30.053%', '29.797%', '30.203%', '30.118%', '29.690%', '29.690%', '29.455%', '29.626%', '29.412%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.606084. Accuracy: 72.8984%.
Workers before    accuracies:  ['41.433%', '41.925%', '42.396%', '42.503%', '42.888%', '43.273%', '43.487%', '43.615%', '43.957%', '44.193%']
Workers standlone accuracies:  ['42.695%', '44.963%', '47.358%', '48.513%', '50.888%', '53.241%', '54.524%', '56.235%', '57.369%', '59.059%']
Workers federated accuracies:  ['71.765%', '71.979%', '72.193%', '72.706%', '73.005%', '72.963%', '73.176%', '73.070%', '73.583%', '73.604%']
Workers improved  accuracies:  ['30.332%', '30.053%', '29.797%', '30.203%', '30.118%', '29.690%', '29.690%', '29.455%', '29.626%', '29.412%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]
Workers sharing_contributions :  tensor([ 12.8000,  32.0000,  51.2000,  64.0000,  83.2000, 102.4000, 121.6000,
        134.4000, 153.6000, 172.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.7712350361083228, 0.008996149547142632)
Correlation between stand alone test acc & collaborative final model acc:  (0.9650957487634221, 6.225634328717794e-06)
Correlation between test_acc & sharing contributions:  (0.9625721715151443, 8.205707076887765e-06)
Correlation between test_acc improvements & sharing_contributions:  (-0.8660973575363923, 0.001192853156097803)
Experiment : No.3/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.785528. Accuracy: 43.9144%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 51.0000%
Leave-one-out validation accuracies :  ['51.0000%', '51.1000%', '52.6000%', '53.7000%', '55.3000%', '55.9000%', '58.5000%', '60.1000%', '61.7000%', '62.8000%']
Computed and normalized credits:  tensor([0.1170, 0.1166, 0.1113, 0.1076, 0.1023, 0.1004, 0.0925, 0.0879, 0.0837,
        0.0809])
Federated model performance: Loss: 0.742523. Accuracy: 50.7594%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['42.545%', '43.166%', '43.765%', '44.021%', '44.150%', '44.877%', '45.155%', '45.583%', '46.246%', '46.524%']
Workers federated accuracies:  ['48.770%', '49.348%', '49.947%', '50.225%', '50.824%', '51.294%', '51.893%', '52.235%', '52.941%', '53.262%']
Workers improved  accuracies:  ['6.267%', '6.481%', '6.738%', '6.866%', '7.123%', '7.294%', '7.807%', '7.893%', '8.064%', '8.235%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 2:
Federated model validation accuracy : 58.2000%
Leave-one-out validation accuracies :  ['58.2000%', '58.1000%', '59.0000%', '60.1000%', '61.0000%', '61.8000%', '62.8000%', '64.1000%', '64.9000%', '65.4000%']
Computed and normalized credits:  tensor([0.1124, 0.1126, 0.1090, 0.1052, 0.1017, 0.0991, 0.0950, 0.0908, 0.0880,
        0.0862])
Federated model performance: Loss: 0.709428. Accuracy: 58.0321%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['42.652%', '43.422%', '44.086%', '44.299%', '45.027%', '45.904%', '46.332%', '46.652%', '47.658%', '48.171%']
Workers federated accuracies:  ['56.214%', '56.877%', '57.305%', '57.626%', '58.439%', '59.123%', '59.658%', '59.957%', '60.471%', '60.578%']
Workers improved  accuracies:  ['13.711%', '14.011%', '14.096%', '14.267%', '14.738%', '15.123%', '15.572%', '15.615%', '15.594%', '15.551%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 3:
Federated model validation accuracy : 62.8000%
Leave-one-out validation accuracies :  ['62.8000%', '62.8000%', '63.2000%', '63.7000%', '64.8000%', '64.8000%', '65.5000%', '65.6000%', '65.8000%', '67.0000%']
Computed and normalized credits:  tensor([0.1067, 0.1068, 0.1051, 0.1031, 0.0997, 0.0993, 0.0968, 0.0959, 0.0949,
        0.0916])
Federated model performance: Loss: 0.684464. Accuracy: 62.2888%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['42.802%', '43.679%', '44.299%', '45.005%', '45.882%', '46.695%', '47.380%', '48.021%', '49.219%', '50.096%']
Workers federated accuracies:  ['61.262%', '61.647%', '62.011%', '62.182%', '62.674%', '63.037%', '63.487%', '63.850%', '64.428%', '64.556%']
Workers improved  accuracies:  ['18.759%', '18.781%', '18.802%', '18.824%', '18.973%', '19.037%', '19.401%', '19.508%', '19.551%', '19.529%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 4:
Federated model validation accuracy : 65.2000%
Leave-one-out validation accuracies :  ['65.2000%', '65.4000%', '65.4000%', '65.6000%', '65.5000%', '66.1000%', '66.4000%', '67.1000%', '67.6000%', '68.5000%']
Computed and normalized credits:  tensor([0.1038, 0.1033, 0.1030, 0.1022, 0.1018, 0.1003, 0.0991, 0.0973, 0.0959,
        0.0933])
Federated model performance: Loss: 0.664792. Accuracy: 65.8396%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['42.866%', '43.979%', '44.984%', '45.583%', '46.503%', '47.850%', '48.599%', '49.647%', '50.995%', '52.043%']
Workers federated accuracies:  ['64.492%', '65.198%', '65.583%', '65.668%', '66.075%', '66.396%', '66.674%', '67.102%', '67.572%', '67.701%']
Workers improved  accuracies:  ['21.989%', '22.332%', '22.374%', '22.310%', '22.374%', '22.396%', '22.588%', '22.759%', '22.695%', '22.674%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 5:
Federated model validation accuracy : 66.7000%
Leave-one-out validation accuracies :  ['66.6000%', '66.5000%', '66.6000%', '67.0000%', '67.2000%', '67.9000%', '68.3000%', '68.8000%', '69.4000%', '70.3000%']
Computed and normalized credits:  tensor([0.1036, 0.1038, 0.1035, 0.1024, 0.1019, 0.0999, 0.0988, 0.0973, 0.0957,
        0.0932])
Federated model performance: Loss: 0.648732. Accuracy: 68.1497%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['42.930%', '44.107%', '45.476%', '46.246%', '47.251%', '48.727%', '50.032%', '51.273%', '52.727%', '53.711%']
Workers federated accuracies:  ['66.717%', '67.080%', '67.722%', '67.872%', '68.449%', '68.642%', '68.920%', '69.219%', '69.668%', '69.754%']
Workers improved  accuracies:  ['24.214%', '24.214%', '24.513%', '24.513%', '24.749%', '24.642%', '24.834%', '24.877%', '24.791%', '24.727%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 6:
Federated model validation accuracy : 68.5000%
Leave-one-out validation accuracies :  ['68.6000%', '68.8000%', '68.7000%', '68.8000%', '69.1000%', '69.8000%', '70.1000%', '70.7000%', '71.2000%', '71.0000%']
Computed and normalized credits:  tensor([0.1031, 0.1027, 0.1029, 0.1024, 0.1016, 0.0997, 0.0988, 0.0972, 0.0958,
        0.0958])
Federated model performance: Loss: 0.635381. Accuracy: 69.8824%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['43.016%', '44.235%', '46.011%', '46.652%', '48.406%', '50.075%', '51.209%', '52.492%', '54.289%', '55.358%']
Workers federated accuracies:  ['68.406%', '68.684%', '69.155%', '69.348%', '69.754%', '70.011%', '70.225%', '70.460%', '70.973%', '71.037%']
Workers improved  accuracies:  ['25.904%', '25.818%', '25.947%', '25.989%', '26.053%', '26.011%', '26.139%', '26.118%', '26.096%', '26.011%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 7:
Federated model validation accuracy : 70.1000%
Leave-one-out validation accuracies :  ['70.2000%', '70.4000%', '70.6000%', '70.7000%', '70.9000%', '71.3000%', '71.2000%', '71.0000%', '71.0000%', '71.6000%']
Computed and normalized credits:  tensor([0.1021, 0.1016, 0.1011, 0.1008, 0.1003, 0.0990, 0.0991, 0.0993, 0.0990,
        0.0977])
Federated model performance: Loss: 0.623926. Accuracy: 70.8449%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['43.187%', '44.535%', '46.545%', '47.187%', '49.027%', '51.508%', '52.706%', '53.733%', '55.936%', '57.283%']
Workers federated accuracies:  ['69.583%', '69.754%', '70.096%', '70.417%', '70.888%', '70.888%', '71.230%', '71.422%', '71.872%', '72.043%']
Workers improved  accuracies:  ['27.080%', '26.888%', '26.888%', '27.059%', '27.187%', '26.888%', '27.144%', '27.080%', '26.995%', '27.016%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 8:
Federated model validation accuracy : 70.9000%
Leave-one-out validation accuracies :  ['70.9000%', '70.8000%', '71.0000%', '71.1000%', '71.1000%', '71.0000%', '71.5000%', '71.5000%', '71.9000%', '71.9000%']
Computed and normalized credits:  tensor([0.1012, 0.1013, 0.1008, 0.1005, 0.1004, 0.1004, 0.0993, 0.0994, 0.0984,
        0.0982])
Federated model performance: Loss: 0.614077. Accuracy: 72.0642%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['43.316%', '44.984%', '46.995%', '47.979%', '50.289%', '52.578%', '53.733%', '55.230%', '57.754%', '58.674%']
Workers federated accuracies:  ['70.610%', '70.652%', '71.059%', '71.209%', '71.551%', '71.615%', '71.979%', '72.193%', '72.663%', '72.642%']
Workers improved  accuracies:  ['28.107%', '27.786%', '27.850%', '27.850%', '27.850%', '27.615%', '27.893%', '27.850%', '27.786%', '27.615%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 9:
Federated model validation accuracy : 71.4000%
Leave-one-out validation accuracies :  ['71.4000%', '71.4000%', '71.6000%', '71.7000%', '72.0000%', '71.8000%', '71.9000%', '72.2000%', '72.3000%', '72.2000%']
Computed and normalized credits:  tensor([0.1012, 0.1012, 0.1007, 0.1004, 0.0997, 0.1002, 0.0998, 0.0991, 0.0988,
        0.0989])
Federated model performance: Loss: 0.605504. Accuracy: 72.6845%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['43.337%', '45.198%', '47.658%', '48.556%', '51.209%', '53.326%', '54.866%', '56.791%', '59.358%', '60.321%']
Workers federated accuracies:  ['71.059%', '71.209%', '71.679%', '71.872%', '72.128%', '72.214%', '72.385%', '72.642%', '73.198%', '73.112%']
Workers improved  accuracies:  ['28.556%', '28.342%', '28.471%', '28.513%', '28.428%', '28.214%', '28.299%', '28.299%', '28.321%', '28.086%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 10:
Federated model validation accuracy : 72.3000%
Leave-one-out validation accuracies :  ['72.3000%', '72.3000%', '72.3000%', '72.2000%', '72.3000%', '72.2000%', '72.2000%', '72.5000%', '72.8000%', '72.9000%']
Computed and normalized credits:  tensor([0.1004, 0.1004, 0.1003, 0.1005, 0.1002, 0.1005, 0.1004, 0.0996, 0.0989,
        0.0987])
Federated model performance: Loss: 0.597847. Accuracy: 73.0481%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['43.444%', '45.497%', '48.128%', '49.198%', '52.342%', '54.545%', '56.214%', '58.139%', '60.770%', '61.840%']
Workers federated accuracies:  ['71.508%', '71.615%', '71.957%', '72.214%', '72.449%', '72.834%', '73.112%', '73.283%', '73.604%', '73.519%']
Workers improved  accuracies:  ['29.005%', '28.749%', '28.749%', '28.856%', '28.749%', '28.834%', '29.027%', '28.941%', '28.727%', '28.492%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.597847. Accuracy: 73.0481%.
Workers before    accuracies:  ['42.503%', '42.866%', '43.209%', '43.358%', '43.701%', '44.000%', '44.086%', '44.342%', '44.877%', '45.027%']
Workers standlone accuracies:  ['43.444%', '45.497%', '48.128%', '49.198%', '52.342%', '54.545%', '56.214%', '58.139%', '60.770%', '61.840%']
Workers federated accuracies:  ['71.508%', '71.615%', '71.957%', '72.214%', '72.449%', '72.834%', '73.112%', '73.283%', '73.604%', '73.519%']
Workers improved  accuracies:  ['29.005%', '28.749%', '28.749%', '28.856%', '28.749%', '28.834%', '29.027%', '28.941%', '28.727%', '28.492%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]
Workers sharing_contributions :  tensor([ 12.8000,  32.0000,  51.2000,  64.0000,  83.2000, 102.4000, 121.6000,
        134.4000, 153.6000, 172.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.51406241667966, 0.1284995334713255)
Correlation between stand alone test acc & collaborative final model acc:  (0.9933911697949688, 8.279956218317633e-09)
Correlation between test_acc & sharing contributions:  (0.9893186307733529, 5.6222248531459797e-08)
Correlation between test_acc improvements & sharing_contributions:  (-0.3784233347892429, 0.2809051983479693)
Experiment : No.4/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.739369. Accuracy: 50.2246%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 61.6000%
Leave-one-out validation accuracies :  ['61.7000%', '62.1000%', '62.7000%', '63.7000%', '64.5000%', '65.8000%', '66.7000%', '68.0000%', '69.5000%', '69.7000%']
Computed and normalized credits:  tensor([0.1099, 0.1087, 0.1071, 0.1044, 0.1022, 0.0988, 0.0965, 0.0933, 0.0897,
        0.0893])
Federated model performance: Loss: 0.700618. Accuracy: 60.3422%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['47.850%', '48.663%', '50.011%', '50.374%', '51.102%', '52.107%', '52.684%', '53.369%', '53.882%', '54.332%']
Workers federated accuracies:  ['57.904%', '58.545%', '59.422%', '59.572%', '60.449%', '61.176%', '61.604%', '61.925%', '62.310%', '62.524%']
Workers improved  accuracies:  ['10.332%', '10.332%', '10.567%', '10.481%', '10.374%', '10.545%', '10.674%', '10.652%', '10.588%', '10.439%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 2:
Federated model validation accuracy : 66.9000%
Leave-one-out validation accuracies :  ['66.9000%', '66.9000%', '67.5000%', '68.0000%', '68.3000%', '69.5000%', '69.6000%', '70.0000%', '70.9000%', '71.6000%']
Computed and normalized credits:  tensor([0.1065, 0.1063, 0.1046, 0.1029, 0.1018, 0.0984, 0.0977, 0.0962, 0.0936,
        0.0919])
Federated model performance: Loss: 0.670402. Accuracy: 66.1818%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['47.957%', '49.176%', '50.717%', '51.144%', '52.235%', '53.540%', '54.075%', '54.952%', '55.850%', '56.535%']
Workers federated accuracies:  ['65.198%', '65.561%', '65.775%', '66.096%', '66.460%', '66.866%', '67.016%', '67.187%', '67.615%', '67.743%']
Workers improved  accuracies:  ['17.626%', '17.348%', '16.920%', '17.005%', '16.385%', '16.235%', '16.086%', '15.914%', '15.893%', '15.658%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 3:
Federated model validation accuracy : 70.1000%
Leave-one-out validation accuracies :  ['70.1000%', '70.1000%', '69.8000%', '70.2000%', '70.2000%', '70.6000%', '71.3000%', '71.9000%', '72.0000%', '72.5000%']
Computed and normalized credits:  tensor([0.1028, 0.1028, 0.1032, 0.1020, 0.1018, 0.1003, 0.0986, 0.0971, 0.0964,
        0.0950])
Federated model performance: Loss: 0.646645. Accuracy: 69.4332%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['48.150%', '50.053%', '51.551%', '51.957%', '53.519%', '55.037%', '56.000%', '56.706%', '57.775%', '58.695%']
Workers federated accuracies:  ['68.471%', '68.770%', '69.219%', '69.604%', '69.947%', '70.310%', '70.545%', '70.695%', '70.973%', '71.059%']
Workers improved  accuracies:  ['20.898%', '20.556%', '20.364%', '20.513%', '19.872%', '19.679%', '19.615%', '19.422%', '19.251%', '18.973%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 4:
Federated model validation accuracy : 71.6000%
Leave-one-out validation accuracies :  ['71.6000%', '71.8000%', '72.0000%', '72.1000%', '72.0000%', '72.0000%', '72.6000%', '72.4000%', '72.7000%', '72.8000%']
Computed and normalized credits:  tensor([0.1018, 0.1013, 0.1010, 0.1006, 0.1007, 0.1005, 0.0989, 0.0991, 0.0983,
        0.0978])
Federated model performance: Loss: 0.627674. Accuracy: 71.7861%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['48.321%', '50.289%', '52.278%', '53.048%', '54.460%', '56.642%', '57.604%', '58.652%', '60.000%', '60.749%']
Workers federated accuracies:  ['71.102%', '71.337%', '71.658%', '71.829%', '72.064%', '72.235%', '72.492%', '72.428%', '72.791%', '72.749%']
Workers improved  accuracies:  ['23.529%', '23.123%', '22.802%', '22.738%', '21.989%', '21.604%', '21.561%', '21.155%', '21.070%', '20.663%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 5:
Federated model validation accuracy : 72.8000%
Leave-one-out validation accuracies :  ['72.7000%', '72.6000%', '72.6000%', '72.5000%', '72.5000%', '72.7000%', '72.6000%', '73.0000%', '72.6000%', '72.8000%']
Computed and normalized credits:  tensor([0.1002, 0.1004, 0.1003, 0.1004, 0.1005, 0.1000, 0.0999, 0.0991, 0.0998,
        0.0993])
Federated model performance: Loss: 0.612165. Accuracy: 72.8984%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['48.513%', '50.738%', '52.898%', '53.840%', '55.551%', '58.075%', '59.123%', '60.214%', '61.690%', '62.160%']
Workers federated accuracies:  ['72.364%', '72.620%', '72.706%', '72.898%', '73.176%', '73.219%', '73.497%', '73.348%', '73.711%', '73.733%']
Workers improved  accuracies:  ['24.791%', '24.406%', '23.850%', '23.807%', '23.102%', '22.588%', '22.567%', '22.075%', '21.989%', '21.647%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 6:
Federated model validation accuracy : 72.6000%
Leave-one-out validation accuracies :  ['72.7000%', '72.7000%', '72.7000%', '72.9000%', '72.8000%', '72.7000%', '72.8000%', '72.9000%', '72.9000%', '72.8000%']
Computed and normalized credits:  tensor([0.1002, 0.1003, 0.1002, 0.0998, 0.1001, 0.1002, 0.1000, 0.0996, 0.0997,
        0.0999])
Federated model performance: Loss: 0.599421. Accuracy: 73.5615%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['48.642%', '51.294%', '53.540%', '54.588%', '56.749%', '59.487%', '60.663%', '61.775%', '63.016%', '63.936%']
Workers federated accuracies:  ['73.326%', '73.369%', '73.583%', '73.797%', '73.925%', '74.011%', '74.225%', '74.139%', '74.310%', '74.631%']
Workers improved  accuracies:  ['25.754%', '25.155%', '24.727%', '24.706%', '23.850%', '23.380%', '23.294%', '22.866%', '22.588%', '22.545%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 7:
Federated model validation accuracy : 72.8000%
Leave-one-out validation accuracies :  ['72.7000%', '72.9000%', '73.0000%', '72.9000%', '72.9000%', '72.9000%', '73.1000%', '73.1000%', '73.2000%', '73.2000%']
Computed and normalized credits:  tensor([0.1007, 0.1002, 0.1000, 0.1002, 0.1002, 0.1002, 0.0998, 0.0997, 0.0995,
        0.0995])
Federated model performance: Loss: 0.588531. Accuracy: 74.2246%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['48.749%', '51.786%', '54.203%', '55.508%', '57.840%', '60.963%', '61.690%', '62.930%', '64.406%', '65.155%']
Workers federated accuracies:  ['73.882%', '73.882%', '73.989%', '74.032%', '74.289%', '74.289%', '74.631%', '74.503%', '74.695%', '74.845%']
Workers improved  accuracies:  ['26.310%', '25.668%', '25.134%', '24.941%', '24.214%', '23.658%', '23.701%', '23.230%', '22.973%', '22.759%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 8:
Federated model validation accuracy : 72.7000%
Leave-one-out validation accuracies :  ['72.7000%', '72.8000%', '72.9000%', '73.1000%', '73.2000%', '73.2000%', '73.2000%', '73.2000%', '73.2000%', '73.3000%']
Computed and normalized credits:  tensor([0.1009, 0.1006, 0.1004, 0.1000, 0.0998, 0.0998, 0.0997, 0.0997, 0.0997,
        0.0994])
Federated model performance: Loss: 0.578956. Accuracy: 74.5882%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['49.091%', '52.107%', '55.037%', '56.321%', '58.888%', '61.947%', '62.845%', '64.321%', '65.476%', '66.289%']
Workers federated accuracies:  ['74.246%', '74.267%', '74.460%', '74.503%', '74.738%', '74.781%', '74.930%', '74.866%', '74.930%', '75.080%']
Workers improved  accuracies:  ['26.674%', '26.053%', '25.604%', '25.412%', '24.663%', '24.150%', '24.000%', '23.594%', '23.209%', '22.995%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 9:
Federated model validation accuracy : 73.0000%
Leave-one-out validation accuracies :  ['73.0000%', '72.9000%', '73.0000%', '73.2000%', '73.2000%', '73.3000%', '73.3000%', '73.3000%', '73.2000%', '73.3000%']
Computed and normalized credits:  tensor([0.1005, 0.1007, 0.1004, 0.0999, 0.0999, 0.0997, 0.0997, 0.0997, 0.0999,
        0.0996])
Federated model performance: Loss: 0.570565. Accuracy: 74.8449%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['49.176%', '52.492%', '56.000%', '57.540%', '59.979%', '63.251%', '63.850%', '65.241%', '66.524%', '67.444%']
Workers federated accuracies:  ['74.503%', '74.567%', '74.845%', '74.802%', '74.952%', '75.037%', '75.251%', '75.016%', '75.294%', '75.422%']
Workers improved  accuracies:  ['26.930%', '26.353%', '25.989%', '25.711%', '24.877%', '24.406%', '24.321%', '23.743%', '23.572%', '23.337%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 10:
Federated model validation accuracy : 73.2000%
Leave-one-out validation accuracies :  ['73.2000%', '73.2000%', '73.3000%', '73.4000%', '73.4000%', '73.6000%', '73.5000%', '73.7000%', '73.7000%', '73.7000%']
Computed and normalized credits:  tensor([0.1007, 0.1007, 0.1004, 0.1001, 0.1001, 0.0997, 0.0999, 0.0995, 0.0995,
        0.0994])
Federated model performance: Loss: 0.563110. Accuracy: 75.2086%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['49.433%', '52.920%', '56.620%', '58.118%', '61.005%', '64.064%', '65.048%', '66.096%', '67.658%', '68.235%']
Workers federated accuracies:  ['74.738%', '74.866%', '74.995%', '74.995%', '75.209%', '75.251%', '75.636%', '75.465%', '75.594%', '75.615%']
Workers improved  accuracies:  ['27.166%', '26.652%', '26.139%', '25.904%', '25.134%', '24.620%', '24.706%', '24.193%', '23.872%', '23.529%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.563110. Accuracy: 75.2086%.
Workers before    accuracies:  ['47.572%', '48.214%', '48.856%', '49.091%', '50.075%', '50.631%', '50.930%', '51.273%', '51.722%', '52.086%']
Workers standlone accuracies:  ['49.433%', '52.920%', '56.620%', '58.118%', '61.005%', '64.064%', '65.048%', '66.096%', '67.658%', '68.235%']
Workers federated accuracies:  ['74.738%', '74.866%', '74.995%', '74.995%', '75.209%', '75.251%', '75.636%', '75.465%', '75.594%', '75.615%']
Workers improved  accuracies:  ['27.166%', '26.652%', '26.139%', '25.904%', '25.134%', '24.620%', '24.706%', '24.193%', '23.872%', '23.529%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]
Workers sharing_contributions :  tensor([ 12.8000,  32.0000,  51.2000,  64.0000,  83.2000, 102.4000, 121.6000,
        134.4000, 153.6000, 172.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (-0.1667439590265899, 0.6452209403625385)
Correlation between stand alone test acc & collaborative final model acc:  (0.9598148337776276, 1.0867830624141712e-05)
Correlation between test_acc & sharing contributions:  (0.9637279433375915, 7.248310394381223e-06)
Correlation between test_acc improvements & sharing_contributions:  (-0.9890437301092844, 6.221678298724829e-08)
Experiment : No.5/5
reading from datasets/adult.data datasets/adult.test
Start local pretraining 
Performance of an average model of the pretrained local models
Loss: 0.734825. Accuracy: 55.0802%.
Start federated learning 

Epoch 1:
Federated model validation accuracy : 61.0000%
Leave-one-out validation accuracies :  ['61.0000%', '61.1000%', '61.4000%', '61.6000%', '61.4000%', '62.7000%', '64.5000%', '65.3000%', '66.2000%', '66.9000%']
Computed and normalized credits:  tensor([0.1057, 0.1055, 0.1047, 0.1041, 0.1047, 0.1012, 0.0966, 0.0946, 0.0923,
        0.0907])
Federated model performance: Loss: 0.702236. Accuracy: 59.8717%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['53.818%', '54.460%', '54.930%', '55.251%', '55.701%', '56.278%', '56.620%', '56.663%', '56.877%', '57.155%']
Workers federated accuracies:  ['58.738%', '59.209%', '59.529%', '59.743%', '59.914%', '60.214%', '60.578%', '60.599%', '61.027%', '61.283%']
Workers improved  accuracies:  ['5.027%', '5.112%', '4.877%', '4.920%', '4.898%', '4.813%', '4.770%', '4.770%', '4.920%', '4.984%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 2:
Federated model validation accuracy : 64.1000%
Leave-one-out validation accuracies :  ['64.1000%', '64.2000%', '64.4000%', '65.0000%', '65.4000%', '65.9000%', '66.6000%', '67.6000%', '67.8000%', '68.6000%']
Computed and normalized credits:  tensor([0.1056, 0.1053, 0.1047, 0.1031, 0.1021, 0.1003, 0.0978, 0.0950, 0.0941,
        0.0920])
Federated model performance: Loss: 0.676915. Accuracy: 63.8503%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['53.925%', '54.695%', '55.358%', '55.701%', '56.235%', '56.898%', '57.476%', '57.476%', '58.182%', '58.610%']
Workers federated accuracies:  ['62.332%', '62.866%', '63.230%', '63.529%', '64.107%', '64.492%', '65.134%', '65.198%', '65.540%', '65.626%']
Workers improved  accuracies:  ['8.620%', '8.770%', '8.578%', '8.706%', '9.091%', '9.091%', '9.326%', '9.369%', '9.433%', '9.326%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 3:
Federated model validation accuracy : 66.8000%
Leave-one-out validation accuracies :  ['66.8000%', '67.0000%', '67.1000%', '67.4000%', '67.8000%', '67.8000%', '68.1000%', '68.7000%', '70.0000%', '70.7000%']
Computed and normalized credits:  tensor([0.1041, 0.1036, 0.1032, 0.1023, 0.1011, 0.1008, 0.0997, 0.0978, 0.0946,
        0.0927])
Federated model performance: Loss: 0.656811. Accuracy: 67.0588%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.075%', '54.866%', '55.786%', '56.299%', '56.727%', '57.583%', '58.845%', '58.845%', '59.658%', '60.086%']
Workers federated accuracies:  ['66.118%', '66.460%', '66.824%', '67.037%', '67.487%', '67.829%', '68.364%', '68.321%', '68.663%', '68.941%']
Workers improved  accuracies:  ['12.406%', '12.364%', '12.171%', '12.214%', '12.471%', '12.428%', '12.556%', '12.492%', '12.556%', '12.642%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 4:
Federated model validation accuracy : 68.2000%
Leave-one-out validation accuracies :  ['68.2000%', '68.3000%', '68.4000%', '68.8000%', '69.1000%', '69.5000%', '70.5000%', '70.9000%', '70.9000%', '71.3000%']
Computed and normalized credits:  tensor([0.1039, 0.1036, 0.1033, 0.1022, 0.1013, 0.1003, 0.0978, 0.0966, 0.0961,
        0.0948])
Federated model performance: Loss: 0.640155. Accuracy: 69.4545%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.203%', '55.230%', '56.150%', '56.599%', '57.519%', '58.567%', '59.957%', '60.086%', '60.471%', '60.834%']
Workers federated accuracies:  ['68.578%', '69.048%', '69.326%', '69.647%', '69.925%', '70.160%', '70.524%', '70.481%', '70.759%', '70.781%']
Workers improved  accuracies:  ['14.866%', '14.952%', '14.674%', '14.824%', '14.909%', '14.759%', '14.717%', '14.652%', '14.652%', '14.481%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 5:
Federated model validation accuracy : 70.2000%
Leave-one-out validation accuracies :  ['70.2000%', '70.2000%', '70.6000%', '70.7000%', '70.9000%', '71.0000%', '71.4000%', '71.6000%', '71.6000%', '71.6000%']
Computed and normalized credits:  tensor([0.1024, 0.1024, 0.1014, 0.1010, 0.1004, 0.1000, 0.0987, 0.0980, 0.0979,
        0.0977])
Federated model performance: Loss: 0.626314. Accuracy: 70.8877%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.289%', '55.380%', '56.449%', '56.984%', '58.289%', '59.487%', '60.513%', '60.642%', '61.390%', '61.968%']
Workers federated accuracies:  ['70.353%', '70.567%', '70.824%', '70.952%', '71.187%', '71.123%', '71.529%', '71.422%', '71.679%', '71.872%']
Workers improved  accuracies:  ['16.642%', '16.471%', '16.171%', '16.128%', '16.171%', '15.722%', '15.722%', '15.594%', '15.572%', '15.572%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 6:
Federated model validation accuracy : 71.2000%
Leave-one-out validation accuracies :  ['71.2000%', '71.1000%', '71.3000%', '71.4000%', '71.6000%', '71.6000%', '71.6000%', '71.6000%', '71.8000%', '72.4000%']
Computed and normalized credits:  tensor([0.1012, 0.1014, 0.1008, 0.1005, 0.1000, 0.0999, 0.0997, 0.0996, 0.0991,
        0.0978])
Federated model performance: Loss: 0.614266. Accuracy: 71.5936%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.460%', '55.679%', '56.770%', '57.497%', '59.037%', '60.107%', '61.219%', '61.326%', '62.396%', '63.594%']
Workers federated accuracies:  ['71.102%', '71.209%', '71.487%', '71.765%', '71.829%', '71.679%', '72.021%', '71.850%', '72.193%', '72.278%']
Workers improved  accuracies:  ['17.390%', '17.112%', '16.834%', '16.941%', '16.813%', '16.278%', '16.214%', '16.021%', '16.086%', '15.979%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 7:
Federated model validation accuracy : 71.9000%
Leave-one-out validation accuracies :  ['71.9000%', '71.9000%', '71.7000%', '71.8000%', '71.8000%', '71.9000%', '72.3000%', '72.3000%', '72.6000%', '72.8000%']
Computed and normalized credits:  tensor([0.1006, 0.1007, 0.1010, 0.1007, 0.1006, 0.1004, 0.0995, 0.0995, 0.0988,
        0.0981])
Federated model performance: Loss: 0.604068. Accuracy: 71.9786%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.652%', '55.979%', '57.134%', '58.203%', '59.658%', '60.620%', '62.011%', '62.332%', '63.487%', '64.578%']
Workers federated accuracies:  ['71.850%', '71.979%', '71.936%', '72.064%', '72.278%', '72.342%', '72.492%', '72.449%', '72.727%', '72.727%']
Workers improved  accuracies:  ['18.139%', '17.882%', '17.283%', '17.241%', '17.262%', '16.941%', '16.684%', '16.620%', '16.620%', '16.428%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 8:
Federated model validation accuracy : 72.1000%
Leave-one-out validation accuracies :  ['72.1000%', '72.3000%', '72.3000%', '72.4000%', '72.6000%', '72.7000%', '73.0000%', '73.1000%', '73.4000%', '73.6000%']
Computed and normalized credits:  tensor([0.1015, 0.1011, 0.1011, 0.1009, 0.1004, 0.1002, 0.0994, 0.0992, 0.0984,
        0.0978])
Federated model performance: Loss: 0.594990. Accuracy: 72.5348%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.781%', '56.257%', '57.604%', '58.588%', '60.086%', '61.305%', '63.080%', '63.401%', '64.449%', '65.283%']
Workers federated accuracies:  ['72.064%', '72.342%', '72.449%', '72.642%', '72.620%', '72.749%', '73.112%', '73.091%', '73.326%', '73.412%']
Workers improved  accuracies:  ['18.353%', '18.246%', '17.797%', '17.818%', '17.604%', '17.348%', '17.305%', '17.262%', '17.219%', '17.112%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 9:
Federated model validation accuracy : 72.8000%
Leave-one-out validation accuracies :  ['72.8000%', '72.8000%', '72.8000%', '72.8000%', '73.3000%', '73.5000%', '73.7000%', '73.5000%', '73.5000%', '73.5000%']
Computed and normalized credits:  tensor([0.1012, 0.1011, 0.1011, 0.1011, 0.0999, 0.0994, 0.0989, 0.0993, 0.0991,
        0.0990])
Federated model performance: Loss: 0.587097. Accuracy: 72.9412%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.845%', '56.385%', '57.968%', '59.273%', '60.321%', '62.011%', '63.850%', '63.979%', '65.112%', '66.225%']
Workers federated accuracies:  ['72.492%', '72.663%', '72.706%', '72.791%', '73.048%', '73.134%', '73.647%', '73.433%', '73.797%', '73.904%']
Workers improved  accuracies:  ['18.781%', '18.567%', '18.053%', '17.968%', '18.032%', '17.733%', '17.840%', '17.604%', '17.690%', '17.604%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Epoch 10:
Federated model validation accuracy : 73.4000%
Leave-one-out validation accuracies :  ['73.4000%', '73.3000%', '73.3000%', '73.6000%', '73.6000%', '73.7000%', '73.7000%', '73.7000%', '73.8000%', '73.8000%']
Computed and normalized credits:  tensor([0.1006, 0.1008, 0.1008, 0.1002, 0.1000, 0.0997, 0.0996, 0.0996, 0.0994,
        0.0994])
Federated model performance: Loss: 0.579896. Accuracy: 73.4973%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.930%', '56.406%', '58.717%', '59.914%', '60.749%', '62.995%', '64.791%', '64.920%', '66.160%', '67.444%']
Workers federated accuracies:  ['72.727%', '72.920%', '73.176%', '73.305%', '73.369%', '73.733%', '73.947%', '73.861%', '74.118%', '74.267%']
Workers improved  accuracies:  ['19.016%', '18.824%', '18.524%', '18.481%', '18.353%', '18.332%', '18.139%', '18.032%', '18.011%', '17.968%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]

Performance and Fairness analysis: 
Federated model performance: Loss: 0.579896. Accuracy: 73.4973%.
Workers before    accuracies:  ['53.711%', '54.096%', '54.652%', '54.824%', '55.016%', '55.401%', '55.807%', '55.829%', '56.107%', '56.299%']
Workers standlone accuracies:  ['54.930%', '56.406%', '58.717%', '59.914%', '60.749%', '62.995%', '64.791%', '64.920%', '66.160%', '67.444%']
Workers federated accuracies:  ['72.727%', '72.920%', '73.176%', '73.305%', '73.369%', '73.733%', '73.947%', '73.861%', '74.118%', '74.267%']
Workers improved  accuracies:  ['19.016%', '18.824%', '18.524%', '18.481%', '18.353%', '18.332%', '18.139%', '18.032%', '18.011%', '17.968%']
Workers shard sizes:  [128, 320, 512, 640, 832, 1024, 1216, 1344, 1536, 1728]
Workers sharing_contributions :  tensor([ 12.8000,  32.0000,  51.2000,  64.0000,  83.2000, 102.4000, 121.6000,
        134.4000, 153.6000, 172.8000])
Correlation between stand alone test acc & perturbed federated test acc:  (0.27774370780713387, 0.43717464565564734)
Correlation between stand alone test acc & collaborative final model acc:  (0.9972916358891708, 2.3463569614097823e-10)
Correlation between test_acc & sharing contributions:  (0.9902375196073174, 3.9275514333254986e-08)
Correlation between test_acc improvements & sharing_contributions:  (-0.9696301222318588, 3.5878490657629363e-06)
standalone_vs_final_corr [[0.9421145210587669], [0.9650957487634221], [0.9933911697949688], [0.9598148337776276], [0.9972916358891708]]
standalone_vs_final_corr_mean [0.9715415818567912]
standalone_vs_final_corr_std [0.02090687479146026]
sharingcontribution_vs_final_corr [[0.9877734872297459], [0.9625721715151443], [0.9893186307733529], [0.9637279433375915], [0.9902375196073174]]
sharingcontribution_vs_final_corr_mean [0.9787259504926304]
sharingcontribution_vs_final_corr_std [0.012747264913677357]
standalone_vs_federated_perturbed_corr [[0.27228164253425324], [-0.7712350361083228], [0.51406241667966], [-0.1667439590265899], [0.27774370780713387]]
standalone_vs_federated_perturbed_corr_mean [0.02522175437722689]
standalone_vs_federated_perturbed_corr_std [0.4549649157140974]
federated_final_performance [0.7311229705810547, 0.7289839386940002, 0.7304812669754028, 0.7520855665206909, 0.7349732518196106]
federated_final_performance_mean 0.7355293989181518
federated_final_performance_std 0.0085106907078792
CFFL_best_worker [0.7388235330581665, 0.7360427975654602, 0.7360427975654602, 0.7563636302947998, 0.7426738142967224]
CFFL_best_worker_mean 0.7419893145561218
CFFL_best_worker_std 0.007587276111798471
standalone_best_worker [0.6517646908760071, 0.5905882120132446, 0.6183957457542419, 0.6823529601097107, 0.6744384765625]
standalone_best_worker_mean 0.6435080170631409
standalone_best_worker_std 0.03453962224575014
