Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap'
: 5000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 256, 'train_val_split_ratio': 0.9, 'alpha': 5
, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar'>, 'optimizer_fn': <class 'to
rch.optim.adam.Adam'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.0001, 'dssgd_lr': 0.0001, 'lr': 0.001, 'grad_clip': 0
.1, 'gamma': 1, 'pretrain_epochs': 1, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_id
s': [0]}                                                                                                              
Files already downloaded and verified                                            
Files already downloaded and verified                                                 
Experiment : No.1/1                             
CFFL server model validation accuracy : 8.8000%                                      
CFFL server model test accuracy : 9.9900%                                             
                                               
Epoch 1:                                                                               
credits, credit threshold: tensor(0.2222)                                             
tensor([0.0000, 0.2113, 0.2080, 0.2244, 0.3563])
Reputable parties:  [1, 2, 3, 4]                                                                                      

credits, credit_threshold pretrain: tensor(0.3333)
tensor([0.0000, 0.0000, 0.2387, 0.2967, 0.4647])
Reputable parties pretrain:  [2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['16.990%', '16.680%', '15.210%', '19.500%', '22.140%']
Workers DSSGD     accuracies:  ['9.980%', '11.470%', '16.950%', '19.860%', '18.390%']

Workers before    accuracies:  ['9.990%', '9.990%', '9.990%', '9.990%', '9.990%']
Workers CFFL      accuracies:  ['15.470%', '20.580%', '20.220%', '20.970%', '20.510%']

Workers before pr accuracies:  ['9.990%', '10.030%', '10.010%', '10.370%', '10.080%']
Workers CFFL pret accuracies:  ['10.000%', '12.690%', '19.300%', '18.350%', '18.440%']

Epoch 21:
credits, credit threshold: tensor(0.2222)
tensor([0.0000, 0.2509, 0.2430, 0.2623, 0.2438])
Reputable parties:  [1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties pretrain:  [4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['20.660%', '28.120%', '34.730%', '34.950%', '39.750%']
Workers DSSGD     accuracies:  ['38.390%', '37.170%', '37.150%', '37.940%', '38.280%']

Workers before    accuracies:  ['9.990%', '9.990%', '9.990%', '9.990%', '9.990%']
Workers CFFL      accuracies:  ['32.040%', '42.220%', '42.970%', '40.930%', '39.760%']

Workers before pr accuracies:  ['9.990%', '10.030%', '10.010%', '10.370%', '10.080%']                        [59/1375]
Workers CFFL pret accuracies:  ['15.310%', '22.570%', '29.890%', '31.030%', '34.920%']

Epoch 41:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties pretrain:  [4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['23.460%', '30.950%', '37.740%', '37.740%', '43.480%']
Workers DSSGD     accuracies:  ['39.420%', '39.120%', '38.520%', '39.190%', '40.340%']

Workers before    accuracies:  ['9.990%', '9.990%', '9.990%', '9.990%', '9.990%']
Workers CFFL      accuracies:  ['30.970%', '39.760%', '42.780%', '42.370%', '43.090%']

Workers before pr accuracies:  ['9.990%', '10.030%', '10.010%', '10.370%', '10.080%']
Workers CFFL pret accuracies:  ['19.250%', '28.020%', '34.030%', '34.210%', '39.650%']

Epoch 61:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties pretrain:  [4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['23.810%', '32.160%', '38.690%', '38.470%', '44.080%']
Workers DSSGD     accuracies:  ['35.790%', '37.490%', '41.640%', '43.870%', '42.070%']

Workers before    accuracies:  ['9.990%', '9.990%', '9.990%', '9.990%', '9.990%']
Workers CFFL      accuracies:  ['30.700%', '38.940%', '41.880%', '40.880%', '42.500%']

Workers before pr accuracies:  ['9.990%', '10.030%', '10.010%', '10.370%', '10.080%']
Workers CFFL pret accuracies:  ['20.550%', '29.990%', '36.270%', '35.500%', '41.680%']

Epoch 81:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties pretrain:  [4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['24.650%', '31.830%', '37.920%', '38.790%', '43.000%']
Workers DSSGD     accuracies:  ['41.690%', '40.420%', '40.720%', '39.650%', '40.590%']

Workers before    accuracies:  ['9.990%', '9.990%', '9.990%', '9.990%', '9.990%']
Workers CFFL      accuracies:  ['30.550%', '38.760%', '41.770%', '40.690%', '42.210%']

Workers before pr accuracies:  ['9.990%', '10.030%', '10.010%', '10.370%', '10.080%']
Workers CFFL pret accuracies:  ['22.190%', '30.670%', '36.700%', '37.080%', '42.330%']
pretraining 2.174001932144165
evaluation after pretraining 18.72426128387451
workers local training 641.5391626358032
server aggregation 60.12927842140198
server aggregation with pretraining 58.33549404144287
server aggregation dssgd 56.98216533660889
fed model eval on valid loader 21.747808933258057
credit updates 0.3125894069671631
assign updates 1.373274564743042
performance update 4107.355298042297
total seconds 4968.673334598541
Time_dict-----
{"pretraining": 2.174001932144165, "evaluation after pretraining": 18.72426128387451, "workers local training": 641.53
91626358032, "server aggregation": 60.12927842140198, "server aggregation with pretraining": 58.33549404144287, "serve
r aggregation dssgd": 56.98216533660889, "fed model eval on valid loader": 21.747808933258057, "credit updates": 0.312
5894069671631, "assign updates": 1.373274564743042, "performance update": 4107.355298042297}
-----
Performance and Fairness analysis:
Worker credits : [0.0, 0.0, 0.0, 0.0, 1.0]
Number of reputable parties:  1
Worker credits pretrain: [0.0, 0.0, 0.0, 0.0, 1.0]
Number of reputable parties with pretrain:  1
----Results without pretrain
standalone_best_worker  -  0.429099977016449
CFFL_best_worker  -  0.42080000042915344
rr_dssgd_best  -  0.38339999318122864
standlone_vs_rrdssgd  -  [-0.9399097020771285]
standalone_vs_final  -  [0.9313861773263281]
----
----Results with pretrain
standalone_best_worker  -  0.429099977016449
CFFL_best_worker  -  0.4195999801158905
rr_dssgd_best  -  0.38339999318122864
standlone_vs_rrdssgd  -  [-0.9399097020771285]
standalone_vs_final  -  [0.9903759766223353]
----
for all without pretraining:
standalone_vs_final_mean [0.9313861773263281]
standlone_vs_rrdssgd_mean [-0.9399097020771285]
rr_dssgd_best_mean 0.38339999318122864
CFFL_best_worker_mean 0.42080000042915344
standalone_best_worker_mean 0.429099977016449

for all the pretraining included:
standalone_vs_final_mean [0.9903759766223353]
standlone_vs_rrdssgd_mean [-0.9399097020771285]
rr_dssgd_best_mean 0.38339999318122864
CFFL_best_worker_mean 0.4195999801158905
standalone_best_worker_mean 0.429099977016449



Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap'
: 5000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 256, 'train_val_split_ratio': 0.9, 'alpha': 5
, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar'>, 'optimizer_fn': <class 'to
rch.optim.adam.Adam'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.0001, 'dssgd_lr': 0.0001, 'lr': 0.001, 'grad_clip': 0
.1, 'gamma': 1, 'pretrain_epochs': 1, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_id
s': [0]}                                      
Files already downloaded and verified                                                 
Files already downloaded and verified                                                                                 
Experiment : No.1/1                                                                                                   
CFFL server model validation accuracy : 8.8000%                                                                       
CFFL server model test accuracy : 10.0100%                                                  
                                             
Epoch 1:                                                                               
credits, credit threshold: tensor(0.3333)                                             
tensor([0.0000, 0.0000, 0.3067, 0.3067, 0.3866])
Reputable parties:  [2, 3, 4]                                                         
                                                                                                                      
credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1988, 0.2048, 0.1988, 0.1988, 0.1988])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.070%', '11.230%', '16.010%', '15.350%']
Workers DSSGD     accuracies:  ['10.010%', '10.000%', '10.000%', '9.790%', '14.340%']

Workers before    accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL      accuracies:  ['9.950%', '13.490%', '18.480%', '18.480%', '18.480%']

Workers before pr accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL pret accuracies:  ['14.300%', '14.980%', '15.190%', '15.220%', '15.540%']

Epoch 21:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1925, 0.1947, 0.2022, 0.1985, 0.2121])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['18.220%', '27.440%', '33.870%', '35.290%', '38.570%']
Workers DSSGD     accuracies:  ['37.430%', '37.660%', '37.270%', '36.220%', '36.310%']

Workers before    accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL      accuracies:  ['21.020%', '28.160%', '33.860%', '38.600%', '37.360%']

Workers before pr accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL pret accuracies:  ['38.870%', '39.550%', '39.930%', '39.430%', '39.570%']

Epoch 41:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1991, 0.2074, 0.1942, 0.2075, 0.1917])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['22.750%', '30.640%', '37.050%', '37.350%', '40.700%']
Workers DSSGD     accuracies:  ['37.350%', '36.730%', '37.120%', '38.790%', '40.050%']

Workers before    accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL      accuracies:  ['21.580%', '29.070%', '34.400%', '36.380%', '36.250%']

Workers before pr accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL pret accuracies:  ['39.820%', '39.770%', '40.280%', '39.820%', '40.270%']

Epoch 61:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1933, 0.1995, 0.1994, 0.2024, 0.2055])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['22.700%', '31.330%', '35.390%', '38.560%', '39.430%']
Workers DSSGD     accuracies:  ['39.380%', '39.840%', '39.680%', '39.770%', '40.200%']

Workers before    accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL      accuracies:  ['21.340%', '28.680%', '34.580%', '35.950%', '36.680%']

Workers before pr accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL pret accuracies:  ['40.940%', '41.440%', '41.790%', '41.310%', '41.640%']

Epoch 81:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1981, 0.1983, 0.2012, 0.2043, 0.1981])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['22.770%', '31.170%', '34.510%', '38.260%', '39.130%']
Workers DSSGD     accuracies:  ['38.650%', '39.120%', '39.780%', '37.520%', '36.100%']

Workers before    accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL      accuracies:  ['21.200%', '28.680%', '34.350%', '35.720%', '36.720%']

Workers before pr accuracies:  ['10.010%', '10.010%', '10.010%', '10.010%', '10.010%']
Workers CFFL pret accuracies:  ['40.800%', '42.370%', '41.780%', '42.180%', '41.800%']
pretraining 2.171332597732544
evaluation after pretraining 18.36701250076294
workers local training 749.7583055496216
server aggregation 74.86111497879028
server aggregation with pretraining 72.19030904769897
server aggregation dssgd 69.58535981178284
fed model eval on valid loader 27.19413137435913
credit updates 0.17763066291809082
assign updates 2.8043761253356934
performance update 5188.958348035812
total seconds 6206.067920684814
Time_dict-----
{"pretraining": 2.171332597732544, "evaluation after pretraining": 18.36701250076294, "workers local training": 749.75
83055496216, "server aggregation": 74.86111497879028, "server aggregation with pretraining": 72.19030904769897, "serve
r aggregation dssgd": 69.58535981178284, "fed model eval on valid loader": 27.19413137435913, "credit updates": 0.1776
3066291809082, "assign updates": 2.8043761253356934, "performance update": 5188.958348035812}
-----
Performance and Fairness analysis:
Worker credits : [0.0, 0.0, 0.0, 0.0, 1.0]
Number of reputable parties:  1
Worker credits pretrain: [0.19749721884727478, 0.19750243425369263, 0.19749724864959717, 0.203754261136055, 0.20374882
221221924]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.3824999928474426
CFFL_best_worker  -  0.36739999055862427
rr_dssgd_best  -  0.41130000352859497
standlone_vs_rrdssgd  -  [0.8792241008009898]
standalone_vs_final  -  [0.9917364145838206]
----
----Results with pretrain
standalone_best_worker  -  0.3824999928474426
CFFL_best_worker  -  0.4235000014305115
rr_dssgd_best  -  0.41130000352859497
standlone_vs_rrdssgd  -  [0.8792241008009898]
standalone_vs_final  -  [0.9391832350878958]
----
for all without pretraining:
standalone_vs_final_mean [0.9917364145838206]
standlone_vs_rrdssgd_mean [0.8792241008009898]
rr_dssgd_best_mean 0.41130000352859497
CFFL_best_worker_mean 0.36739999055862427
standalone_best_worker_mean 0.3824999928474426

for all the pretraining included:
standalone_vs_final_mean [0.9391832350878958]
standlone_vs_rrdssgd_mean [0.8792241008009898]
rr_dssgd_best_mean 0.41130000352859497
CFFL_best_worker_mean 0.4235000014305115
standalone_best_worker_mean 0.3824999928474426


USING FastCIFAR10




Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap'
: 5000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 256, 'train_val_split_ratio': 0.9, 'alpha': 5
, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar'>, 'optimizer_fn': <class 'to
rch.optim.adam.Adam'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.0001, 'dssgd_lr': 0.0001, 'lr': 0.01, 'grad_clip': 0.
1, 'gamma': 1, 'pretrain_epochs': 1, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_ids
': [0]}                                                                                
Files already downloaded and verified                                                 
CIFAR10 data shape torch.Size([50000, 3, 32, 32]), targets shape torch.Size([50000])
Files already downloaded and verified                                                 
CIFAR10 data shape torch.Size([10000, 3, 32, 32]), targets shape torch.Size([10000])  
Experiment : No.1/1                               
CFFL server model validation accuracy : 10.2000%                                      
CFFL server model test accuracy : 10.0000%                                            
                                             
Epoch 1:                                                                               
credits, credit threshold: tensor(0.6667)                                             
tensor([0.3137, 0.0000, 0.0000, 0.0000, 0.6863])
Reputable parties:  [0, 4]                                                            
                                                                                                                      
credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.510%', '10.880%', '10.000%', '19.130%', '14.460%']
Workers DSSGD     accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['18.010%', '9.460%', '13.450%', '12.250%', '16.950%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']

Epoch 21:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1985, 0.1985, 0.2107, 0.2020, 0.1903])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['21.730%', '31.100%', '32.490%', '35.370%', '37.190%']
Workers DSSGD     accuracies:  ['40.250%', '39.710%', '39.980%', '39.920%', '39.970%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['22.760%', '29.260%', '32.750%', '32.500%', '36.020%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['40.990%', '41.270%', '40.950%', '40.870%', '40.920%']

Epoch 41:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2035, 0.1954, 0.2038, 0.1976, 0.1998])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['23.660%', '29.800%', '29.080%', '33.630%', '36.860%']
Workers DSSGD     accuracies:  ['28.200%', '27.250%', '29.460%', '33.530%', '37.860%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['22.630%', '29.220%', '32.910%', '33.570%', '36.820%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['43.180%', '42.870%', '43.640%', '42.940%', '43.540%']

Epoch 61:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1970, 0.2090, 0.2018, 0.1906, 0.2018])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['23.590%', '29.890%', '29.820%', '33.470%', '36.370%']
Workers DSSGD     accuracies:  ['38.960%', '38.490%', '40.190%', '41.070%', '41.960%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['22.700%', '29.140%', '33.080%', '33.590%', '36.700%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['42.960%', '43.110%', '43.500%', '43.430%', '43.810%']

Epoch 81:
credits, credit threshold: tensor(1.)
tensor([0., 0., 0., 0., 1.])
Reputable parties:  [4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2037, 0.1992, 0.2015, 0.1991, 0.1966])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['23.300%', '29.960%', '29.740%', '31.720%', '36.890%']
Workers DSSGD     accuracies:  ['41.330%', '40.310%', '41.180%', '43.150%', '43.620%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['22.590%', '29.210%', '33.110%', '33.520%', '36.820%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['43.210%', '43.370%', '43.380%', '43.710%', '43.600%']
pretraining 0.3358290195465088
evaluation after pretraining 1.4617199897766113
workers local training 173.6771514415741
server aggregation 20.594132661819458
server aggregation with pretraining 8.809431791305542
server aggregation dssgd 7.6680779457092285
fed model eval on valid loader 2.073549509048462
credit updates 0.13530874252319336
assign updates 2.197498083114624
performance update 302.92195892333984
total seconds 519.8746581077576
Time_dict-----
{"pretraining": 0.3358290195465088, "evaluation after pretraining": 1.4617199897766113, "workers local training": 173.
6771514415741, "server aggregation": 20.594132661819458, "server aggregation with pretraining": 8.809431791305542, "se
rver aggregation dssgd": 7.6680779457092285, "fed model eval on valid loader": 2.073549509048462, "credit updates": 0.
13530874252319336, "assign updates": 2.197498083114624, "performance update": 302.92195892333984}
-----
Performance and Fairness analysis:
Worker credits : [0.0, 0.0, 0.0, 0.0, 1.0]
Number of reputable parties:  1
Worker credits pretrain: [0.2003815621137619, 0.20310662686824799, 0.19542327523231506, 0.197881281375885, 0.203207328
915596]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.3726999759674072
CFFL_best_worker  -  0.3686999976634979
rr_dssgd_best  -  0.3974999785423279
standlone_vs_rrdssgd  -  [-0.25190563320754406]
standalone_vs_final  -  [0.9520840843395371]
----
----Results with pretrain
standalone_best_worker  -  0.32739999890327454
CFFL_best_worker  -  0.4390999972820282
rr_dssgd_best  -  0.41689997911453247
standlone_vs_rrdssgd  -  [-0.25190563320754406]
standalone_vs_final  -  [0.8077586955738694]
----
for all without pretraining:
standalone_vs_final_mean [0.9520840843395371]
standlone_vs_rrdssgd_mean [-0.25190563320754406]
rr_dssgd_best_mean 0.3974999785423279
CFFL_best_worker_mean 0.3686999976634979
standalone_best_worker_mean 0.3726999759674072

for all the pretraining included:
standalone_vs_final_mean [0.8077586955738694]
standlone_vs_rrdssgd_mean [-0.25190563320754406]
rr_dssgd_best_mean 0.41689997911453247
CFFL_best_worker_mean 0.4390999972820282
standalone_best_worker_mean 0.32739999890327454


Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 256, 'train_val_split_ratio': 0.9, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.001, 'dssgd_lr': 0.01, 'lr': 0.001, 'grad_clip': 2, 'gamma': 1, 'pretrain_epochs': 1, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_ids': [0]}
Files already downloaded and verified
CIFAR10 data shape torch.Size([50000, 3, 32, 32]), targets shape torch.Size([50000])
Files already downloaded and verified
CIFAR10 data shape torch.Size([10000, 3, 32, 32]), targets shape torch.Size([10000])
Experiment : No.1/1
CFFL server model validation accuracy : 10.0000%
CFFL server model test accuracy : 10.0000%
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.222528e-07              0            0.0
1    w pretrain:   8.223449e-07              0            0.0
2          dssgd:  8.124669e-06              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000023              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000047              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000055              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000068              0            0.0

Epoch 1:
credits, credit threshold: tensor(0.1667)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers DSSGD     accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.260%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.308972e-07              0            0.0
1    w pretrain:   8.316507e-07              0            0.0
2          dssgd:  7.948493e-06              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000023              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000043              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000056              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000066              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.516596e-07              0            0.0
1    w pretrain:   8.527191e-07              0            0.0
2          dssgd:  8.438394e-06              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000024              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000043              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000057              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000075              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.528659e-07              0            0.0
1    w pretrain:   8.505291e-07              0            0.0
2          dssgd:  9.435584e-06              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000028              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000054              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000069              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000095              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.496509e-07              0            0.0
1    w pretrain:   8.499481e-07              0            0.0
2          dssgd:  1.190019e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000035              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000065              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000088              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000126              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.537448e-07              0            0.0
1    w pretrain:   8.509119e-07              0            0.0
2          dssgd:  1.654243e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000045              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000088              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000123              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000185              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.530778e-07              0            0.0
1    w pretrain:   8.549675e-07              0            0.0
2          dssgd:  2.152504e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000064              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000134              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000176              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000246              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.602969e-07              0            0.0
1    w pretrain:   8.597769e-07              0            0.0
2          dssgd:  3.098640e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000091              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000179              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000202              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000238              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.603892e-07              0            0.0
1    w pretrain:   8.611185e-07              0            0.0
2          dssgd:  5.016087e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000101              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000190              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000280              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000315              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.708500e-07              0            0.0
1    w pretrain:   8.687103e-07              0            0.0
2          dssgd:  1.407026e-04              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000234              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000289              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000282              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000336              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.770264e-07              0            0.0
1    w pretrain:   8.749796e-07              0            0.0
2          dssgd:  1.202850e-04              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000310              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000507              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000578              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000667              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   8.887362e-07              0            0.0
1    w pretrain:   8.886163e-07              0            0.0
2          dssgd:  2.039812e-04              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000333              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000419              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000620              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000728              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   9.152423e-07              0            0.0
1    w pretrain:   9.181007e-07              0            0.0
2          dssgd:  2.157621e-04              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000431              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000528              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000371              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000395              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   9.380295e-07              0            0.0
1    w pretrain:   9.417810e-07              0            0.0
2          dssgd:  4.040470e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000080              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000112              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000138              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000243              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   9.628874e-07              0            0.0
1    w pretrain:   9.637677e-07              0            0.0
2          dssgd:  2.081617e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000078              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000167              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000189              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000251              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   9.748718e-07              0            0.0
1    w pretrain:   9.744700e-07              0            0.0
2          dssgd:  2.662846e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000108              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000234              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000305              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000341              0            0.0
                      grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:   9.909437e-07              0            0.0
1    w pretrain:   9.916981e-07              0            0.0
2          dssgd:  6.774553e-05              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000135              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000248              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000392              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000499              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000123              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000250              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000338              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000357              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000409              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000062              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000224              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000375              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000524              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000603              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000175              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000270              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000278              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000395              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000411              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000032              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000124              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000248              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000329              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000329              0            0.0

Epoch 21:
credits, credit threshold: tensor(0.1667)
tensor([0.2020, 0.1972, 0.2019, 0.1995, 0.1994])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2022, 0.1975, 0.2022, 0.1984, 0.1996])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers DSSGD     accuracies:  ['13.650%', '16.970%', '17.700%', '17.330%', '17.930%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['19.730%', '19.730%', '19.730%', '19.730%', '19.730%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['19.720%', '19.740%', '19.760%', '19.780%', '19.760%']
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000041              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000135              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000271              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000414              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000478              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000120              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000248              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000335              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000397              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000454              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000056              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000169              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000297              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000450              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000502              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000132              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000356              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000417              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000344              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000511              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000206              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000437              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000610              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000552              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000556              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000047              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000104              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000168              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000197              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000331              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000026              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000103              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000176              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000255              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000333              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000001              0            0.0
1    w pretrain:    0.000001              0            0.0
2          dssgd:   0.000068              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000191              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000314              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000379              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000334              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000072              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000175              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000277              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000315              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000389              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000036              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000133              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000232              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000271              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000337              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000112              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000277              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000454              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000489              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000399              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000090              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000192              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000313              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000388              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000322              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000054              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000120              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000210              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000345              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000438              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000033              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000129              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000233              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000294              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000389              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000132              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000320              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000515              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000543              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000397              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000096              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000190              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000320              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000415              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000488              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000030              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000130              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000342              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000393              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000016              0            0.0
1    w pretrain:    0.000016              0            0.0
2          dssgd:   0.000434              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000111              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000252              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000453              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000497              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000017              0            0.0
1    w pretrain:    0.000017              0            0.0
2          dssgd:   0.000554              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000169              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000337              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000596              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000564              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000018              0            0.0
1    w pretrain:    0.000018              0            0.0
2          dssgd:   0.000473              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000002              0            0.0
1    w pretrain:    0.000002              0            0.0
2          dssgd:   0.000094              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000203              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000310              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000283              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000018              0            0.0
1    w pretrain:    0.000018              0            0.0
2          dssgd:   0.000279              0            0.0

Epoch 41:
credits, credit threshold: tensor(0.1667)
tensor([0.2008, 0.2051, 0.1983, 0.2023, 0.1936])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.2014, 0.2056, 0.2002, 0.2000, 0.1927])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers DSSGD     accuracies:  ['11.710%', '11.440%', '13.950%', '11.660%', '11.740%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['19.010%', '19.010%', '18.990%', '18.990%', '18.990%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['19.040%', '19.030%', '19.000%', '18.990%', '19.020%']
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000022              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000072              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000159              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000274              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000020              0            0.0
1    w pretrain:    0.000020              0            0.0
2          dssgd:   0.000397              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000075              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000007              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000193              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000308              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000016              0            0.0
1    w pretrain:    0.000016              0            0.0
2          dssgd:   0.000301              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000021              0            0.0
1    w pretrain:    0.000021              0            0.0
2          dssgd:   0.000325              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000046              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000120              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000212              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000017              0            0.0
1    w pretrain:    0.000017              0            0.0
2          dssgd:   0.000287              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000021              0            0.0
1    w pretrain:    0.000022              0            0.0
2          dssgd:   0.000363              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000074              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000160              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000232              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000017              0            0.0
1    w pretrain:    0.000017              0            0.0
2          dssgd:   0.000306              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000022              0            0.0
1    w pretrain:    0.000022              0            0.0
2          dssgd:   0.000417              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000051              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000185              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000017              0            0.0
1    w pretrain:    0.000017              0            0.0
2          dssgd:   0.000368              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000017              0            0.0
1    w pretrain:    0.000018              0            0.0
2          dssgd:   0.000436              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000023              0            0.0
1    w pretrain:    0.000023              0            0.0
2          dssgd:   0.000444              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000108              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000256              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000016              0            0.0
1    w pretrain:    0.000016              0            0.0
2          dssgd:   0.000368              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000019              0            0.0
1    w pretrain:    0.000019              0            0.0
2          dssgd:   0.000508              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000024              0            0.0
1    w pretrain:    0.000024              0            0.0
2          dssgd:   0.000703              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000003              0            0.0
1    w pretrain:    0.000003              0            0.0
2          dssgd:   0.000257              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000446              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000018              0            0.0
1    w pretrain:    0.000018              0            0.0
2          dssgd:   0.000512              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000019              0            0.0
1    w pretrain:    0.000019              0            0.0
2          dssgd:   0.000462              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000024              0            0.0
1    w pretrain:    0.000024              0            0.0
2          dssgd:   0.000573              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000045              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000159              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000016              0            0.0
1    w pretrain:    0.000016              0            0.0
2          dssgd:   0.000396              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000020              0            0.0
1    w pretrain:    0.000020              0            0.0
2          dssgd:   0.000467              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000025              0            0.0
1    w pretrain:    0.000025              0            0.0
2          dssgd:   0.000477              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000113              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000244              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000021              0            0.0
1    w pretrain:    0.000021              0            0.0
2          dssgd:   0.000369              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000019              0            0.0
1    w pretrain:    0.000019              0            0.0
2          dssgd:   0.000530              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000025              0            0.0
1    w pretrain:    0.000025              0            0.0
2          dssgd:   0.000524              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000241              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000297              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000019              0            0.0
1    w pretrain:    0.000019              0            0.0
2          dssgd:   0.000289              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000020              0            0.0
1    w pretrain:    0.000020              0            0.0
2          dssgd:   0.000286              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000025              0            0.0
1    w pretrain:    0.000025              0            0.0
2          dssgd:   0.000417              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000026              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000088              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000018              0            0.0
1    w pretrain:    0.000018              0            0.0
2          dssgd:   0.000175              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000020              0            0.0
1    w pretrain:    0.000020              0            0.0
2          dssgd:   0.000307              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000026              0            0.0
1    w pretrain:    0.000026              0            0.0
2          dssgd:   0.000390              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000004              0            0.0
1    w pretrain:    0.000004              0            0.0
2          dssgd:   0.000045              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000141              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:     0.00002              0            0.0
1    w pretrain:     0.00002              0            0.0
2          dssgd:    0.00022              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000020              0            0.0
1    w pretrain:    0.000020              0            0.0
2          dssgd:   0.000345              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000025              0            0.0
1    w pretrain:    0.000025              0            0.0
2          dssgd:   0.000516              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000148              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000360              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000022              0            0.0
1    w pretrain:    0.000023              0            0.0
2          dssgd:   0.000493              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000021              0            0.0
1    w pretrain:    0.000021              0            0.0
2          dssgd:   0.000465              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000028              0            0.0
1    w pretrain:    0.000028              0            0.0
2          dssgd:   0.000383              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000005              0            0.0
1    w pretrain:    0.000005              0            0.0
2          dssgd:   0.000079              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000279              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000021              0            0.0
1    w pretrain:    0.000021              0            0.0
2          dssgd:   0.000375              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000025              0            0.0
1    w pretrain:    0.000025              0            0.0
2          dssgd:   0.000425              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000028              0            0.0
1    w pretrain:    0.000029              0            0.0
2          dssgd:   0.000516              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000006              0            0.0
2          dssgd:   0.000068              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000016              0            0.0
1    w pretrain:    0.000017              0            0.0
2          dssgd:   0.000212              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000032              0            0.0
1    w pretrain:    0.000033              0            0.0
2          dssgd:   0.000270              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000027              0            0.0
1    w pretrain:    0.000027              0            0.0
2          dssgd:   0.000351              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000034              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000503              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000006              0            0.0
1    w pretrain:    0.000007              0            0.0
2          dssgd:   0.000243              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000019              0            0.0
1    w pretrain:    0.000020              0            0.0
2          dssgd:   0.000442              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000029              0            0.0
1    w pretrain:    0.000030              0            0.0
2          dssgd:   0.000509              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000039              0            0.0
1    w pretrain:    0.000040              0            0.0
2          dssgd:   0.000418              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000041              0            0.0
1    w pretrain:    0.000042              0            0.0
2          dssgd:   0.000393              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000092              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000027              0            0.0
1    w pretrain:    0.000028              0            0.0
2          dssgd:   0.000251              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000050              0            0.0
1    w pretrain:    0.000051              0            0.0
2          dssgd:   0.000371              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000052              0            0.0
1    w pretrain:    0.000054              0            0.0
2          dssgd:   0.000392              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000060              0            0.0
1    w pretrain:    0.000062              0            0.0
2          dssgd:   0.000441              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000053              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000042              0            0.0
1    w pretrain:    0.000043              0            0.0
2          dssgd:   0.000168              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000070              0            0.0
1    w pretrain:    0.000072              0            0.0
2          dssgd:   0.000217              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000081              0            0.0
1    w pretrain:    0.000083              0            0.0
2          dssgd:   0.000281              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000084              0            0.0
1    w pretrain:    0.000087              0            0.0
2          dssgd:   0.000366              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000104              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000050              0            0.0
1    w pretrain:    0.000051              0            0.0
2          dssgd:   0.000232              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000097              0            0.0
1    w pretrain:    0.000099              0            0.0
2          dssgd:   0.000326              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000105              0            0.0
1    w pretrain:    0.000107              0            0.0
2          dssgd:   0.000382              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000127              0            0.0
1    w pretrain:    0.000129              0            0.0
2          dssgd:   0.000307              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000063              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000061              0            0.0
1    w pretrain:    0.000060              0            0.0
2          dssgd:   0.000117              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000104              0            0.0
1    w pretrain:    0.000102              0            0.0
2          dssgd:   0.000199              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000128              0            0.0
1    w pretrain:    0.000127              0            0.0
2          dssgd:   0.000262              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000139              0            0.0
1    w pretrain:    0.000138              0            0.0
2          dssgd:   0.000302              0            0.0

Epoch 61:
credits, credit threshold: tensor(0.6667)
tensor([0.0000, 0.0000, 0.0000, 0.5037, 0.4963])
Reputable parties:  [3, 4]

credits, credit_threshold pretrain: tensor(0.6667)
tensor([0.0000, 0.0000, 0.0000, 0.5074, 0.4926])
Reputable parties pretrain:  [3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers DSSGD     accuracies:  ['15.560%', '17.050%', '18.300%', '18.850%', '17.730%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['19.420%', '20.410%', '21.780%', '19.250%', '19.250%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['19.210%', '20.470%', '21.770%', '19.540%', '19.570%']
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000019              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000043              0            0.0
1    w pretrain:    0.000042              0            0.0
2          dssgd:   0.000077              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000046              0            0.0
1    w pretrain:    0.000047              0            0.0
2          dssgd:   0.000207              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000087              0            0.0
1    w pretrain:    0.000084              0            0.0
2          dssgd:   0.000359              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000112              0            0.0
1    w pretrain:    0.000108              0            0.0
2          dssgd:   0.000385              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000184              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000030              0            0.0
1    w pretrain:    0.000030              0            0.0
2          dssgd:   0.000298              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000025              0            0.0
1    w pretrain:    0.000025              0            0.0
2          dssgd:   0.000356              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000062              0            0.0
1    w pretrain:    0.000061              0            0.0
2          dssgd:   0.000416              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000073              0            0.0
1    w pretrain:    0.000071              0            0.0
2          dssgd:   0.000346              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000084              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000031              0            0.0
1    w pretrain:    0.000031              0            0.0
2          dssgd:   0.000179              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000032              0            0.0
1    w pretrain:    0.000032              0            0.0
2          dssgd:   0.000346              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000064              0            0.0
1    w pretrain:    0.000063              0            0.0
2          dssgd:   0.000311              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000073              0            0.0
1    w pretrain:    0.000071              0            0.0
2          dssgd:   0.000363              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000050              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000055              0            0.0
1    w pretrain:    0.000054              0            0.0
2          dssgd:   0.000126              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000064              0            0.0
1    w pretrain:    0.000061              0            0.0
2          dssgd:   0.000202              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000034              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000239              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000036              0            0.0
2          dssgd:   0.000311              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000025              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000037              0            0.0
1    w pretrain:    0.000037              0            0.0
2          dssgd:   0.000091              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000034              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000174              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000061              0            0.0
1    w pretrain:    0.000059              0            0.0
2          dssgd:   0.000211              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000069              0            0.0
1    w pretrain:    0.000067              0            0.0
2          dssgd:   0.000320              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000067              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000056              0            0.0
1    w pretrain:    0.000055              0            0.0
2          dssgd:   0.000199              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000073              0            0.0
1    w pretrain:    0.000071              0            0.0
2          dssgd:   0.000355              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000037              0            0.0
1    w pretrain:    0.000037              0            0.0
2          dssgd:   0.000400              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000038              0            0.0
1    w pretrain:    0.000039              0            0.0
2          dssgd:   0.000325              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000083              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000036              0            0.0
1    w pretrain:    0.000036              0            0.0
2          dssgd:   0.000145              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000036              0            0.0
2          dssgd:   0.000234              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000062              0            0.0
2          dssgd:   0.000295              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000070              0            0.0
1    w pretrain:    0.000068              0            0.0
2          dssgd:   0.000388              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000027              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000056              0            0.0
1    w pretrain:    0.000055              0            0.0
2          dssgd:   0.000097              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000080              0            0.0
1    w pretrain:    0.000078              0            0.0
2          dssgd:   0.000215              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000038              0            0.0
1    w pretrain:    0.000038              0            0.0
2          dssgd:   0.000290              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000039              0            0.0
1    w pretrain:    0.000040              0            0.0
2          dssgd:   0.000350              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000094              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000033              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000202              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000033              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000350              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000064              0            0.0
1    w pretrain:    0.000062              0            0.0
2          dssgd:   0.000447              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000072              0            0.0
1    w pretrain:    0.000071              0            0.0
2          dssgd:   0.000422              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000167              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000055              0            0.0
1    w pretrain:    0.000054              0            0.0
2          dssgd:   0.000255              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000073              0            0.0
1    w pretrain:    0.000072              0            0.0
2          dssgd:   0.000312              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000312              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000036              0            0.0
1    w pretrain:    0.000036              0            0.0
2          dssgd:   0.000316              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000052              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000033              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000112              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000033              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000155              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000060              0            0.0
1    w pretrain:    0.000059              0            0.0
2          dssgd:   0.000177              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000071              0            0.0
1    w pretrain:    0.000070              0            0.0
2          dssgd:   0.000227              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000059              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000055              0            0.0
1    w pretrain:    0.000054              0            0.0
2          dssgd:   0.000096              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000068              0            0.0
1    w pretrain:    0.000067              0            0.0
2          dssgd:   0.000160              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000182              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000036              0            0.0
1    w pretrain:    0.000037              0            0.0
2          dssgd:   0.000253              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000028              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000034              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000106              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000036              0            0.0
1    w pretrain:    0.000036              0            0.0
2          dssgd:   0.000179              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000058              0            0.0
1    w pretrain:    0.000057              0            0.0
2          dssgd:   0.000215              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000068              0            0.0
1    w pretrain:    0.000067              0            0.0
2          dssgd:   0.000262              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000028              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000054              0            0.0
1    w pretrain:    0.000053              0            0.0
2          dssgd:   0.000118              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000063              0            0.0
2          dssgd:   0.000261              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000356              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000371              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000092              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000036              0            0.0
1    w pretrain:    0.000036              0            0.0
2          dssgd:   0.000139              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000204              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000059              0            0.0
1    w pretrain:    0.000058              0            0.0
2          dssgd:   0.000260              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000065              0            0.0
1    w pretrain:    0.000064              0            0.0
2          dssgd:   0.000365              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000041              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000054              0            0.0
1    w pretrain:    0.000054              0            0.0
2          dssgd:   0.000149              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000060              0            0.0
1    w pretrain:    0.000059              0            0.0
2          dssgd:   0.000324              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000034              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000338              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000277              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000035              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000037              0            0.0
1    w pretrain:    0.000037              0            0.0
2          dssgd:   0.000104              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000030              0            0.0
1    w pretrain:    0.000030              0            0.0
2          dssgd:   0.000251              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000055              0            0.0
1    w pretrain:    0.000055              0            0.0
2          dssgd:   0.000419              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000061              0            0.0
1    w pretrain:    0.000061              0            0.0
2          dssgd:   0.000516              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000217              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000054              0            0.0
1    w pretrain:    0.000054              0            0.0
2          dssgd:   0.000374              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000070              0            0.0
1    w pretrain:    0.000070              0            0.0
2          dssgd:   0.000415              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000031              0            0.0
1    w pretrain:    0.000031              0            0.0
2          dssgd:   0.000304              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000034              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000425              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000101              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000032              0            0.0
1    w pretrain:    0.000032              0            0.0
2          dssgd:   0.000247              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000028              0            0.0
1    w pretrain:    0.000028              0            0.0
2          dssgd:   0.000343              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000062              0            0.0
2          dssgd:   0.000416              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000067              0            0.0
1    w pretrain:    0.000066              0            0.0
2          dssgd:   0.000482              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000051              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000056              0            0.0
1    w pretrain:    0.000056              0            0.0
2          dssgd:   0.000138              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000071              0            0.0
1    w pretrain:    0.000071              0            0.0
2          dssgd:   0.000220              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000031              0            0.0
1    w pretrain:    0.000030              0            0.0
2          dssgd:   0.000250              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000032              0            0.0
1    w pretrain:    0.000033              0            0.0
2          dssgd:   0.000366              0            0.0

Epoch 81:
credits, credit threshold: tensor(0.1667)
tensor([0.1905, 0.2176, 0.2148, 0.1885, 0.1885])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1667)
tensor([0.1876, 0.2174, 0.2137, 0.1902, 0.1911])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.010%']
Workers DSSGD     accuracies:  ['18.210%', '16.890%', '16.580%', '18.090%', '25.650%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['20.940%', '25.000%', '27.170%', '23.210%', '23.870%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['20.540%', '25.080%', '27.150%', '23.170%', '23.870%']
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000016              0            0.0
2          dssgd:   0.000073              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000030              0            0.0
1    w pretrain:    0.000030              0            0.0
2          dssgd:   0.000203              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000027              0            0.0
1    w pretrain:    0.000027              0            0.0
2          dssgd:   0.000375              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000063              0            0.0
2          dssgd:   0.000406              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:     0.00007              0            0.0
1    w pretrain:     0.00007              0            0.0
2          dssgd:    0.00037              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000008              0            0.0
1    w pretrain:    0.000008              0            0.0
2          dssgd:   0.000058              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000056              0            0.0
1    w pretrain:    0.000056              0            0.0
2          dssgd:   0.000147              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000070              0            0.0
1    w pretrain:    0.000070              0            0.0
2          dssgd:   0.000317              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000029              0            0.0
1    w pretrain:    0.000029              0            0.0
2          dssgd:   0.000363              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000032              0            0.0
1    w pretrain:    0.000032              0            0.0
2          dssgd:   0.000433              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000059              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000030              0            0.0
1    w pretrain:    0.000030              0            0.0
2          dssgd:   0.000175              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000030              0            0.0
1    w pretrain:    0.000030              0            0.0
2          dssgd:   0.000315              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000063              0            0.0
2          dssgd:   0.000361              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000068              0            0.0
1    w pretrain:    0.000069              0            0.0
2          dssgd:   0.000344              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000009              0            0.0
1    w pretrain:    0.000009              0            0.0
2          dssgd:   0.000046              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000055              0            0.0
1    w pretrain:    0.000055              0            0.0
2          dssgd:   0.000141              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000069              0            0.0
1    w pretrain:    0.000069              0            0.0
2          dssgd:   0.000284              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000034              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000455              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000036              0            0.0
1    w pretrain:    0.000037              0            0.0
2          dssgd:   0.000538              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000167              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000031              0            0.0
1    w pretrain:    0.000031              0            0.0
2          dssgd:   0.000361              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000034              0            0.0
1    w pretrain:    0.000034              0            0.0
2          dssgd:   0.000438              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000063              0            0.0
2          dssgd:   0.000336              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000067              0            0.0
1    w pretrain:    0.000068              0            0.0
2          dssgd:   0.000408              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000010              0            0.0
1    w pretrain:    0.000010              0            0.0
2          dssgd:   0.000054              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000053              0            0.0
1    w pretrain:    0.000053              0            0.0
2          dssgd:   0.000163              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000065              0            0.0
1    w pretrain:    0.000066              0            0.0
2          dssgd:   0.000334              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000039              0            0.0
1    w pretrain:    0.000040              0            0.0
2          dssgd:   0.000357              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000043              0            0.0
1    w pretrain:    0.000043              0            0.0
2          dssgd:   0.000491              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000064              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000035              0            0.0
1    w pretrain:    0.000035              0            0.0
2          dssgd:   0.000201              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000044              0            0.0
1    w pretrain:    0.000044              0            0.0
2          dssgd:   0.000329              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000063              0            0.0
2          dssgd:   0.000397              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000068              0            0.0
1    w pretrain:    0.000068              0            0.0
2          dssgd:   0.000496              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000215              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000052              0            0.0
1    w pretrain:    0.000051              0            0.0
2          dssgd:   0.000398              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000069              0            0.0
1    w pretrain:    0.000069              0            0.0
2          dssgd:   0.000545              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000048              0            0.0
1    w pretrain:    0.000047              0            0.0
2          dssgd:   0.000496              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000055              0            0.0
1    w pretrain:    0.000055              0            0.0
2          dssgd:   0.000477              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000015              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000124              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000037              0            0.0
1    w pretrain:    0.000036              0            0.0
2          dssgd:   0.000309              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000044              0            0.0
1    w pretrain:    0.000043              0            0.0
2          dssgd:   0.000449              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000069              0            0.0
1    w pretrain:    0.000068              0            0.0
2          dssgd:   0.000475              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000073              0            0.0
1    w pretrain:    0.000072              0            0.0
2          dssgd:   0.000387              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000055              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000051              0            0.0
1    w pretrain:    0.000050              0            0.0
2          dssgd:   0.000108              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000071              0            0.0
1    w pretrain:    0.000070              0            0.0
2          dssgd:   0.000305              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000053              0            0.0
1    w pretrain:    0.000051              0            0.0
2          dssgd:   0.000514              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000061              0            0.0
1    w pretrain:    0.000060              0            0.0
2          dssgd:   0.000596              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000014              0            0.0
1    w pretrain:    0.000015              0            0.0
2          dssgd:   0.000248              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000038              0            0.0
1    w pretrain:    0.000037              0            0.0
2          dssgd:   0.000429              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000051              0            0.0
1    w pretrain:    0.000050              0            0.0
2          dssgd:   0.000359              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000067              0            0.0
1    w pretrain:    0.000065              0            0.0
2          dssgd:   0.000244              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000072              0            0.0
1    w pretrain:    0.000071              0            0.0
2          dssgd:   0.000422              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000011              0            0.0
1    w pretrain:    0.000011              0            0.0
2          dssgd:   0.000034              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000047              0            0.0
1    w pretrain:    0.000047              0            0.0
2          dssgd:   0.000104              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000063              0            0.0
2          dssgd:   0.000214              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000054              0            0.0
1    w pretrain:    0.000053              0            0.0
2          dssgd:   0.000280              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000062              0            0.0
1    w pretrain:    0.000060              0            0.0
2          dssgd:   0.000356              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000035              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000041              0            0.0
1    w pretrain:    0.000040              0            0.0
2          dssgd:   0.000115              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000059              0            0.0
1    w pretrain:    0.000058              0            0.0
2          dssgd:   0.000195              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000059              0            0.0
1    w pretrain:    0.000059              0            0.0
2          dssgd:   0.000248              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000065              0            0.0
1    w pretrain:    0.000064              0            0.0
2          dssgd:   0.000305              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000012              0            0.0
2          dssgd:   0.000051              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000044              0            0.0
1    w pretrain:    0.000044              0            0.0
2          dssgd:   0.000148              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000064              0            0.0
1    w pretrain:    0.000063              0            0.0
2          dssgd:   0.000247              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000057              0            0.0
1    w pretrain:    0.000056              0            0.0
2          dssgd:   0.000255              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000067              0            0.0
1    w pretrain:    0.000067              0            0.0
2          dssgd:   0.000267              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000014              0            0.0
2          dssgd:   0.000057              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000045              0            0.0
1    w pretrain:    0.000045              0            0.0
2          dssgd:   0.000134              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000061              0            0.0
1    w pretrain:    0.000060              0            0.0
2          dssgd:   0.000294              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000060              0            0.0
1    w pretrain:    0.000061              0            0.0
2          dssgd:   0.000422              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000063              0            0.0
1    w pretrain:    0.000064              0            0.0
2          dssgd:   0.000451              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000084              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000040              0            0.0
1    w pretrain:    0.000041              0            0.0
2          dssgd:   0.000222              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000056              0            0.0
1    w pretrain:    0.000057              0            0.0
2          dssgd:   0.000292              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000059              0            0.0
1    w pretrain:    0.000059              0            0.0
2          dssgd:   0.000335              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000068              0            0.0
1    w pretrain:    0.000068              0            0.0
2          dssgd:   0.000449              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000094              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000046              0            0.0
1    w pretrain:    0.000046              0            0.0
2          dssgd:   0.000271              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000066              0            0.0
1    w pretrain:    0.000066              0            0.0
2          dssgd:   0.000470              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000055              0            0.0
1    w pretrain:    0.000055              0            0.0
2          dssgd:   0.000523              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000060              0            0.0
1    w pretrain:    0.000061              0            0.0
2          dssgd:   0.000449              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000013              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000105              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000039              0            0.0
1    w pretrain:    0.000039              0            0.0
2          dssgd:   0.000126              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000051              0            0.0
1    w pretrain:    0.000051              0            0.0
2          dssgd:   0.000236              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000062              0            0.0
1    w pretrain:    0.000062              0            0.0
2          dssgd:   0.000309              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000068              0            0.0
1    w pretrain:    0.000068              0            0.0
2          dssgd:   0.000385              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000012              0            0.0
1    w pretrain:    0.000013              0            0.0
2          dssgd:   0.000057              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000045              0            0.0
1    w pretrain:    0.000045              0            0.0
2          dssgd:   0.000175              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000061              0            0.0
1    w pretrain:    0.000062              0            0.0
2          dssgd:   0.000280              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000049              0            0.0
1    w pretrain:    0.000049              0            0.0
2          dssgd:   0.000311              0            0.0
                   grad_mean  clipped_count  clipped_ratio
0  w/o pretrain:    0.000054              0            0.0
1    w pretrain:    0.000054              0            0.0
2          dssgd:   0.000348              0            0.0
pretraining 0.33667755126953125
evaluation after pretraining 1.3094558715820312
workers local training 307.2726180553436
server aggregation 38.86635875701904
server aggregation with pretraining 10.769695281982422
server aggregation dssgd 9.871861934661865
fed model eval on valid loader 4.090861797332764
credit updates 0.1620650291442871
assign updates 2.480623483657837
performance update 246.93287634849548
total seconds 622.0930941104889
Time_dict-----
{"pretraining": 0.33667755126953125, "evaluation after pretraining": 1.3094558715820312, "workers local training": 307.2726180553436, "server aggregation": 38.86635875701904, "server aggregation with pretraining": 10.769695281982422, "server aggregation dssgd": 9.871861934661865, "fed model eval on valid loader": 4.090861797332764, "credit updates": 0.1620650291442871, "assign updates": 2.480623483657837, "performance update": 246.93287634849548}
-----
Performance and Fairness analysis: 
Worker credits : [0.20380662381649017, 0.19722086191177368, 0.205353781580925, 0.1955285370349884, 0.19809013605117798]
Number of reputable parties:  5
Worker credits pretrain: [0.20173290371894836, 0.19859573245048523, 0.20154933631420135, 0.19865737855434418, 0.1994646191596985]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.1013999953866005
CFFL_best_worker  -  0.2809999883174896
rr_dssgd_best  -  0.25839999318122864
standlone_vs_rrdssgd  -  [-0.07753583814072178]
standalone_vs_final  -  [0.7112477838727231]
----
----Results with pretrain
standalone_best_worker  -  0.1013999953866005
CFFL_best_worker  -  0.2802000045776367
rr_dssgd_best  -  0.25839999318122864
standlone_vs_rrdssgd  -  [-0.07753583814072178]
standalone_vs_final  -  [0.6910089057174559]
----
for all without pretraining:
standalone_vs_final_mean [0.7112477838727231]
standlone_vs_rrdssgd_mean [-0.07753583814072178]
rr_dssgd_best_mean 0.25839999318122864
CFFL_best_worker_mean 0.2809999883174896
standalone_best_worker_mean 0.1013999953866005

for all the pretraining included:
standalone_vs_final_mean [0.6910089057174559]
standlone_vs_rrdssgd_mean [-0.07753583814072178]
rr_dssgd_best_mean 0.25839999318122864
CFFL_best_worker_mean 0.2802000045776367
standalone_best_worker_mean 0.1013999953866005
[Finished in 629.5s

ettings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 64, 'train_val_split_ratio': 0.9, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.001, 'dssgd_lr': 0.001, 'lr': 0.001, 'grad_clip': 0.0001, 'gamma': 1, 'pretrain_epochs': 5, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_ids': [0]}
Files already downloaded and verified
CIFAR10 data shape torch.Size([50000, 3, 32, 32]), targets shape torch.Size([50000])
Files already downloaded and verified
CIFAR10 data shape torch.Size([10000, 3, 32, 32]), targets shape torch.Size([10000])
------
Train to split size: 10000. Validation size: 5000. Test size: 10000
------
Experiment : No.1/1
CFFL server model validation accuracy : 10.0600%
CFFL server model test accuracy : 9.9800%

Epoch 1:
credits, credit threshold: tensor(0.1333)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.980%', '9.970%', '9.980%', '9.970%', '9.990%']
Workers DSSGD     accuracies:  ['9.980%', '9.980%', '9.980%', '9.970%', '9.980%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['9.980%', '9.980%', '9.970%', '9.980%', '9.970%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['9.980%', '9.990%', '9.980%', '10.090%', '10.120%']

Epoch 21:
credits, credit threshold: tensor(0.1333)
tensor([0.1984, 0.2017, 0.2000, 0.1995, 0.2003])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2017, 0.2005, 0.1984, 0.2000, 0.1993])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.500%', '10.740%']
Workers DSSGD     accuracies:  ['10.900%', '10.920%', '10.920%', '10.990%', '11.100%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['21.470%', '21.330%', '21.260%', '21.280%', '21.580%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['21.400%', '21.230%', '21.110%', '21.240%', '21.620%']

Epoch 41:
credits, credit threshold: tensor(0.1333)
tensor([0.1995, 0.2011, 0.2002, 0.2007, 0.1986])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1991, 0.2007, 0.2005, 0.2001, 0.1997])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.020%', '10.020%', '10.080%', '12.260%', '12.850%']
Workers DSSGD     accuracies:  ['18.260%', '18.290%', '18.430%', '18.410%', '18.790%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['25.450%', '25.530%', '25.420%', '25.510%', '25.950%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['25.560%', '25.510%', '25.560%', '25.630%', '26.060%']

Epoch 61:
credits, credit threshold: tensor(0.1333)
tensor([0.1990, 0.1999, 0.2004, 0.2001, 0.2006])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1988, 0.2006, 0.2008, 0.2004, 0.1994])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.020%', '10.310%', '14.700%', '17.750%']
Workers DSSGD     accuracies:  ['21.230%', '21.320%', '21.370%', '21.330%', '21.340%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['30.300%', '30.250%', '30.150%', '30.250%', '30.450%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['30.420%', '30.390%', '30.230%', '30.270%', '30.460%']

Epoch 81:
credits, credit threshold: tensor(0.1333)
tensor([0.2005, 0.2003, 0.2010, 0.1978, 0.2004])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1997, 0.2008, 0.2017, 0.1981, 0.1997])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.980%', '10.000%', '10.710%', '16.330%', '18.480%']
Workers DSSGD     accuracies:  ['24.210%', '24.200%', '24.100%', '24.450%', '24.400%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['32.760%', '33.470%', '33.650%', '32.970%', '33.580%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['32.790%', '33.480%', '33.560%', '32.910%', '33.450%']
pretraining 2.1985716819763184
evaluation after pretraining 1.3565623760223389
workers local training 443.8053834438324
server aggregation 40.58028173446655
server aggregation with pretraining 36.29133224487305
server aggregation dssgd 35.583150148391724
fed model eval on valid loader 13.166182279586792
credit updates 0.19888877868652344
assign updates 4.136810541152954
performance update 260.11723589897156
total seconds 837.4343991279602
Time_dict-----
{"pretraining": 2.1985716819763184, "evaluation after pretraining": 1.3565623760223389, "workers local training": 443.8053834438324, "server aggregation": 40.58028173446655, "server aggregation with pretraining": 36.29133224487305, "server aggregation dssgd": 35.583150148391724, "fed model eval on valid loader": 13.166182279586792, "credit updates": 0.19888877868652344, "assign updates": 4.136810541152954, "performance update": 260.11723589897156}
-----
Performance and Fairness analysis:
Worker credits : [0.19905132055282593, 0.19940008223056793, 0.20183171331882477, 0.20024389028549194, 0.19947302341461182]
Number of reputable parties:  5
Worker credits pretrain: [0.19925272464752197, 0.19906273484230042, 0.20083703100681305, 0.201039120554924, 0.19980835914611816]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.12119999527931213
CFFL_best_worker  -  0.3734999895095825
rr_dssgd_best  -  0.2685999870300293
standlone_vs_rrdssgd  -  [-0.7522330161908424]
standalone_vs_final  -  [0.28348690368242546]
----
----Results with pretrain
standalone_best_worker  -  0.12119999527931213
CFFL_best_worker  -  0.37279999256134033
rr_dssgd_best  -  0.2685999870300293
standlone_vs_rrdssgd  -  [-0.7522330161908424]
standalone_vs_final  -  [0.2737805745180887]
----
for all without pretraining:
standalone_vs_final_mean [0.28348690368242546]
standlone_vs_rrdssgd_mean [-0.7522330161908424]
rr_dssgd_best_mean 0.2685999870300293
CFFL_best_worker_mean 0.3734999895095825
standalone_best_worker_mean 0.12119999527931213

for all the pretraining included:
standalone_vs_final_mean [0.2737805745180887]
standlone_vs_rrdssgd_mean [-0.7522330161908424]
rr_dssgd_best_mean 0.2685999870300293
CFFL_best_worker_mean 0.37279999256134033
standalone_best_worker_mean 0.12119999527931213


**********

With transforms customized to cifar10

**********
Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 256, 'train_val_split_ratio': 0.9, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.001, 'dssgd_lr': 0.001, 'lr': 0.001, 'grad_clip': 0.001, 'gamma': 1, 'pretrain_epochs': 5, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_ids': [0]}
Files already downloaded and verified
CIFAR10 data shape torch.Size([50000, 3, 32, 32]), targets shape torch.Size([50000])
Files already downloaded and verified
CIFAR10 data shape torch.Size([10000, 3, 32, 32]), targets shape torch.Size([10000])
------
Train to split size: 50000. Validation size: 10000. Test size: 10000
------
Experiment : No.1/1
CFFL server model validation accuracy : 10.0000%
CFFL server model test accuracy : 10.0000%

Epoch 1:
credits, credit threshold: tensor(0.1333)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers DSSGD     accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']

Epoch 21:
credits, credit threshold: tensor(0.1333)
tensor([0.1955, 0.1926, 0.1902, 0.2148, 0.2068])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1991, 0.1965, 0.1917, 0.2082, 0.2046])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers DSSGD     accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['11.560%', '11.660%', '11.580%', '11.840%', '12.020%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['10.970%', '11.220%', '11.150%', '13.650%', '13.820%']

Epoch 41:
credits, credit threshold: tensor(0.1333)
tensor([0.1943, 0.1993, 0.2043, 0.1989, 0.2032])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1928, 0.1966, 0.2025, 0.2027, 0.2055])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers DSSGD     accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['20.490%', '20.460%', '20.620%', '20.570%', '20.520%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['19.740%', '19.880%', '20.130%', '19.760%', '19.800%']

Epoch 61:
credits, credit threshold: tensor(0.1333)
tensor([0.1900, 0.2016, 0.2054, 0.2029, 0.2000])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1908, 0.2005, 0.2060, 0.2029, 0.1998])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers DSSGD     accuracies:  ['10.080%', '10.080%', '10.040%', '10.060%', '10.080%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['20.590%', '21.250%', '20.950%', '21.120%', '21.320%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['20.950%', '21.490%', '21.190%', '21.650%', '21.840%']

Epoch 81:
credits, credit threshold: tensor(0.1333)
tensor([0.1887, 0.2045, 0.2051, 0.2029, 0.1987])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1909, 0.2024, 0.2057, 0.2029, 0.1981])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '9.990%', '10.000%']
Workers DSSGD     accuracies:  ['11.720%', '11.680%', '11.330%', '11.560%', '11.650%']

Workers before    accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL      accuracies:  ['25.050%', '24.540%', '24.470%', '23.350%', '24.060%']

Workers before pr accuracies:  ['10.000%', '10.000%', '10.000%', '10.000%', '10.000%']
Workers CFFL pret accuracies:  ['23.780%', '22.420%', '23.270%', '22.460%', '22.480%']
pretraining 9.538909196853638
evaluation after pretraining 1.9836652278900146
workers local training 1576.3194963932037
server aggregation 93.99316906929016
server aggregation with pretraining 93.15206289291382
server aggregation dssgd 92.3238046169281
fed model eval on valid loader 35.28323793411255
credit updates 0.15969228744506836
assign updates 3.333364248275757
performance update 359.9308400154114
total seconds 2266.018241882324
Time_dict-----
{"pretraining": 9.538909196853638, "evaluation after pretraining": 1.9836652278900146, "workers local training": 1576.3194963932037, "server aggregation": 93.99316906929016, "server aggregation with pretraining": 93.15206289291382, "server aggregation dssgd": 92.3238046169281, "fed model eval on valid loader": 35.28323793411255, "credit updates": 0.15969228744506836, "assign updates": 3.333364248275757, "performance update": 359.9308400154114}
-----
Performance and Fairness analysis: 
Worker credits : [0.19050009548664093, 0.20525015890598297, 0.20204487442970276, 0.2023114413022995, 0.19989344477653503]
Number of reputable parties:  5
Worker credits pretrain: [0.1895926296710968, 0.20538504421710968, 0.2021956741809845, 0.20188550651073456, 0.20094116032123566]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.1021999940276146
CFFL_best_worker  -  0.30410000681877136
rr_dssgd_best  -  0.14630000293254852
standlone_vs_rrdssgd  -  [0.6122381650016765]
standalone_vs_final  -  [0.0021244452046992324]
----
----Results with pretrain
standalone_best_worker  -  0.09999999403953552
CFFL_best_worker  -  0.3073999881744385
rr_dssgd_best  -  0.14149999618530273
standlone_vs_rrdssgd  -  [0.6122381650016765]
standalone_vs_final  -  [0.14136201488346142]
----
for all without pretraining:
standalone_vs_final_mean [0.0021244452046992324]
standlone_vs_rrdssgd_mean [0.6122381650016765]
rr_dssgd_best_mean 0.14630000293254852
CFFL_best_worker_mean 0.30410000681877136
standalone_best_worker_mean 0.1021999940276146

for all the pretraining included:
standalone_vs_final_mean [0.14136201488346142]
standlone_vs_rrdssgd_mean [0.6122381650016765]
rr_dssgd_best_mean 0.14149999618530273
CFFL_best_worker_mean 0.3073999881744385
standalone_best_worker_mean 0.09999999403953552
[Finished in 2269.4s

ettings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 64, 'train_val_split_ratio': 0.9, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.001, 'dssgd_lr': 0.001, 'lr': 0.001, 'grad_clip': 0.0001, 'gamma': 1, 'pretrain_epochs': 5, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'sum', 'device_ids': [0]}
Files already downloaded and verified
CIFAR10 data shape torch.Size([50000, 3, 32, 32]), targets shape torch.Size([50000])
Files already downloaded and verified
CIFAR10 data shape torch.Size([10000, 3, 32, 32]), targets shape torch.Size([10000])
------
Train to split size: 10000. Validation size: 5000. Test size: 10000
------
Experiment : No.1/1
CFFL server model validation accuracy : 10.0600%
CFFL server model test accuracy : 9.9800%

Epoch 1:
credits, credit threshold: tensor(0.1333)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.980%', '9.970%', '9.980%', '9.970%', '9.990%']
Workers DSSGD     accuracies:  ['9.980%', '9.980%', '9.980%', '9.970%', '9.980%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['9.980%', '9.980%', '9.970%', '9.980%', '9.970%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['9.980%', '9.990%', '9.980%', '10.090%', '10.120%']

Epoch 21:
credits, credit threshold: tensor(0.1333)
tensor([0.1984, 0.2017, 0.2000, 0.1995, 0.2003])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2017, 0.2005, 0.1984, 0.2000, 0.1993])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.000%', '10.000%', '10.500%', '10.740%']
Workers DSSGD     accuracies:  ['10.900%', '10.920%', '10.920%', '10.990%', '11.100%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['21.470%', '21.330%', '21.260%', '21.280%', '21.580%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['21.400%', '21.230%', '21.110%', '21.240%', '21.620%']

Epoch 41:
credits, credit threshold: tensor(0.1333)
tensor([0.1995, 0.2011, 0.2002, 0.2007, 0.1986])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1991, 0.2007, 0.2005, 0.2001, 0.1997])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.020%', '10.020%', '10.080%', '12.260%', '12.850%']
Workers DSSGD     accuracies:  ['18.260%', '18.290%', '18.430%', '18.410%', '18.790%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['25.450%', '25.530%', '25.420%', '25.510%', '25.950%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['25.560%', '25.510%', '25.560%', '25.630%', '26.060%']

Epoch 61:
credits, credit threshold: tensor(0.1333)
tensor([0.1990, 0.1999, 0.2004, 0.2001, 0.2006])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1988, 0.2006, 0.2008, 0.2004, 0.1994])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.020%', '10.310%', '14.700%', '17.750%']
Workers DSSGD     accuracies:  ['21.230%', '21.320%', '21.370%', '21.330%', '21.340%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['30.300%', '30.250%', '30.150%', '30.250%', '30.450%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['30.420%', '30.390%', '30.230%', '30.270%', '30.460%']

Epoch 81:
credits, credit threshold: tensor(0.1333)
tensor([0.2005, 0.2003, 0.2010, 0.1978, 0.2004])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1997, 0.2008, 0.2017, 0.1981, 0.1997])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.980%', '10.000%', '10.710%', '16.330%', '18.480%']
Workers DSSGD     accuracies:  ['24.210%', '24.200%', '24.100%', '24.450%', '24.400%']

Workers before    accuracies:  ['9.980%', '9.980%', '9.980%', '9.980%', '9.980%']
Workers CFFL      accuracies:  ['32.760%', '33.470%', '33.650%', '32.970%', '33.580%']

Workers before pr accuracies:  ['9.980%', '9.980%', '10.000%', '10.010%', '10.030%']
Workers CFFL pret accuracies:  ['32.790%', '33.480%', '33.560%', '32.910%', '33.450%']
pretraining 2.1985716819763184
evaluation after pretraining 1.3565623760223389
workers local training 443.8053834438324
server aggregation 40.58028173446655
server aggregation with pretraining 36.29133224487305
server aggregation dssgd 35.583150148391724
fed model eval on valid loader 13.166182279586792
credit updates 0.19888877868652344
assign updates 4.136810541152954
performance update 260.11723589897156
total seconds 837.4343991279602
Time_dict-----
{"pretraining": 2.1985716819763184, "evaluation after pretraining": 1.3565623760223389, "workers local training": 443.8053834438324, "server aggregation": 40.58028173446655, "server aggregation with pretraining": 36.29133224487305, "server aggregation dssgd": 35.583150148391724, "fed model eval on valid loader": 13.166182279586792, "credit updates": 0.19888877868652344, "assign updates": 4.136810541152954, "performance update": 260.11723589897156}
-----
Performance and Fairness analysis:
Worker credits : [0.19905132055282593, 0.19940008223056793, 0.20183171331882477, 0.20024389028549194, 0.19947302341461182]
Number of reputable parties:  5
Worker credits pretrain: [0.19925272464752197, 0.19906273484230042, 0.20083703100681305, 0.201039120554924, 0.19980835914611816]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.12119999527931213
CFFL_best_worker  -  0.3734999895095825
rr_dssgd_best  -  0.2685999870300293
standlone_vs_rrdssgd  -  [-0.7522330161908424]
standalone_vs_final  -  [0.28348690368242546]
----
----Results with pretrain
standalone_best_worker  -  0.12119999527931213
CFFL_best_worker  -  0.37279999256134033
rr_dssgd_best  -  0.2685999870300293
standlone_vs_rrdssgd  -  [-0.7522330161908424]
standalone_vs_final  -  [0.2737805745180887]
----
for all without pretraining:
standalone_vs_final_mean [0.28348690368242546]
standlone_vs_rrdssgd_mean [-0.7522330161908424]
rr_dssgd_best_mean 0.2685999870300293
CFFL_best_worker_mean 0.3734999895095825
standalone_best_worker_mean 0.12119999527931213

for all the pretraining included:
standalone_vs_final_mean [0.2737805745180887]
standlone_vs_rrdssgd_mean [-0.7522330161908424]
rr_dssgd_best_mean 0.2685999870300293
CFFL_best_worker_mean 0.37279999256134033
standalone_best_worker_mean 0.12119999527931213



Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap': 10000, 'n_workers': 5, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 128, 'train_val_split_ratio': 0.8, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar_TF'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.005, 'dssgd_lr': 0.005, 'std_lr': 0.005, 'lr': 0.001, 'grad_clip': 0.001, 'gamma': 1, 'pretrain_epochs': 5, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'credit-sum', 'largest_criterion': 'layer', 'device_ids': [0]}
Files already downloaded and verified
CIFAR10 data shape torch.Size([50000, 3, 32, 32]), targets shape torch.Size([50000])
Files already downloaded and verified
CIFAR10 data shape torch.Size([10000, 3, 32, 32]), targets shape torch.Size([10000])
------
Train to split size: 10000. Validation size: 10000. Test size: 10000
------
Experiment : No.1/1
Shard sizes are:  [236, 1118, 2000, 2883, 3763]
CFFL server model validation accuracy : 9.9500%
CFFL server model test accuracy : 9.7600%

Epoch 1:
credits, credit threshold: tensor(0.1333)
tensor([0.2003, 0.1994, 0.2001, 0.1999, 0.2003])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1976, 0.1988, 0.2012, 0.1974, 0.2050])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.780%', '9.910%', '9.890%', '9.860%', '9.920%']
Workers DSSGD     accuracies:  ['9.780%', '9.890%', '9.980%', '10.080%', '10.070%']

Workers before    accuracies:  ['9.760%', '9.760%', '9.760%', '9.760%', '9.760%']
Workers CFFL      accuracies:  ['9.810%', '9.760%', '9.760%', '9.870%', '9.770%']

Workers before pr accuracies:  ['9.820%', '9.950%', '10.070%', '10.210%', '10.350%']
Workers CFFL pret accuracies:  ['9.880%', '9.990%', '10.090%', '10.840%', '11.080%']

Epoch 21:
credits, credit threshold: tensor(0.1333)
tensor([0.1901, 0.1878, 0.2065, 0.2061, 0.2094])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1982, 0.2016, 0.2003, 0.2092, 0.1908])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.080%', '10.000%', '15.220%', '20.010%', '20.730%']
Workers DSSGD     accuracies:  ['12.720%', '10.830%', '10.510%', '11.120%', '15.180%']

Workers before    accuracies:  ['9.760%', '9.760%', '9.760%', '9.760%', '9.760%']
Workers CFFL      accuracies:  ['13.810%', '12.910%', '14.120%', '17.590%', '14.650%']

Workers before pr accuracies:  ['9.820%', '9.950%', '10.070%', '10.210%', '10.350%']
Workers CFFL pret accuracies:  ['29.860%', '34.020%', '36.050%', '37.610%', '39.800%']

Epoch 41:
credits, credit threshold: tensor(0.1333)
tensor([0.1937, 0.1961, 0.2026, 0.2041, 0.2035])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1983, 0.2095, 0.1992, 0.1992, 0.1939])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.210%', '10.510%', '22.160%', '28.570%', '32.600%']
Workers DSSGD     accuracies:  ['21.700%', '21.050%', '23.270%', '26.750%', '28.380%']

Workers before    accuracies:  ['9.760%', '9.760%', '9.760%', '9.760%', '9.760%']
Workers CFFL      accuracies:  ['21.230%', '21.720%', '22.180%', '24.680%', '26.410%']

Workers before pr accuracies:  ['9.820%', '9.950%', '10.070%', '10.210%', '10.350%']
Workers CFFL pret accuracies:  ['36.220%', '39.760%', '44.260%', '45.450%', '47.130%']

Epoch 61:
credits, credit threshold: tensor(0.1333)
tensor([0.2009, 0.1995, 0.1990, 0.1990, 0.2017])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.2044, 0.2043, 0.1862, 0.1986, 0.2065])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.360%', '13.980%', '29.580%', '33.790%', '35.480%']
Workers DSSGD     accuracies:  ['24.750%', '27.310%', '29.780%', '31.510%', '30.660%']

Workers before    accuracies:  ['9.760%', '9.760%', '9.760%', '9.760%', '9.760%']
Workers CFFL      accuracies:  ['26.670%', '30.000%', '30.280%', '31.420%', '33.640%']

Workers before pr accuracies:  ['9.820%', '9.950%', '10.070%', '10.210%', '10.350%']
Workers CFFL pret accuracies:  ['37.710%', '43.310%', '46.400%', '47.810%', '51.110%']

Epoch 81:
credits, credit threshold: tensor(0.1333)
tensor([0.2016, 0.1986, 0.2008, 0.1961, 0.2029])
Reputable parties:  [0, 1, 2, 3, 4]

credits, credit_threshold pretrain: tensor(0.1333)
tensor([0.1958, 0.2030, 0.2038, 0.2010, 0.1964])
Reputable parties pretrain:  [0, 1, 2, 3, 4]
Below are testset accuracies: ---
Workers standalone accuracies:  ['11.650%', '23.150%', '33.460%', '36.800%', '39.680%']
Workers DSSGD     accuracies:  ['32.800%', '33.180%', '33.020%', '32.370%', '32.200%']

Workers before    accuracies:  ['9.760%', '9.760%', '9.760%', '9.760%', '9.760%']
Workers CFFL      accuracies:  ['29.680%', '32.990%', '33.920%', '34.440%', '36.750%']

Workers before pr accuracies:  ['9.820%', '9.950%', '10.070%', '10.210%', '10.350%']
Workers CFFL pret accuracies:  ['38.070%', '45.030%', '48.560%', '49.780%', '50.410%']
pretraining 3.405095100402832
evaluation after pretraining 2.897484064102173
workers local training 867.8392238616943
server aggregation 134.8653426170349
server aggregation with pretraining 128.3419635295868
server aggregation dssgd 127.19049263000488
fed model eval on valid loader 50.200021743774414
credit updates 8.889081001281738
assign updates 3.719177484512329
performance update 494.28577041625977
total seconds 1821.6336524486542
Time_dict-----
{"pretraining": 3.405095100402832, "evaluation after pretraining": 2.897484064102173, "workers local training": 867.8392238616943, "server aggregation": 134.8653426170349, "server aggregation with pretraining": 128.3419635295868, "server aggregation dssgd": 127.19049263000488, "fed model eval on valid loader": 50.200021743774414, "credit updates": 8.889081001281738, "assign updates": 3.719177484512329, "performance update": 494.28577041625977}
-----
Performance and Fairness analysis: 
Worker credits : [0.2001129388809204, 0.20047211647033691, 0.19838792085647583, 0.19935467839241028, 0.20167239010334015]
Number of reputable parties:  5
Worker credits pretrain: [0.19977203011512756, 0.19927799701690674, 0.19424846768379211, 0.20441296696662903, 0.20228856801986694]
Number of reputable parties with pretrain:  5
----Results without pretrain
standalone_best_worker  -  0.42339998483657837
CFFL_best_worker  -  0.39329999685287476
rr_dssgd_best  -  0.3676999807357788
standlone_vs_rrdssgd  -  [0.7300421343872049]
standalone_vs_final  -  [0.968758929275652]
----
----Results with pretrain
standalone_best_worker  -  0.42339998483657837
CFFL_best_worker  -  0.5259999632835388
rr_dssgd_best  -  0.3676999807357788
standlone_vs_rrdssgd  -  [0.7300421343872049]
standalone_vs_final  -  [0.9933072078009092]
----
for all without pretraining:
standalone_vs_final_mean [0.968758929275652]
standlone_vs_rrdssgd_mean [0.7300421343872049]
rr_dssgd_best_mean 0.3676999807357788
CFFL_best_worker_mean 0.39329999685287476
standalone_best_worker_mean 0.42339998483657837

for all the pretraining included:
standalone_vs_final_mean [0.9933072078009092]
standlone_vs_rrdssgd_mean [0.7300421343872049]
rr_dssgd_best_mean 0.3676999807357788
CFFL_best_worker_mean 0.5259999632835388
standalone_best_worker_mean 0.42339998483657837
[Finished in 1835.0s]


Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap': 20000, 'n_workers': 10, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 128, 'train_val_split_ratio': 0.8, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar_TF'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.005, 'dssgd_lr': 0.005, 'std_lr': 0.005, 'lr': 0.001, 'grad_clip': 0.001, 'gamma': 1, 'pretrain_epochs': 5, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'credit-sum', 'largest_criterion': 'layer', 'device_ids': [0]}
Files already downloaded and verified
CIFAR10 data shape torch.Size([50000, 3, 32, 32]), targets shape torch.Size([50000])
Files already downloaded and verified
CIFAR10 data shape torch.Size([10000, 3, 32, 32]), targets shape torch.Size([10000])
------
Train to split size: 20000. Validation size: 10000. Test size: 10000
------
Experiment : No.1/1
Shard sizes are:  [236, 628, 1020, 1412, 1804, 2197, 2589, 2981, 3373, 3760]
CFFL server model validation accuracy : 9.5100%
CFFL server model test accuracy : 9.7000%

Epoch 1:
credits, credit threshold: tensor(0.0667)
tensor([0.0985, 0.0982, 0.0984, 0.0989, 0.1004, 0.1000, 0.1012, 0.1031, 0.1015,
        0.0998])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

credits, credit_threshold pretrain: tensor(0.0667)
tensor([0.0919, 0.0948, 0.0961, 0.0976, 0.1057, 0.1018, 0.1014, 0.1064, 0.1027,
        0.1016])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.660%', '9.710%', '9.760%', '9.810%', '10.060%', '9.890%', '9.890%', '10.120%', '10.040%', '9.430%']
Workers DSSGD     accuracies:  ['9.690%', '9.650%', '9.700%', '9.810%', '10.100%', '10.220%', '10.110%', '10.280%', '10.500%', '10.500%']

Workers before    accuracies:  ['9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%']
Workers CFFL      accuracies:  ['9.700%', '9.670%', '9.760%', '9.730%', '9.810%', '9.790%', '9.690%', '9.910%', '9.830%', '9.710%']

Workers before pr accuracies:  ['9.580%', '9.360%', '10.020%', '10.510%', '10.980%', '10.590%', '10.720%', '10.540%', '10.260%', '10.000%']
Workers CFFL pret accuracies:  ['9.670%', '9.400%', '10.270%', '11.150%', '11.970%', '10.900%', '11.220%', '11.090%', '10.220%', '10.000%']

Epoch 21:
credits, credit threshold: tensor(0.0667)
tensor([0.0980, 0.0972, 0.0987, 0.1015, 0.1037, 0.1011, 0.1002, 0.0997, 0.1004,
        0.0996])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

credits, credit_threshold pretrain: tensor(0.0667)
tensor([0.1046, 0.1027, 0.1024, 0.0953, 0.0966, 0.1006, 0.1002, 0.0994, 0.1007,
        0.0976])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.520%', '10.000%', '11.930%', '14.720%', '13.810%', '15.990%', '13.090%', '19.540%', '19.330%', '18.820%']
Workers DSSGD     accuracies:  ['22.810%', '22.400%', '20.740%', '19.210%', '17.520%', '16.370%', '15.670%', '16.350%', '17.580%', '19.060%']

Workers before    accuracies:  ['9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%']
Workers CFFL      accuracies:  ['10.210%', '10.010%', '11.860%', '13.220%', '15.650%', '11.540%', '12.310%', '11.240%', '11.770%', '11.020%']

Workers before pr accuracies:  ['9.580%', '9.360%', '10.020%', '10.510%', '10.980%', '10.590%', '10.720%', '10.540%', '10.260%', '10.000%']
Workers CFFL pret accuracies:  ['27.750%', '29.200%', '31.360%', '33.390%', '35.400%', '34.980%', '36.480%', '37.920%', '38.550%', '40.740%']

Epoch 41:
credits, credit threshold: tensor(0.0667)
tensor([0.0991, 0.0977, 0.0985, 0.0991, 0.0989, 0.1005, 0.1011, 0.1011, 0.1007,
        0.1033])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

credits, credit_threshold pretrain: tensor(0.0667)
tensor([0.0995, 0.1001, 0.1015, 0.0922, 0.1014, 0.1009, 0.0968, 0.0990, 0.1036,
        0.1050])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.850%', '10.000%', '13.350%', '19.260%', '20.180%', '23.580%', '26.710%', '28.830%', '30.330%', '31.420%']
Workers DSSGD     accuracies:  ['24.730%', '24.600%', '24.680%', '24.590%', '25.190%', '25.790%', '26.570%', '27.910%', '28.930%', '29.610%']

Workers before    accuracies:  ['9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%']
Workers CFFL      accuracies:  ['21.520%', '18.560%', '20.670%', '21.130%', '21.310%', '22.940%', '20.750%', '24.390%', '23.370%', '23.610%']

Workers before pr accuracies:  ['9.580%', '9.360%', '10.020%', '10.510%', '10.980%', '10.590%', '10.720%', '10.540%', '10.260%', '10.000%']
Workers CFFL pret accuracies:  ['34.830%', '37.140%', '38.890%', '40.530%', '41.060%', '41.420%', '44.450%', '44.760%', '45.660%', '48.930%']

Epoch 61:
credits, credit threshold: tensor(0.0667)
tensor([0.0997, 0.1000, 0.1005, 0.0998, 0.0996, 0.1013, 0.0994, 0.1005, 0.0994,
        0.0998])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

credits, credit_threshold pretrain: tensor(0.0667)
tensor([0.1053, 0.1066, 0.1057, 0.0846, 0.1000, 0.0945, 0.0970, 0.0990, 0.1026,
        0.1047])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.050%', '10.000%', '15.310%', '23.520%', '25.600%', '28.980%', '32.010%', '33.100%', '33.910%', '35.430%']
Workers DSSGD     accuracies:  ['31.090%', '31.230%', '31.070%', '30.770%', '29.900%', '28.680%', '27.820%', '26.730%', '26.260%', '26.630%']

Workers before    accuracies:  ['9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%']
Workers CFFL      accuracies:  ['25.800%', '25.010%', '25.310%', '27.760%', '27.430%', '29.340%', '30.080%', '30.220%', '31.100%', '31.510%']

Workers before pr accuracies:  ['9.580%', '9.360%', '10.020%', '10.510%', '10.980%', '10.590%', '10.720%', '10.540%', '10.260%', '10.000%']
Workers CFFL pret accuracies:  ['37.750%', '39.750%', '42.190%', '41.890%', '45.040%', '45.870%', '47.310%', '48.660%', '49.820%', '51.660%']

Epoch 81:
credits, credit threshold: tensor(0.0667)
tensor([0.1005, 0.1000, 0.0996, 0.0993, 0.1002, 0.0992, 0.1009, 0.1003, 0.0995,
        0.1004])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

credits, credit_threshold pretrain: tensor(0.0667)
tensor([0.1023, 0.1010, 0.1006, 0.1027, 0.0794, 0.1011, 0.1035, 0.1025, 0.1011,
        0.1058])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.150%', '10.000%', '20.390%', '26.700%', '29.870%', '29.620%', '32.220%', '36.310%', '37.180%', '40.380%']
Workers DSSGD     accuracies:  ['31.990%', '32.890%', '33.670%', '34.540%', '34.500%', '34.540%', '34.040%', '32.970%', '32.590%', '31.190%']

Workers before    accuracies:  ['9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%', '9.700%']
Workers CFFL      accuracies:  ['28.380%', '29.120%', '29.930%', '32.420%', '31.450%', '32.560%', '33.780%', '33.810%', '34.720%', '36.070%']

Workers before pr accuracies:  ['9.580%', '9.360%', '10.020%', '10.510%', '10.980%', '10.590%', '10.720%', '10.540%', '10.260%', '10.000%']
Workers CFFL pret accuracies:  ['38.040%', '41.880%', '45.590%', '39.610%', '46.880%', '49.540%', '47.710%', '50.870%', '52.750%', '51.750%']
pretraining 7.392421722412109
evaluation after pretraining 5.505299806594849
workers local training 1692.6888480186462
server aggregation 256.64952778816223
server aggregation with pretraining 250.10413527488708
server aggregation dssgd 247.52329421043396
fed model eval on valid loader 48.9766149520874
credit updates 8.860804557800293
assign updates 7.042666912078857
performance update 969.7412073612213
total seconds 3494.4848206043243
Time_dict-----
{"pretraining": 7.392421722412109, "evaluation after pretraining": 5.505299806594849, "workers local training": 1692.6888480186462, "server aggregation": 256.64952778816223, "server aggregation with pretraining": 250.10413527488708, "server aggregation dssgd": 247.52329421043396, "fed model eval on valid loader": 48.9766149520874, "credit updates": 8.860804557800293, "assign updates": 7.042666912078857, "performance update": 969.7412073612213}
-----
Performance and Fairness analysis: 
Worker credits : [0.10106462985277176, 0.09972400963306427, 0.10031268000602722, 0.096957728266716, 0.09920506924390793, 0.09965988248586655, 0.10077137500047684, 0.10056000202894211, 0.10044864565134048, 0.10129600763320923]
Number of reputable parties:  10
Worker credits pretrain: [0.1001409962773323, 0.09882725030183792, 0.08571242541074753, 0.10871220380067825, 0.09905111789703369, 0.10231390595436096, 0.10299927741289139, 0.10191728919744492, 0.09914323687553406, 0.10118229687213898]
Number of reputable parties with pretrain:  10
----Results without pretrain
standalone_best_worker  -  0.42239999771118164
CFFL_best_worker  -  0.39100000262260437
rr_dssgd_best  -  0.32349997758865356
standlone_vs_rrdssgd  -  [-0.9398045390329834]
standalone_vs_final  -  [0.9303078792831495]
----
----Results with pretrain
standalone_best_worker  -  0.42239999771118164
CFFL_best_worker  -  0.5227999687194824
rr_dssgd_best  -  0.32349997758865356
standlone_vs_rrdssgd  -  [-0.9398045390329834]
standalone_vs_final  -  [0.9273871188037784]
----
for all without pretraining:
standalone_vs_final_mean [0.9303078792831495]
standlone_vs_rrdssgd_mean [-0.9398045390329834]
rr_dssgd_best_mean 0.32349997758865356
CFFL_best_worker_mean 0.39100000262260437
standalone_best_worker_mean 0.42239999771118164

for all the pretraining included:
standalone_vs_final_mean [0.9273871188037784]
standlone_vs_rrdssgd_mean [-0.9398045390329834]
rr_dssgd_best_mean 0.32349997758865356
CFFL_best_worker_mean 0.5227999687194824
standalone_best_worker_mean 0.42239999771118164
[Finished in 3507.9s]


Experimental settings are:  {'gpu': 0, 'device': device(type='cuda', index=0), 'dataset': 'cifar10', 'sample_size_cap': 40000, 'n_workers': 20, 'split': 'powerlaw', 'theta': 0.1, 'batch_size': 128, 'train_val_split_ratio': 0.8, 'alpha': 5, 'epoch_sample_size': inf, 'n_freeriders': 0, 'model_fn': <class 'utils.models.CNNCifar_TF'>, 'optimizer_fn': <class 'torch.optim.sgd.SGD'>, 'loss_fn': NLLLoss(), 'pretraining_lr': 0.005, 'dssgd_lr': 0.005, 'std_lr': 0.005, 'lr': 0.001, 'grad_clip': 0.001, 'gamma': 1, 'pretrain_epochs': 5, 'fl_epochs': 100, 'fl_individual_epochs': 5, 'aggregate_mode': 'credit-sum', 'largest_criterion': 'layer', 'device_ids': [0]}
Files already downloaded and verified
CIFAR10 data shape torch.Size([50000, 3, 32, 32]), targets shape torch.Size([50000])
Files already downloaded and verified
CIFAR10 data shape torch.Size([10000, 3, 32, 32]), targets shape torch.Size([10000])
------
Train to split size: 40000. Validation size: 10000. Test size: 10000
------
Experiment : No.1/1
Shard sizes are:  [236, 422, 608, 794, 979, 1165, 1351, 1536, 1722, 1908, 2093, 2279, 2465, 2650, 2836, 3022, 3207, 3393, 3579, 3755]
CFFL server model validation accuracy : 9.2200%
CFFL server model test accuracy : 9.3400%

Epoch 1:
credits, credit threshold: tensor(0.0333)
tensor([0.0499, 0.0496, 0.0502, 0.0496, 0.0496, 0.0495, 0.0500, 0.0496, 0.0504,
        0.0498, 0.0497, 0.0503, 0.0504, 0.0496, 0.0505, 0.0505, 0.0503, 0.0503,
        0.0499, 0.0504])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0496, 0.0489, 0.0502, 0.0502, 0.0495, 0.0492, 0.0498, 0.0496, 0.0500,
        0.0504, 0.0497, 0.0498, 0.0507, 0.0500, 0.0504, 0.0509, 0.0505, 0.0502,
        0.0500, 0.0504])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.320%', '9.340%', '9.370%', '9.250%', '9.290%', '9.390%', '9.350%', '9.330%', '9.380%', '9.300%', '9.340%', '9.400%', '9.420%', '9.340%', '9.420%', '9.600%', '9.420%', '9.390%', '9.350%', '9.440%']
Workers DSSGD     accuracies:  ['9.340%', '9.340%', '9.320%', '9.370%', '9.280%', '9.320%', '9.410%', '9.410%', '9.490%', '9.480%', '9.480%', '9.570%', '9.630%', '9.630%', '9.710%', '9.950%', '10.030%', '10.230%', '10.510%', '10.920%']

Workers before    accuracies:  ['9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%']
Workers CFFL      accuracies:  ['9.370%', '9.350%', '9.350%', '9.300%', '9.350%', '9.350%', '9.340%', '9.320%', '9.360%', '9.310%', '9.350%', '9.350%', '9.340%', '9.350%', '9.340%', '9.360%', '9.340%', '9.330%', '9.340%', '9.330%']

Workers before pr accuracies:  ['9.500%', '9.280%', '9.810%', '9.980%', '9.360%', '9.370%', '9.660%', '9.460%', '9.730%', '10.820%', '9.450%', '9.770%', '9.940%', '9.480%', '9.970%', '10.010%', '9.690%', '9.780%', '9.630%', '9.930%']
Workers CFFL pret accuracies:  ['9.560%', '9.300%', '9.880%', '10.730%', '9.450%', '9.510%', '9.830%', '9.510%', '9.870%', '11.400%', '9.360%', '9.880%', '10.020%', '9.750%', '10.030%', '10.020%', '9.850%', '9.880%', '9.860%', '10.160%']

Epoch 21:
credits, credit threshold: tensor(0.0333)
tensor([0.0491, 0.0496, 0.0490, 0.0507, 0.0498, 0.0497, 0.0493, 0.0501, 0.0503,
        0.0505, 0.0491, 0.0497, 0.0499, 0.0507, 0.0495, 0.0499, 0.0507, 0.0508,
        0.0501, 0.0516])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0508, 0.0518, 0.0521, 0.0504, 0.0471, 0.0514, 0.0473, 0.0498, 0.0499,
        0.0495, 0.0488, 0.0507, 0.0510, 0.0499, 0.0499, 0.0510, 0.0480, 0.0498,
        0.0517, 0.0491])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['9.940%', '10.430%', '10.000%', '13.000%', '11.850%', '11.370%', '10.300%', '13.400%', '13.900%', '13.140%', '14.440%', '13.410%', '14.750%', '15.380%', '15.920%', '16.590%', '19.700%', '17.960%', '16.720%', '18.120%']
Workers DSSGD     accuracies:  ['14.940%', '14.960%', '15.080%', '14.820%', '14.880%', '15.070%', '15.540%', '15.610%', '15.790%', '16.230%', '16.520%', '16.740%', '17.100%', '17.240%', '16.780%', '16.080%', '15.260%', '14.250%', '13.150%', '12.570%']

Workers before    accuracies:  ['9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%']
Workers CFFL      accuracies:  ['10.130%', '11.640%', '10.080%', '12.140%', '10.640%', '10.970%', '10.360%', '10.930%', '12.290%', '12.000%', '12.920%', '11.350%', '13.790%', '13.160%', '11.530%', '11.260%', '12.170%', '11.680%', '11.130%', '13.060%']

Workers before pr accuracies:  ['9.500%', '9.280%', '9.810%', '9.980%', '9.360%', '9.370%', '9.660%', '9.460%', '9.730%', '10.820%', '9.450%', '9.770%', '9.940%', '9.480%', '9.970%', '10.010%', '9.690%', '9.780%', '9.630%', '9.930%']
Workers CFFL pret accuracies:  ['22.720%', '21.240%', '26.240%', '26.170%', '30.290%', '30.920%', '29.970%', '31.730%', '32.070%', '33.310%', '33.800%', '34.230%', '35.200%', '36.800%', '35.670%', '37.360%', '36.140%', '38.440%', '39.510%', '38.510%']

Epoch 41:
credits, credit threshold: tensor(0.0333)
tensor([0.0489, 0.0504, 0.0489, 0.0491, 0.0501, 0.0497, 0.0497, 0.0500, 0.0491,
        0.0497, 0.0501, 0.0499, 0.0502, 0.0501, 0.0505, 0.0504, 0.0507, 0.0503,
        0.0516, 0.0506])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0510, 0.0520, 0.0491, 0.0476, 0.0492, 0.0473, 0.0520, 0.0532, 0.0513,
        0.0488, 0.0485, 0.0533, 0.0506, 0.0502, 0.0477, 0.0523, 0.0493, 0.0493,
        0.0490, 0.0483])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.000%', '10.020%', '10.000%', '10.300%', '15.070%', '14.640%', '14.620%', '18.590%', '14.290%', '19.780%', '20.170%', '22.660%', '23.830%', '26.130%', '26.840%', '27.710%', '27.770%', '28.470%', '30.610%', '31.460%']
Workers DSSGD     accuracies:  ['14.930%', '14.980%', '15.340%', '16.310%', '16.770%', '17.570%', '18.970%', '20.020%', '21.080%', '22.370%', '23.140%', '23.530%', '23.140%', '22.940%', '22.770%', '22.610%', '22.410%', '21.810%', '21.620%', '21.410%']

Workers before    accuracies:  ['9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%']
Workers CFFL      accuracies:  ['16.120%', '16.530%', '15.290%', '16.690%', '19.470%', '18.830%', '17.440%', '18.060%', '15.490%', '20.510%', '17.440%', '19.600%', '17.230%', '18.360%', '20.230%', '19.630%', '20.330%', '20.010%', '21.120%', '20.290%']

Workers before pr accuracies:  ['9.500%', '9.280%', '9.810%', '9.980%', '9.360%', '9.370%', '9.660%', '9.460%', '9.730%', '10.820%', '9.450%', '9.770%', '9.940%', '9.480%', '9.970%', '10.010%', '9.690%', '9.780%', '9.630%', '9.930%']
Workers CFFL pret accuracies:  ['30.790%', '32.400%', '34.990%', '35.880%', '37.630%', '37.210%', '39.080%', '39.570%', '41.400%', '42.290%', '42.300%', '43.490%', '43.930%', '45.140%', '44.960%', '44.410%', '42.860%', '47.210%', '47.990%', '48.870%']

Epoch 61:
credits, credit threshold: tensor(0.0333)
tensor([0.0491, 0.0503, 0.0498, 0.0497, 0.0504, 0.0504, 0.0504, 0.0502, 0.0507,
        0.0506, 0.0501, 0.0502, 0.0503, 0.0502, 0.0499, 0.0499, 0.0486, 0.0499,
        0.0496, 0.0497])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0515, 0.0492, 0.0501, 0.0515, 0.0516, 0.0471, 0.0497, 0.0508, 0.0470,
        0.0507, 0.0517, 0.0495, 0.0518, 0.0530, 0.0456, 0.0497, 0.0490, 0.0494,
        0.0516, 0.0494])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.030%', '10.030%', '10.000%', '10.030%', '15.020%', '20.080%', '16.990%', '21.720%', '23.750%', '26.810%', '27.790%', '28.800%', '30.300%', '32.140%', '30.380%', '34.040%', '31.840%', '34.570%', '35.260%', '34.610%']
Workers DSSGD     accuracies:  ['16.400%', '16.490%', '16.450%', '16.720%', '17.060%', '17.260%', '17.810%', '18.510%', '19.190%', '20.170%', '21.300%', '22.470%', '23.620%', '24.730%', '25.710%', '26.690%', '27.850%', '29.160%', '29.670%', '30.070%']

Workers before    accuracies:  ['9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%']
Workers CFFL      accuracies:  ['21.720%', '21.790%', '21.480%', '21.860%', '24.740%', '24.550%', '26.160%', '25.540%', '24.320%', '25.450%', '25.020%', '26.290%', '26.650%', '27.400%', '27.240%', '27.000%', '27.120%', '28.430%', '28.100%', '29.160%']

Workers before pr accuracies:  ['9.500%', '9.280%', '9.810%', '9.980%', '9.360%', '9.370%', '9.660%', '9.460%', '9.730%', '10.820%', '9.450%', '9.770%', '9.940%', '9.480%', '9.970%', '10.010%', '9.690%', '9.780%', '9.630%', '9.930%']
Workers CFFL pret accuracies:  ['36.230%', '37.670%', '38.980%', '41.110%', '42.040%', '43.510%', '44.580%', '43.870%', '45.570%', '47.400%', '46.410%', '48.280%', '48.270%', '49.280%', '48.570%', '50.600%', '47.250%', '50.570%', '52.500%', '51.430%']

Epoch 81:
credits, credit threshold: tensor(0.0333)
tensor([0.0499, 0.0505, 0.0504, 0.0499, 0.0497, 0.0495, 0.0499, 0.0497, 0.0500,
        0.0502, 0.0498, 0.0500, 0.0497, 0.0503, 0.0503, 0.0505, 0.0497, 0.0498,
        0.0502, 0.0500])
Reputable parties:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

credits, credit_threshold pretrain: tensor(0.0333)
tensor([0.0521, 0.0514, 0.0469, 0.0500, 0.0486, 0.0464, 0.0462, 0.0522, 0.0561,
        0.0520, 0.0496, 0.0478, 0.0550, 0.0504, 0.0519, 0.0502, 0.0433, 0.0465,
        0.0508, 0.0525])
Reputable parties pretrain:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Below are testset accuracies: ---
Workers standalone accuracies:  ['10.390%', '10.020%', '10.350%', '12.720%', '17.760%', '23.010%', '23.390%', '27.190%', '29.700%', '31.480%', '29.830%', '32.670%', '33.700%', '34.970%', '35.610%', '36.460%', '31.010%', '38.580%', '39.710%', '40.790%']
Workers DSSGD     accuracies:  ['27.900%', '27.720%', '27.550%', '27.590%', '27.130%', '26.910%', '26.330%', '25.950%', '25.660%', '25.220%', '24.280%', '23.630%', '23.320%', '23.160%', '23.190%', '23.340%', '23.400%', '23.540%', '23.700%', '24.040%']

Workers before    accuracies:  ['9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%', '9.340%']
Workers CFFL      accuracies:  ['25.290%', '23.790%', '27.410%', '26.320%', '28.950%', '28.550%', '29.180%', '29.560%', '30.440%', '30.520%', '30.600%', '31.250%', '31.460%', '32.200%', '32.420%', '31.900%', '32.570%', '33.110%', '33.590%', '33.730%']

Workers before pr accuracies:  ['9.500%', '9.280%', '9.810%', '9.980%', '9.360%', '9.370%', '9.660%', '9.460%', '9.730%', '10.820%', '9.450%', '9.770%', '9.940%', '9.480%', '9.970%', '10.010%', '9.690%', '9.780%', '9.630%', '9.930%']
Workers CFFL pret accuracies:  ['37.490%', '39.280%', '40.860%', '44.780%', '44.210%', '43.810%', '47.110%', '45.560%', '46.770%', '50.370%', '47.510%', '50.030%', '49.490%', '50.680%', '50.710%', '52.060%', '50.190%', '51.770%', '53.710%', '53.740%']
pretraining 13.423068761825562
evaluation after pretraining 10.399915933609009
workers local training 3154.2363979816437
server aggregation 477.54600954055786
server aggregation with pretraining 461.621244430542
server aggregation dssgd 456.4154403209686
fed model eval on valid loader 45.15807127952576
credit updates 8.29104733467102
assign updates 12.296303272247314
performance update 1785.2976562976837
total seconds 6424.6851551532745
Time_dict-----
{"pretraining": 13.423068761825562, "evaluation after pretraining": 10.399915933609009, "workers local training": 3154.2363979816437, "server aggregation": 477.54600954055786, "server aggregation with pretraining": 461.621244430542, "server aggregation dssgd": 456.4154403209686, "fed model eval on valid loader": 45.15807127952576, "credit updates": 8.29104733467102, "assign updates": 12.296303272247314, "performance update": 1785.2976562976837}
-----
Performance and Fairness analysis: 
Worker credits : [0.04993526637554169, 0.05013938248157501, 0.050225380808115005, 0.050010669976472855, 0.04990121349692345, 0.04961513727903366, 0.05011928454041481, 0.04990311339497566, 0.050079166889190674, 0.05011636018753052, 0.049862686544656754, 0.05019766837358475, 0.04998847469687462, 0.05007801949977875, 0.05047594755887985, 0.050118207931518555, 0.04856372997164726, 0.049992773681879044, 0.050349149852991104, 0.05032843351364136]
Number of reputable parties:  20
Worker credits pretrain: [0.051784444600343704, 0.047439102083444595, 0.04875139519572258, 0.04686632379889488, 0.04610951244831085, 0.05135168507695198, 0.05049482733011246, 0.04951033368706703, 0.052065979689359665, 0.05061572790145874, 0.046394456177949905, 0.05060045048594475, 0.04735599458217621, 0.048936136066913605, 0.05089472606778145, 0.053825974464416504, 0.050847020000219345, 0.053421515971422195, 0.05301589146256447, 0.04971843585371971]
Number of reputable parties with pretrain:  20
----Results without pretrain
standalone_best_worker  -  0.4226999878883362
CFFL_best_worker  -  0.375900000333786
rr_dssgd_best  -  0.26600000262260437
standlone_vs_rrdssgd  -  [-0.25364428080767204]
standalone_vs_final  -  [0.9394926730649379]
----
----Results with pretrain
standalone_best_worker  -  0.41679999232292175
CFFL_best_worker  -  0.5317999720573425
rr_dssgd_best  -  0.2597000002861023
standlone_vs_rrdssgd  -  [-0.25364428080767204]
standalone_vs_final  -  [0.9551937642055245]
----
for all without pretraining:
standalone_vs_final_mean [0.9394926730649379]
standlone_vs_rrdssgd_mean [-0.25364428080767204]
rr_dssgd_best_mean 0.26600000262260437
CFFL_best_worker_mean 0.375900000333786
standalone_best_worker_mean 0.4226999878883362

for all the pretraining included:
standalone_vs_final_mean [0.9551937642055245]
standlone_vs_rrdssgd_mean [-0.25364428080767204]
rr_dssgd_best_mean 0.2597000002861023
CFFL_best_worker_mean 0.5317999720573425
standalone_best_worker_mean 0.41679999232292175
[Finished in 6437.2s]